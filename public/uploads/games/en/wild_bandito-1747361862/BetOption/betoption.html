<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
	<title>bet option module</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
	
	<!-- Made with Construct, the game and app creator :: https://www.construct.net -->
	

<style>
html, body {
	padding: 0;
	margin: 0;
	overflow: hidden;
	height: 100%;
}

/* body {
	background: #000000;
	color: white;
} */

html, body, canvas {
	touch-action-delay: none;
	touch-action: none;
}

canvas, .c3htmlwrap {
	position: absolute;
}

.c3htmlwrap {
	contain: strict;
}

.c3overlay {
	pointer-events: none;
}

.c3htmlwrap[interactive] > * {
	pointer-events: auto;
}

/* HACK - work around elements being selectable only in iOS WKWebView for some reason */
html[ioswebview] .c3htmlwrap,
html[ioswebview] canvas {
	-webkit-user-select: none;
	user-select: none;
}

html[ioswebview] .c3htmlwrap > * {
	-webkit-user-select: auto;
	user-select: auto;
}

#notSupportedWrap {
	margin: 2em auto 1em auto;
	width: 75%;
	max-width: 45em;
	border: 2px solid #aaa;
	border-radius: 1em;
	padding: 2em;
	background-color: #f0f0f0;
	font-family: "Segoe UI", Frutiger, "Frutiger Linotype", "Dejavu Sans", "Helvetica Neue", Arial, sans-serif;
	color: black;
}

#notSupportedTitle {
	font-size: 1.8em;
}

.notSupportedMessage {
	font-size: 1.2em;
}

.notSupportedMessage em {
	color: #888;
}

/* bbcode styles */
.bbCodeH1 {
	font-size: 2em;
	font-weight: bold;
}

.bbCodeH2 {
	font-size: 1.5em;
	font-weight: bold;
}

.bbCodeH3 {
	font-size: 1.25em;
	font-weight: bold;
}

.bbCodeH4 {
	font-size: 1.1em;
	font-weight: bold;
}

.bbCodeItem::before {
	content: " • ";
}

/* For text icons converted to HTML: size the height to the line height
   preserving the aspect ratio. Also add position: relative as that allows
   just adding a 'top' style for the iconoffsety style. */
.c3-text-icon {
	height: 1em;
	width: auto;
	position: relative;
}

/* screen reader text */
.c3-screen-reader-text {
	position: absolute;
	width: 1px;
    height: 1px;
    overflow: hidden;
    clip: rect(1px, 1px, 1px, 1px);
}
</style>


<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">
<style>
html, body {
	pointer-events: none;
	}
</style>
</head> 
 
<body>

<script>
self.c3_base64files = {
	"scripts/c3main.js": {
		"type": "application/javascript",
		"str": "// Generated by Construct, the game and animation creation tool\n// Visit: https://www.construct.net\n\n{let O=function(e){Tr=e},L=function(e){return e*Or},k=function(e,t){return Math.abs(e-t)<=Ir*Math.max(1,Math.abs(e),Math.abs(t))},N=function(){var e=new Tr(4);return Tr!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},W=function(e){var t=new Tr(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},V=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},U=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},j=function(e,t,s,i){var r=new Tr(4);return r[0]=e,r[1]=t,r[2]=s,r[3]=i,r},H=function(e,t,s,i,r){return e[0]=t,e[1]=s,e[2]=i,e[3]=r,e},X=function(e,t){var s;return e===t?(s=t[1],e[1]=t[2],e[2]=s):(e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3]),e},z=function(e,t){var s=t[0],i=t[1],r=t[2],n=s*(t=t[3])-r*i;return n?(e[0]=t*(n=1/n),e[1]=-i*n,e[2]=-r*n,e[3]=s*n,e):null},Y=function(e,t){var s=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=s,e},q=function(e){return e[0]*e[3]-e[2]*e[1]},e=function(e,t,s){var i=t[0],r=t[1],n=t[2],t=t[3],a=s[0],o=s[1],h=s[2],s=s[3];return e[0]=i*a+n*o,e[1]=r*a+t*o,e[2]=i*h+n*s,e[3]=r*h+t*s,e},K=function(e,t,s){var i=t[0],r=t[1],n=t[2],t=t[3],a=Math.sin(s),s=Math.cos(s);return e[0]=i*s+n*a,e[1]=r*s+t*a,e[2]=i*-a+n*s,e[3]=r*-a+t*s,e},J=function(e,t,s){var i=t[0],r=t[1],n=t[2],t=t[3],a=s[0],s=s[1];return e[0]=i*a,e[1]=r*a,e[2]=n*s,e[3]=t*s,e},Z=function(e,t){var s=Math.sin(t),t=Math.cos(t);return e[0]=t,e[1]=s,e[2]=-s,e[3]=t,e},Q=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e},$=function(e){return\"mat2(\"+e[0]+\", \"+e[1]+\", \"+e[2]+\", \"+e[3]+\")\"},ee=function(e){return Math.hypot(e[0],e[1],e[2],e[3])},te=function(e,t,s,i){return e[2]=i[2]/i[0],s[0]=i[0],s[1]=i[1],s[3]=i[3]-e[2]*s[1],[e,t,s]},se=function(e,t,s){return e[0]=t[0]+s[0],e[1]=t[1]+s[1],e[2]=t[2]+s[2],e[3]=t[3]+s[3],e},t=function(e,t,s){return e[0]=t[0]-s[0],e[1]=t[1]-s[1],e[2]=t[2]-s[2],e[3]=t[3]-s[3],e},ie=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},re=function(e,t){var s=e[0],i=e[1],r=e[2],e=e[3],n=t[0],a=t[1],o=t[2],t=t[3];return Math.abs(s-n)<=Ir*Math.max(1,Math.abs(s),Math.abs(n))&&Math.abs(i-a)<=Ir*Math.max(1,Math.abs(i),Math.abs(a))&&Math.abs(r-o)<=Ir*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(e-t)<=Ir*Math.max(1,Math.abs(e),Math.abs(t))},ne=function(e,t,s){return e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e[3]=t[3]*s,e},ae=function(e,t,s,i){return e[0]=t[0]+s[0]*i,e[1]=t[1]+s[1]*i,e[2]=t[2]+s[2]*i,e[3]=t[3]+s[3]*i,e},oe=function(){var e=new Tr(6);return Tr!=Float32Array&&(e[1]=0,e[2]=0,e[4]=0,e[5]=0),e[0]=1,e[3]=1,e},he=function(e){var t=new Tr(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},le=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},ce=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},ue=function(e,t,s,i,r,n){var a=new Tr(6);return a[0]=e,a[1]=t,a[2]=s,a[3]=i,a[4]=r,a[5]=n,a},_e=function(e,t,s,i,r,n,a){return e[0]=t,e[1]=s,e[2]=i,e[3]=r,e[4]=n,e[5]=a,e},de=function(e,t){var s=t[0],i=t[1],r=t[2],n=t[3],a=t[4],t=t[5],o=s*n-i*r;return o?(e[0]=n*(o=1/o),e[1]=-i*o,e[2]=-r*o,e[3]=s*o,e[4]=(r*t-n*a)*o,e[5]=(i*a-s*t)*o,e):null},pe=function(e){return e[0]*e[3]-e[1]*e[2]},s=function(e,t,s){var i=t[0],r=t[1],n=t[2],a=t[3],o=t[4],t=t[5],h=s[0],l=s[1],c=s[2],u=s[3],_=s[4],s=s[5];return e[0]=i*h+n*l,e[1]=r*h+a*l,e[2]=i*c+n*u,e[3]=r*c+a*u,e[4]=i*_+n*s+o,e[5]=r*_+a*s+t,e},fe=function(e,t,s){var i=t[0],r=t[1],n=t[2],a=t[3],o=t[4],t=t[5],h=Math.sin(s),s=Math.cos(s);return e[0]=i*s+n*h,e[1]=r*s+a*h,e[2]=i*-h+n*s,e[3]=r*-h+a*s,e[4]=o,e[5]=t,e},me=function(e,t,s){var i=t[0],r=t[1],n=t[2],a=t[3],o=t[4],t=t[5],h=s[0],s=s[1];return e[0]=i*h,e[1]=r*h,e[2]=n*s,e[3]=a*s,e[4]=o,e[5]=t,e},ge=function(e,t,s){var i=t[0],r=t[1],n=t[2],a=t[3],o=t[4],t=t[5],h=s[0],s=s[1];return e[0]=i,e[1]=r,e[2]=n,e[3]=a,e[4]=i*h+n*s+o,e[5]=r*h+a*s+t,e},Se=function(e,t){var s=Math.sin(t),t=Math.cos(t);return e[0]=t,e[1]=s,e[2]=-s,e[3]=t,e[4]=0,e[5]=0,e},ye=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e},Ge=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e},Ie=function(e){return\"mat2d(\"+e[0]+\", \"+e[1]+\", \"+e[2]+\", \"+e[3]+\", \"+e[4]+\", \"+e[5]+\")\"},Te=function(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],1)},Ce=function(e,t,s){return e[0]=t[0]+s[0],e[1]=t[1]+s[1],e[2]=t[2]+s[2],e[3]=t[3]+s[3],e[4]=t[4]+s[4],e[5]=t[5]+s[5],e},i=function(e,t,s){return e[0]=t[0]-s[0],e[1]=t[1]-s[1],e[2]=t[2]-s[2],e[3]=t[3]-s[3],e[4]=t[4]-s[4],e[5]=t[5]-s[5],e},be=function(e,t,s){return e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e[3]=t[3]*s,e[4]=t[4]*s,e[5]=t[5]*s,e},we=function(e,t,s,i){return e[0]=t[0]+s[0]*i,e[1]=t[1]+s[1]*i,e[2]=t[2]+s[2]*i,e[3]=t[3]+s[3]*i,e[4]=t[4]+s[4]*i,e[5]=t[5]+s[5]*i,e},xe=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]},ve=function(e,t){var s=e[0],i=e[1],r=e[2],n=e[3],a=e[4],e=e[5],o=t[0],h=t[1],l=t[2],c=t[3],u=t[4],t=t[5];return Math.abs(s-o)<=Ir*Math.max(1,Math.abs(s),Math.abs(o))&&Math.abs(i-h)<=Ir*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(r-l)<=Ir*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(n-c)<=Ir*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(a-u)<=Ir*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(e-t)<=Ir*Math.max(1,Math.abs(e),Math.abs(t))},r=function(){var e=new Tr(9);return Tr!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},Pe=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},Re=function(e){var t=new Tr(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},Ae=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},Me=function(e,t,s,i,r,n,a,o,h){var l=new Tr(9);return l[0]=e,l[1]=t,l[2]=s,l[3]=i,l[4]=r,l[5]=n,l[6]=a,l[7]=o,l[8]=h,l},De=function(e,t,s,i,r,n,a,o,h,l){return e[0]=t,e[1]=s,e[2]=i,e[3]=r,e[4]=n,e[5]=a,e[6]=o,e[7]=h,e[8]=l,e},Ee=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},Fe=function(e,t){var s,i,r;return e===t?(s=t[1],i=t[2],r=t[5],e[1]=t[3],e[2]=t[6],e[3]=s,e[5]=t[7],e[6]=i,e[7]=r):(e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8]),e},Be=function(e,t){var s=t[0],i=t[1],r=t[2],n=t[3],a=t[4],o=t[5],h=t[6],l=t[7],c=(t=t[8])*a-o*l,u=-t*n+o*h,_=l*n-a*h,d=s*c+i*u+r*_;return d?(e[0]=c*(d=1/d),e[1]=(-t*i+r*l)*d,e[2]=(o*i-r*a)*d,e[3]=u*d,e[4]=(t*s-r*h)*d,e[5]=(-o*s+r*n)*d,e[6]=_*d,e[7]=(-l*s+i*h)*d,e[8]=(a*s-i*n)*d,e):null},Oe=function(e,t){var s=t[0],i=t[1],r=t[2],n=t[3],a=t[4],o=t[5],h=t[6],l=t[7],t=t[8];return e[0]=a*t-o*l,e[1]=r*l-i*t,e[2]=i*o-r*a,e[3]=o*h-n*t,e[4]=s*t-r*h,e[5]=r*n-s*o,e[6]=n*l-a*h,e[7]=i*h-s*l,e[8]=s*a-i*n,e},Le=function(e){var t=e[0],s=e[3],i=e[4],r=e[5],n=e[6],a=e[7],o=e[8];return t*(o*i-r*a)+e[1]*(-o*s+r*n)+e[2]*(a*s-i*n)},n=function(e,t,s){var i=t[0],r=t[1],n=t[2],a=t[3],o=t[4],h=t[5],l=t[6],c=t[7],t=t[8],u=s[0],_=s[1],d=s[2],p=s[3],f=s[4],m=s[5],g=s[6],S=s[7],s=s[8];return e[0]=u*i+_*a+d*l,e[1]=u*r+_*o+d*c,e[2]=u*n+_*h+d*t,e[3]=p*i+f*a+m*l,e[4]=p*r+f*o+m*c,e[5]=p*n+f*h+m*t,e[6]=g*i+S*a+s*l,e[7]=g*r+S*o+s*c,e[8]=g*n+S*h+s*t,e},ke=function(e,t,s){var i=t[0],r=t[1],n=t[2],a=t[3],o=t[4],h=t[5],l=t[6],c=t[7],t=t[8],u=s[0],s=s[1];return e[0]=i,e[1]=r,e[2]=n,e[3]=a,e[4]=o,e[5]=h,e[6]=u*i+s*a+l,e[7]=u*r+s*o+c,e[8]=u*n+s*h+t,e},Ne=function(e,t,s){var i=t[0],r=t[1],n=t[2],a=t[3],o=t[4],h=t[5],l=t[6],c=t[7],t=t[8],u=Math.sin(s),s=Math.cos(s);return e[0]=s*i+u*a,e[1]=s*r+u*o,e[2]=s*n+u*h,e[3]=s*a-u*i,e[4]=s*o-u*r,e[5]=s*h-u*n,e[6]=l,e[7]=c,e[8]=t,e},We=function(e,t,s){var i=s[0],s=s[1];return e[0]=i*t[0],e[1]=i*t[1],e[2]=i*t[2],e[3]=s*t[3],e[4]=s*t[4],e[5]=s*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},Ve=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e},Ue=function(e,t){var s=Math.sin(t),t=Math.cos(t);return e[0]=t,e[1]=s,e[2]=0,e[3]=-s,e[4]=t,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},je=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},He=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e},Xe=function(e,t){var s=t[0],i=t[2],r=i+i,s=s*(l=s+s),n=(a=t[1])*l,a=a*(c=a+a),o=i*l,h=i*c,l=(t=t[3])*l,c=t*c,t=t*r;return e[0]=1-a-(i=i*r),e[3]=n-t,e[6]=o+c,e[1]=n+t,e[4]=1-s-i,e[7]=h-l,e[2]=o-c,e[5]=h+l,e[8]=1-s-a,e},ze=function(e,t){var s=t[0],i=t[1],r=t[2],n=t[3],a=t[4],o=t[5],h=t[6],l=t[7],c=t[8],u=t[9],_=t[10],d=t[11],p=t[12],f=t[13],m=t[14],g=s*o-i*a,S=s*h-r*a,y=s*l-n*a,G=i*h-r*o,I=i*l-n*o,T=r*l-n*h,C=c*f-u*p,b=c*m-_*p,w=u*m-_*f;return(d=g*(_=_*(t=t[15])-d*m)-S*(u=u*t-d*f)+y*w+G*(c=c*t-d*p)-I*b+T*C)?(e[0]=(o*_-h*u+l*w)*(d=1/d),e[1]=(h*c-a*_-l*b)*d,e[2]=(a*u-o*c+l*C)*d,e[3]=(r*u-i*_-n*w)*d,e[4]=(s*_-r*c+n*b)*d,e[5]=(i*c-s*u-n*C)*d,e[6]=(f*T-m*I+t*G)*d,e[7]=(m*y-p*T-t*S)*d,e[8]=(p*I-f*y+t*g)*d,e):null},Ye=function(e,t,s){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/s,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e},qe=function(e){return\"mat3(\"+e[0]+\", \"+e[1]+\", \"+e[2]+\", \"+e[3]+\", \"+e[4]+\", \"+e[5]+\", \"+e[6]+\", \"+e[7]+\", \"+e[8]+\")\"},Ke=function(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])},Je=function(e,t,s){return e[0]=t[0]+s[0],e[1]=t[1]+s[1],e[2]=t[2]+s[2],e[3]=t[3]+s[3],e[4]=t[4]+s[4],e[5]=t[5]+s[5],e[6]=t[6]+s[6],e[7]=t[7]+s[7],e[8]=t[8]+s[8],e},a=function(e,t,s){return e[0]=t[0]-s[0],e[1]=t[1]-s[1],e[2]=t[2]-s[2],e[3]=t[3]-s[3],e[4]=t[4]-s[4],e[5]=t[5]-s[5],e[6]=t[6]-s[6],e[7]=t[7]-s[7],e[8]=t[8]-s[8],e},Ze=function(e,t,s){return e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e[3]=t[3]*s,e[4]=t[4]*s,e[5]=t[5]*s,e[6]=t[6]*s,e[7]=t[7]*s,e[8]=t[8]*s,e},Qe=function(e,t,s,i){return e[0]=t[0]+s[0]*i,e[1]=t[1]+s[1]*i,e[2]=t[2]+s[2]*i,e[3]=t[3]+s[3]*i,e[4]=t[4]+s[4]*i,e[5]=t[5]+s[5]*i,e[6]=t[6]+s[6]*i,e[7]=t[7]+s[7]*i,e[8]=t[8]+s[8]*i,e},$e=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},et=function(e,t){var s=e[0],i=e[1],r=e[2],n=e[3],a=e[4],o=e[5],h=e[6],l=e[7],e=e[8],c=t[0],u=t[1],_=t[2],d=t[3],p=t[4],f=t[5],m=t[6],g=t[7],t=t[8];return Math.abs(s-c)<=Ir*Math.max(1,Math.abs(s),Math.abs(c))&&Math.abs(i-u)<=Ir*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(r-_)<=Ir*Math.max(1,Math.abs(r),Math.abs(_))&&Math.abs(n-d)<=Ir*Math.max(1,Math.abs(n),Math.abs(d))&&Math.abs(a-p)<=Ir*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(o-f)<=Ir*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(h-m)<=Ir*Math.max(1,Math.abs(h),Math.abs(m))&&Math.abs(l-g)<=Ir*Math.max(1,Math.abs(l),Math.abs(g))&&Math.abs(e-t)<=Ir*Math.max(1,Math.abs(e),Math.abs(t))},tt=function(){var e=new Tr(16);return Tr!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},st=function(e){var t=new Tr(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},it=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},rt=function(e,t,s,i,r,n,a,o,h,l,c,u,_,d,p,f){var m=new Tr(16);return m[0]=e,m[1]=t,m[2]=s,m[3]=i,m[4]=r,m[5]=n,m[6]=a,m[7]=o,m[8]=h,m[9]=l,m[10]=c,m[11]=u,m[12]=_,m[13]=d,m[14]=p,m[15]=f,m},nt=function(e,t,s,i,r,n,a,o,h,l,c,u,_,d,p,f,m){return e[0]=t,e[1]=s,e[2]=i,e[3]=r,e[4]=n,e[5]=a,e[6]=o,e[7]=h,e[8]=l,e[9]=c,e[10]=u,e[11]=_,e[12]=d,e[13]=p,e[14]=f,e[15]=m,e},p=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},at=function(e,t){var s,i,r,n,a,o;return e===t?(s=t[1],i=t[2],r=t[3],n=t[6],a=t[7],o=t[11],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=s,e[6]=t[9],e[7]=t[13],e[8]=i,e[9]=n,e[11]=t[14],e[12]=r,e[13]=a,e[14]=o):(e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15]),e},ot=function(e,t){var s=t[0],i=t[1],r=t[2],n=t[3],a=t[4],o=t[5],h=t[6],l=t[7],c=t[8],u=t[9],_=t[10],d=t[11],p=t[12],f=t[13],m=t[14],g=s*o-i*a,S=s*h-r*a,y=s*l-n*a,G=i*h-r*o,I=i*l-n*o,T=r*l-n*h,C=c*f-u*p,b=c*m-_*p,w=c*(t=t[15])-d*p,x=u*m-_*f,v=u*t-d*f,P=_*t-d*m,R=g*P-S*v+y*x+G*w-I*b+T*C;return R?(e[0]=(o*P-h*v+l*x)*(R=1/R),e[1]=(r*v-i*P-n*x)*R,e[2]=(f*T-m*I+t*G)*R,e[3]=(_*I-u*T-d*G)*R,e[4]=(h*w-a*P-l*b)*R,e[5]=(s*P-r*w+n*b)*R,e[6]=(m*y-p*T-t*S)*R,e[7]=(c*T-_*y+d*S)*R,e[8]=(a*v-o*w+l*C)*R,e[9]=(i*w-s*v-n*C)*R,e[10]=(p*I-f*y+t*g)*R,e[11]=(u*y-c*I-d*g)*R,e[12]=(o*b-a*x-h*C)*R,e[13]=(s*x-i*b+r*C)*R,e[14]=(f*S-p*G-m*g)*R,e[15]=(c*G-u*S+_*g)*R,e):null},ht=function(e,t){var s=t[0],i=t[1],r=t[2],n=t[3],a=t[4],o=t[5],h=t[6],l=t[7],c=t[8],u=t[9],_=t[10],d=t[11],p=t[12],f=t[13],m=t[14],g=s*o-i*a,S=s*h-r*a,y=s*l-n*a,G=i*h-r*o,I=i*l-n*o,T=r*l-n*h,C=c*f-u*p,b=c*m-_*p,w=c*(t=t[15])-d*p,x=u*m-_*f,v=u*t-d*f,P=_*t-d*m;return e[0]=o*P-h*v+l*x,e[1]=r*v-i*P-n*x,e[2]=f*T-m*I+t*G,e[3]=_*I-u*T-d*G,e[4]=h*w-a*P-l*b,e[5]=s*P-r*w+n*b,e[6]=m*y-p*T-t*S,e[7]=c*T-_*y+d*S,e[8]=a*v-o*w+l*C,e[9]=i*w-s*v-n*C,e[10]=p*I-f*y+t*g,e[11]=u*y-c*I-d*g,e[12]=o*b-a*x-h*C,e[13]=s*x-i*b+r*C,e[14]=f*S-p*G-m*g,e[15]=c*G-u*S+_*g,e},lt=function(e){var t=e[0],s=e[1],i=e[2],r=e[4],n=e[5],a=e[6],o=e[8],h=e[9],l=e[10],c=e[12],u=e[13],_=e[14],d=t*n-s*r,p=t*a-i*r,f=s*a-i*n,m=o*u-h*c,g=o*_-l*c,S=h*_-l*u;return e[7]*(t*S-s*g+i*m)-e[3]*(r*S-n*g+a*m)+e[15]*(o*f-h*p+l*d)-e[11]*(c*f-u*p+_*d)},o=function(e,t,s){var i=t[0],r=t[1],n=t[2],a=t[3],o=t[4],h=t[5],l=t[6],c=t[7],u=t[8],_=t[9],d=t[10],p=t[11],f=t[12],m=t[13],g=t[14],t=t[15],S=s[0],y=s[1],G=s[2],I=s[3];return e[0]=S*i+y*o+G*u+I*f,e[1]=S*r+y*h+G*_+I*m,e[2]=S*n+y*l+G*d+I*g,e[3]=S*a+y*c+G*p+I*t,e[4]=(S=s[4])*i+(y=s[5])*o+(G=s[6])*u+(I=s[7])*f,e[5]=S*r+y*h+G*_+I*m,e[6]=S*n+y*l+G*d+I*g,e[7]=S*a+y*c+G*p+I*t,e[8]=(S=s[8])*i+(y=s[9])*o+(G=s[10])*u+(I=s[11])*f,e[9]=S*r+y*h+G*_+I*m,e[10]=S*n+y*l+G*d+I*g,e[11]=S*a+y*c+G*p+I*t,e[12]=(S=s[12])*i+(y=s[13])*o+(G=s[14])*u+(I=s[15])*f,e[13]=S*r+y*h+G*_+I*m,e[14]=S*n+y*l+G*d+I*g,e[15]=S*a+y*c+G*p+I*t,e},ct=function(e,t,s){var i,r,n,a,o,h,l,c,u,_,d,p,f=s[0],m=s[1],s=s[2];return t===e?(e[12]=t[0]*f+t[4]*m+t[8]*s+t[12],e[13]=t[1]*f+t[5]*m+t[9]*s+t[13],e[14]=t[2]*f+t[6]*m+t[10]*s+t[14],e[15]=t[3]*f+t[7]*m+t[11]*s+t[15]):(i=t[0],r=t[1],n=t[2],a=t[3],o=t[4],h=t[5],l=t[6],c=t[7],u=t[8],_=t[9],d=t[10],p=t[11],e[0]=i,e[1]=r,e[2]=n,e[3]=a,e[4]=o,e[5]=h,e[6]=l,e[7]=c,e[8]=u,e[9]=_,e[10]=d,e[11]=p,e[12]=i*f+o*m+u*s+t[12],e[13]=r*f+h*m+_*s+t[13],e[14]=n*f+l*m+d*s+t[14],e[15]=a*f+c*m+p*s+t[15]),e},ut=function(e,t,s){var i=s[0],r=s[1],s=s[2];return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*s,e[9]=t[9]*s,e[10]=t[10]*s,e[11]=t[11]*s,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},_t=function(e,t,s,i){var r,n,a,o,h,l,c,u,_,d,p,f,m,g,S,y,G,I,T,C,b=i[0],w=i[1],i=i[2],x=Math.hypot(b,w,i);return x<Ir?null:(b*=x=1/x,w*=x,i*=x,x=Math.sin(s),s=Math.cos(s),n=t[0],a=t[1],o=t[2],h=t[3],c=t[5],u=t[6],_=t[7],p=t[9],f=t[10],m=t[11],S=b*w*(r=1-s)-i*x,y=w*w*r+s,G=i*w*r+b*x,I=b*i*r+w*x,T=w*i*r-b*x,C=i*i*r+s,e[0]=n*(s=b*b*r+s)+(l=t[4])*(g=w*b*r+i*x)+(d=t[8])*(i=i*b*r-w*x),e[1]=a*s+c*g+p*i,e[2]=o*s+u*g+f*i,e[3]=h*s+_*g+m*i,e[4]=n*S+l*y+d*G,e[5]=a*S+c*y+p*G,e[6]=o*S+u*y+f*G,e[7]=h*S+_*y+m*G,e[8]=n*I+l*T+d*C,e[9]=a*I+c*T+p*C,e[10]=o*I+u*T+f*C,e[11]=h*I+_*T+m*C,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)},dt=function(e,t,s){var i=Math.sin(s),s=Math.cos(s),r=t[4],n=t[5],a=t[6],o=t[7],h=t[8],l=t[9],c=t[10],u=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=r*s+h*i,e[5]=n*s+l*i,e[6]=a*s+c*i,e[7]=o*s+u*i,e[8]=h*s-r*i,e[9]=l*s-n*i,e[10]=c*s-a*i,e[11]=u*s-o*i,e},pt=function(e,t,s){var i=Math.sin(s),s=Math.cos(s),r=t[0],n=t[1],a=t[2],o=t[3],h=t[8],l=t[9],c=t[10],u=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=r*s-h*i,e[1]=n*s-l*i,e[2]=a*s-c*i,e[3]=o*s-u*i,e[8]=r*i+h*s,e[9]=n*i+l*s,e[10]=a*i+c*s,e[11]=o*i+u*s,e},ft=function(e,t,s){var i=Math.sin(s),s=Math.cos(s),r=t[0],n=t[1],a=t[2],o=t[3],h=t[4],l=t[5],c=t[6],u=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=r*s+h*i,e[1]=n*s+l*i,e[2]=a*s+c*i,e[3]=o*s+u*i,e[4]=h*s-r*i,e[5]=l*s-n*i,e[6]=c*s-a*i,e[7]=u*s-o*i,e},mt=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},gt=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},St=function(e,t,s){var i,r=s[0],n=s[1],s=s[2],a=Math.hypot(r,n,s);return a<Ir?null:(r*=a=1/a,n*=a,s*=a,a=Math.sin(t),t=Math.cos(t),e[0]=r*r*(i=1-t)+t,e[1]=n*r*i+s*a,e[2]=s*r*i-n*a,e[3]=0,e[4]=r*n*i-s*a,e[5]=n*n*i+t,e[6]=s*n*i+r*a,e[7]=0,e[8]=r*s*i+n*a,e[9]=n*s*i-r*a,e[10]=s*s*i+t,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)},yt=function(e,t){var s=Math.sin(t),t=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t,e[6]=s,e[7]=0,e[8]=0,e[9]=-s,e[10]=t,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},Gt=function(e,t){var s=Math.sin(t),t=Math.cos(t);return e[0]=t,e[1]=0,e[2]=-s,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=s,e[9]=0,e[10]=t,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},It=function(e,t){var s=Math.sin(t),t=Math.cos(t);return e[0]=t,e[1]=s,e[2]=0,e[3]=0,e[4]=-s,e[5]=t,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},_=function(e,t,s){var i=t[0],r=t[2],n=r+r,a=i*(c=i+i),o=i*(u=(l=t[1])+l),i=i*n,h=l*u,l=l*n,c=(t=t[3])*c,u=t*u,t=t*n;return e[0]=1-(h+(r=r*n)),e[1]=o+t,e[2]=i-u,e[3]=0,e[4]=o-t,e[5]=1-(a+r),e[6]=l+c,e[7]=0,e[8]=i+u,e[9]=l-c,e[10]=1-(a+h),e[11]=0,e[12]=s[0],e[13]=s[1],e[14]=s[2],e[15]=1,e},Tt=function(e,t){var s=new Tr(3),i=-t[0],r=-t[1],n=-t[2],a=t[3],o=t[4],h=t[5],l=t[6],c=t[7],u=i*i+r*r+n*n+a*a;return 0<u?(s[0]=2*(o*a+c*i+h*n-l*r)/u,s[1]=2*(h*a+c*r+l*i-o*n)/u,s[2]=2*(l*a+c*n+o*r-h*i)/u):(s[0]=2*(o*a+c*i+h*n-l*r),s[1]=2*(h*a+c*r+l*i-o*n),s[2]=2*(l*a+c*n+o*r-h*i)),_(e,t,s),e},h=function(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e},d=function(e,t){var s=t[0],i=t[4],r=t[5],n=t[6],a=t[8],o=t[9],h=t[10];return e[0]=Math.hypot(s,t[1],t[2]),e[1]=Math.hypot(i,r,n),e[2]=Math.hypot(a,o,h),e},l=function(e,t){var s=new Tr(3),i=(d(s,t),1/s[0]),r=t[0]*i,n=t[1]*(c=1/s[1]),a=t[2]*(s=1/s[2]),o=t[4]*i,h=t[5]*c,l=t[6]*s,i=t[8]*i,c=t[9]*c,u=0;return 0<(s=r+h+(t=t[10]*s))?(u=2*Math.sqrt(1+s),e[3]=.25*u,e[0]=(l-c)/u,e[1]=(i-a)/u,e[2]=(n-o)/u):h<r&&t<r?(u=2*Math.sqrt(1+r-h-t),e[3]=(l-c)/u,e[0]=.25*u,e[1]=(n+o)/u,e[2]=(i+a)/u):t<h?(u=2*Math.sqrt(1+h-r-t),e[3]=(i-a)/u,e[0]=(n+o)/u,e[1]=.25*u,e[2]=(l+c)/u):(u=2*Math.sqrt(1+t-r-h),e[3]=(n-o)/u,e[0]=(i+a)/u,e[1]=(l+c)/u,e[2]=.25*u),e},Ct=function(e,t,s,i){t[0]=i[12],t[1]=i[13],t[2]=i[14];var t=i[0],r=i[1],n=i[2],a=i[4],o=i[5],h=i[6],l=i[8],c=i[9],i=i[10],u=(s[0]=Math.hypot(t,r,n),s[1]=Math.hypot(a,o,h),s[2]=Math.hypot(l,c,i),1/s[0]),_=1/s[1],t=t*u,r=r*_,n=n*(s=1/s[2]),a=a*u,h=h*s,l=l*u,u=c*_,c=i*s,i=0;return 0<(_=t+(o=o*_)+c)?(i=2*Math.sqrt(1+_),e[3]=.25*i,e[0]=(h-u)/i,e[1]=(l-n)/i,e[2]=(r-a)/i):o<t&&c<t?(i=2*Math.sqrt(1+t-o-c),e[3]=(h-u)/i,e[0]=.25*i,e[1]=(r+a)/i,e[2]=(l+n)/i):c<o?(i=2*Math.sqrt(1+o-t-c),e[3]=(l-n)/i,e[0]=(r+a)/i,e[1]=.25*i,e[2]=(h+u)/i):(i=2*Math.sqrt(1+c-t-o),e[3]=(r-a)/i,e[0]=(l+n)/i,e[1]=(h+u)/i,e[2]=.25*i),e},bt=function(e,t,s,i){var r=(a=t[0])*(c=a+a),n=a*(u=(h=t[1])+h),a=a*(_=(l=t[2])+l),o=h*u,h=h*_,l=l*_,c=(t=t[3])*c,u=t*u,t=t*_,_=i[0],d=i[1],i=i[2];return e[0]=(1-(o+l))*_,e[1]=(n+t)*_,e[2]=(a-u)*_,e[3]=0,e[4]=(n-t)*d,e[5]=(1-(r+l))*d,e[6]=(h+c)*d,e[7]=0,e[8]=(a+u)*i,e[9]=(h-c)*i,e[10]=(1-(r+o))*i,e[11]=0,e[12]=s[0],e[13]=s[1],e[14]=s[2],e[15]=1,e},wt=function(e,t,s,i,r){var n=(o=t[0])*(u=o+o),a=o*(_=(l=t[1])+l),o=o*(d=(c=t[2])+c),h=l*_,l=l*d,c=c*d,u=(t=t[3])*u,_=t*_,t=t*d,d=i[0],p=i[1],i=i[2],f=r[0],m=r[1],r=r[2],g=(1-(h+c))*d,S=(a+t)*d,d=(o-_)*d,a=(a-t)*p,t=(1-(n+c))*p,c=(l+u)*p,p=(o+_)*i,o=(l-u)*i,_=(1-(n+h))*i;return e[0]=g,e[1]=S,e[2]=d,e[3]=0,e[4]=a,e[5]=t,e[6]=c,e[7]=0,e[8]=p,e[9]=o,e[10]=_,e[11]=0,e[12]=s[0]+f-(g*f+a*m+p*r),e[13]=s[1]+m-(S*f+t*m+o*r),e[14]=s[2]+r-(d*f+c*m+_*r),e[15]=1,e},xt=function(e,t){var s=t[0],i=t[2],r=i+i,s=s*(l=s+s),n=(a=t[1])*l,a=a*(c=a+a),o=i*l,h=i*c,l=(t=t[3])*l,c=t*c,t=t*r;return e[0]=1-a-(i=i*r),e[1]=n+t,e[2]=o-c,e[3]=0,e[4]=n-t,e[5]=1-s-i,e[6]=h+l,e[7]=0,e[8]=o+c,e[9]=h-l,e[10]=1-s-a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},vt=function(e,t,s,i,r,n,a){var o=1/(s-t),h=1/(r-i),l=1/(n-a);return e[0]=2*n*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*n*h,e[6]=0,e[7]=0,e[8]=(s+t)*o,e[9]=(r+i)*h,e[10]=(a+n)*l,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*n*2*l,e[15]=0,e},c=function(e,t,s,i,r){return t=1/Math.tan(t/2),e[0]=t/s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=r&&r!==1/0?(e[10]=(r+i)*(s=1/(i-r)),e[14]=2*r*i*s):(e[10]=-1,e[14]=-2*i),e},Pt=function(e,t,s,i,r){return t=1/Math.tan(t/2),e[0]=t/s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=r&&r!==1/0?(e[10]=r*(s=1/(i-r)),e[14]=r*i*s):(e[10]=-1,e[14]=-i),e},Rt=function(e,t,s,i){var r=Math.tan(t.upDegrees*Math.PI/180),n=Math.tan(t.downDegrees*Math.PI/180),a=Math.tan(t.leftDegrees*Math.PI/180),o=2/(a+(t=Math.tan(t.rightDegrees*Math.PI/180))),h=2/(r+n);return e[0]=o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=h,e[6]=0,e[7]=0,e[8]=-(a-t)*o*.5,e[9]=(r-n)*h*.5,e[10]=i/(s-i),e[11]=-1,e[12]=0,e[13]=0,e[14]=i*s/(s-i),e[15]=0,e},u=function(e,t,s,i,r,n,a){var o=1/(t-s),h=1/(i-r),l=1/(n-a);return e[0]=-2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*h,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*l,e[11]=0,e[12]=(t+s)*o,e[13]=(r+i)*h,e[14]=(a+n)*l,e[15]=1,e},At=function(e,t,s,i,r,n,a){var o=1/(t-s),h=1/(i-r),a=1/(n-a);return e[0]=-2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*h,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=a,e[11]=0,e[12]=(t+s)*o,e[13]=(r+i)*h,e[14]=n*a,e[15]=1,e},Mt=function(e,t,s,i){var r,n,a,o,h=t[0],l=t[1],t=t[2],c=i[0],u=i[1],i=i[2],_=s[0],d=s[1],s=s[2];return Math.abs(h-_)<Ir&&Math.abs(l-d)<Ir&&Math.abs(t-s)<Ir?p(e):(_=h-_,d=l-d,s=t-s,r=u*(s*=o=1/Math.hypot(_,d,s))-i*(d*=o),i=i*(_*=o)-c*s,c=c*d-u*_,(o=Math.hypot(r,i,c))?(r*=o=1/o,i*=o,c*=o):c=i=r=0,u=d*c-s*i,n=s*r-_*c,a=_*i-d*r,(o=Math.hypot(u,n,a))?(u*=o=1/o,n*=o,a*=o):a=n=u=0,e[0]=r,e[1]=u,e[2]=_,e[3]=0,e[4]=i,e[5]=n,e[6]=d,e[7]=0,e[8]=c,e[9]=a,e[10]=s,e[11]=0,e[12]=-(r*h+i*l+c*t),e[13]=-(u*h+n*l+a*t),e[14]=-(_*h+d*l+s*t),e[15]=1,e)},Dt=function(e,t,s,i){var r=t[0],n=t[1],t=t[2],a=i[0],o=i[1],i=i[2],h=r-s[0],l=n-s[1],c=h*h+l*l+(s=t-s[2])*s,u=(0<c&&(h*=c=1/Math.sqrt(c),l*=c,s*=c),o*s-i*l);return 0<(c=u*u+(i=i*h-a*s)*i+(a=a*l-o*h)*a)&&(u*=c=1/Math.sqrt(c),i*=c,a*=c),e[0]=u,e[1]=i,e[2]=a,e[3]=0,e[4]=l*a-s*i,e[5]=s*u-h*a,e[6]=h*i-l*u,e[7]=0,e[8]=h,e[9]=l,e[10]=s,e[11]=0,e[12]=r,e[13]=n,e[14]=t,e[15]=1,e},Et=function(e){return\"mat4(\"+e[0]+\", \"+e[1]+\", \"+e[2]+\", \"+e[3]+\", \"+e[4]+\", \"+e[5]+\", \"+e[6]+\", \"+e[7]+\", \"+e[8]+\", \"+e[9]+\", \"+e[10]+\", \"+e[11]+\", \"+e[12]+\", \"+e[13]+\", \"+e[14]+\", \"+e[15]+\")\"},Ft=function(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])},Bt=function(e,t,s){return e[0]=t[0]+s[0],e[1]=t[1]+s[1],e[2]=t[2]+s[2],e[3]=t[3]+s[3],e[4]=t[4]+s[4],e[5]=t[5]+s[5],e[6]=t[6]+s[6],e[7]=t[7]+s[7],e[8]=t[8]+s[8],e[9]=t[9]+s[9],e[10]=t[10]+s[10],e[11]=t[11]+s[11],e[12]=t[12]+s[12],e[13]=t[13]+s[13],e[14]=t[14]+s[14],e[15]=t[15]+s[15],e},Ot=function(e,t,s){return e[0]=t[0]-s[0],e[1]=t[1]-s[1],e[2]=t[2]-s[2],e[3]=t[3]-s[3],e[4]=t[4]-s[4],e[5]=t[5]-s[5],e[6]=t[6]-s[6],e[7]=t[7]-s[7],e[8]=t[8]-s[8],e[9]=t[9]-s[9],e[10]=t[10]-s[10],e[11]=t[11]-s[11],e[12]=t[12]-s[12],e[13]=t[13]-s[13],e[14]=t[14]-s[14],e[15]=t[15]-s[15],e},Lt=function(e,t,s){return e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e[3]=t[3]*s,e[4]=t[4]*s,e[5]=t[5]*s,e[6]=t[6]*s,e[7]=t[7]*s,e[8]=t[8]*s,e[9]=t[9]*s,e[10]=t[10]*s,e[11]=t[11]*s,e[12]=t[12]*s,e[13]=t[13]*s,e[14]=t[14]*s,e[15]=t[15]*s,e},kt=function(e,t,s,i){return e[0]=t[0]+s[0]*i,e[1]=t[1]+s[1]*i,e[2]=t[2]+s[2]*i,e[3]=t[3]+s[3]*i,e[4]=t[4]+s[4]*i,e[5]=t[5]+s[5]*i,e[6]=t[6]+s[6]*i,e[7]=t[7]+s[7]*i,e[8]=t[8]+s[8]*i,e[9]=t[9]+s[9]*i,e[10]=t[10]+s[10]*i,e[11]=t[11]+s[11]*i,e[12]=t[12]+s[12]*i,e[13]=t[13]+s[13]*i,e[14]=t[14]+s[14]*i,e[15]=t[15]+s[15]*i,e},Nt=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]},Wt=function(e,t){var s=e[0],i=e[1],r=e[2],n=e[3],a=e[4],o=e[5],h=e[6],l=e[7],c=e[8],u=e[9],_=e[10],d=e[11],p=e[12],f=e[13],m=e[14],e=e[15],g=t[0],S=t[1],y=t[2],G=t[3],I=t[4],T=t[5],C=t[6],b=t[7],w=t[8],x=t[9],v=t[10],P=t[11],R=t[12],A=t[13],M=t[14],t=t[15];return Math.abs(s-g)<=Ir*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(i-S)<=Ir*Math.max(1,Math.abs(i),Math.abs(S))&&Math.abs(r-y)<=Ir*Math.max(1,Math.abs(r),Math.abs(y))&&Math.abs(n-G)<=Ir*Math.max(1,Math.abs(n),Math.abs(G))&&Math.abs(a-I)<=Ir*Math.max(1,Math.abs(a),Math.abs(I))&&Math.abs(o-T)<=Ir*Math.max(1,Math.abs(o),Math.abs(T))&&Math.abs(h-C)<=Ir*Math.max(1,Math.abs(h),Math.abs(C))&&Math.abs(l-b)<=Ir*Math.max(1,Math.abs(l),Math.abs(b))&&Math.abs(c-w)<=Ir*Math.max(1,Math.abs(c),Math.abs(w))&&Math.abs(u-x)<=Ir*Math.max(1,Math.abs(u),Math.abs(x))&&Math.abs(_-v)<=Ir*Math.max(1,Math.abs(_),Math.abs(v))&&Math.abs(d-P)<=Ir*Math.max(1,Math.abs(d),Math.abs(P))&&Math.abs(p-R)<=Ir*Math.max(1,Math.abs(p),Math.abs(R))&&Math.abs(f-A)<=Ir*Math.max(1,Math.abs(f),Math.abs(A))&&Math.abs(m-M)<=Ir*Math.max(1,Math.abs(m),Math.abs(M))&&Math.abs(e-t)<=Ir*Math.max(1,Math.abs(e),Math.abs(t))},f=function(){var e=new Tr(3);return Tr!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e},Vt=function(e){var t=new Tr(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},Ut=function(e){var t=e[0];return Math.hypot(t,e[1],e[2])},m=function(e,t,s){var i=new Tr(3);return i[0]=e,i[1]=t,i[2]=s,i},jt=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},Ht=function(e,t,s,i){return e[0]=t,e[1]=s,e[2]=i,e},Xt=function(e,t,s){return e[0]=t[0]+s[0],e[1]=t[1]+s[1],e[2]=t[2]+s[2],e},zt=function(e,t,s){return e[0]=t[0]-s[0],e[1]=t[1]-s[1],e[2]=t[2]-s[2],e},Yt=function(e,t,s){return e[0]=t[0]*s[0],e[1]=t[1]*s[1],e[2]=t[2]*s[2],e},qt=function(e,t,s){return e[0]=t[0]/s[0],e[1]=t[1]/s[1],e[2]=t[2]/s[2],e},Kt=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e},Jt=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e},Zt=function(e,t,s){return e[0]=Math.min(t[0],s[0]),e[1]=Math.min(t[1],s[1]),e[2]=Math.min(t[2],s[2]),e},Qt=function(e,t,s){return e[0]=Math.max(t[0],s[0]),e[1]=Math.max(t[1],s[1]),e[2]=Math.max(t[2],s[2]),e},$t=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e},es=function(e,t,s){return e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e},ts=function(e,t,s,i){return e[0]=t[0]+s[0]*i,e[1]=t[1]+s[1]*i,e[2]=t[2]+s[2]*i,e},ss=function(e,t){var s=t[0]-e[0];return Math.hypot(s,t[1]-e[1],t[2]-e[2])},is=function(e,t){var s=t[0]-e[0],i=t[1]-e[1];return s*s+i*i+(t=t[2]-e[2])*t},rs=function(e){var t=e[0],s=e[1];return t*t+s*s+(e=e[2])*e},ns=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},as=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e},g=function(e,t){var s=t[0],i=t[1],r=t[2];return 0<(s=s*s+i*i+r*r)&&(s=1/Math.sqrt(s)),e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e},S=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},y=function(e,t,s){var i=t[0],r=t[1],t=t[2],n=s[0],a=s[1],s=s[2];return e[0]=r*s-t*a,e[1]=t*n-i*s,e[2]=i*a-r*n,e},os=function(e,t,s,i){var r=t[0],n=t[1],t=t[2];return e[0]=r+i*(s[0]-r),e[1]=n+i*(s[1]-n),e[2]=t+i*(s[2]-t),e},hs=function(e,t,s,i){var r=Math.acos(Math.min(Math.max(S(t,s),-1),1)),n=Math.sin(r),a=Math.sin((1-i)*r)/n,i=Math.sin(i*r)/n;return e[0]=a*t[0]+i*s[0],e[1]=a*t[1]+i*s[1],e[2]=a*t[2]+i*s[2],e},ls=function(e,t,s,i,r,n){var a=n*n,o=a*(2*n-3)+1,h=a*(n-2)+n,l=a*(n-1);return e[0]=t[0]*o+s[0]*h+i[0]*l+r[0]*(a=a*(3-2*n)),e[1]=t[1]*o+s[1]*h+i[1]*l+r[1]*a,e[2]=t[2]*o+s[2]*h+i[2]*l+r[2]*a,e},cs=function(e,t,s,i,r,n){var a=1-n,o=a*a,h=n*n,l=o*a;return e[0]=t[0]*l+s[0]*(o=3*n*o)+i[0]*(a=3*h*a)+r[0]*(h=h*n),e[1]=t[1]*l+s[1]*o+i[1]*a+r[1]*h,e[2]=t[2]*l+s[2]*o+i[2]*a+r[2]*h,e},us=function(e,t){t=t||1;var s=2*Fr()*Math.PI,i=2*Fr()-1,r=Math.sqrt(1-i*i)*t;return e[0]=Math.cos(s)*r,e[1]=Math.sin(s)*r,e[2]=i*t,e},_s=function(e,t,s){var i=t[0],r=t[1],t=t[2],n=s[3]*i+s[7]*r+s[11]*t+s[15];return e[0]=(s[0]*i+s[4]*r+s[8]*t+s[12])/(n=n||1),e[1]=(s[1]*i+s[5]*r+s[9]*t+s[13])/n,e[2]=(s[2]*i+s[6]*r+s[10]*t+s[14])/n,e},ds=function(e,t,s){var i=t[0],r=t[1],t=t[2];return e[0]=i*s[0]+r*s[3]+t*s[6],e[1]=i*s[1]+r*s[4]+t*s[7],e[2]=i*s[2]+r*s[5]+t*s[8],e},ps=function(e,t,s){var i=s[0],r=s[1],n=t[0],a=t[1],o=r*(t=t[2])-(u=s[2])*a,h=u*n-i*t,l=i*a-r*n,c=r*l-u*h,u=u*o-i*l,i=i*h-r*o;return h*=r=2*s[3],l*=r,u*=2,i*=2,e[0]=n+(o*=r)+(c*=2),e[1]=a+h+u,e[2]=t+l+i,e},fs=function(e,t,s,i){var r=[],n=[];return r[0]=t[0]-s[0],r[1]=t[1]-s[1],r[2]=t[2]-s[2],n[0]=r[0],n[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),n[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),e[0]=n[0]+s[0],e[1]=n[1]+s[1],e[2]=n[2]+s[2],e},ms=function(e,t,s,i){var r=[],n=[];return r[0]=t[0]-s[0],r[1]=t[1]-s[1],r[2]=t[2]-s[2],n[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),n[1]=r[1],n[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),e[0]=n[0]+s[0],e[1]=n[1]+s[1],e[2]=n[2]+s[2],e},gs=function(e,t,s,i){var r=[],n=[];return r[0]=t[0]-s[0],r[1]=t[1]-s[1],r[2]=t[2]-s[2],n[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),n[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),n[2]=r[2],e[0]=n[0]+s[0],e[1]=n[1]+s[1],e[2]=n[2]+s[2],e},Ss=function(e,t){var s=e[0],i=e[1],r=e[2],n=t[0],a=t[1],o=t[2],i=(s=Math.sqrt((s*s+i*i+r*r)*(n*n+a*a+o*o)))&&S(e,t)/s;return Math.acos(Math.min(Math.max(i,-1),1))},ys=function(e){return e[0]=0,e[1]=0,e[2]=0,e},Gs=function(e){return\"vec3(\"+e[0]+\", \"+e[1]+\", \"+e[2]+\")\"},Is=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},Ts=function(e,t){var s=e[0],i=e[1],e=e[2],r=t[0],n=t[1],t=t[2];return Math.abs(s-r)<=Ir*Math.max(1,Math.abs(s),Math.abs(r))&&Math.abs(i-n)<=Ir*Math.max(1,Math.abs(i),Math.abs(n))&&Math.abs(e-t)<=Ir*Math.max(1,Math.abs(e),Math.abs(t))},G=function(){var e=new Tr(4);return Tr!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e},Cs=function(e){var t=new Tr(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},bs=function(e,t,s,i){var r=new Tr(4);return r[0]=e,r[1]=t,r[2]=s,r[3]=i,r},ws=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},xs=function(e,t,s,i,r){return e[0]=t,e[1]=s,e[2]=i,e[3]=r,e},vs=function(e,t,s){return e[0]=t[0]+s[0],e[1]=t[1]+s[1],e[2]=t[2]+s[2],e[3]=t[3]+s[3],e},Ps=function(e,t,s){return e[0]=t[0]-s[0],e[1]=t[1]-s[1],e[2]=t[2]-s[2],e[3]=t[3]-s[3],e},Rs=function(e,t,s){return e[0]=t[0]*s[0],e[1]=t[1]*s[1],e[2]=t[2]*s[2],e[3]=t[3]*s[3],e},As=function(e,t,s){return e[0]=t[0]/s[0],e[1]=t[1]/s[1],e[2]=t[2]/s[2],e[3]=t[3]/s[3],e},Ms=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e},Ds=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e},Es=function(e,t,s){return e[0]=Math.min(t[0],s[0]),e[1]=Math.min(t[1],s[1]),e[2]=Math.min(t[2],s[2]),e[3]=Math.min(t[3],s[3]),e},Fs=function(e,t,s){return e[0]=Math.max(t[0],s[0]),e[1]=Math.max(t[1],s[1]),e[2]=Math.max(t[2],s[2]),e[3]=Math.max(t[3],s[3]),e},Bs=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e},Os=function(e,t,s){return e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e[3]=t[3]*s,e},Ls=function(e,t,s,i){return e[0]=t[0]+s[0]*i,e[1]=t[1]+s[1]*i,e[2]=t[2]+s[2]*i,e[3]=t[3]+s[3]*i,e},ks=function(e,t){var s=t[0]-e[0];return Math.hypot(s,t[1]-e[1],t[2]-e[2],t[3]-e[3])},Ns=function(e,t){var s=t[0]-e[0],i=t[1]-e[1],r=t[2]-e[2];return s*s+i*i+r*r+(t=t[3]-e[3])*t},I=function(e){var t=e[0];return Math.hypot(t,e[1],e[2],e[3])},T=function(e){var t=e[0],s=e[1],i=e[2];return t*t+s*s+i*i+(e=e[3])*e},Ws=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},Vs=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},Us=function(e,t){var s=t[0],i=t[1],r=t[2],n=s*s+i*i+r*r+(t=t[3])*t;return 0<n&&(n=1/Math.sqrt(n)),e[0]=s*n,e[1]=i*n,e[2]=r*n,e[3]=t*n,e},C=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},js=function(e,t,s,i){var r=s[0]*i[1]-s[1]*i[0],n=s[0]*i[2]-s[2]*i[0],a=s[0]*i[3]-s[3]*i[0],o=s[1]*i[2]-s[2]*i[1],h=s[1]*i[3]-s[3]*i[1],s=s[2]*i[3]-s[3]*i[2],i=t[0],l=t[1],c=t[2],t=t[3];return e[0]=l*s-c*h+t*o,e[1]=-i*s+c*a-t*n,e[2]=i*h-l*a+t*r,e[3]=-i*o+l*n-c*r,e},Hs=function(e,t,s,i){var r=t[0],n=t[1],a=t[2],t=t[3];return e[0]=r+i*(s[0]-r),e[1]=n+i*(s[1]-n),e[2]=a+i*(s[2]-a),e[3]=t+i*(s[3]-t),e},Xs=function(e,t){var s,i,r,n,a,o;for(t=t||1;1<=(a=(s=2*Fr()-1)*s+(i=2*Fr()-1)*i););for(;1<=(o=(r=2*Fr()-1)*r+(n=2*Fr()-1)*n););var h=Math.sqrt((1-a)/o);return e[0]=t*s,e[1]=t*i,e[2]=t*r*h,e[3]=t*n*h,e},zs=function(e,t,s){var i=t[0],r=t[1],n=t[2],t=t[3];return e[0]=s[0]*i+s[4]*r+s[8]*n+s[12]*t,e[1]=s[1]*i+s[5]*r+s[9]*n+s[13]*t,e[2]=s[2]*i+s[6]*r+s[10]*n+s[14]*t,e[3]=s[3]*i+s[7]*r+s[11]*n+s[15]*t,e},Ys=function(e,t,s){var i=t[0],r=t[1],n=t[2],a=s[0],o=s[1],h=s[2],l=(s=s[3])*i+o*n-h*r,c=s*r+h*i-a*n,u=s*n+a*r-o*i;return e[0]=l*s+(i=-a*i-o*r-h*n)*-a+c*-h-u*-o,e[1]=c*s+i*-o+u*-a-l*-h,e[2]=u*s+i*-h+l*-o-c*-a,e[3]=t[3],e},qs=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e},Ks=function(e){return\"vec4(\"+e[0]+\", \"+e[1]+\", \"+e[2]+\", \"+e[3]+\")\"},Js=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},Zs=function(e,t){var s=e[0],i=e[1],r=e[2],e=e[3],n=t[0],a=t[1],o=t[2],t=t[3];return Math.abs(s-n)<=Ir*Math.max(1,Math.abs(s),Math.abs(n))&&Math.abs(i-a)<=Ir*Math.max(1,Math.abs(i),Math.abs(a))&&Math.abs(r-o)<=Ir*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(e-t)<=Ir*Math.max(1,Math.abs(e),Math.abs(t))},b=function(){var e=new Tr(4);return Tr!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e},Qs=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},w=function(e,t,s){s*=.5;var i=Math.sin(s);return e[0]=i*t[0],e[1]=i*t[1],e[2]=i*t[2],e[3]=Math.cos(s),e},$s=function(e,t){var s=2*Math.acos(t[3]),i=Math.sin(s/2);return Ir<i?(e[0]=t[0]/i,e[1]=t[1]/i,e[2]=t[2]/i):(e[0]=1,e[1]=0,e[2]=0),s},ei=function(e,t){return e=Xr(e,t),Math.acos(2*e*e-1)},ti=function(e,t,s){var i=t[0],r=t[1],n=t[2],t=t[3],a=s[0],o=s[1],h=s[2],s=s[3];return e[0]=i*s+t*a+r*h-n*o,e[1]=r*s+t*o+n*a-i*h,e[2]=n*s+t*h+i*o-r*a,e[3]=t*s-i*a-r*o-n*h,e},x=function(e,t,s){s*=.5;var i=t[0],r=t[1],n=t[2],t=t[3],a=Math.sin(s),s=Math.cos(s);return e[0]=i*s+t*a,e[1]=r*s+n*a,e[2]=n*s-r*a,e[3]=t*s-i*a,e},v=function(e,t,s){s*=.5;var i=t[0],r=t[1],n=t[2],t=t[3],a=Math.sin(s),s=Math.cos(s);return e[0]=i*s-n*a,e[1]=r*s+t*a,e[2]=n*s+i*a,e[3]=t*s-r*a,e},P=function(e,t,s){s*=.5;var i=t[0],r=t[1],n=t[2],t=t[3],a=Math.sin(s),s=Math.cos(s);return e[0]=i*s+r*a,e[1]=r*s-i*a,e[2]=n*s+t*a,e[3]=t*s-n*a,e},si=function(e,t){var s=t[0],i=t[1],t=t[2];return e[0]=s,e[1]=i,e[2]=t,e[3]=Math.sqrt(Math.abs(1-s*s-i*i-t*t)),e},R=function(e,t){var s=t[0],i=t[1],r=t[2],t=t[3],n=Math.sqrt(s*s+i*i+r*r),t=Math.exp(t),a=0<n?t*Math.sin(n)/n:0;return e[0]=s*a,e[1]=i*a,e[2]=r*a,e[3]=t*Math.cos(n),e},A=function(e,t){var s=t[0],i=t[1],r=t[2],t=t[3],n=0<(n=Math.sqrt(s*s+i*i+r*r))?Math.atan2(n,t)/n:0;return e[0]=s*n,e[1]=i*n,e[2]=r*n,e[3]=.5*Math.log(s*s+i*i+r*r+t*t),e},ii=function(e,t,s){return A(e,t),Hr(e,e,s),R(e,e),e},M=function(e,t,s,i){var r,n,a=t[0],o=t[1],h=t[2],t=t[3],l=s[0],c=s[1],u=s[2],_=a*l+o*c+h*u+t*(s=s[3]);return _<0&&(_=-_,l=-l,c=-c,u=-u,s=-s),_=Ir<1-_?(_=Math.acos(_),r=Math.sin(_),n=Math.sin((1-i)*_)/r,Math.sin(i*_)/r):(n=1-i,i),e[0]=n*a+_*l,e[1]=n*o+_*c,e[2]=n*h+_*u,e[3]=n*t+_*s,e},ri=function(e){var t=Fr(),s=Fr(),i=Fr(),r=Math.sqrt(1-t),t=Math.sqrt(t);return e[0]=r*Math.sin(2*Math.PI*s),e[1]=r*Math.cos(2*Math.PI*s),e[2]=t*Math.sin(2*Math.PI*i),e[3]=t*Math.cos(2*Math.PI*i),e},ni=function(e,t){var s=t[0],i=t[1],r=t[2],n=s*s+i*i+r*r+(t=t[3])*t;return e[0]=-s*(n=n?1/n:0),e[1]=-i*n,e[2]=-r*n,e[3]=t*n,e},ai=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},D=function(e,t){var s,i,r,n=t[0]+t[4]+t[8];return 0<n?(r=Math.sqrt(n+1),e[3]=.5*r,e[0]=(t[5]-t[7])*(r=.5/r),e[1]=(t[6]-t[2])*r,e[2]=(t[1]-t[3])*r):(s=(1+(n=t[3*(n=t[4]>t[0]?1:0)+n]<t[8]?2:n))%3,i=(2+n)%3,r=Math.sqrt(t[3*n+n]-t[3*s+s]-t[3*i+i]+1),e[n]=.5*r,e[3]=(t[3*s+i]-t[3*i+s])*(r=.5/r),e[s]=(t[3*s+n]+t[3*n+s])*r,e[i]=(t[3*i+n]+t[3*n+i])*r),e},oi=function(e,t,s,i){var r=4<arguments.length&&void 0!==arguments[4]?arguments[4]:Br,n=Math.PI/360,a=(i*=n,s*=n,Math.sin(t*=n)),o=Math.cos(t),h=Math.sin(s),l=Math.cos(s),c=Math.sin(i),u=Math.cos(i);switch(r){case\"xyz\":e[0]=a*l*u+o*h*c,e[1]=o*h*u-a*l*c,e[2]=o*l*c+a*h*u,e[3]=o*l*u-a*h*c;break;case\"xzy\":e[0]=a*l*u-o*h*c,e[1]=o*h*u-a*l*c,e[2]=o*l*c+a*h*u,e[3]=o*l*u+a*h*c;break;case\"yxz\":e[0]=a*l*u+o*h*c,e[1]=o*h*u-a*l*c,e[2]=o*l*c-a*h*u,e[3]=o*l*u+a*h*c;break;case\"yzx\":e[0]=a*l*u+o*h*c,e[1]=o*h*u+a*l*c,e[2]=o*l*c-a*h*u,e[3]=o*l*u-a*h*c;break;case\"zxy\":e[0]=a*l*u-o*h*c,e[1]=o*h*u+a*l*c,e[2]=o*l*c+a*h*u,e[3]=o*l*u-a*h*c;break;case\"zyx\":e[0]=a*l*u-o*h*c,e[1]=o*h*u+a*l*c,e[2]=o*l*c-a*h*u,e[3]=o*l*u+a*h*c;break;default:throw new Error(\"Unknown angle order \"+r)}return e},hi=function(e){return\"quat(\"+e[0]+\", \"+e[1]+\", \"+e[2]+\", \"+e[3]+\")\"},li=function(e,t){return Math.abs(C(e,t))>=1-Ir},ci=function(){var e=new Tr(8);return Tr!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0),e[3]=1,e},ui=function(e){var t=new Tr(8);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t},_i=function(e,t,s,i,r,n,a,o){var h=new Tr(8);return h[0]=e,h[1]=t,h[2]=s,h[3]=i,h[4]=r,h[5]=n,h[6]=a,h[7]=o,h},di=function(e,t,s,i,r,n,a){var o=new Tr(8),r=(o[0]=e,o[1]=t,o[2]=s,o[3]=i,.5*r),n=.5*n,a=.5*a;return o[4]=r*i+n*s-a*t,o[5]=n*i+a*e-r*s,o[6]=a*i+r*t-n*e,o[7]=-r*e-n*t-a*s,o},E=function(e,t,s){var i=.5*s[0],r=.5*s[1],s=.5*s[2],n=t[0],a=t[1],o=t[2],t=t[3];return e[0]=n,e[1]=a,e[2]=o,e[3]=t,e[4]=i*t+r*o-s*a,e[5]=r*t+s*n-i*o,e[6]=s*t+i*a-r*n,e[7]=-i*n-r*a-s*o,e},pi=function(e,t){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=.5*t[0],e[5]=.5*t[1],e[6]=.5*t[2],e[7]=0,e},fi=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=0,e[5]=0,e[6]=0,e[7]=0,e},mi=function(e,t){var s=b(),i=(l(s,t),new Tr(3));return h(i,t),E(e,s,i),e},F=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e},gi=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e},Si=function(e,t,s,i,r,n,a,o,h){return e[0]=t,e[1]=s,e[2]=i,e[3]=r,e[4]=n,e[5]=a,e[6]=o,e[7]=h,e},yi=function(e,t){return e[0]=t[4],e[1]=t[5],e[2]=t[6],e[3]=t[7],e},Gi=function(e,t){return e[4]=t[0],e[5]=t[1],e[6]=t[2],e[7]=t[3],e},Ii=function(e,t){var s=t[4],i=t[5],r=t[6],n=t[7],a=-t[0],o=-t[1],h=-t[2],t=t[3];return e[0]=2*(s*t+n*a+i*h-r*o),e[1]=2*(i*t+n*o+r*a-s*h),e[2]=2*(r*t+n*h+s*o-i*a),e},Ti=function(e,t,s){var i=t[0],r=t[1],n=t[2],a=t[3],o=.5*s[0],h=.5*s[1],s=.5*s[2],l=t[4],c=t[5],u=t[6],t=t[7];return e[0]=i,e[1]=r,e[2]=n,e[3]=a,e[4]=a*o+r*s-n*h+l,e[5]=a*h+n*o-i*s+c,e[6]=a*s+i*h-r*o+u,e[7]=-i*o-r*h-n*s+t,e},Ci=function(e,t,s){var i=-t[0],r=-t[1],n=-t[2],a=t[3],o=t[4],h=t[5],l=t[6],c=o*a+(d=t[7])*i+h*n-l*r,u=h*a+d*r+l*i-o*n,_=l*a+d*n+o*r-h*i,d=d*a-o*i-h*r-l*n;return x(e,t,s),i=e[0],e[4]=c*(a=e[3])+d*i+u*(n=e[2])-_*(r=e[1]),e[5]=u*a+d*r+_*i-c*n,e[6]=_*a+d*n+c*r-u*i,e[7]=d*a-c*i-u*r-_*n,e},bi=function(e,t,s){var i=-t[0],r=-t[1],n=-t[2],a=t[3],o=t[4],h=t[5],l=t[6],c=o*a+(d=t[7])*i+h*n-l*r,u=h*a+d*r+l*i-o*n,_=l*a+d*n+o*r-h*i,d=d*a-o*i-h*r-l*n;return v(e,t,s),i=e[0],e[4]=c*(a=e[3])+d*i+u*(n=e[2])-_*(r=e[1]),e[5]=u*a+d*r+_*i-c*n,e[6]=_*a+d*n+c*r-u*i,e[7]=d*a-c*i-u*r-_*n,e},wi=function(e,t,s){var i=-t[0],r=-t[1],n=-t[2],a=t[3],o=t[4],h=t[5],l=t[6],c=o*a+(d=t[7])*i+h*n-l*r,u=h*a+d*r+l*i-o*n,_=l*a+d*n+o*r-h*i,d=d*a-o*i-h*r-l*n;return P(e,t,s),i=e[0],e[4]=c*(a=e[3])+d*i+u*(n=e[2])-_*(r=e[1]),e[5]=u*a+d*r+_*i-c*n,e[6]=_*a+d*n+c*r-u*i,e[7]=d*a-c*i-u*r-_*n,e},xi=function(e,t,s){var i=s[0],r=s[1],n=s[2],s=s[3],a=t[0],o=t[1],h=t[2],l=t[3];return e[0]=a*s+l*i+o*n-h*r,e[1]=o*s+l*r+h*i-a*n,e[2]=h*s+l*n+a*r-o*i,e[3]=l*s-a*i-o*r-h*n,e[4]=(a=t[4])*s+(l=t[7])*i+(o=t[5])*n-(h=t[6])*r,e[5]=o*s+l*r+h*i-a*n,e[6]=h*s+l*n+a*r-o*i,e[7]=l*s-a*i-o*r-h*n,e},vi=function(e,t,s){var i=t[0],r=t[1],n=t[2],t=t[3],a=s[0],o=s[1],h=s[2],l=s[3];return e[0]=i*l+t*a+r*h-n*o,e[1]=r*l+t*o+n*a-i*h,e[2]=n*l+t*h+i*o-r*a,e[3]=t*l-i*a-r*o-n*h,e[4]=i*(l=s[7])+t*(a=s[4])+r*(h=s[6])-n*(o=s[5]),e[5]=r*l+t*o+n*a-i*h,e[6]=n*l+t*h+i*o-r*a,e[7]=t*l-i*a-r*o-n*h,e},Pi=function(e,t,s,i){var r,n,a,o,h,l;return Math.abs(i)<Ir?F(e,t):(l=Math.hypot(s[0],s[1],s[2]),i*=.5,r=(a=Math.sin(i))*s[0]/l,n=a*s[1]/l,a=a*s[2]/l,s=Math.cos(i),l=t[0],e[0]=l*s+(i=t[3])*r+(o=t[1])*a-(h=t[2])*n,e[1]=o*s+i*n+h*r-l*a,e[2]=h*s+i*a+l*n-o*r,e[3]=i*s-l*r-o*n-h*a,e[4]=(i=t[4])*s+(l=t[7])*r+(o=t[5])*a-(h=t[6])*n,e[5]=o*s+l*n+h*r-i*a,e[6]=h*s+l*a+i*n-o*r,e[7]=l*s-i*r-o*n-h*a,e)},Ri=function(e,t,s){return e[0]=t[0]+s[0],e[1]=t[1]+s[1],e[2]=t[2]+s[2],e[3]=t[3]+s[3],e[4]=t[4]+s[4],e[5]=t[5]+s[5],e[6]=t[6]+s[6],e[7]=t[7]+s[7],e},Ai=function(e,t,s){var i=t[0],r=t[1],n=t[2],a=t[3],o=s[4],h=s[5],l=s[6],c=s[7],u=t[4],_=t[5],d=t[6],t=t[7],p=s[0],f=s[1],m=s[2],s=s[3];return e[0]=i*s+a*p+r*m-n*f,e[1]=r*s+a*f+n*p-i*m,e[2]=n*s+a*m+i*f-r*p,e[3]=a*s-i*p-r*f-n*m,e[4]=i*c+a*o+r*l-n*h+u*s+t*p+_*m-d*f,e[5]=r*c+a*h+n*o-i*l+_*s+t*f+d*p-u*m,e[6]=n*c+a*l+i*h-r*o+d*s+t*m+u*f-_*p,e[7]=a*c-i*o-r*h-n*l+t*s-u*p-_*f-d*m,e},Mi=function(e,t,s){return e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e[3]=t[3]*s,e[4]=t[4]*s,e[5]=t[5]*s,e[6]=t[6]*s,e[7]=t[7]*s,e},Di=function(e,t,s,i){var r=1-i;return Jr(t,s)<0&&(i=-i),e[0]=t[0]*r+s[0]*i,e[1]=t[1]*r+s[1]*i,e[2]=t[2]*r+s[2]*i,e[3]=t[3]*r+s[3]*i,e[4]=t[4]*r+s[4]*i,e[5]=t[5]*r+s[5]*i,e[6]=t[6]*r+s[6]*i,e[7]=t[7]*r+s[7]*i,e},Ei=function(e,t){var s=Zr(t);return e[0]=-t[0]/s,e[1]=-t[1]/s,e[2]=-t[2]/s,e[3]=t[3]/s,e[4]=-t[4]/s,e[5]=-t[5]/s,e[6]=-t[6]/s,e[7]=t[7]/s,e},Fi=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e[4]=-t[4],e[5]=-t[5],e[6]=-t[6],e[7]=t[7],e},Bi=function(e,t){var s,i,r,n,a,o,h,l,c=Zr(t);return 0<c&&(c=Math.sqrt(c),l=(s=t[0]/c)*(a=t[4])+(i=t[1]/c)*(o=t[5])+(r=t[2]/c)*(h=t[6])+(n=t[3]/c)*(t=t[7]),e[0]=s,e[1]=i,e[2]=r,e[3]=n,e[4]=(a-s*l)/c,e[5]=(o-i*l)/c,e[6]=(h-r*l)/c,e[7]=(t-n*l)/c),e},Oi=function(e){return\"quat2(\"+e[0]+\", \"+e[1]+\", \"+e[2]+\", \"+e[3]+\", \"+e[4]+\", \"+e[5]+\", \"+e[6]+\", \"+e[7]+\")\"},Li=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]},ki=function(e,t){var s=e[0],i=e[1],r=e[2],n=e[3],a=e[4],o=e[5],h=e[6],e=e[7],l=t[0],c=t[1],u=t[2],_=t[3],d=t[4],p=t[5],f=t[6],t=t[7];return Math.abs(s-l)<=Ir*Math.max(1,Math.abs(s),Math.abs(l))&&Math.abs(i-c)<=Ir*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(r-u)<=Ir*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(n-_)<=Ir*Math.max(1,Math.abs(n),Math.abs(_))&&Math.abs(a-d)<=Ir*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(o-p)<=Ir*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(h-f)<=Ir*Math.max(1,Math.abs(h),Math.abs(f))&&Math.abs(e-t)<=Ir*Math.max(1,Math.abs(e),Math.abs(t))},B=function(){var e=new Tr(2);return Tr!=Float32Array&&(e[0]=0,e[1]=0),e},Ni=function(e){var t=new Tr(2);return t[0]=e[0],t[1]=e[1],t},Wi=function(e,t){var s=new Tr(2);return s[0]=e,s[1]=t,s},Vi=function(e,t){return e[0]=t[0],e[1]=t[1],e},Ui=function(e,t,s){return e[0]=t,e[1]=s,e},ji=function(e,t,s){return e[0]=t[0]+s[0],e[1]=t[1]+s[1],e},Hi=function(e,t,s){return e[0]=t[0]-s[0],e[1]=t[1]-s[1],e},Xi=function(e,t,s){return e[0]=t[0]*s[0],e[1]=t[1]*s[1],e},zi=function(e,t,s){return e[0]=t[0]/s[0],e[1]=t[1]/s[1],e},Yi=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e},qi=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e},Ki=function(e,t,s){return e[0]=Math.min(t[0],s[0]),e[1]=Math.min(t[1],s[1]),e},Ji=function(e,t,s){return e[0]=Math.max(t[0],s[0]),e[1]=Math.max(t[1],s[1]),e},Zi=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e},Qi=function(e,t,s){return e[0]=t[0]*s,e[1]=t[1]*s,e},$i=function(e,t,s,i){return e[0]=t[0]+s[0]*i,e[1]=t[1]+s[1]*i,e},er=function(e,t){var s=t[0]-e[0];return Math.hypot(s,t[1]-e[1])},tr=function(e,t){var s=t[0]-e[0];return s*s+(t=t[1]-e[1])*t},sr=function(e){var t=e[0];return Math.hypot(t,e[1])},ir=function(e){var t=e[0];return t*t+(e=e[1])*e},rr=function(e,t){return e[0]=-t[0],e[1]=-t[1],e},nr=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e},ar=function(e,t){var s=t[0],i=t[1];return 0<(s=s*s+i*i)&&(s=1/Math.sqrt(s)),e[0]=t[0]*s,e[1]=t[1]*s,e},or=function(e,t){return e[0]*t[0]+e[1]*t[1]},hr=function(e,t,s){return t=t[0]*s[1]-t[1]*s[0],e[0]=e[1]=0,e[2]=t,e},lr=function(e,t,s,i){var r=t[0],t=t[1];return e[0]=r+i*(s[0]-r),e[1]=t+i*(s[1]-t),e},cr=function(e,t){t=t||1;var s=2*Fr()*Math.PI;return e[0]=Math.cos(s)*t,e[1]=Math.sin(s)*t,e},ur=function(e,t,s){var i=t[0],t=t[1];return e[0]=s[0]*i+s[2]*t,e[1]=s[1]*i+s[3]*t,e},_r=function(e,t,s){var i=t[0],t=t[1];return e[0]=s[0]*i+s[2]*t+s[4],e[1]=s[1]*i+s[3]*t+s[5],e},dr=function(e,t,s){var i=t[0],t=t[1];return e[0]=s[0]*i+s[3]*t+s[6],e[1]=s[1]*i+s[4]*t+s[7],e},pr=function(e,t,s){var i=t[0],t=t[1];return e[0]=s[0]*i+s[4]*t+s[12],e[1]=s[1]*i+s[5]*t+s[13],e},fr=function(e,t,s,i){var r=t[0]-s[0],t=t[1]-s[1],n=Math.sin(i),i=Math.cos(i);return e[0]=r*i-t*n+s[0],e[1]=r*n+t*i+s[1],e},mr=function(e,t){var s=e[0],e=e[1],i=t[0],t=t[1],r=Math.sqrt((s*s+e*e)*(i*i+t*t));return Math.acos(Math.min(Math.max(r&&(s*i+e*t)/r,-1),1))},gr=function(e){return e[0]=0,e[1]=0,e},Sr=function(e){return\"vec2(\"+e[0]+\", \"+e[1]+\")\"},yr=function(e,t){return e[0]===t[0]&&e[1]===t[1]},Gr=function(e,t){var s=e[0],e=e[1],i=t[0],t=t[1];return Math.abs(s-i)<=Ir*Math.max(1,Math.abs(s),Math.abs(i))&&Math.abs(e-t)<=Ir*Math.max(1,Math.abs(e),Math.abs(t))};r,p,_,h,d,l,f,m,g,S,y,G,C,b,w,x,v,P,R,A,M,D,E,F,B,Ir=1e-6,Tr=\"undefined\"!=typeof Float32Array?Float32Array:Array,Fr=Math.random,Br=\"zyx\",Or=Math.PI/180,Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)}),Lr={__proto__:null,EPSILON:Ir,get ARRAY_TYPE(){return Tr},RANDOM:Fr,ANGLE_ORDER:Br,setMatrixArrayType:O,toRadian:L,equals:k},kr=Object.freeze({__proto__:null,create:N,clone:W,copy:V,identity:U,fromValues:j,set:H,transpose:X,invert:z,adjoint:Y,determinant:q,multiply:e,rotate:K,scale:J,fromRotation:Z,fromScaling:Q,str:$,frob:ee,LDU:te,add:se,subtract:t,exactEquals:ie,equals:re,multiplyScalar:ne,multiplyScalarAndAdd:ae,mul:e,sub:t}),Nr=Object.freeze({__proto__:null,create:oe,clone:he,copy:le,identity:ce,fromValues:ue,set:_e,invert:de,determinant:pe,multiply:s,rotate:fe,scale:me,translate:ge,fromRotation:Se,fromScaling:ye,fromTranslation:Ge,str:Ie,frob:Te,add:Ce,subtract:i,multiplyScalar:be,multiplyScalarAndAdd:we,exactEquals:xe,equals:ve,mul:s,sub:i}),Wr=Object.freeze({__proto__:null,create:r,fromMat4:Pe,clone:Re,copy:Ae,fromValues:Me,set:De,identity:Ee,transpose:Fe,invert:Be,adjoint:Oe,determinant:Le,multiply:n,translate:ke,rotate:Ne,scale:We,fromTranslation:Ve,fromRotation:Ue,fromScaling:je,fromMat2d:He,fromQuat:Xe,normalFromMat4:ze,projection:Ye,str:qe,frob:Ke,add:Je,subtract:a,multiplyScalar:Ze,multiplyScalarAndAdd:Qe,exactEquals:$e,equals:et,mul:n,sub:a}),Cr=Object.freeze({__proto__:null,create:tt,clone:st,copy:it,fromValues:rt,set:nt,identity:p,transpose:at,invert:ot,adjoint:ht,determinant:lt,multiply:o,translate:ct,scale:ut,rotate:_t,rotateX:dt,rotateY:pt,rotateZ:ft,fromTranslation:mt,fromScaling:gt,fromRotation:St,fromXRotation:yt,fromYRotation:Gt,fromZRotation:It,fromRotationTranslation:_,fromQuat2:Tt,getTranslation:h,getScaling:d,getRotation:l,decompose:Ct,fromRotationTranslationScale:bt,fromRotationTranslationScaleOrigin:wt,fromQuat:xt,frustum:vt,perspectiveNO:c,perspective:c,perspectiveZO:Pt,perspectiveFromFieldOfView:Rt,orthoNO:u,ortho:u,orthoZO:At,lookAt:Mt,targetTo:Dt,str:Et,frob:Ft,add:Bt,subtract:Ot,multiplyScalar:Lt,multiplyScalarAndAdd:kt,exactEquals:Nt,equals:Wt,mul:o,sub:Ot}),Kr=zt,Qr=Yt,jr=qt,$r=ss,en=is,Vr=Ut,tn=rs,Er=f(),br=Object.freeze({__proto__:null,create:f,clone:Vt,length:Ut,fromValues:m,copy:jt,set:Ht,add:Xt,subtract:zt,multiply:Yt,divide:qt,ceil:Kt,floor:Jt,min:Zt,max:Qt,round:$t,scale:es,scaleAndAdd:ts,distance:ss,squaredDistance:is,squaredLength:rs,negate:ns,inverse:as,normalize:g,dot:S,cross:y,lerp:os,slerp:hs,hermite:ls,bezier:cs,random:us,transformMat4:_s,transformMat3:ds,transformQuat:ps,rotateX:fs,rotateY:ms,rotateZ:gs,angle:Ss,zero:ys,str:Gs,exactEquals:Is,equals:Ts,sub:Kr,mul:Qr,div:jr,dist:$r,sqrDist:en,len:Vr,sqrLen:tn,forEach:function(e,t,s,i,r,n){var a,o;for(t=t||3,s=s||0,o=i?Math.min(i*t+s,e.length):e.length,a=s;a<o;a+=t)Er[0]=e[a],Er[1]=e[a+1],Er[2]=e[a+2],r(Er,Er,n),e[a]=Er[0],e[a+1]=Er[1],e[a+2]=Er[2];return e}}),Kr=Ps,Qr=Rs,jr=As,$r=ks,en=Ns,tn=I,sn=T,Dr=G(),Ur=Object.freeze({__proto__:null,create:G,clone:Cs,fromValues:bs,copy:ws,set:xs,add:vs,subtract:Ps,multiply:Rs,divide:As,ceil:Ms,floor:Ds,min:Es,max:Fs,round:Bs,scale:Os,scaleAndAdd:Ls,distance:ks,squaredDistance:Ns,length:I,squaredLength:T,negate:Ws,inverse:Vs,normalize:Us,dot:C,cross:js,lerp:Hs,random:Xs,transformMat4:zs,transformQuat:Ys,zero:qs,str:Ks,exactEquals:Js,equals:Zs,sub:Kr,mul:Qr,div:jr,dist:$r,sqrDist:en,len:tn,sqrLen:sn,forEach:function(e,t,s,i,r,n){var a,o;for(t=t||4,s=s||0,o=i?Math.min(i*t+s,e.length):e.length,a=s;a<o;a+=t)Dr[0]=e[a],Dr[1]=e[a+1],Dr[2]=e[a+2],Dr[3]=e[a+3],r(Dr,Dr,n),e[a]=Dr[0],e[a+1]=Dr[1],e[a+2]=Dr[2],e[a+3]=Dr[3];return e}}),Kr=Cs,Qr=bs,jr=ws,$r=xs,en=vs,tn=ti,Hr=Os,Xr=C,sn=Hs,rn=zr=I,nn=Yr=T,qr=Us,an=Js,Rr=f(),Ar=m(1,0,0),Mr=m(0,1,0),on=function(e,t,s){var i=S(t,s);return i<-.999999?(y(Rr,Ar,t),Vr(Rr)<1e-6&&y(Rr,Mr,t),g(Rr,Rr),w(e,Rr,Math.PI),e):.999999<i?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(y(Rr,t,s),e[0]=Rr[0],e[1]=Rr[1],e[2]=Rr[2],e[3]=1+i,qr(e,e))},vr=b(),Pr=b(),hn=function(e,t,s,i,r,n){return M(vr,t,r,n),M(Pr,s,i,n),M(e,vr,Pr,2*n*(1-n)),e},xr=r(),Kr=Object.freeze({__proto__:null,create:b,identity:Qs,setAxisAngle:w,getAxisAngle:$s,getAngle:ei,multiply:ti,rotateX:x,rotateY:v,rotateZ:P,calculateW:si,exp:R,ln:A,pow:ii,slerp:M,random:ri,invert:ni,conjugate:ai,fromMat3:D,fromEuler:oi,str:hi,clone:Kr,fromValues:Qr,copy:jr,set:$r,add:en,mul:tn,scale:Hr,dot:Xr,lerp:sn,length:zr,len:rn,squaredLength:Yr,sqrLen:nn,normalize:qr,exactEquals:an,equals:li,rotationTo:on,sqlerp:hn,setAxes:function(e,t,s,i){return xr[0]=s[0],xr[3]=s[1],xr[6]=s[2],xr[1]=i[0],xr[4]=i[1],xr[7]=i[2],xr[2]=-t[0],xr[5]=-t[1],xr[8]=-t[2],qr(e,D(e,xr))}}),Jr=Xr,Qr=Zr=Yr,$r=Object.freeze({__proto__:null,create:ci,clone:ui,fromValues:_i,fromRotationTranslationValues:di,fromRotationTranslation:E,fromTranslation:pi,fromRotation:fi,fromMat4:mi,copy:F,identity:gi,set:Si,getReal:jr,getDual:yi,setReal:jr,setDual:Gi,getTranslation:Ii,translate:Ti,rotateX:Ci,rotateY:bi,rotateZ:wi,rotateByQuatAppend:xi,rotateByQuatPrepend:vi,rotateAroundAxis:Pi,add:Ri,multiply:Ai,mul:Ai,scale:Mi,dot:Jr,lerp:Di,invert:Ei,conjugate:Fi,length:zr,len:zr,squaredLength:Zr,sqrLen:Qr,normalize:Bi,str:Oi,exactEquals:Li,equals:ki}),en=sr,tn=Hi,sn=Xi,rn=zi,nn=er,an=tr,on=ir,wr=B(),hn=Object.freeze({__proto__:null,create:B,clone:Ni,fromValues:Wi,copy:Vi,set:Ui,add:ji,subtract:Hi,multiply:Xi,divide:zi,ceil:Yi,floor:qi,min:Ki,max:Ji,round:Zi,scale:Qi,scaleAndAdd:$i,distance:er,squaredDistance:tr,length:sr,squaredLength:ir,negate:rr,inverse:nr,normalize:ar,dot:or,cross:hr,lerp:lr,random:cr,transformMat2:ur,transformMat2d:_r,transformMat3:dr,transformMat4:pr,rotate:fr,angle:mr,zero:gr,str:Sr,exactEquals:yr,equals:Gr,len:en,sub:tn,mul:sn,div:rn,dist:nn,sqrDist:an,sqrLen:on,forEach:function(e,t,s,i,r,n){var a,o;for(t=t||2,s=s||0,o=i?Math.min(i*t+s,e.length):e.length,a=s;a<o;a+=t)wr[0]=e[a],wr[1]=e[a+1],r(wr,wr,n),e[a]=wr[0],e[a+1]=wr[1];return e}}),globalThis.glMatrix=Lr,globalThis.glMatrix.mat2=kr,globalThis.glMatrix.mat2d=Nr,globalThis.glMatrix.mat3=Wr,globalThis.glMatrix.mat4=Cr,globalThis.glMatrix.quat=Kr,globalThis.glMatrix.quat2=$r,globalThis.glMatrix.vec2=hn,globalThis.glMatrix.vec3=br,globalThis.glMatrix.vec4=Ur}var wr,xr,vr,Pr,Rr,Ar,Mr,Dr,Er,Ir,Tr,Fr,Br,Or,Lr,kr,Nr,Wr,Cr,Vr,br,Ur,jr,Hr,Xr,zr,Yr,qr,Kr,Jr,Zr,Qr,$r,en,tn,sn,rn,nn,an,on,hn,F,B,O,L;{let h=function(e,t,s){var i=[0,0],r=e[1][1]-e[0][1],n=e[0][0]-e[1][0],e=r*e[0][0]+n*e[0][1],a=t[1][1]-t[0][1],o=t[0][0]-t[1][0],t=a*t[0][0]+o*t[0][1],h=r*o-a*n;return f(h,0,s=s||0)||(i[0]=(o*e-n*t)/h,i[1]=(r*t-a*e)/h),i},r=function(e,t,s,i){var r,n=t[0]-e[0],t=t[1]-e[1],a=i[0]-s[0];return a*t-(i=i[1]-s[1])*n!=0&&(r=(a*(e[1]-s[1])+i*(s[0]-e[0]))/(i*n-a*t),0<=(e=(n*(s[1]-e[1])+t*(e[0]-s[0]))/(a*t-i*n)))&&e<=1&&0<=r&&r<=1},o=function(e,t,s){return(t[0]-e[0])*(s[1]-e[1])-(s[0]-e[0])*(t[1]-e[1])},C=function(e,t,s){return 0<o(e,t,s)},b=function(e,t,s){return 0<=o(e,t,s)},w=function(e,t,s){return o(e,t,s)<0},x=function(e,t,s){return o(e,t,s)<=0},n=function(e,t,s,i){var r,n,a;return i?(a=B,(n=F)[0]=t[0]-e[0],n[1]=t[1]-e[1],a[0]=s[0]-t[0],a[1]=s[1]-t[1],r=n[0]*a[0]+n[1]*a[1],n=Math.sqrt(n[0]*n[0]+n[1]*n[1]),a=Math.sqrt(a[0]*a[0]+a[1]*a[1]),Math.acos(r/(n*a))<i):0===o(e,t,s)},v=function(e,t){var s=t[0]-e[0];return s*s+(t=t[1]-e[1])*t},P=function(e,t){var s=e.length;return e[t<0?t%s+s:t%s]},a=function(e){e.length=0},R=function(e,t,s,i){for(var r=s;r<i;r++)e.push(t[r])},e=function(e){for(var t=0,s=e,i=1;i<e.length;++i)(s[i][1]<s[t][1]||s[i][1]===s[t][1]&&s[i][0]>s[t][0])&&(t=i);return!C(P(e,t-1),P(e,t),P(e,t+1))&&(l(e),!0)},l=function(e){for(var t=[],s=e.length,i=0;i!==s;i++)t.push(e.pop());for(i=0;i!==s;i++)e[i]=t[i]},A=function(e,t){return w(P(e,t-1),P(e,t),P(e,t+1))},c=function(e,t,s){var i,r=O,n=L;if(b(P(e,t+1),P(e,t),P(e,s))&&x(P(e,t-1),P(e,t),P(e,s)))return!1;for(var a=v(P(e,t),P(e,s)),o=0;o!==e.length;++o)if((o+1)%e.length!==t&&o!==t&&b(P(e,t),P(e,s),P(e,o+1))&&x(P(e,t),P(e,s),P(e,o))&&(r[0]=P(e,t),r[1]=P(e,s),n[0]=P(e,o),n[1]=P(e,o+1),i=h(r,n),v(P(e,t),i)<a))return!1;return!0},M=function(e,t,s){for(var i=0;i!==e.length;++i)if(i!==t&&i!==s&&(i+1)%e.length!==t&&(i+1)%e.length!==s&&r(P(e,t),P(e,s),P(e,i),P(e,i+1)))return!1;return!0},u=function(e,t,s,i){var r=i||[];if(a(r),t<s)for(var n=t;n<=s;n++)r.push(e[n]);else{for(n=0;n<=s;n++)r.push(e[n]);for(n=t;n<e.length;n++)r.push(e[n])}return r},_=function(e){for(var t=[],s=[],i=[],r=Number.MAX_VALUE,n=0;n<e.length;++n)if(A(e,n))for(var a=0;a<e.length;++a)if(c(e,n,a)){for(var s=_(u(e,n,a,i)),o=_(u(e,a,n,i)),h=0;h<o.length;h++)s.push(o[h]);s.length<r&&(r=(t=s).length,t.push([P(e,n),P(e,a)]))}return t},t=function(e){var t=_(e);return 0<t.length?d(e,t):[e]},d=function(e,t){if(0===t.length)return[e];if(t instanceof Array&&t.length&&t[0]instanceof Array&&2===t[0].length&&t[0][0]instanceof Array){for(var s=[e],i=0;i<t.length;i++)for(var r=t[i],n=0;n<s.length;n++){var a=d(s[n],r);if(a){s.splice(n,1),s.push(a[0],a[1]);break}}return s}return i=e.indexOf((r=t)[0]),n=e.indexOf(r[1]),-1!==i&&-1!==n&&[u(e,i,n),u(e,n,i)]},s=function(e){for(var t=e,s=0;s<t.length-1;s++)for(var i=0;i<s-1;i++)if(r(t[s],t[s+1],t[i],t[i+1]))return!1;for(s=1;s<t.length-2;s++)if(r(t[0],t[t.length-1],t[s],t[s+1]))return!1;return!0},D=function(e,t,s,i,r){var n=t[1]-e[1],t=e[0]-t[0],e=n*e[0]+t*e[1],a=i[1]-s[1],i=s[0]-i[0],s=a*s[0]+i*s[1],o=n*i-a*t;return f(o,0,r=r||0)?[0,0]:[(i*e-t*s)/o,(n*s-a*e)/o]},E=function(e,t,s,i,r,n,a){n=n||100,a=a||0,r=r||25,t=void 0!==t?t:[],s=s||[],i=i||[];var o=[0,0],h=[0,0],l=[0,0],c=0,u=0,_=0,d=0,p=0,f=0,m=0,g=[],S=[],y=e,G=e;if(!(G.length<3))if(n<++a)console.warn(\"quickDecomp: max level (\"+n+\") reached.\");else{for(var I=0;I<e.length;++I)if(A(y,I)){s.push(y[I]);for(var c=u=Number.MAX_VALUE,T=0;T<e.length;++T)C(P(y,I-1),P(y,I),P(y,T))&&x(P(y,I-1),P(y,I),P(y,T-1))&&(l=D(P(y,I-1),P(y,I),P(y,T),P(y,T-1)),w(P(y,I+1),P(y,I),l))&&(_=v(y[I],l))<u&&(u=_,h=l,f=T),C(P(y,I+1),P(y,I),P(y,T+1))&&x(P(y,I+1),P(y,I),P(y,T))&&(l=D(P(y,I+1),P(y,I),P(y,T),P(y,T+1)),C(P(y,I-1),P(y,I),l))&&(_=v(y[I],l))<c&&(c=_,o=l,p=T);if(f===(p+1)%e.length)l[0]=(h[0]+o[0])/2,l[1]=(h[1]+o[1])/2,i.push(l),I<p?(R(g,y,I,p+1),g.push(l),S.push(l),0!==f&&R(S,y,f,y.length),R(S,y,0,I+1)):(0!==I&&R(g,y,I,y.length),R(g,y,0,p+1),g.push(l),S.push(l),R(S,y,f,I+1));else{if(p<f&&(p+=e.length),d=Number.MAX_VALUE,p<f)return t;for(T=f;T<=p;++T)b(P(y,I-1),P(y,I),P(y,T))&&x(P(y,I+1),P(y,I),P(y,T))&&(_=v(P(y,I),P(y,T)))<d&&M(y,I,T)&&(d=_,m=T%e.length);I<m?(R(g,y,I,m+1),0!==m&&R(S,y,m,G.length),R(S,y,0,I+1)):(0!==I&&R(g,y,I,G.length),R(g,y,0,m+1),R(S,y,m,I+1))}return g.length<S.length?(E(g,t,s,i,r,n,a),E(S,t,s,i,r,n,a)):(E(S,t,s,i,r,n,a),E(g,t,s,i,r,n,a)),t}t.push(e)}return t},i=function(e,t){for(var s=0,i=e.length-1;3<e.length&&0<=i;--i)n(P(e,i-1),P(e,i),P(e,i+1),t)&&(e.splice(i%e.length,1),s++);return s},p=function(e,t){for(var s=e.length-1;1<=s;--s)for(var i=e[s],r=s-1;0<=r;--r)m(i,e[r],t)&&e.splice(s,1)},f=function(e,t,s){return s=s||0,Math.abs(e-t)<=s},m=function(e,t,s){return f(e[0],t[0],s)&&f(e[1],t[1],s)};h,r,o,C,b,w,x,n,v,P,a,R,l,A,c,M,u,_,d,D,E,f,m,F=[],B=[],O=[],L=[],self.polyDecomp={decomp:t,quickDecomp:E,isSimple:s,removeCollinearPoints:i,removeDuplicatePoints:p,makeCCW:e}}{let e=!1,t=!1,s=\"dev\",i=Symbol(\"Construct internal API token\"),r=14,n=self.C3=class{constructor(){throw TypeError(\"static class can't be instantiated\")}static _GetInternalAPIToken(){if(r<=0)throw new Error(\"cannot obtain internal API token\");return--r,i}static SetReady(){e=!0}static IsReady(){return e}static SetAppStarted(){t=!0}static HasAppStarted(){return t}static SetBuildMode(e){s=e}static GetBuildMode(){return s}static IsReleaseBuild(){return\"final\"===s}};n.isDebug=!1,n.isDebugDefend=!1,n.hardwareConcurrency=navigator.hardwareConcurrency||2,self.C3X={}}{const t=self.C3;t.QueryParser=class{constructor(e){this._queryString=e,this._parameters=new Map,this._Parse()}_Parse(){let e=this._queryString,t=(e=e.startsWith(\"?\")||e.startsWith(\"#\")?e.substr(1):e).split(\"&\");for(const s of t)this._ParseParameter(s)}_ParseParameter(e){if(e)if(e.includes(\"=\")){const t=e.indexOf(\"=\"),s=decodeURIComponent(e.substring(0,t)),i=decodeURIComponent(e.substring(t+1));this._parameters.set(s,i)}else this._parameters.set(e,null)}LogAll(){for(const e of this._parameters)console.log(\"[QueryParser] Parameter '\"+e[0]+\"' = \"+(null===e[1]?\"null\":\"'\"+e[1]+\"'\"))}Has(e){return this._parameters.has(e)}Get(e){const t=this._parameters.get(e);return void 0===t?null:t}ClearHash(){history.replaceState(\"\",document.title,location.pathname+location.search)}Reparse(e){this._queryString=e,this._parameters.clear(),this._Parse()}},t.QueryString=new t.QueryParser(location.search),t.LocationHashString=new t.QueryParser(location.hash),t.QueryString.Has(\"perf\")&&(t.isPerformanceProfiling=!0),\"dev\"!==t.QueryString.Get(\"mode\")&&t.SetBuildMode(\"final\")}{let i=function(e){const t=parseFloat(e),s=V.get(t);return s||(13<=t?\"11\":\"NT \"+e)};i;const h=self.C3,W=\"(unknown)\",V=(h.Platform={OS:W,OSVersion:W,Browser:W,BrowserVersion:W,BrowserVersionNumber:NaN,BrowserEngine:W,Context:\"browser\",IsDesktop:!0,IsMobile:!1,IsAppleOS:!1,IsIpadOS:!1,GetDetailedInfo:async()=>{}},new Map([[5,\"2000\"],[5.1,\"XP\"],[5.2,\"XP\"],[6,\"Vista\"],[6.1,\"7\"],[6.2,\"8\"],[6.3,\"8.1\"],[10,\"10\"]])),U=navigator.userAgent,j=navigator.userAgentData;if(j&&0<j.brands.length){let t=function(e){let t=\"\",s=\"\",i=\"\",r=\"\";for(const n of e){const a=H.get(n.brand),o=(!t&&a&&(t=a,s=n.version),X.get(n.brand));!i&&o&&(i=o,r=n.version)}t||\"Chromium\"!==i||(h.Platform.Browser=\"Chromium\",h.Platform.BrowserVersion=r),h.Platform.Browser=t||W,h.Platform.BrowserVersion=s||W,h.Platform.BrowserEngine=i||W};t,h.Platform.OS=j.platform,h.Platform.IsMobile=j.mobile,h.Platform.IsDesktop=!h.Platform.IsMobile;const H=new Map([[\"Google Chrome\",\"Chrome\"],[\"Microsoft Edge\",\"Edge\"],[\"Opera\",\"Opera\"],[\"Opera GX\",\"Opera GX\"],[\"Mozilla Firefox\",\"Firefox\"],[\"Apple Safari\",\"Safari\"],[\"NW.js\",\"NW.js\"]]),X=new Map([[\"Chromium\",\"Chromium\"],[\"Gecko\",\"Gecko\"],[\"WebKit\",\"WebKit\"]]);t(j.brands);let s=!1;h.Platform.GetDetailedInfo=async()=>{if(!s)try{const e=await navigator.userAgentData.getHighEntropyValues([\"platformVersion\",\"fullVersionList\"]);t(e.fullVersionList),\"Windows\"===h.Platform.OS?h.Platform.OSVersion=i(e.platformVersion):h.Platform.OSVersion=e.platformVersion,s=!0}catch(e){console.warn(\"Failed to get detailed user agent information: \",e)}}}else{let e=function(e,t){const s=Array.isArray(e)?e:[e];for(const i of s){const r=i.exec(U);if(r){t(r);break}}};e(/windows\\s+nt\\s+([\\d\\.]+)/i,e=>{h.Platform.OS=\"Windows\";const t=e[1];h.Platform.OSVersion=i(t)}),e(/mac\\s+os\\s+x\\s+([\\d\\._]+)/i,e=>{h.Platform.OS=\"macOS\",h.Platform.OSVersion=e[1].replace(/_/g,\".\")}),e(/CrOS/,()=>{h.Platform.OS=\"Chrome OS\"}),e(/linux|openbsd|freebsd|netbsd/i,()=>{h.Platform.OS=\"Linux\"}),e(/android/i,()=>{h.Platform.OS=\"Android\"}),e(/android\\s+([\\d\\.]+)/i,e=>{h.Platform.OS=\"Android\",h.Platform.OSVersion=e[1]}),h.Platform.OS===W&&(e(/(iphone|ipod|ipad)/i,e=>{h.Platform.OS=\"iOS\"}),e([/iphone\\s+os\\s+([\\d\\._]+)/i,/ipad[^)]*os\\s+([\\d\\._]+)/i],e=>{h.Platform.OS=\"iOS\",h.Platform.OSVersion=e[1].replace(/_/g,\".\")}));const z=/chrome\\//i.test(U),Y=/chromium\\//i.test(U),q=/edg\\//i.test(U),K=/OPR\\//.test(U),J=/nwjs/i.test(U),Z=/safari\\//i.test(U),Q=/webkit/i.test(U),$=(q||K||e(/chrome\\/([\\d\\.]+)/i,e=>{h.Platform.Browser=\"Chrome\",h.Platform.BrowserVersion=e[1],h.Platform.BrowserEngine=\"Chromium\"}),e(/edg\\/([\\d\\.]+)/i,e=>{h.Platform.Browser=\"Edge\",h.Platform.BrowserVersion=e[1],h.Platform.BrowserEngine=\"Chromium\"}),e(/OPR\\/([\\d\\.]+)/,e=>{h.Platform.Browser=\"Opera\",h.Platform.BrowserVersion=e[1],h.Platform.BrowserEngine=\"Chromium\"}),e(/chromium\\/([\\d\\.]+)/i,e=>{h.Platform.Browser=\"Chromium\",h.Platform.BrowserVersion=e[1],h.Platform.BrowserEngine=\"Chromium\"}),e(/nwjs\\/[0-9.]+/i,e=>{h.Platform.Browser=\"NW.js\",h.Platform.BrowserVersion=e[1],h.Platform.BrowserEngine=\"Chromium\",h.Platform.Context=\"nwjs\"}),e(/firefox\\/([\\d\\.]+)/i,e=>{h.Platform.Browser=\"Firefox\",h.Platform.BrowserVersion=e[1],h.Platform.BrowserEngine=\"Gecko\"}),!Z||z||Y||q||K||J||(h.Platform.Browser=\"Safari\",h.Platform.BrowserEngine=\"WebKit\",e(/version\\/([\\d\\.]+)/i,e=>{h.Platform.BrowserVersion=e[1]}),e(/crios\\/([\\d\\.]+)/i,e=>{h.Platform.Browser=\"Chrome for iOS\",h.Platform.BrowserVersion=e[1]}),e(/fxios\\/([\\d\\.]+)/i,e=>{h.Platform.Browser=\"Firefox for iOS\",h.Platform.BrowserVersion=e[1]}),e(/edgios\\/([\\d\\.]+)/i,e=>{h.Platform.Browser=\"Edge for iOS\",h.Platform.BrowserVersion=e[1]})),h.Platform.BrowserEngine===W&&Q&&(h.Platform.BrowserEngine=\"WebKit\"),\"Android\"===h.Platform.OS&&\"Safari\"===h.Platform.Browser&&(h.Platform.Browser=\"Stock\"),new Set([\"Windows\",\"macOS\",\"Linux\",\"Chrome OS\"])),ee=$.has(h.Platform.OS)||\"nwjs\"===h.Platform.Context;h.Platform.IsDesktop=ee,h.Platform.IsMobile=!ee}\"Chrome\"===h.Platform.Browser&&\"browser\"===h.Platform.Context&&/wv\\)/.test(U)&&(h.Platform.Context=\"webview\"),\"nwjs\"!==h.Platform.Context&&\"undefined\"!=typeof window&&(window.matchMedia&&window.matchMedia(\"(display-mode: standalone)\").matches||navigator.standalone)&&(h.Platform.Context=\"webapp\"),h.Platform.BrowserVersionNumber=parseFloat(h.Platform.BrowserVersion);const s=\"macOS\"===h.Platform.OS&&navigator.maxTouchPoints&&2<navigator.maxTouchPoints;s&&(h.Platform.OS=\"iOS\",h.Platform.OSVersion=h.Platform.BrowserVersion,h.Platform.IsDesktop=!1,h.Platform.IsMobile=!0,h.Platform.IsIpadOS=!0),h.Platform.IsAppleOS=\"macOS\"===h.Platform.OS||\"iOS\"===h.Platform.OS}{let a=function(s){return new Promise((e,t)=>{s.onsuccess=()=>e(s.result),s.onerror=()=>t(s.error)})},o=function(s){return new Promise((e,t)=>{s.oncomplete=()=>e(),s.onerror=()=>t(s.error),s.onabort=()=>t(s.error)})},e=function(e,t){return k(e,t)},t=function(e,t){return k(e,t,!0)},h=function(t){i(t);let e=ie.get(t);return e instanceof Promise||(e=(async s=>{i(s);const e=indexedDB.open(s,te);return e.addEventListener(\"upgradeneeded\",e=>{try{const t=e.target.result;t.createObjectStore(se)}catch(e){console.error(\"Failed to create objectstore for database \"+s,e)}}),a(e)})(t),ie.set(t,e),e.catch(e=>ie.delete(t))),e},i=function(e){if(\"string\"!=typeof e)throw new TypeError(\"expected string\")},n=function(e,r){const t=e.objectStore(se).openCursor();return new Promise(s=>{const i=[];t.onsuccess=e=>{const t=e.target.result;if(t){switch(r){case\"entries\":i.push([t.key,t.value]);break;case\"keys\":i.push(t.key);break;case\"values\":i.push(t.value)}t.continue()}else s(i)}})};a,o,e,t,h,i,n;const te=2,se=\"keyvaluepairs\",ie=new Map,re=\"undefined\"!=typeof IDBObjectStore&&\"function\"==typeof IDBObjectStore.prototype.getAll,ne=\"undefined\"!=typeof IDBObjectStore&&\"function\"==typeof IDBObjectStore.prototype.getAllKeys;async function k(t,s,i=!1,r=!0){const e=await h(t);try{const n=e.transaction([se],i?\"readwrite\":\"readonly\");return s(n)}catch(e){if(r&&\"InvalidStateError\"===e.name)return ie.delete(t),k(t,s,i,!1);throw e}}class ae{constructor(e){i(e),this.name=e}async ready(){await h(this.name)}set(r,n){return i(r),t(this.name,async e=>{const t=e.objectStore(se).put(n,r),s=a(t),i=o(e);await Promise.all([i,s])})}get(n){return i(n),e(this.name,async e=>{const t=e.objectStore(se).get(n),s=a(t),i=o(e),[,r]=await Promise.all([i,s]);return r})}delete(r){return i(r),t(this.name,async e=>{const t=e.objectStore(se).delete(r),s=a(t),i=o(e);await Promise.all([i,s])})}clear(){return t(this.name,async e=>{const t=e.objectStore(se).clear(),s=a(t),i=o(e);await Promise.all([i,s])})}keys(){return e(this.name,async e=>{let t;if(ne){const r=e.objectStore(se).getAllKeys();t=a(r)}else t=n(e,\"keys\");const s=o(e),[,i]=await Promise.all([s,t]);return i})}values(){return e(this.name,async e=>{let t;if(re){const r=e.objectStore(se).getAll();t=a(r)}else t=n(e,\"values\");const s=o(e),[,i]=await Promise.all([s,t]);return i})}entries(){return e(this.name,async e=>{const t=n(e,\"entries\"),s=o(e),[,i]=await Promise.all([s,t]);return i})}}self.KVStorageContainer=ae}{let s=function(e){throw new Error(`\"${e}\" is not implemented`)},i=function(e){if(\"function\"==typeof e)throw new Error(\"localforage callback API is not implemented; please use the promise API instead\")},r=function(i){return\"object\"==typeof i?new Promise(t=>{const{port1:e,port2:s}=new MessageChannel;s.onmessage=e=>t(e.data),e.postMessage(i)}):Promise.resolve(i)};s,i,r;const oe=self.KVStorageContainer,he=[/no available storage method found/i,/an attempt was made to break through the security policy of the user agent/i,/the user denied permission to access the database/i,/a mutation operation was attempted on a database that did not allow mutations/i,/idbfactory\\.open\\(\\) called in an invalid security context/i];new WeakMap;class le{constructor(e){this._inst=e,this._isInMemory=!this._inst,this._isInMemory||\"undefined\"!=typeof indexedDB||(this._isInMemory=!0,console.warn(\"Unable to use local storage because IndexedDB API is not available\")),this._memoryStorage=new Map}_MaybeSwitchToMemoryFallback(e){if(!this._isInMemory)for(const t of he)if(e&&t.test(e.message)){console.error(\"Unable to use local storage, reverting to in-memory store: \",e,e.message),this._isInMemory=!0;break}}async _getItemFallback(e){const t=this._memoryStorage.get(e),s=await r(t);return void 0===s?null:s}async _setItemFallback(e,t){t=await r(t),this._memoryStorage.set(e,t)}_removeItemFallback(e){this._memoryStorage.delete(e)}_clearFallback(){this._memoryStorage.clear()}_keysFallback(){return Array.from(this._memoryStorage.keys())}IsInMemory(){return this._isInMemory}GetMemoryStorage(){return this._memoryStorage}SetMemoryStorage(e){this._memoryStorage=e}async getItem(t,e){if(i(e),this._isInMemory)return this._getItemFallback(t);let s;try{s=await this._inst.get(t)}catch(e){return this._MaybeSwitchToMemoryFallback(e),this._isInMemory?this._getItemFallback(t):(console.error(`Error reading '${t}' from storage, returning null: `,e),null)}return void 0===s?null:s}async setItem(t,s,e){if(i(e),void 0===s&&(s=null),this._isInMemory)await this._setItemFallback(t,s);else try{await this._inst.set(t,s)}catch(e){if(this._MaybeSwitchToMemoryFallback(e),!this._isInMemory)throw e;await this._setItemFallback(t,s)}}async removeItem(t,e){if(i(e),this._isInMemory)this._removeItemFallback(t);else try{await this._inst.delete(t)}catch(e){this._MaybeSwitchToMemoryFallback(e),this._isInMemory?this._removeItemFallback(t):console.error(`Error removing '${t}' from storage: `,e)}}async clear(e){if(i(e),this._isInMemory)this._clearFallback();else try{await this._inst.clear()}catch(e){this._MaybeSwitchToMemoryFallback(e),this._isInMemory?this._clearFallback():console.error(\"Error clearing storage: \",e)}}async keys(e){if(i(e),this._isInMemory)return this._keysFallback();let t=[];try{t=await this._inst.keys()}catch(e){if(this._MaybeSwitchToMemoryFallback(e),this._isInMemory)return this._keysFallback();console.error(\"Error getting storage keys: \",e)}return t}ready(e){return i(e),this._isInMemory?Promise.resolve(!0):this._inst.ready()}createInstance(e){if(e.forceInMemoryFallback)return new le(null);{const t=e.name;if(\"string\"!=typeof t)throw new TypeError(\"invalid store name\");const s=new oe(t);return new le(s)}}length(e){s(\"localforage.length()\")}key(e,t){s(\"localforage.key()\")}iterate(e,t){s(\"localforage.iterate()\")}setDriver(e){s(\"localforage.setDriver()\")}config(e){s(\"localforage.config()\")}defineDriver(e){s(\"localforage.defineDriver()\")}driver(){s(\"localforage.driver()\")}supports(e){s(\"localforage.supports()\")}dropInstance(){s(\"localforage.dropInstance()\")}}self.localforage=new le(new oe(\"localforage\"))}{const i=self.C3;if(i.Supports={},i.Supports.WebAnimations=(()=>{try{if(\"undefined\"==typeof document)return!1;const e=document.createElement(\"div\");if(void 0===e.animate)return!1;const t=e.animate([{opacity:\"0\"},{opacity:\"1\"}],1e3);return void 0!==t.reverse}catch(e){return!1}})(),i.Supports.DialogElement=\"undefined\"!=typeof HTMLDialogElement,i.Supports.RequestIdleCallback=!!self.requestIdleCallback,i.Supports.ImageBitmap=!!self.createImageBitmap,i.Supports.ImageBitmapOptions=!1,i.Supports.ImageBitmapOptionsResize=!1,i.Supports.ImageBitmap){try{self.createImageBitmap(new ImageData(32,32),{premultiplyAlpha:\"none\"}).then(()=>{i.Supports.ImageBitmapOptions=!0}).catch(()=>{i.Supports.ImageBitmapOptions=!1})}catch(e){i.Supports.ImageBitmapOptions=!1}try{self.createImageBitmap(new ImageData(32,32),{resizeWidth:10,resizeHeight:10}).then(e=>{i.Supports.ImageBitmapOptionsResize=10===e.width&&10===e.height}).catch(()=>{i.Supports.ImageBitmapOptionsResize=!1})}catch(e){i.Supports.ImageBitmapOptionsResize=!1}}if(i.Supports.ClipboardReadText=!(!navigator.clipboard||!navigator.clipboard.readText),i.Supports.PermissionsQuery=!(!navigator.permissions||!navigator.permissions.query),i.Supports.ClipboardPermissionsQuery=!1,i.Supports.PermissionsQuery){const ce={name:\"clipboard-read\"};navigator.permissions.query(ce).then(()=>{i.Supports.ClipboardPermissionsQuery=!0}).catch(()=>{i.Supports.ClipboardPermissionsQuery=!1})}i.Supports.AsyncClipboardApi=!!(navigator.permissions&&navigator.clipboard&&self.ClipboardItem),i.Supports.Proxies=\"undefined\"!=typeof Proxy,i.Supports.DownloadAttribute=(()=>{if(\"undefined\"==typeof document)return!1;const e=document.createElement(\"a\");return void 0!==e.download})(),i.Supports.Fetch=\"function\"==typeof fetch,i.Supports.PersistentStorage=!!(self.isSecureContext&&\"Opera\"!==i.Platform.Browser&&navigator.storage&&navigator.storage.persist),i.Supports.StorageQuotaEstimate=!!(self.isSecureContext&&navigator.storage&&navigator.storage.estimate),i.Supports.Fullscreen=(()=>{if(\"undefined\"==typeof document)return!1;if(\"iOS\"===i.Platform.OS)return!1;const e=document.documentElement;return!!(e.requestFullscreen||e.msRequestFullscreen||e.mozRequestFullScreen||e.webkitRequestFullscreen)})(),i.Supports.ImageDecoder=void 0!==self.ImageDecoder,i.Supports.WebCodecs=!!self.VideoEncoder,i.Supports.NativeFileSystemAPI=!!self.showOpenFilePicker,i.Supports.QueryLocalFonts=!!self.queryLocalFonts,i.Supports.UserActivation=!!navigator.userActivation,i.Supports.CanvasToBlobWebP=!1,(async()=>{let t;\"undefined\"==typeof document?t=new OffscreenCanvas(32,32):((t=document.createElement(\"canvas\")).width=32,t.height=32);const e=t.getContext(\"2d\");e.fillStyle=\"blue\",e.fillRect(0,0,32,32);let s=null;try{t.convertToBlob?s=await t.convertToBlob({type:\"image/webp\",quality:1}):t.toBlob&&(s=await new Promise(e=>t.toBlob(e,\"image/webp\",1))),i.Supports.CanvasToBlobWebP=s&&\"image/webp\"===s.type}catch(e){i.Supports.CanvasToBlobWebP=!1}})()}{let i=function(e,s){return e.reduce((e,t)=>(0<s&&Array.isArray(t)?Array.prototype.push.apply(e,i(t,s-1)):e.push(t),e),[])};i;const ue=self.C3;if(!String.prototype.trimStart){const _e=/^[\\x09\\x0A\\x0B\\x0C\\x0D\\x20\\xA0\\u1680\\u180E\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000\\u2028\\u2029\\uFEFF]*/;String.prototype.trimStart=function(){return this.replace(_e,\"\")}}if(!String.prototype.trimEnd){const de=/[\\x09\\x0A\\x0B\\x0C\\x0D\\x20\\xA0\\u1680\\u180E\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000\\u2028\\u2029\\uFEFF]*$/;String.prototype.trimEnd=function(){return this.replace(de,\"\")}}String.prototype.replaceAll||(String.prototype.replaceAll=function(e,t){return this.replace(new RegExp(ue.EscapeRegex(e),\"g\"),t)}),Array.prototype.values||(Array.prototype.values=function*(){for(const e of this)yield e}),Array.prototype.flat||(Array.prototype.flat=function(e=1){return i(this,e)}),Array.prototype.at||(Array.prototype.at=function(e){if((e=Math.trunc(e)||0)<0&&(e+=this.length),!(e<0||e>=this.length))return this[e]}),String.prototype.at||(String.prototype.at=function(e){if((e=Math.trunc(e)||0)<0&&(e+=this.length),!(e<0||e>=this.length))return this[e]}),RegExp.escape||(RegExp.escape=function(e){return String(e).replace(/[\\\\^$*+?.()|[\\]{}]/g,\"\\\\$&\")}),Set.prototype.isSubsetOf||(Set.prototype.isSubsetOf=function(e){if(!(e instanceof Set))throw new TypeError(\"argument must be a Set\");for(const t of this)if(!e.has(t))return!1;return!0}),navigator.storage&&!navigator.storage.estimate&&navigator.webkitTemporaryStorage&&navigator.webkitTemporaryStorage.queryUsageAndQuota&&(navigator.storage.estimate=function(){return new Promise((s,e)=>navigator.webkitTemporaryStorage.queryUsageAndQuota((e,t)=>s({usage:e,quota:t}),e))}),void 0===self.isSecureContext&&(self.isSecureContext=\"https:\"===location.protocol),void 0===self.globalThis&&(self.globalThis=self)}{let s=function(e){let t=pe.GetCallStack(),s=\"Assertion failure: \"+e+\"\\n\\nStack trace:\\n\"+t;console.error(s)};s;const pe=self.C3;self.assert=function(e,t){e||s(t)}}{const r=self.C3,fe=self.C3X,me=(r.IsNumber=function(e){return\"number\"==typeof e},r.IsFiniteNumber=function(e){return r.IsNumber(e)&&isFinite(e)},r.RequireNumber=function(e){if(!r.IsNumber(e))throw new TypeError(\"expected number\")},r.RequireOptionalNumber=function(e){r.IsNullOrUndefined(e)},r.RequireNumberInRange=function(e,t,s){if(!r.IsNumber(e)||isNaN(e)||e<t||s<e)throw new RangeError(\"number outside of range\")},r.RequireAllNumber=function(...t){for(let e of t);},r.RequireFiniteNumber=function(e){if(!r.IsFiniteNumber(e))throw new TypeError(\"expected finite number\")},r.RequireOptionalFiniteNumber=function(e){r.IsNullOrUndefined(e)},r.RequireAllFiniteNumber=function(...t){for(let e of t);},r.IsString=function(e){return\"string\"==typeof e},r.RequireString=function(e){if(!r.IsString(e))throw new TypeError(\"expected string\")},r.RequireOptionalString=function(e){r.IsNullOrUndefined(e)},r.RequireAllString=function(...t){for(let e of t);},r.IsSimpleObject=function(e){if(\"object\"!=typeof e||null===e)return!1;let t=Object.getPrototypeOf(e);return t?t.constructor===Object:null===t},r.RequireSimpleObject=function(e){if(!r.IsSimpleObject(e))throw new TypeError(\"expected simple object\")},r.RequireOptionalSimpleObject=function(e){if(!r.IsNullOrUndefined(e)&&!r.IsSimpleObject(e))throw new TypeError(\"expected simple object\")},r.IsObject=function(e){return\"object\"==typeof e&&null!==e&&!Array.isArray(e)},r.RequireObject=function(e){if(!r.IsObject(e))throw new TypeError(\"expected object\")},r.RequireOptionalObject=function(e){r.IsNullOrUndefined(e)},r.RequireAllObject=function(...t){for(let e of t);},r.IsFileLike=function(e){return r.WeakIsInstanceOf(e,Blob)&&\"string\"==typeof e.name},r.RequireFileLike=function(e){if(!r.IsFileLike(e))throw new TypeError(\"expected file\")},r.RequireOptionalFileLike=function(e){r.IsNullOrUndefined(e)},r.IsArray=function(e){return Array.isArray(e)},r.RequireArray=function(e){if(!r.IsArray(e))throw new TypeError(\"expected array\")},r.RequireOptionalArray=function(e){r.IsNullOrUndefined(e)},r.RequireAllArray=function(...t){for(let e of t);},r.Is2DArray=function(e){return!(!r.IsArray(e)||e.length&&!r.IsArray(e[0]))},r.Require2DArray=function(t){if(!r.Is2DArray(t))throw new TypeError(\"expected 2d array\");for(let e of t)if(!r.IsArray(e))throw new TypeError(\"expected 2d array\")},r.RequireOptional2DArray=function(e){r.IsNullOrUndefined(e)},r.IsFunction=function(e){return\"function\"==typeof e},r.RequireFunction=function(e,t){if(!r.IsFunction(e))throw new TypeError(\"expected function\");if(!r.IsNullOrUndefined(t)&&e!==t)throw new TypeError(\"expected same function reference\")},r.RequireOptionalFunction=function(e){r.IsNullOrUndefined(e)},r.RequireAllFunction=function(...t){for(let e of t);},r.RequireAnyFunction=function(t,...s){if(!r.IsFunction(t))throw new TypeError(\"expected function\");if(!s.length)throw new Error(\"missing comparison functions\");for(let e of s)if(!r.IsNullOrUndefined(e)&&t===e)return;throw new TypeError(\"expected same function reference\")},r.RequireOptionalAllFunction=function(...t){if(!r.IsNullOrUndefined(t))for(let e of t);},r.IsInstanceOf=function(e,t){return e instanceof t},r.IsInstanceOfAny=function(t,...s){for(let e of s)if(r.IsInstanceOf(t,e))return!0;return!1},r.RequireInstanceOf=function(e,t){if(!r.IsInstanceOf(e,t))throw new TypeError(\"unexpected type\")},r.RequireOptionalInstanceOf=function(e,t){r.IsNullOrUndefined(e)},r.RequireAllInstanceOf=function(e,...t){for(let e of t);},r.RequireAnyInstanceOf=function(e,...t){if(!r.IsInstanceOfAny(e,...t))throw new TypeError(\"unexpected type\")},r.RequireAnyOptionalInstanceOf=function(e,...t){if(!r.IsNullOrUndefined(e)&&!r.IsInstanceOfAny(e,...t))throw new TypeError(\"unexpected type\")},r.IsArrayOf=function(t,s){for(let e of t)if(!r.IsInstanceOf(e,s))return!1;return!0},r.IsArrayOfFiniteNumbers=function(t){for(let e of t)if(!r.IsFiniteNumber(e))return!1;return!0},r.RequireArrayOf=function(t,e){for(let e of t);},r.RequireOptionalArrayOf=function(t,e){if(!r.IsNullOrUndefined(t))for(let e of t);},r.RequireOptionalArrayOfFunctions=function(t,e){if(!r.IsNullOrUndefined(t))for(let e of t);},r.RequireArrayOfAny=function(t){for(let e of t);},r.RequireOptionalArrayOfAny=function(t){if(!r.IsNullOrUndefined(t))for(let e of t);},r.IsDOMNode=function(e,t){return!(r.IsNullOrUndefined(e)||!r.IsString(e.nodeName))&&(!t||r.equalsNoCase(e.nodeName,t))},r.RequireDOMNode=function(e,t){if(r.IsNullOrUndefined(e)||!r.IsString(e.nodeName))throw new TypeError(\"expected DOM node\");if(t&&!r.equalsNoCase(e.nodeName,t))throw new TypeError(`expected DOM '${t}' node`)},r.RequireOptionalDOMNode=function(e,t){r.IsNullOrUndefined(e)},r.IsHTMLElement=function(e,t){return!(r.IsNullOrUndefined(e)||!r.IsString(e.tagName))&&(!t||r.equalsNoCase(e.tagName,t))},r.RequireHTMLElement=function(e,t){if(r.IsNullOrUndefined(e)||!r.IsString(e.tagName))throw new TypeError(\"expected HTML element\");if(t&&!r.equalsNoCase(e.tagName,t))throw new TypeError(`expected HTML '${t}' element`)},r.RequireOptionalHTMLElement=function(e,t){r.IsNullOrUndefined(e)},r.IsDrawable=function(e){return r.IsHTMLElement(e,\"img\")||r.IsHTMLElement(e,\"canvas\")||r.IsHTMLElement(e,\"video\")||\"undefined\"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas||\"undefined\"!=typeof ImageBitmap&&e instanceof ImageBitmap},r.RequireDrawable=function(e){if(!r.IsDrawable(e))throw new TypeError(\"expected drawable\")},r.RequireOptionalDrawable=function(e){r.IsNullOrUndefined(e)},r.IsDrawableOrImageData=function(e){return e instanceof ImageData||r.IsDrawable(e)},r.RequireDrawableOrImageData=function(e){if(!r.IsDrawableOrImageData(e))throw new TypeError(\"expected drawable or image data\")},r.RequireOptionalDrawableOrImageData=function(e){if(!r.IsNullOrUndefined(e)&&!r.IsDrawableOrImageData(e))throw new TypeError(\"expected drawable or image data\")},r.IsStringLike=function(e){return\"string\"==typeof e||r.HtmlString&&e instanceof r.HtmlString||e instanceof r.BBString},r.RequireStringLike=function(e){if(!r.IsStringLike(e))throw new TypeError(\"expected string-like\")},r.RequireOptionalStringLike=function(e){r.IsNullOrUndefined(e)},r.RequireAllStringLike=function(...t){for(let e of t);},r.RequireOverride=function(){throw new Error(\"must be overridden\")},r.NotYetImplemented=function(){throw new Error(\"not yet implemented\")},r.IsDefined=function(e,...t){let s=e;if(void 0===s)return!1;for(let e of t){if(void 0===s[e])return!1;s=s[e]}return!0},r.IsNullOrUndefined=function(e){return null==e},r.AreArrayElementsOfSameType=function(t){let s=t[0].constructor;for(let e of t)if(e.constructor!==s)return!1;return s},r.AreArrayElementsOfType=function(t,s){for(let e of t)if(!(e instanceof s))return!1;return!0},Object.getPrototypeOf(Uint8Array));r.IsTypedArray=function(e){return r.IsInstanceOf(e,me)},r.RequireTypedArray=function(e){},r.WeakRequireTypedArray=function(e){r.WeakRequireInstanceOf(e,me)},r.WeakRequireAnyInstanceOf=function(e,...t){if(!r.WeakIsAnyInstanceOf(e,...t))throw new TypeError(\"unexpected type\")},r.WeakIsAnyInstanceOf=function(e,...t){for(const s of t)if(r.WeakIsInstanceOf(e,s))return!0;return!1},r.WeakRequireInstanceOf=function(e,t){if(!r.WeakIsInstanceOf(e,t))throw new TypeError(\"unexpected type\")},r.WeakIsInstanceOf=function(e,t){for(;e=Object.getPrototypeOf(e);)if(e.constructor.name===t.name)return!0;return!1},fe.RequireNumber=r.RequireNumber,fe.RequireOptionalNumber=r.RequireOptionalNumber,fe.RequireFiniteNumber=r.RequireFiniteNumber,fe.RequireOptionalFiniteNumber=r.RequireOptionalFiniteNumber,fe.RequireString=r.RequireString,fe.RequireOptionalString=r.RequireOptionalString,fe.RequireObject=r.RequireObject,fe.RequireOptionalObject=r.RequireOptionalObject,fe.RequireArray=r.RequireArray,fe.RequireOptionalArray=r.RequireOptionalArray,fe.RequireFunction=r.RequireFunction,fe.RequireOptionalFunction=r.RequireOptionalFunction,fe.RequireInstanceOf=r.RequireInstanceOf,fe.RequireOptionalInstanceOf=r.RequireOptionalInstanceOf,fe.IsNullOrUndefined=r.IsNullOrUndefined}{let i=function(e,t){let s=p.getType(e),i=p.getType(t);return\"null\"===s||\"null\"===i||\"undefined\"!==s&&\"undefined\"!==i&&s===i},r=function(e){console.warn(\"[Defence] \"+e+\" @\",p.GetCallStack())},s=function(){if(_=-1,0<h.size||0<l.size){let e=new Set([...h.keys()].map(e=>p.getName(e))),t=[...e].join(\",\");console.warn(\"An object derived from DefendedBase was not protected with debugDefend(). This will disable some checks. See the coding guidelines! Possible affected class names: \"+t),h.clear(),l.clear()}},n=function(t){let s=new Set;for(let e in t)s.add(e);return s},a=function(e,t){let s=n(t),i=d.get(e);if(i){let t=[];for(let e of i.values())s.has(e)?s.delete(e):t.push(e);p.appendArray(t,[...s]),t.length&&console.warn(`[Defence] '${p.getName(e)}' constructor creates inconsistent properties: `+t.join(\", \"))}else d.set(e,s)};i,r,s,n,a;const p=self.C3,ge=new Map;p.ColorLog=function(e,t){console.log(\"%c\"+e,\"font-weight: bold; color:\"+t)},p.RafLog=function(e,...t){ge.has(e)||ge.set(e,-1),-1===ge.get(e)&&ge.set(e,requestAnimationFrame(()=>{console.log(\"%c\"+e,\"font-weight: bold\",...t),ge.set(e,-1)}))};let o,h=(p.StartMeasure=function(e){performance.mark(e),(o=o||new Map).has(e)||o.set(e,{current:0,total:0,average:0,calls:1,toString:function(){return`${e} :: current => ${this.current.toPrecision(3)} :: average => ${this.average.toPrecision(3)} :: calls => `+this.calls}})},p.EndMeasure=function(e){performance.measure(\"measure-\"+e,e);const t=performance.getEntriesByName(\"measure-\"+e)[0],s=o.get(e);s.current=t.duration,s.total+=s.current,s.average=s.total/s.calls,console.log(s.toString()),s.calls++,performance.clearMarks(e),performance.clearMeasures(\"measure-\"+e)},p.GetCallStack=function(){return(new Error).stack},p.Debugger=function(){},p.cast=function(e,t){return e&&e instanceof t?e:null},p.getName=function(e){return void 0===e?\"undefined\":null===e?\"null\":\"boolean\"==typeof e?\"<boolean>\":p.IsNumber(e)?\"<number>\":p.IsString(e)?\"<string>\":p.IsArray(e)?\"<array>\":\"symbol\"==typeof e?\"<\"+e.toString()+\">\":p.IsFunction(e)?e.name&&\"Function\"!==e.name?e.name:\"<anonymous function>\":\"object\"==typeof e?e.constructor&&e.constructor.name&&\"Object\"!==e.constructor.name?e.constructor.name:\"<anonymous object>\":\"<unknown>\"},p.getType=function(e){return null===e?\"null\":Array.isArray(e)?\"array\":typeof e},p.range=function*(t,s){if(!isFinite(Math.abs(t-s)))throw new Error(\"Invalid parameters\");if(s<t)for(let e=t-1;e>=s;e--)yield e;else for(let e=t;e<s;e++)yield e},new Map),l=new Map,c=new WeakMap,u=new WeakMap;p.DefendHandler={};const Se=new Set([\"then\",\"splice\"]);p.DefendHandler.get=function(e,t){return t in e||\"symbol\"==typeof t||Se.has(t)||r(`Accessed missing property '${t}' from defended object '${p.getName(e)}', returning undefined`),u.has(e)&&\"symbol\"!=typeof t&&!Se.has(t)&&r(`Accessed property '${t}' on a released object '${p.getName(e)}'\nObject was originally released at: ${u.get(e)})\nCall stack at access: `),e[t]},p.DefendHandler.set=function(e,t,s){return t in e||h.has(e)||r(`Set non-existent property '${t}' to '${s}' on defended object '${p.getName(e)}'`),i(e[t],s)||h.has(e)||r(`Set '${p.getType(e[t])}' property '${t}' to type '${p.getType(s)}' on defended object '${p.getName(e)}'`),u.has(e)&&r(`Set property '${t}' on a released object '${p.getName(e)}'\nObject was originally released at: ${u.get(e)})\nCall stack at access: `),e[t]=s,!0},p.DefendHandler.deleteProperty=function(e,t){throw new ReferenceError(`Cannot delete property '${t}' from defended object '${p.getName(e)}'`)},p.DefendHandler.defineProperty=function(e,t,s){throw new ReferenceError(`Cannot define property '${t}' on defended object '${p.getName(e)}'`)},p.DefendHandler.enumerate=function(e){throw new ReferenceError(`Cannot enumerate defended object '${p.getName(e)}'`)};let _=-1,d=(p.DefendedBase=class{constructor(){if(p.isDebugDefend&&p.Supports.Proxies){let e=Object.create(new.target.prototype),t=new Proxy(e,p.DefendHandler);return h.set(e,t),l.set(t,e),c.set(t,e),-1===_&&(_=requestAnimationFrame(s)),t}}},p.debugDefend=function(t){if(p.isDebugDefend&&p.Supports.Proxies&&t instanceof p.DefendedBase){if(l.has(t)){let e=l.get(t);l.delete(t),h.delete(e)}return t}return p.isDebug?Object.seal(t):t},p.New=function(e,...t){let s;try{s=new e(...t)}catch(e){throw l.clear(),h.clear(),e}return p.isDebugDefend&&a(e,s),p.debugDefend(s)},p.Release=function(e){let t=c.get(e);t&&u.set(t,p.GetCallStack())},p.WasReleased=function(e){let t=c.get(e);return!!t&&!!u.get(t)},new Map);p.PerfMark=class{constructor(e){this._name=\"\",e&&this.start(e)}start(e){p.isPerformanceProfiling&&(this._name=e,performance.mark(this._name+\"-Start\"))}end(){p.isPerformanceProfiling&&(performance.mark(this._name+\"-End\"),performance.measure(this._name,this._name+\"-Start\",this._name+\"-End\"))}next(e){p.isPerformanceProfiling&&(this.end(),this._name=e,performance.mark(this._name+\"-Start\"))}}}{let s=function(e){return 0===e&&1/e<0};s;const g=self.C3,ye=2*Math.PI,Ge=Math.PI/180,Ie=180/Math.PI,Te=(g.wrap=function(e,t,s){e=Math.floor(e),t=Math.floor(t);const i=(s=Math.floor(s))-t;if(0==i)return s;if(e<t){const r=s-(t-e)%i;return r===s?0:r}return t+(e-t)%i},g.mapToRange=function(e,t,s,i,r){const n=s-t;if(0==n&&0===i)return e;const a=r-i;return(e-t)*a/n+i},g.normalize=function(e,t,s){return t-s==0?1:(e-t)/(s-t)},g.clamp=function(e,t,s){return e<t?t:s<e?s:e},g.clampAngle=function(e){return(e%=ye)<0&&(e+=ye),e},g.toRadians=function(e){return e*Ge},g.toDegrees=function(e){return e*Ie},g.distanceTo=function(e,t,s,i){return Math.hypot(s-e,i-t)},g.distanceSquared=function(e,t,s,i){const r=s-e,n=i-t;return r*r+n*n},g.angleTo=function(e,t,s,i){return Math.atan2(i-t,s-e)},g.angleDiff=function(e,t){if(e===t)return 0;let s=Math.sin(e),i=Math.cos(e),r=Math.sin(t),n=Math.cos(t),a=s*r+i*n;return 1<=a?0:a<=-1?Math.PI:Math.acos(a)},g.angleRotate=function(e,t,s){let i=Math.sin(e),r=Math.cos(e),n=Math.sin(t),a=Math.cos(t);return Math.acos(i*n+r*a)>s?0<r*n-i*a?g.clampAngle(e+s):g.clampAngle(e-s):g.clampAngle(t)},g.angleClockwise=function(e,t){let s=Math.sin(e),i=Math.cos(e),r=Math.sin(t),n=Math.cos(t);return i*r-s*n<=0},g.angleLerp=function(e,t,s,i=0){let r=g.angleDiff(e,t),n=ye*i;return g.angleClockwise(t,e)?g.clampAngle(e+(r+n)*s):g.clampAngle(e-(r+n)*s)},g.angleLerpClockwise=function(e,t,s,i=0){const r=g.angleDiff(e,t),n=ye*i;return g.angleClockwise(t,e)?g.clampAngle(e+(r+n)*s):g.clampAngle(e+(ye-r+n)*s)},g.angleLerpAntiClockwise=function(e,t,s,i=0){const r=g.angleDiff(e,t),n=ye*i;return g.angleClockwise(t,e)?g.clampAngle(e-(-ye+r-n)*s):g.clampAngle(e-(r+n)*s)},g.angleReflect=function(e,t){const s=g.angleDiff(e,t);return g.angleClockwise(e,t)?g.clampAngle(t-s):g.clampAngle(t+s)},g.lerp=function(e,t,s){return e+s*(t-e)},g.unlerp=function(e,t,s){return e===t?0:(s-e)/(t-e)},g.relerp=function(e,t,s,i,r){return g.lerp(i,r,g.unlerp(e,t,s))},g.qarp=function(e,t,s,i){return g.lerp(g.lerp(e,t,i),g.lerp(t,s,i),i)},g.cubic=function(e,t,s,i,r){return g.lerp(g.qarp(e,t,s,r),g.qarp(t,s,i,r),r)},g.cosp=function(e,t,s){return(e+t+(e-t)*Math.cos(s*Math.PI))/2},g.isPOT=function(e){return 0<e&&0==(e-1&e)},g.nextHighestPowerOfTwo=function(t){--t;for(let e=1;e<32;e<<=1)t|=t>>e;return t+1},g.roundToNearestFraction=function(e,t){return Math.round(e*t)/t},g.floorToNearestFraction=function(e,t){return Math.floor(e*t)/t},g.roundToDp=function(e,t){t=Math.max(Math.floor(t),0);const s=Math.pow(10,t);return Math.round(e*s)/s},g.countDecimals=function(e){return Math.floor(e)!==e&&e.toString().split(\".\")[1].length||0},g.toFixed=function(e,t){let s=e.toFixed(t),i=s.length-1;for(;0<=i&&\"0\"===s.charAt(i);--i);return 0<=i&&\".\"===s.charAt(i)&&--i,i<0?s:s.substr(0,i+1)},g.PackRGB=function(e,t,s){return g.clamp(e,0,255)|g.clamp(t,0,255)<<8|g.clamp(s,0,255)<<16},1024),Ce=16384,be=8191,we=(g.PackRGBAEx=function(e,t,s,i){return e=g.clamp(Math.floor(1024*e),-8192,be),t=g.clamp(Math.floor(1024*t),-8192,be),s=g.clamp(Math.floor(1024*s),-8192,be),i=g.clamp(Math.floor(1023*i),0,1023),e<0&&(e+=Ce),t<0&&(t+=Ce),s<0&&(s+=Ce),-(e*Ce*Ce*Te+t*Ce*Te+s*Te+i)},g.PackRGBEx=function(e,t,s){return g.PackRGBAEx(e,t,s,1)},g.GetRValue=function(t){if(0<=t)return(255&t)/255;{let e=Math.floor(-t/(Ce*Ce*Te));return e>be&&(e-=Ce),e/1024}},g.GetGValue=function(t){if(0<=t)return((65280&t)>>8)/255;{let e=Math.floor(-t%(Ce*Ce*Te)/(Ce*Te));return e>be&&(e-=Ce),e/1024}},g.GetBValue=function(t){if(0<=t)return((16711680&t)>>16)/255;{let e=Math.floor(-t%(Ce*Te)/Te);return e>be&&(e-=Ce),e/1024}},g.GetAValue=function(e){if(s(e))return 0;if(0<=e)return 1;{const t=Math.floor(-e%Te);return t/1023}},g.greatestCommonDivisor=function(t,s){for(t=Math.floor(t),s=Math.floor(s);0!==s;){let e=s;s=t%s,t=e}return t},[[3,2],[4,3],[5,4],[5,3],[6,5],[14,9],[16,9],[16,10],[21,9]]);g.getAspectRatio=function(s,i){if((s=Math.floor(s))===(i=Math.floor(i)))return[1,1];for(let t of we){let e=s/t[0]*t[1];if(Math.abs(i-e)<1)return t.slice(0);if(e=s/t[1]*t[0],Math.abs(i-e)<1)return[t[1],t[0]]}let e=g.greatestCommonDivisor(s,i);return[s/e,i/e]},g.segmentsIntersect=function(e,t,s,i,r,n,a,o){const h=Math.min(e,s),l=Math.max(e,s),c=Math.min(r,a),u=Math.max(r,a);if(l<c||u<h)return!1;const _=Math.min(t,i),d=Math.max(t,i),p=Math.min(n,o),f=Math.max(n,o);if(d<p||f<_)return!1;const m=r-e+a-s,g=n-t+o-i,S=s-e,y=i-t,G=a-r,I=o-n,T=Math.abs(y*G-I*S),C=G*g-I*m;if(Math.abs(C)>T)return!1;const b=S*g-y*m;return Math.abs(b)<=T},g.segmentsIntersectPreCalc=function(e,t,s,i,r,n,a,o,h,l,c,u){const _=Math.min(h,c),d=Math.max(h,c);if(n<_||d<r)return!1;const p=Math.min(l,u),f=Math.max(l,u);if(o<p||f<a)return!1;const m=h-e+c-s,g=l-t+u-i,S=s-e,y=i-t,G=c-h,I=u-l,T=Math.abs(y*G-I*S),C=G*g-I*m;if(Math.abs(C)>T)return!1;const b=S*g-y*m;return Math.abs(b)<=T},g.segmentIntersectsQuad=function(e,t,s,i,r){const n=Math.min(e,s),a=Math.max(e,s),o=Math.min(t,i),h=Math.max(t,i),l=r.getTlx(),c=r.getTly(),u=r.getTrx(),_=r.getTry(),d=r.getBrx(),p=r.getBry(),f=r.getBlx(),m=r.getBly();return g.segmentsIntersectPreCalc(e,t,s,i,n,a,o,h,l,c,u,_)||g.segmentsIntersectPreCalc(e,t,s,i,n,a,o,h,u,_,d,p)||g.segmentsIntersectPreCalc(e,t,s,i,n,a,o,h,d,p,f,m)||g.segmentsIntersectPreCalc(e,t,s,i,n,a,o,h,f,m,l,c)},g.segmentIntersectsAnyN=function(t,s,i,r,n){let a=Math.min(t,i),o=Math.max(t,i),h=Math.min(s,r),l=Math.max(s,r),c=0;for(let e=n.length-4;c<=e;c+=2)if(g.segmentsIntersectPreCalc(t,s,i,r,a,o,h,l,n[c],n[c+1],n[c+2],n[c+3]))return!0;return g.segmentsIntersectPreCalc(t,s,i,r,a,o,h,l,n[c],n[c+1],n[0],n[1])};g.rayIntersect=function(e,t,s,i,r,n,a,o){const h=s-e,l=i-t,c=a-r,u=o-n,_=h*u-l*c;if(0==_)return 2;const d=((t-i)*(a-e)+h*(o-t))/_;return 0<d&&d<1+1e-6?(u*(a-e)+(r-a)*(o-t))/_:2},g.rayIntersectExtended=function(e,t,s,i,r,n,a,o,h){const l=(a-r)*h,c=(o-n)*h;return g.rayIntersect(e,t,s,i,r-l,n-c,a+l,o+c)},g.isPointInTriangleInclusive=function(e,t,s,i,r,n,a,o){const h=r-s,l=n-i,c=a-s,u=o-i,_=e-s,d=t-i,p=h*h+l*l,f=h*c+l*u,m=h*_+l*d,g=c*c+u*u,S=c*_+u*d,y=1/(p*g-f*f),G=(g*m-f*S)*y,I=(p*S-f*m)*y;return 0<=G&&0<=I&&G+I<=1},g.triangleCartesianToBarycentric=function(e,t,s,i,r,n,a,o){const h=r-s,l=n-i,c=a-s,u=o-i,_=e-s,d=t-i,p=h*h+l*l,f=h*c+l*u,m=c*c+u*u,g=_*h+d*l,S=_*c+d*u,y=p*m-f*f,G=(m*g-f*S)/y,I=(p*S-f*g)/y,T=1-G-I;return[T,G,I]},g.triangleBarycentricToCartesian3d=function(e,t,s,i,r,n,a,o,h,l,c,u){return[e*i+t*a+s*l,e*r+t*o+s*c,e*n+t*h+s*u]}}{let l=self.C3,t=null,s=\"\";if(\"undefined\"!=typeof document){const xe=(t=document).querySelector(\"base\");(s=xe&&xe.hasAttribute(\"href\")?xe.getAttribute(\"href\"):\"\")&&!(s=s.startsWith(\"/\")?s.substr(1):s).endsWith(\"/\")&&(s+=\"/\")}l.GetBaseHref=function(){return s},l.GetBaseURL=function(){if(!t)return\"\";const e=t.location;return l.GetPathFromURL(e.origin+e.pathname)+s},l.GetPathFromURL=function(e){if(!e.length)return e;if(e.endsWith(\"/\")||e.endsWith(\"\\\\\"))return e;const t=Math.max(e.lastIndexOf(\"/\"),e.lastIndexOf(\"\\\\\"));return-1===t?\"\":e.substr(0,t+1)},l.GetFilenameFromURL=function(e){if(!e.length)return e;if(e.endsWith(\"/\")||e.endsWith(\"\\\\\"))return\"\";const t=Math.max(e.lastIndexOf(\"/\"),e.lastIndexOf(\"\\\\\"));return-1===t?e:e.substr(t+1)},l.GetFileExtension=function(e){let t=e.lastIndexOf(\".\");return t<1?\"\":e.substr(t)},l.SetFileExtension=function(e,t){const s=e.lastIndexOf(\".\");return-1===s?e+\".\"+t:e.substr(0,s+1)+t},l.GetFileNamePart=function(e){let t=e.lastIndexOf(\".\");return t<1?e:e.substr(0,t)},l.NormalizeFileSeparator=function(e){return e.replace(/\\\\/g,\"/\")},l.IsFileExtension=function(e,t){const s=e?l.GetFileExtension(e).slice(1):\"\";return t===s},l.FileNameEquals=function(e,t){let s,i;return l.IsFileLike(e)&&(s=l.GetFileNamePart(e.name)),l.IsString(e)&&(s=l.GetFileNamePart(e)),l.IsFileLike(t)&&(i=l.GetFileNamePart(t.name)),l.IsString(t)&&(i=l.GetFileNamePart(t)),s===i},l.ParseFilePath=function(e){e=l.NormalizeFileSeparator(e);let t=/^\\w\\:\\//.exec(e),s=(t?(t=t[0],\"/\"!==(e=e.slice(3))[0]&&(e=\"/\"+e)):t=\"\",(e=1<(e=e.replace(/\\/{2,}/g,\"/\")).length&&\"/\"===e.slice(-1)?e.slice(0,-1):e).lastIndexOf(\"/\")+1),i=\"\",r=e,n,a=\"\";0<s&&(i=e.slice(0,s),r=e.slice(s));const o=(n=r).lastIndexOf(\".\"),h=(0<o&&(a=r.slice(o),n=r.slice(0,-a.length)),t+i+r);return{dir:i,base:r,name:n,root:t,ext:a,full:h}},l.Wait=function(s,i){return new Promise((e,t)=>{self.setTimeout(e,s,i)})},l.swallowException=function(e){try{e()}catch(e){l.isDebug&&console.warn(\"Swallowed exception: \",e)}},l.noop=function(){},l.equalsNoCase=function(e,t){return\"string\"==typeof e&&\"string\"==typeof t&&(e===t||e.normalize().toLowerCase()===t.normalize().toLowerCase())},l.equalsCase=function(e,t){return\"string\"==typeof e&&\"string\"==typeof t&&(e===t||e.normalize()===t.normalize())},l.typedArraySet16=function(e,t,s){e[s++]=t[0],e[s++]=t[1],e[s++]=t[2],e[s++]=t[3],e[s++]=t[4],e[s++]=t[5],e[s++]=t[6],e[s++]=t[7],e[s++]=t[8],e[s++]=t[9],e[s++]=t[10],e[s++]=t[11],e[s++]=t[12],e[s++]=t[13],e[s++]=t[14],e[s]=t[15]},l.truncateArray=function(e,t){e.length=t},l.clearArray=function(e){e&&0!==e.length&&l.truncateArray(e,0)},l.clear2DArray=function(s){if(s){for(let t=0;t<s.length;t++){let e=s[t];l.truncateArray(e,0)}l.truncateArray(s,0)}},l.extendArray=function(t,s,i){const r=t.length;if(!((s|=0)<=r))for(let e=r;e<s;++e)t.push(i)},l.resizeArray=function(e,t,s){const i=e.length;(t|=0)<i?l.truncateArray(e,t):i<t&&l.extendArray(e,t,s)},l.shallowAssignArray=function(e,t){l.clearArray(e),l.appendArray(e,t)},l.appendArray=function(s,i){if(i.length<1e4)s.push(...i);else for(let e=0,t=i.length;e<t;++e)s.push(i[e])},l.arrayRemove=function(s,i){if(!((i=Math.floor(i))<0||i>=s.length)){let t=s.length-1;for(let e=i;e<t;++e)s[e]=s[e+1];l.truncateArray(s,t)}},l.arrayFindRemove=function(e,t){let s=e.indexOf(t);0<=s&&e.splice(s,1)},l.arraysEqual=function(t,s){let i=t.length;if(s.length!==i)return!1;for(let e=0;e<i;++e)if(t[e]!==s[e])return!1;return!0},l.arrayFilterOut=function(s,i){let r=[],n=0;for(let t=0,e=s.length;t<e;++t){let e=s[t];i(e)?r.push(e):(s[n]=e,++n)}return l.truncateArray(s,n),r},l.arrayRemoveAllInSet=function(s,i){let e=s.length,r=0;for(let t=0,e=s.length;t<e;++t){let e=s[t];i.has(e)||(s[r++]=e)}return l.truncateArray(s,r),e-r},l.isArrayIndexInBounds=function(e,t){return e===Math.floor(e)&&0<=e&&e<t.length},l.validateArrayIndex=function(e,t){if(!l.isArrayIndexInBounds(e,t))throw new RangeError(\"array index out of bounds\")},l.cloneArray=function(e){return e.slice()},l.deepCloneArray=function(e,s){let i=[];for(let t of e)if(l.IsObject(t)){let e=s(t);if(!e)throw new Error(\"missing clone\");if(e.constructor!==t.constructor)throw new Error(\"object is not a clone\");i.push(e)}else l.IsArray(t)?i.push(l.deepCloneArray(t,s)):i.push(t);return i},l.clone2DArray=function(t){let s=[];for(let e of t)s.push(e.slice());return s},l.splitStringAndNormalize=function(e,t=\" \"){return e?e.split(t).map(e=>e.trim()).filter(e=>!!e):[]},l.filterSet=function(e,t,s){const i=new Set;for(const r of e.values())t(r)&&(s?i.add(s(r)):i.add(r));return i},l.mergeSets=function(e,t){return e.union?e.union(t):new Set([...e,...t])},l.mergeSetsInPlace=function(e,t){for(const s of t)e.add(s);return e},l.first=function(t){for(let e of t)return e;return null},l.xor=function(e,t){return!e!=!t},l.compare=function(e,t,s){switch(t){case 0:return e===s;case 1:return e!==s;case 2:return e<s;case 3:return e<=s;case 4:return s<e;case 5:return s<=e;default:return!1}},l.hasAnyOwnProperty=function(t){for(let e in t)if(t.hasOwnProperty(e))return!0;return!1},l.PromiseAllWithProgress=function(o,h){return o.length?new Promise((s,i)=>{let r=[],n=0,a=!1;for(let t=0,e=o.length;t<e;++t)r.push(void 0),o[t].then(e=>{a||(r[t]=e,++n===o.length?s(r):h(n,o.length))}).catch(e=>{a=!0,i(e)})}):Promise.resolve([])};let i=[],r=(l.AddLibraryMemoryCallback=function(e){i.push(e)},l.GetEstimatedLibraryMemoryUsage=function(){let s=0;for(let t of i){let e=t();s+=e}return Math.floor(s)},1),n=new Map,a=new MessageChannel,o=(a.port2.onmessage=function(e){const t=e.data,s=n.get(t);n.delete(t),s&&s(performance.now())},l.RequestUnlimitedAnimationFrame=function(e){const t=r++;return n.set(t,e),a.port1.postMessage(t),t},l.CancelUnlimitedAnimationFrame=function(e){n.delete(e)},l.PostTask=l.RequestUnlimitedAnimationFrame,l.WaitForNextTask=function(){return new Promise(e=>l.PostTask(e))},new Set);l.RequestPostAnimationFrame=function(t){const s=self.requestAnimationFrame(async e=>{await l.WaitForNextTask(),o.has(s)&&(o.delete(s),t(e))});return o.add(s),s},l.CancelPostAnimationFrame=function(e){o.has(e)&&(self.cancelAnimationFrame(e),o.delete(e))}}{const n=self.C3;n.IsAbsoluteURL=function(e){return/^(?:[a-z\\-]+:)?\\/\\//.test(e)||\"data:\"===e.substr(0,5)||\"blob:\"===e.substr(0,5)},n.IsRelativeURL=function(e){return!n.IsAbsoluteURL(e)},n.ThrowIfNotOk=function(e){if(!e.ok)throw new Error(`fetch '${e.url}' response returned ${e.status} `+e.statusText)},n.FetchOk=function(e,t){return fetch(e,t).then(e=>(n.ThrowIfNotOk(e),e))},n.FetchText=function(e){return n.FetchOk(e).then(e=>e.text())},n.FetchJson=function(e){return n.FetchOk(e).then(e=>e.json())},n.FetchBlob=function(e){return n.FetchOk(e).then(e=>e.blob())},n.FetchArrayBuffer=function(e){return n.FetchOk(e).then(e=>e.arrayBuffer())},n.FetchImage=function(i){return new Promise((e,t)=>{const s=new Image;s.onload=()=>e(s),s.onerror=e=>t(e),s.src=i})},n.BlobToArrayBuffer=function(i){return\"function\"==typeof i.arrayBuffer?i.arrayBuffer():new Promise((e,t)=>{const s=new FileReader;s.onload=()=>e(s.result),s.onerror=()=>t(s.error),s.readAsArrayBuffer(i)})},n.BlobToString=function(i){return\"function\"==typeof i.text?i.text():new Promise((e,t)=>{const s=new FileReader;s.onload=()=>e(s.result),s.onerror=()=>t(s.error),s.readAsText(i)})},n.BlobToJson=function(e){return n.BlobToString(e).then(e=>JSON.parse(e))},n.BlobToImage=async function(e,t){let s=URL.createObjectURL(e);try{const i=await n.FetchImage(s);return URL.revokeObjectURL(s),s=\"\",t&&\"function\"==typeof i.decode&&await i.decode(),i}finally{s&&URL.revokeObjectURL(s)}},n.CreateCanvas=function(e,t){if(\"undefined\"==typeof document||\"function\"!=typeof document.createElement)return new OffscreenCanvas(e,t);{const s=document.createElement(\"canvas\");return s.width=e,s.height=t,s}},n.CanvasToBlob=function(t,s,i){if(\"number\"!=typeof i&&(i=1),s=s||\"image/png\",i=n.clamp(i,0,1),t.convertToBlob)return t.convertToBlob({type:s,quality:i});if(t.toBlob)return new Promise(e=>t.toBlob(e,s,i));throw new Error(\"could not convert canvas to blob\")},n.DrawableToBlob=function(e,t,s){const i=n.CreateCanvas(e.width,e.height),r=i.getContext(\"2d\");return r.drawImage(e,0,0),n.CanvasToBlob(i,t,s)},n.ImageDataToBlob=function(e,t,s){if(n.Supports.ImageBitmapOptions)return createImageBitmap(e,{premultiplyAlpha:\"none\"}).then(e=>n.DrawableToBlob(e,t,s));if(n.Supports.ImageBitmap)return createImageBitmap(e).then(e=>n.DrawableToBlob(e,t,s));{const i=n.CreateCanvas(e.width,e.height),r=i.getContext(\"2d\");return r.putImageData(e,0,0),n.CanvasToBlob(i,t,s)}},n.CopySet=function(e,t){e.clear();for(const s of t)e.add(s)},n.MapToObject=function(e){const t=Object.create(null);for(const[s,i]of e.entries())t[s]=i;return t},n.ObjectToMap=function(e,t){t.clear();for(const[s,i]of Object.entries(e))t.set(s,i)},n.ToSuperJSON=function t(e){if(\"object\"!=typeof e||null===e)return e;if(e instanceof Set)return{_c3type_:\"set\",data:[...e].map(e=>t(e))};if(e instanceof Map)return{_c3type_:\"map\",data:[...e].map(e=>[e[0],t(e[1])])};{const s=Object.create(null);for(const[i,r]of Object.entries(e))s[i]=t(r);return s}},n.FromSuperJSON=function t(e){if(\"object\"==typeof e&null!==e){if(\"set\"===e._c3type_)return new Set(e.data.map(e=>t(e)));if(\"map\"===e._c3type_)return new Map(e.data.map(e=>[e[0],t(e[1])]));{const s=Object.create(null);for(const[i,r]of Object.entries(e))s[i]=t(r);return s}}return e},n.CSSToCamelCase=function(e){if(e.startsWith(\"--\"))return e;let t=\"\",s=!1,i=0;for(const r of e)\"-\"===r?0<i&&(s=!0):s?(t+=r.toUpperCase(),s=!1):t+=r,++i;return t},n.IsIterator=function(e){return\"object\"==typeof e&&\"function\"==typeof e.next},n.MakeFilledArray=function(t,s){const i=[];if(\"function\"==typeof s)for(let e=0;e<t;++e)i.push(s());else for(let e=0;e<t;++e)i.push(s);return i}}{let i=function(e){return 0===e.length?\"00\":1===e.length?\"0\"+e:e},l=function(e,t,s){return s<0&&(s+=1),1<s&&--s,s<1/6?e+6*(t-e)*s:s<.5?t:s<2/3?e+(t-e)*(2/3-s)*6:e};i,l;const c=self.C3,ve=/([0-9.]+),([0-9.]+)\\%?,([0-9.]+)\\%?/i,Pe=/([0-9.]+),([0-9.]+)\\%?,([0-9.]+)\\%?,([0-9.])/i;c.Color=class{constructor(e,t,s,i){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,this._r=0,this._g=0,this._b=0,this._a=0,e instanceof c.Color?this.set(e):this.setRgba(e||0,t||0,s||0,i||0)}setRgb(e,t,s){return this._r=+e,this._g=+t,this._b=+s,this.clamp(),this}setRgba(e,t,s,i){return this._r=+e,this._g=+t,this._b=+s,this._a=+i,this.clamp(),this}set(e){return this._r=e._r,this._g=e._g,this._b=e._b,this._a=e._a,this}copy(e){return this.set(e)}add(e){this._r+=e._r,this._g+=e._g,this._b+=e._b,this._a+=e._a,this.clamp()}addRgb(e,t,s,i=0){this._r+=+e,this._g+=+t,this._b+=+s,this._a+=+i,this.clamp()}diff(e){this.setR(Math.max(this._r,e._r)-Math.min(this._r,e._r)),this.setG(Math.max(this._g,e._g)-Math.min(this._g,e._g)),this.setB(Math.max(this._b,e._b)-Math.min(this._b,e._b)),this.setA(Math.max(this._a,e._a)-Math.min(this._a,e._a)),this.clamp()}copyRgb(e){this._r=e._r,this._g=e._g,this._b=e._b}setR(e){this._r=c.clamp(+e,0,1)}getR(){return this._r}setG(e){this._g=c.clamp(+e,0,1)}getG(){return this._g}setB(e){this._b=c.clamp(+e,0,1)}getB(){return this._b}setA(e){this._a=c.clamp(+e,0,1)}getA(){return this._a}clone(){return c.New(c.Color,this._r,this._g,this._b,this._a)}toArray(){return[this._r,this._g,this._b,this._a]}toTypedArray(){return new Float64Array(this.toArray())}writeToTypedArray(e,t){e[t++]=this._r,e[t++]=this._g,e[t++]=this._b,e[t]=this._a}writeRGBToTypedArray(e,t){e[t++]=this._r,e[t++]=this._g,e[t]=this._b}equals(e){return this._r===e._r&&this._g===e._g&&this._b===e._b&&this._a===e._a}equalsIgnoringAlpha(e){return this._r===e._r&&this._g===e._g&&this._b===e._b}equalsRgb(e,t,s){return this._r===e&&this._g===t&&this._b===s}equalsRgba(e,t,s,i){return this._r===e&&this._g===t&&this._b===s&&this._a===i}equalsF32Array(e,t){return e[t]===Math.fround(this._r)&&e[t+1]===Math.fround(this._g)&&e[t+2]===Math.fround(this._b)&&e[t+3]===Math.fround(this._a)}equalsRGBF32Array(e,t){return e[t]===Math.fround(this._r)&&e[t+1]===Math.fround(this._g)&&e[t+2]===Math.fround(this._b)}multiply(e){this._r*=e._r,this._g*=e._g,this._b*=e._b,this._a*=e._a}multiplyAlpha(e){this._r*=e,this._g*=e,this._b*=e,this._a*=e}premultiply(){return this._r*=this._a,this._g*=this._a,this._b*=this._a,this}unpremultiply(){return this._r/=this._a,this._g/=this._a,this._b/=this._a,this}clamp(){return this._r=c.clamp(this._r,0,1),this._g=c.clamp(this._g,0,1),this._b=c.clamp(this._b,0,1),this._a=c.clamp(this._a,0,1),this}setFromRgbValue(e){this._r=c.GetRValue(e),this._g=c.GetGValue(e),this._b=c.GetBValue(e),this._a=c.GetAValue(e)}getCssRgb(e,t,s){const i=c.IsFiniteNumber(e)?e:this.getR(),r=c.IsFiniteNumber(t)?t:this.getG(),n=c.IsFiniteNumber(s)?s:this.getB();return`rgb(${100*i}%, ${100*r}%, ${100*n}%)`}getCssRgba(e,t,s,i){const r=c.IsFiniteNumber(e)?e:this.getR(),n=c.IsFiniteNumber(t)?t:this.getG(),a=c.IsFiniteNumber(s)?s:this.getB(),o=c.IsFiniteNumber(i)?i:this.getA();return`rgba(${100*r}%, ${100*n}%, ${100*a}%, ${o})`}toHexString(){const e=Math.round(255*this.getR()),t=Math.round(255*this.getG()),s=Math.round(255*this.getB());return\"#\"+i(e.toString(16))+i(t.toString(16))+i(s.toString(16))}parseHexString(e){if(\"string\"!=typeof e)return!1;let t,s,i;if(3===(e=\"#\"===(e=e.trim()).charAt(0)?e.substr(1):e).length)t=parseInt(e[0],16)/15,s=parseInt(e[1],16)/15,i=parseInt(e[2],16)/15;else{if(6!==e.length)return!1;t=parseInt(e.substr(0,2),16)/255,s=parseInt(e.substr(2,2),16)/255,i=parseInt(e.substr(4,2),16)/255}return isFinite(t)&&this.setR(t),isFinite(s)&&this.setG(s),isFinite(i)&&this.setB(i),this.setA(1),!0}toCommaSeparatedRgb(){const e=Math.round(255*this.getR()),t=Math.round(255*this.getG()),s=Math.round(255*this.getB());return e+`, ${t}, `+s}toRgbArray(){const e=Math.round(255*this.getR()),t=Math.round(255*this.getG()),s=Math.round(255*this.getB());return[e,t,s]}parseCommaSeparatedRgb(e){if(\"string\"!=typeof e)return!1;const t=(e=e.replace(/^rgb\\(|\\)|%/,\"\")).split(\",\");if(t.length<3)return!1;const s=parseInt(t[0].trim(),10)/255,i=parseInt(t[1].trim(),10)/255,r=parseInt(t[2].trim(),10)/255;return isFinite(s)&&this.setR(s),isFinite(i)&&this.setG(i),isFinite(r)&&this.setB(r),this.setA(1),!0}parseCommaSeparatedPercentageRgb(e){if(\"string\"!=typeof e)return!1;const t=(e=e.replace(/^rgb\\(|\\)|%/,\"\")).split(\",\");if(t.length<3)return!1;const s=parseInt(t[0].trim(),10)/100,i=parseInt(t[1].trim(),10)/100,r=parseInt(t[2].trim(),10)/100;return isFinite(s)&&this.setR(s),isFinite(i)&&this.setG(i),isFinite(r)&&this.setB(r),this.setA(1),!0}parseCommaSeparatedRgba(e){if(\"string\"!=typeof e)return!1;const t=(e=e.replace(/^rgba\\(|\\)|%/,\"\")).split(\",\");if(t.length<4)return!1;const s=parseInt(t[0].trim(),10)/255,i=parseInt(t[1].trim(),10)/255,r=parseInt(t[2].trim(),10)/255,n=parseFloat(t[3].trim());return isFinite(s)&&this.setR(s),isFinite(i)&&this.setG(i),isFinite(r)&&this.setB(r),isFinite(n)&&this.setA(n),!0}parseCommaSeparatedPercentageRgba(e){if(\"string\"!=typeof e)return!1;const t=(e=e.replace(/^rgba\\(|\\)|%/,\"\")).split(\",\");if(t.length<4)return!1;const s=parseInt(t[0].trim(),10)/100,i=parseInt(t[1].trim(),10)/100,r=parseInt(t[2].trim(),10)/100,n=parseFloat(t[3].trim());return isFinite(s)&&this.setR(s),isFinite(i)&&this.setG(i),isFinite(r)&&this.setB(r),isFinite(n)&&this.setA(n),!0}parseString(e){if(\"string\"!=typeof e)return!1;if((e=e.replace(/\\s+/,\"\")).includes(\",\")){if(e.startsWith(\"rgb(\"))return e.includes(\"%\")?this.parseCommaSeparatedPercentageRgb(e):this.parseCommaSeparatedRgb(e);if(e.startsWith(\"rgba(\"))return e.includes(\"%\")?this.parseCommaSeparatedPercentageRgba(e):this.parseCommaSeparatedRgba(e);if(e.startsWith(\"hsl(\")||e.startsWith(\"hsla(\"))return this.parseHSLString(e);{const t=e.split(\",\");return e.includes(\"%\")?3===t.length?this.parseCommaSeparatedPercentageRgb(e):4===t.length&&this.parseCommaSeparatedPercentageRgba(e):3===t.length?this.parseCommaSeparatedRgb(e):4===t.length&&this.parseCommaSeparatedRgba(e)}}return this.parseHexString(e)}toJSON(){return[this._r,this._g,this._b,this._a]}setFromHSLA(e,t,s,i){let r,n,a;if(e%=360,t=c.clamp(t,0,100),s=c.clamp(s,0,100),i=c.clamp(i,0,1),e/=360,s/=100,0==(t/=100))r=n=a=s;else{const o=s<.5?s*(1+t):s+t-s*t,h=2*s-o;r=l(h,o,e+1/3),n=l(h,o,e),a=l(h,o,e-1/3)}return this.setR(r),this.setG(n),this.setB(a),this.setA(i),this}parseHSLString(e){const t=e.replace(/ |hsl|hsla|\\(|\\)|;/gi,\"\"),s=ve.exec(t),i=Pe.exec(t);return s&&4===s.length?(this.setFromHSLA(+s[1],+s[2],+s[3],1),!0):!(!i||5!==i.length||(this.setFromHSLA(+s[1],+s[2],+s[3],+s[4]),0))}toHSLAString(){const e=this._r,t=this._g,s=this._b,i=this._a,r=c.Color.GetHue(e,t,s),n=c.Color.GetSaturation(e,t,s),a=c.Color.GetLuminosity(e,t,s);return`hsla(${r}, ${n}%, ${a}%, ${i})`}toHSLAArray(){const e=this._r,t=this._g,s=this._b;return[c.Color.GetHue(e,t,s),c.Color.GetSaturation(e,t,s),c.Color.GetLuminosity(e,t,s),this._a]}setFromJSON(e){!Array.isArray(e)||e.length<3||(this._r=e[0],this._g=e[1],this._b=e[2],this._a=4<=e.length?e[3]:1)}set r(e){this.setR(e)}get r(){return this.getR()}set g(e){this.setG(e)}get g(){return this.getG()}set b(e){this.setB(e)}get b(){return this.getB()}set a(e){this.setA(e)}get a(){return this.getA()}setAtIndex(e,t){switch(e){case 0:this.setR(t);break;case 1:this.setG(t);break;case 2:this.setB(t);break;case 3:this.setA(t);break;default:throw new RangeError(\"invalid color index\")}}getAtIndex(e){switch(e){case 0:return this.getR();case 1:return this.getG();case 2:return this.getB();case 3:return this.getA();default:throw new RangeError(\"invalid color index\")}}static Equals(e,t){let s,i;if(Array.isArray(e))(s=new c.Color).setFromJSON(e);else{if(!(e instanceof c.Color))throw new Error(\"unexpected type\");s=e}if(Array.isArray(t))(i=new c.Color).setFromJSON(t);else{if(!(t instanceof c.Color))throw new Error(\"unexpected type\");i=t}return s.equals(i)}static DiffChannel(e,t){return c.clamp(Math.max(e,t)-Math.min(e,t),0,1)}static Diff(e,t){const s=new c.Color;return s.setR(Math.max(e._r,t._r)-Math.min(e._r,t._r)),s.setG(Math.max(e._g,t._g)-Math.min(e._g,t._g)),s.setB(Math.max(e._b,t._b)-Math.min(e._b,t._b)),s.setA(Math.max(e._a,t._a)-Math.min(e._a,t._a)),s}static DiffNoAlpha(e,t){const s=new c.Color(0,0,0,1);return s.setR(Math.max(e._r,t._r)-Math.min(e._r,t._r)),s.setG(Math.max(e._g,t._g)-Math.min(e._g,t._g)),s.setB(Math.max(e._b,t._b)-Math.min(e._b,t._b)),s}static GetHue(e,t,s){const i=Math.max(e,t,s),r=Math.min(e,t,s);if(i===r)return 0;let n=0;switch(i){case e:n=(t-s)/(i-r)+(t<s?6:0);break;case t:n=(s-e)/(i-r)+2;break;case s:n=(e-t)/(i-r)+4}return Math.round(n/6*360)}static GetSaturation(e,t,s){const i=Math.max(e,t,s),r=Math.min(e,t,s);if(i===r)return 0;const n=(i+r)/2,a=i-r,o=.5<n?a/(2-i-r):a/(i+r);return Math.round(100*o)}static GetLuminosity(e,t,s){const i=Math.max(e,t,s),r=Math.min(e,t,s),n=(i+r)/2;return i?Math.round(100*n):0}},c.Color.White=Object.freeze(c.New(c.Color,1,1,1,1)),c.Color.Black=Object.freeze(c.New(c.Color,0,0,0,1)),c.Color.TransparentBlack=Object.freeze(c.New(c.Color,0,0,0,0))}{const Re=self.C3;Re.Vector2=class{constructor(e,t){this._x=0,this._y=0,e instanceof Re.Vector2?this.copy(e):this.set(e||0,t||0)}set(e,t){this._x=+e,this._y=+t}copy(e){this._x=e._x,this._y=e._y}equals(e){return this._x===e._x&&this._y===e._y}equalsValues(e,t){return this._x===e&&this._y===t}equalsF32Array(e,t){return e[t]===Math.fround(this._x)&&e[t+1]===Math.fround(this._y)}setX(e){this._x=+e}getX(){return this._x}setY(e){this._y=+e}getY(){return this._y}toArray(){return[this._x,this._y]}toTypedArray(){return new Float64Array(this.toArray())}writeToTypedArray(e,t){e[t++]=this._x,e[t]=this._y}offset(e,t){this._x+=+e,this._y+=+t}scale(e,t){this._x*=e,this._y*=t}divide(e,t){this._x/=e,this._y/=t}round(){this._x=Math.round(this._x),this._y=Math.round(this._y)}floor(){this._x=Math.floor(this._x),this._y=Math.floor(this._y)}ceil(){this._x=Math.ceil(this._x),this._y=Math.ceil(this._y)}angle(){return Re.angleTo(0,0,this._x,this._y)}lengthSquared(){return this._x*this._x+this._y*this._y}length(){return Math.hypot(this._x,this._y)}rotatePrecalc(e,t){const s=this._x*t-this._y*e;this._y=this._y*t+this._x*e,this._x=s}rotate(e){0!==e&&this.rotatePrecalc(Math.sin(e),Math.cos(e))}rotateAbout(e,t,s){0===e||t===this._x&&s===this._y||(this._x-=t,this._y-=s,this.rotatePrecalc(Math.sin(e),Math.cos(e)),this._x+=+t,this._y+=+s)}move(e,t){0!==t&&(this._x+=Math.cos(e)*t,this._y+=Math.sin(e)*t)}normalize(){const e=this.length();0!==e&&1!==e&&(this._x/=e,this._y/=e)}clamp(e,t){this._x=Re.clamp(this._x,e,t),this._y=Re.clamp(this._y,e,t)}dot(e){return this._x*e._x+this._y*e._y}reverse(){this._x=-this._x,this._y=-this._y}perp(){let e=this._x;return this._x=this._y,this._y=-e,this}}}{const Ae=self.C3;Ae.Rect=class{constructor(e,t,s,i){this._left=NaN,this._top=NaN,this._right=NaN,this._bottom=NaN,this._left=0,this._top=0,this._right=0,this._bottom=0,e instanceof Ae.Rect?this.copy(e):this.set(e||0,t||0,s||0,i||0)}set(e,t,s,i){this._left=+e,this._top=+t,this._right=+s,this._bottom=+i}setWH(e,t,s,i){t=+t,this._left=e=+e,this._top=t,this._right=e+ +s,this._bottom=t+ +i}copy(e){this._left=+e._left,this._top=+e._top,this._right=+e._right,this._bottom=+e._bottom}clone(){return new Ae.Rect(this._left,this._top,this._right,this._bottom)}static Merge(e,t){const s=new Ae.Rect;return s.setLeft(Math.min(e._left,t._left)),s.setTop(Math.min(e._top,t._top)),s.setRight(Math.max(e._right,t._right)),s.setBottom(Math.max(e._bottom,t._bottom)),s}static FromObject(e){return new Ae.Rect(e.left,e.top,e.right,e.bottom)}equals(e){return this._left===e._left&&this._top===e._top&&this._right===e._right&&this._bottom===e._bottom}equalsWH(e,t,s,i){return this._left===e&&this._top===t&&this.width()===s&&this.height()===i}equalsF32Array(e,t){return e[t]===Math.fround(this._left)&&e[t+1]===Math.fround(this._top)&&e[t+2]===Math.fround(this._right)&&e[t+3]===Math.fround(this._bottom)}setLeft(e){this._left=+e}getLeft(){return this._left}setTop(e){this._top=+e}getTop(){return this._top}setRight(e){this._right=+e}getRight(){return this._right}setBottom(e){this._bottom=+e}getBottom(){return this._bottom}toArray(){return[this._left,this._top,this._right,this._bottom]}toTypedArray(){return new Float64Array(this.toArray())}toDOMRect(){return new DOMRect(this._left,this._top,this.width(),this.height())}static fromDOMRect(e){return Ae.New(Ae.Rect,e.left,e.top,e.right,e.bottom)}writeToTypedArray(e,t){e[t++]=this._left,e[t++]=this._top,e[t++]=this._right,e[t]=this._bottom}writeAsQuadToTypedArray(e,t){e[t++]=this._left,e[t++]=this._top,e[t++]=this._right,e[t++]=this._top,e[t++]=this._right,e[t++]=this._bottom,e[t++]=this._left,e[t]=this._bottom}writeAsQuadToTypedArray3D(e,t,s){e[t++]=this._left,e[t++]=this._top,e[t++]=s,e[t++]=this._right,e[t++]=this._top,e[t++]=s,e[t++]=this._right,e[t++]=this._bottom,e[t++]=s,e[t++]=this._left,e[t++]=this._bottom,e[t]=s}width(){return this._right-this._left}height(){return this._bottom-this._top}midX(){return(this._left+this._right)/2}midY(){return(this._top+this._bottom)/2}offset(e,t){t=+t,this._left+=e=+e,this._top+=t,this._right+=e,this._bottom+=t}offsetLeft(e){this._left+=+e}offsetTop(e){this._top+=+e}offsetRight(e){this._right+=+e}offsetBottom(e){this._bottom+=+e}toSquare(e){if(\"x\"!==e)throw new Error(\"invalid axis, only 'x' supported\");this._top<this._bottom?this._left<this._right?this._bottom=this._top+this.width():this._bottom=this._top-this.width():this._left<this._right?this._bottom=this._top-this.width():this._bottom=this._top+this.width()}inflate(e,t){t=+t,this._left-=e=+e,this._top-=t,this._right+=e,this._bottom+=t}deflate(e,t){t=+t,this._left+=e=+e,this._top+=t,this._right-=e,this._bottom-=t}multiply(e,t){this._left*=e,this._top*=t,this._right*=e,this._bottom*=t}divide(e,t){this._left/=e,this._top/=t,this._right/=e,this._bottom/=t}mirrorAround(e){this._left=+e-this._left,this._right=+e-this._right}flipAround(e){this._top=+e-this._top,this._bottom=+e-this._bottom}rotate90DegreesAround(e,t){const s=this.width(),i=this.height(),r=this.getLeft()+s*e,n=this.getTop()+i*t;this.setWH(r-i*t,n-s*e,i,s)}swapLeftRight(){const e=this._left;this._left=this._right,this._right=e}swapTopBottom(){const e=this._top;this._top=this._bottom,this._bottom=e}shuntY(e){const t=this._top;this._top=+e-this._bottom,this._bottom=+e-t}round(){this._left=Math.round(this._left),this._top=Math.round(this._top),this._right=Math.round(this._right),this._bottom=Math.round(this._bottom)}roundInner(){this._left=Math.ceil(this._left),this._top=Math.ceil(this._top),this._right=Math.floor(this._right),this._bottom=Math.floor(this._bottom)}roundOuter(){this._left=Math.floor(this._left),this._top=Math.floor(this._top),this._right=Math.ceil(this._right),this._bottom=Math.ceil(this._bottom)}floor(){this._left=Math.floor(this._left),this._top=Math.floor(this._top),this._right=Math.floor(this._right),this._bottom=Math.floor(this._bottom)}ceil(){this._left=Math.ceil(this._left),this._top=Math.ceil(this._top),this._right=Math.ceil(this._right),this._bottom=Math.ceil(this._bottom)}clamp(e,t,s,i){this._left=Math.max(this._left,+e),this._top=Math.max(this._top,+t),this._right=Math.min(this._right,+s),this._bottom=Math.min(this._bottom,+i)}clampBoth(e,t,s,i){e=+e,t=+t,s=+s,i=+i,this._left=Ae.clamp(this._left,e,s),this._top=Ae.clamp(this._top,t,i),this._right=Ae.clamp(this._right,e,s),this._bottom=Ae.clamp(this._bottom,t,i)}normalize(){this._left>this._right&&this.swapLeftRight(),this._top>this._bottom&&this.swapTopBottom()}intersectsRect(e){return!(e._right<this._left||e._bottom<this._top||e._left>this._right||e._top>this._bottom)}intersectsRectOffset(e,t,s){return!(e._right+t<this._left||e._bottom+s<this._top||e._left+t>this._right||e._top+s>this._bottom)}containsPoint(e,t){return e>=this._left&&e<=this._right&&t>=this._top&&t<=this._bottom}containsRect(e){return e._left>=this._left&&e._top>=this._top&&e._right<=this._right&&e._bottom<=this._bottom}expandToContain(e){e._left<this._left&&(this._left=+e._left),e._top<this._top&&(this._top=+e._top),e._right>this._right&&(this._right=+e._right),e._bottom>this._bottom&&(this._bottom=+e._bottom)}lerpInto(e){this._left=Ae.lerp(e._left,e._right,this._left),this._top=Ae.lerp(e._top,e._bottom,this._top),this._right=Ae.lerp(e._left,e._right,this._right),this._bottom=Ae.lerp(e._top,e._bottom,this._bottom)}}}{const Me=self.C3;Me.Quad=class{constructor(e,t,s,i,r,n,a,o){this._tlx=NaN,this._tly=NaN,this._trx=NaN,this._try=NaN,this._brx=NaN,this._bry=NaN,this._blx=NaN,this._bly=NaN,this._tlx=0,this._tly=0,this._trx=0,this._try=0,this._brx=0,this._bry=0,this._blx=0,this._bly=0,e instanceof Me.Quad?this.copy(e):this.set(e||0,t||0,s||0,i||0,r||0,n||0,a||0,o||0)}set(e,t,s,i,r,n,a,o){this._tlx=+e,this._tly=+t,this._trx=+s,this._try=+i,this._brx=+r,this._bry=+n,this._blx=+a,this._bly=+o}setRect(e,t,s,i){this.set(e,t,s,t,s,i,e,i)}copy(e){this._tlx=e._tlx,this._tly=e._tly,this._trx=e._trx,this._try=e._try,this._brx=e._brx,this._bry=e._bry,this._blx=e._blx,this._bly=e._bly}equals(e){return this._tlx===e._tlx&&this._tly===e._tly&&this._trx===e._trx&&this._try===e._try&&this._brx===e._brx&&this._bry===e._bry&&this._blx===e._blx&&this._bly===e._bly}setTlx(e){this._tlx=+e}getTlx(){return this._tlx}setTly(e){this._tly=+e}getTly(){return this._tly}setTrx(e){this._trx=+e}getTrx(){return this._trx}setTry(e){this._try=+e}getTry(){return this._try}setBrx(e){this._brx=+e}getBrx(){return this._brx}setBry(e){this._bry=+e}getBry(){return this._bry}setBlx(e){this._blx=+e}getBlx(){return this._blx}setBly(e){this._bly=+e}getBly(){return this._bly}toDOMQuad(){return new DOMQuad(new DOMPoint(this._tlx,this._tly),new DOMPoint(this._trx,this._try),new DOMPoint(this._brx,this._bry),new DOMPoint(this._blx,this._bly))}static fromDOMQuad(e){return Me.New(Me.Quad,e.p1.x,e.p1.y,e.p2.x,e.p2.y,e.p3.x,e.p3.y,e.p4.x,e.p4.y)}toArray(){return[this._tlx,this._tly,this._trx,this._try,this._brx,this._bry,this._blx,this._bly]}toTypedArray(){return new Float64Array(this.toArray())}writeToTypedArray(e,t){e[t++]=this._tlx,e[t++]=this._tly,e[t++]=this._trx,e[t++]=this._try,e[t++]=this._brx,e[t++]=this._bry,e[t++]=this._blx,e[t]=this._bly}writeToTypedArray3D(e,t,s){e[t++]=this._tlx,e[t++]=this._tly,e[t++]=s,e[t++]=this._trx,e[t++]=this._try,e[t++]=s,e[t++]=this._brx,e[t++]=this._bry,e[t++]=s,e[t++]=this._blx,e[t++]=this._bly,e[t]=s}offset(e,t){t=+t,this._tlx+=e=+e,this._tly+=t,this._trx+=e,this._try+=t,this._brx+=e,this._bry+=t,this._blx+=e,this._bly+=t}round(){this._tlx=Math.round(this._tlx),this._tly=Math.round(this._tly),this._trx=Math.round(this._trx),this._try=Math.round(this._try),this._brx=Math.round(this._brx),this._bry=Math.round(this._bry),this._blx=Math.round(this._blx),this._bly=Math.round(this._bly)}floor(){this._tlx=Math.floor(this._tlx),this._tly=Math.floor(this._tly),this._trx=Math.floor(this._trx),this._try=Math.floor(this._try),this._brx=Math.floor(this._brx),this._bry=Math.floor(this._bry),this._blx=Math.floor(this._blx),this._bly=Math.floor(this._bly)}ceil(){this._tlx=Math.ceil(this._tlx),this._tly=Math.ceil(this._tly),this._trx=Math.ceil(this._trx),this._try=Math.ceil(this._try),this._brx=Math.ceil(this._brx),this._bry=Math.ceil(this._bry),this._blx=Math.ceil(this._blx),this._bly=Math.ceil(this._bly)}setFromRect(e){this._tlx=e._left,this._tly=e._top,this._trx=e._right,this._try=e._top,this._brx=e._right,this._bry=e._bottom,this._blx=e._left,this._bly=e._bottom}setFromRotatedRect(e,t){0===t?this.setFromRect(e):this.setFromRotatedRectPrecalc(e,Math.sin(t),Math.cos(t))}setFromRotatedRectPrecalc(e,t,s){const i=e._left*t,r=e._top*t,n=e._right*t,a=e._bottom*t,o=e._left*s,h=e._top*s,l=e._right*s,c=e._bottom*s;this._tlx=o-r,this._tly=h+i,this._trx=l-r,this._try=h+n,this._brx=l-a,this._bry=c+n,this._blx=o-a,this._bly=c+i}getBoundingBox(e){e.set(Math.min(this._tlx,this._trx,this._brx,this._blx),Math.min(this._tly,this._try,this._bry,this._bly),Math.max(this._tlx,this._trx,this._brx,this._blx),Math.max(this._tly,this._try,this._bry,this._bly))}containsPoint(e,t){let s=this._trx-this._tlx,i=this._try-this._tly,r=this._brx-this._tlx,n=this._bry-this._tly,a=e-this._tlx,o=t-this._tly,h=s*s+i*i,l=s*r+i*n,c=s*a+i*o,u=r*r+n*n,_=r*a+n*o,d=1/(h*u-l*l),p=(u*c-l*_)*d,f=(h*_-l*c)*d;return 0<=p&&0<f&&p+f<1||(f=((h=(s=this._blx-this._tlx)*s+(i=this._bly-this._tly)*i)*_-(l=s*r+i*n)*(c=s*a+i*o))*(d=1/(h*u-l*l)),0<=(p=(u*c-l*_)*d)&&0<f&&p+f<1)}midX(){return(this._tlx+this._trx+this._brx+this._blx)/4}midY(){return(this._tly+this._try+this._bry+this._bly)/4}intersectsSegment(e,t,s,i){return!(!this.containsPoint(e,t)&&!this.containsPoint(s,i))||Me.segmentIntersectsQuad(e,t,s,i,this)}intersectsQuad(e){let t=e.midX(),s=e.midY();if(this.containsPoint(t,s))return!0;if(t=this.midX(),s=this.midY(),e.containsPoint(t,s))return!0;const i=this._tlx,r=this._tly,n=this._trx,a=this._try,o=this._brx,h=this._bry,l=this._blx,c=this._bly;return Me.segmentIntersectsQuad(i,r,n,a,e)||Me.segmentIntersectsQuad(n,a,o,h,e)||Me.segmentIntersectsQuad(o,h,l,c,e)||Me.segmentIntersectsQuad(l,c,i,r,e)}rotatePointsAnticlockwise(){const e=this._tlx,t=this._tly;this._tlx=this._trx,this._tly=this._try,this._trx=this._brx,this._try=this._bry,this._brx=this._blx,this._bry=this._bly,this._blx=e,this._bly=t}mirror(){this._swap(0,2),this._swap(1,3),this._swap(6,4),this._swap(7,5)}flip(){this._swap(0,6),this._swap(1,7),this._swap(2,4),this._swap(3,5)}diag(){this._swap(2,6),this._swap(3,7)}_swap(e,t){const s=this._getAtIndex(e);this._setAtIndex(e,this._getAtIndex(t)),this._setAtIndex(t,s)}_getAtIndex(e){switch(e){case 0:return this._tlx;case 1:return this._tly;case 2:return this._trx;case 3:return this._try;case 4:return this._brx;case 5:return this._bry;case 6:return this._blx;case 7:return this._bly;default:throw new RangeError(\"invalid quad point index\")}}_setAtIndex(e,t){switch(t=+t,e){case 0:this._tlx=t;break;case 1:this._tly=t;break;case 2:this._trx=t;break;case 3:this._try=t;break;case 4:this._brx=t;break;case 5:this._bry=t;break;case 6:this._blx=t;break;case 7:this._bly=t;break;default:throw new RangeError(\"invalid quad point index\")}}}}{const De=self.C3,Ee=[0,0,1,0,1,1,0,1],Fe=De.New(De.Quad);De.CollisionPoly=class extends De.DefendedBase{constructor(e,t=!0){super(),e=e||Ee,this._ptsArr=Float64Array.from(e),this._bbox=new De.Rect,this._isBboxChanged=!0,this._enabled=t}Release(){}pointsArr(){return this._ptsArr}pointCount(){return this._ptsArr.length/2}setPoints(e){this._ptsArr.length===e.length?this._ptsArr.set(e):this._ptsArr=Float64Array.from(e),this._isBboxChanged=!0}setDefaultPoints(){this.setPoints(Ee)}copy(e){this.setPoints(e._ptsArr)}setBboxChanged(){this._isBboxChanged=!0}_updateBbox(){if(this._isBboxChanged){let s=this._ptsArr,i=s[0],r=s[1],n=i,a=r;for(let e=0,t=s.length;e<t;e+=2){const o=s[e],h=s[e+1];o<i&&(i=o),o>n&&(n=o),h<r&&(r=h),h>a&&(a=h)}this._bbox.set(i,r,n,a),this._isBboxChanged=!1}}setFromRect(e,t,s){let i=this._ptsArr;8!==i.length&&(i=new Float64Array(8),this._ptsArr=i),i[0]=e.getLeft()-t,i[1]=e.getTop()-s,i[2]=e.getRight()-t,i[3]=e.getTop()-s,i[4]=e.getRight()-t,i[5]=e.getBottom()-s,i[6]=e.getLeft()-t,i[7]=e.getBottom()-s,this._bbox.copy(e),0===t&&0===s||this._bbox.offset(-t,-s),this._isBboxChanged=!1}setFromQuad(e,t,s){Fe.copy(e),Fe.offset(t,s),this.setPoints(Fe.toArray()),this._isBboxChanged=!0}transform(e,t,s){let i=0,r=1;0!==s&&(i=Math.sin(s),r=Math.cos(s)),this.transformPrecalc(e,t,i,r)}transformPrecalc(s,i,r,n){const a=this._ptsArr;for(let e=0,t=a.length;e<t;e+=2){const o=e+1,h=a[e]*s,l=a[o]*i;a[e]=h*n-l*r,a[o]=l*n+h*r}this._isBboxChanged=!0}offset(s,i){const r=this._ptsArr;for(let e=0,t=r.length;e<t;e+=2)r[e]+=s,r[e+1]+=i}containsPoint(s,i){const r=this._ptsArr;if(s===r[0]&&i===r[1])return!0;this._updateBbox();let e=this._bbox,n=e.getLeft()-110,a=e.getTop()-101,o=e.getRight()+131,h=e.getBottom()+120,l=0,c=0,u,_,d=0,p=0,f,m,g=(u=n<s?(l=n,s):(l=s,n),_=a<i?(c=a,i):(c=i,a),f=o<s?(d=o,s):(d=s,o),m=h<i?(p=h,i):(p=i,h),0),S=0;for(let e=0,t=r.length;e<t;e+=2){const y=(e+2)%t,G=r[e],I=r[e+1],T=r[y],C=r[1+y];De.segmentsIntersectPreCalc(n,a,s,i,l,u,c,_,G,I,T,C)&&++g,De.segmentsIntersectPreCalc(o,h,s,i,d,f,p,m,G,I,T,C)&&++S}return g%2==1||S%2==1}intersectsPoly(e,u,_){const d=e._ptsArr,p=this._ptsArr;if(this.containsPoint(d[0]+u,d[1]+_))return!0;if(e.containsPoint(p[0]-u,p[1]-_))return!0;for(let t=0,c=p.length;t<c;t+=2){let e=(t+2)%c,s=p[t],i=p[t+1],r=p[e],n=p[1+e],a=0,o=0,h,l;h=s<r?(a=s,r):(a=r,s),l=i<n?(o=i,n):(o=n,i);for(let e=0,t=d.length;e<t;e+=2){const f=(e+2)%t,m=d[e]+u,g=d[e+1]+_,S=d[f]+u,y=d[1+f]+_;if(De.segmentsIntersectPreCalc(s,i,r,n,a,h,o,l,m,g,S,y))return!0}}return!1}intersectsSegment(s,i,r,n,a,o){if(this.containsPoint(r-s,n-i))return!0;if(this.containsPoint(a-s,o-i))return!0;let h=0,l=0,c,u;c=r<a?(h=r,a):(h=a,r),u=n<o?(l=n,o):(l=o,n);const _=this._ptsArr;for(let e=0,t=_.length;e<t;e+=2){const d=(e+2)%t,p=_[e]+s,f=_[e+1]+i,m=_[d]+s,g=_[1+d]+i;if(De.segmentsIntersectPreCalc(r,n,a,o,h,c,l,u,p,f,m,g))return!0}return!1}mirror(s){const i=this._ptsArr;for(let e=0,t=i.length;e<t;e+=2)i[e]=2*s-i[e];this._isBboxChanged=!0}flip(s){const i=this._ptsArr;for(let e=0,t=i.length;e<t;e+=2){const r=e+1;i[r]=2*s-i[r]}this._isBboxChanged=!0}diag(){const s=this._ptsArr;for(let e=0,t=s.length;e<t;e+=2){const i=e+1,r=s[e];s[e]=s[i],s[i]=r}this._isBboxChanged=!0}GetMidX(){let s=this._ptsArr,i=0;for(let e=0,t=s.length;e<t;e+=2)i+=s[e];return i/this.pointCount()}GetMidY(){let s=this._ptsArr,i=0;for(let e=0,t=s.length;e<t;e+=2)i+=s[e+1];return i/this.pointCount()}GetPointsArray(){return this._ptsArr}GetPointCount(){return this.pointCount()}IsEnabled(){return this._enabled}}}{const Be=self.C3;Be.PairMap=class extends Be.DefendedBase{constructor(e){if(super(),this._firstMap=new Map,e)for(const[t,s,i]of e)this.Set(t,s,i)}Release(){this.Clear(),this._firstMap=null}IsEmpty(){return 0===this._firstMap.size}Clear(){const e=this._firstMap;for(const t of e.values())t.clear();e.clear()}Set(e,t,s){let i=this._firstMap,r=i.get(e);r||(r=new Map,i.set(e,r)),r.set(t,s)}Get(e,t){const s=this._firstMap.get(e);return s&&s.get(t)}Has(e,t){const s=this._firstMap.get(e);return!!s&&s.has(t)}Delete(e,t){const s=this._firstMap,i=s.get(e);if(!i)return!1;const r=i.delete(t);return r&&0===i.size&&s.delete(e),r}DeleteEither(e){const t=this._firstMap,s=t.get(e);s&&(s.clear(),t.delete(e));for(const[i,r]of t.entries())r.delete(e)&&0===r.size&&t.delete(i)}GetSize(){let e=0;for(const t of this._firstMap.values())e+=t.size;return e}*values(){for(const e of this._firstMap.values())yield*e.values()}*keyPairs(){for(const[e,t]of this._firstMap.entries())for(const s of t.keys())yield[e,s]}*entries(){for(const[e,t]of this._firstMap.entries())for(const[s,i]of t.entries())yield[e,s,i]}}}{const Oe=self.C3;Oe.ArraySet=class extends Oe.DefendedBase{constructor(){super(),this._set=new Set,this._arr=[],this._needToRebuildArray=!1}Release(){this.Clear()}Clear(){this._set.clear(),Oe.clearArray(this._arr),this._needToRebuildArray=!1}Add(e){this._set.has(e)||(this._set.add(e),this._needToRebuildArray)||this._arr.push(e)}Has(e){return this._set.has(e)}Delete(e){this._set.delete(e)&&(this._needToRebuildArray=!0)}GetSize(){return this._set.size}IsEmpty(){return 0===this._set.size}GetArray(){return this._needToRebuildArray&&(this._RebuildArray(),this._needToRebuildArray=!1),this._arr}_RebuildArray(){const e=this._arr;Oe.clearArray(e);for(const t of this._set)e.push(t)}}}{const Le=self.C3,ke=new Map,Ne=new Map,We=new Map,Ve=new Map,Ue=new Map,je=new Map,He=new Map,Xe=new Map,ze=new Map,Ye=(ze.set(\"linear\",\"noease\"),ze.set(\"default\",\"noease\"),[\"default\",\"noease\",\"easeinquad\",\"easeoutquad\",\"easeinoutquad\",\"easeincubic\",\"easeoutcubic\",\"easeinoutcubic\",\"easeinquart\",\"easeoutquart\",\"easeinoutquart\",\"easeinquint\",\"easeoutquint\",\"easeinoutquint\",\"easeinsine\",\"easeoutsine\",\"easeinoutsine\",\"easeinexpo\",\"easeoutexpo\",\"easeinoutexpo\",\"easeincirc\",\"easeoutcirc\",\"easeinoutcirc\",\"easeinelastic\",\"easeoutelastic\",\"easeinoutelastic\",\"easeinback\",\"easeoutback\",\"easeinoutback\",\"easeinbounce\",\"easeoutbounce\",\"easeinoutbounce\"]),qe=[\"default\",\"noease\",\"quad\",\"cubic\",\"quart\",\"quint\",\"sine\",\"expo\",\"circ\",\"elastic\",\"back\",\"bounce\"],Ke=new Map([[\"linear\",\"noease\"],[\"in-sine\",\"easeinsine\"],[\"out-sine\",\"easeoutsine\"],[\"in-out-sine\",\"easeinoutsine\"],[\"in-elastic\",\"easeinelastic\"],[\"out-elastic\",\"easeoutelastic\"],[\"in-out-elastic\",\"easeinoutelastic\"],[\"in-back\",\"easeinback\"],[\"out-back\",\"easeoutback\"],[\"in-out-back\",\"easeinoutback\"],[\"in-bounce\",\"easeinbounce\"],[\"out-bounce\",\"easeoutbounce\"],[\"in-out-bounce\",\"easeinoutbounce\"],[\"in-cubic\",\"easeincubic\"],[\"out-cubic\",\"easeoutcubic\"],[\"in-out-cubic\",\"easeinoutcubic\"],[\"in-quadratic\",\"easeinquad\"],[\"out-quadratic\",\"easeoutquad\"],[\"in-out-quadratic\",\"easeinoutquad\"],[\"in-quartic\",\"easeinquart\"],[\"out-quartic\",\"easeoutquart\"],[\"in-out-quartic\",\"easeinoutquart\"],[\"in-quintic\",\"easeinquint\"],[\"out-quintic\",\"easeoutquint\"],[\"in-out-quintic\",\"easeinoutquint\"],[\"in-circular\",\"easeincirc\"],[\"out-circular\",\"easeoutcirc\"],[\"in-out-circular\",\"easeinoutcirc\"],[\"in-exponential\",\"easeinexpo\"],[\"out-exponential\",\"easeoutexpo\"],[\"in-out-exponential\",\"easeinoutexpo\"]]),Je=(self.Ease=class rt{constructor(){}static InheritEase(){return\"default\"}static DefaultEase(){return\"noease\"}static ToInternal(e){return Ke.get(e)}static GetEditorEaseNames(t,...s){this._CreateEaseMap();let e,i=(t?(We.has(t)||We.set(t,new Map),[...(e=We.get(t)).keys()].filter(e=>!rt.GetEditorEaseData(e,t)||rt.GetEditorEaseData(e,t).transition.IsForAnyPurpose())):[...(e=Ue).keys()]).sort();return[...Ne.keys()].concat(i).filter(e=>!s.includes(e))}static GetRuntimeEaseNames(){this._CreateEaseMap();const e=[...Ue.keys()];return e.sort(),[...Ne.keys()].concat(e)}static GetCustomRuntimeEaseNames(){this._CreateEaseMap();const e=[...Ue.keys()];return e.sort(),e}static IsPredefinedTranslatedName(e){for(const t of Ye){const s=self.lang(\"ui.bars.timeline.eases.\"+t);if(s===e)return!0}for(const i of qe){const r=self.lang(\"ui.bars.timeline.short-eases.\"+i);if(r===e)return!0}}static IsNamePredefined(e){return this._CreateEaseMap(),[...Ne.keys()].includes(e)}static _GetEase(e){const t=ze.get(e);return t?ke.get(t):rt.IsNamePredefined(e)?ke.get(e):He.has(e)?He.get(e):void 0}static GetBuiltInTransition(e){return this._CreateEaseMap(),Xe.get(e)}static GetEditorEase(e,t){this._CreateEaseMap();const s=rt._GetEase(e);if(s)return s;if(t)return We.get(t).get(e);throw new Error(\"missing ease function\")}static GetEditorEaseData(e,t){this._CreateEaseMap();const s=Ve.get(t);if(s)return s.get(e)}static HasEditorEase(e,t){this._CreateEaseMap();const s=rt._GetEase(e);return!!s||!!We.get(t).get(e)}static GetRuntimeEase(e){this._CreateEaseMap();const t=rt._GetEase(e);return t||Ue.get(e)}static GetRuntimeEaseData(e){return this._CreateEaseMap(),je.get(e)}static GetEaseFromIndex(e){this._CreateEaseMap();const t=this.GetRuntimeEaseNames();return t[e]}static GetIndexForEase(e,t){this._CreateEaseMap();const s=this.GetEditorEaseNames(t);return s.indexOf(e)}static GetIndexForEaseAtRuntime(e){return this.GetIndexForEase(e)}static _CreateEaseMap(){0===ke.size&&(this._AddPredifinedEase(\"default\",()=>{}),this._AddPredifinedEase(\"noease\",[{x:0,y:0,sax:.336,say:0,eax:0,eay:0,se:!0,ee:!1},{x:1,y:1,sax:0,say:0,eax:-.336,eay:0,se:!1,ee:!0}],!0),this._AddPredifinedEase(\"easeinsine\",[{x:0,y:0,sax:.485,say:0,eax:0,eay:0,se:!0,ee:!1},{x:1,y:1,sax:0,say:0,eax:-.038,eay:0,se:!1,ee:!0}]),this._AddPredifinedEase(\"easeoutsine\",[{x:0,y:0,sax:.038,say:0,eax:0,eay:0,se:!0,ee:!1},{x:1,y:1,sax:0,say:0,eax:-.485,eay:0,se:!1,ee:!0}]),this._AddPredifinedEase(\"easeinoutsine\",[{x:0,y:0,sax:.336,say:0,eax:0,eay:0,se:!0,ee:!1},{x:1,y:1,sax:0,say:0,eax:-.336,eay:0,se:!1,ee:!0}]),this._AddPredifinedEase(\"easeinelastic\",[{x:0,y:0,sax:.018,say:0,eax:0,eay:0,se:!0,ee:!1},{x:.116,y:.002,sax:.025,say:0,eax:-.025,eay:0,se:!0,ee:!0},{x:.266,y:-.005,sax:.024,say:0,eax:-.021,eay:0,se:!0,ee:!0},{x:.416,y:.016,sax:.024,say:0,eax:-.026,eay:0,se:!0,ee:!0},{x:.566,y:-.045,sax:.061,say:0,eax:-.025,eay:0,se:!0,ee:!0},{x:.716,y:.132,sax:.072,say:-.004,eax:-.045,eay:0,se:!0,ee:!0},{x:.866,y:-.373,sax:.06,say:0,eax:-.049,eay:-.002,se:!0,ee:!0},{x:1,y:1,sax:0,say:0,eax:-.038,eay:-.263,se:!1,ee:!0}]),this._AddPredifinedEase(\"easeoutelastic\",[{x:0,y:0,sax:.038,say:.263,eax:0,eay:0,se:!0,ee:!1},{x:.136,y:1.373,sax:.049,say:.002,eax:-.06,eay:0,se:!0,ee:!0},{x:.286,y:.868,sax:.045,say:0,eax:-.072,eay:.004,se:!0,ee:!0},{x:.436,y:1.045,sax:.025,say:0,eax:-.061,eay:0,se:!0,ee:!0},{x:.586,y:.984,sax:.026,say:0,eax:-.024,eay:0,se:!0,ee:!0},{x:.736,y:1.005,sax:.021,say:0,eax:-.024,eay:0,se:!0,ee:!0},{x:.886,y:.998,sax:.025,say:0,eax:-.025,eay:0,se:!0,ee:!0},{x:1,y:1,sax:0,say:0,eax:-.018,eay:0,se:!1,ee:!0}]),this._AddPredifinedEase(\"easeinoutelastic\",[{x:0,y:0,sax:.025,say:0,eax:0,eay:0,se:!0,ee:!1},{x:.067,y:.001,sax:.025,say:0,eax:-.025,eay:0,se:!0,ee:!0},{x:.18,y:-.005,sax:.025,say:0,eax:-.025,eay:0,se:!0,ee:!0},{x:.292,y:.025,sax:.053,say:0,eax:-.025,eay:0,se:!0,ee:!0},{x:.405,y:-.118,sax:.069,say:0,eax:-.027,eay:0,se:!0,ee:!0},{x:.597,y:1.118,sax:.027,say:0,eax:-.069,eay:0,se:!0,ee:!0},{x:.71,y:.975,sax:.025,say:0,eax:-.053,eay:0,se:!0,ee:!0},{x:.822,y:1.005,sax:.025,say:0,eax:-.025,eay:0,se:!0,ee:!0},{x:.935,y:.999,sax:.025,say:0,eax:-.025,eay:0,se:!0,ee:!0},{x:1,y:1,sax:0,say:0,eax:-.025,eay:0,se:!1,ee:!0}]),this._AddPredifinedEase(\"easeinback\",[{x:0,y:0,sax:.35,say:0,eax:0,eay:0,se:!0,ee:!1},{x:1,y:1,sax:0,say:0,eax:-.34,eay:-1.579,se:!1,ee:!0}]),this._AddPredifinedEase(\"easeoutback\",[{x:0,y:0,sax:.34,say:1.579,eax:0,eay:0,se:!0,ee:!1},{x:1,y:1,sax:0,say:0,eax:-.35,eay:0,se:!1,ee:!0}]),this._AddPredifinedEase(\"easeinoutback\",[{x:0,y:0,sax:.035,say:0,eax:0,eay:0,se:!0,ee:!1},{x:.242,y:-.1,sax:.258,say:0,eax:-.025,eay:0,se:!0,ee:!0},{x:.76,y:1.1,sax:.025,say:0,eax:-.26,eay:0,se:!0,ee:!0},{x:1,y:1,sax:0,say:0,eax:-.035,eay:0,se:!1,ee:!0}]),this._AddPredifinedEase(\"easeinbounce\",[{x:0,y:0,sax:.033,say:.025,eax:0,eay:0,se:!0,ee:!1},{x:.092,y:0,sax:.026,say:.078,eax:-.033,eay:.025,se:!0,ee:!0},{x:.274,y:0,sax:.097,say:.319,eax:-.026,eay:.078,se:!0,ee:!0},{x:.637,y:0,sax:.105,say:.625,eax:-.097,eay:.319,se:!0,ee:!0},{x:1,y:1,sax:0,say:0,eax:-.125,eay:-.004,se:!1,ee:!0}]),this._AddPredifinedEase(\"easeoutbounce\",[{x:0,y:0,sax:.125,say:.004,eax:0,eay:0,se:!0,ee:!1},{x:.365,y:1,sax:.097,say:-.319,eax:-.105,eay:-.625,se:!0,ee:!0},{x:.728,y:1,sax:.026,say:-.078,eax:-.097,eay:-.319,se:!0,ee:!0},{x:.91,y:1,sax:.033,say:-.025,eax:-.026,eay:-.078,se:!0,ee:!0},{x:1,y:1,sax:0,say:0,eax:-.033,eay:-.025,se:!1,ee:!0}]),this._AddPredifinedEase(\"easeinoutbounce\",[{x:0,y:0,sax:.01,say:.006,eax:0,eay:0,se:!0,ee:!1},{x:.046,y:0,sax:.021,say:.038,eax:-.01,eay:.006,se:!0,ee:!0},{x:.137,y:0,sax:.059,say:.158,eax:-.021,eay:.038,se:!0,ee:!0},{x:.319,y:0,sax:.117,say:.744,eax:-.059,eay:.158,se:!0,ee:!0},{x:.683,y:1,sax:.059,say:-.158,eax:-.117,eay:-.744,se:!0,ee:!0},{x:.865,y:1,sax:.021,say:-.038,eax:-.059,eay:-.158,se:!0,ee:!0},{x:.956,y:1,sax:.01,say:-.006,eax:-.021,eay:-.038,se:!0,ee:!0},{x:1,y:1,sax:0,say:0,eax:-.01,eay:-.006,se:!1,ee:!0}]),this._AddPredifinedEase(\"easeincubic\",[{x:0,y:0,sax:.75,say:0,eax:0,eay:0,se:!0,ee:!1},{x:1,y:1,sax:0,say:0,eax:-.138,eay:-.321,se:!1,ee:!0}]),this._AddPredifinedEase(\"easeoutcubic\",[{x:0,y:0,sax:.138,say:.321,eax:0,eay:0,se:!0,ee:!1},{x:1,y:1,sax:0,say:0,eax:-.75,eay:0,se:!1,ee:!0}]),this._AddPredifinedEase(\"easeinoutcubic\",[{x:0,y:0,sax:.285,say:0,eax:0,eay:0,se:!0,ee:!1},{x:.5,y:.5,sax:.081,say:.272,eax:-.081,eay:-.272,se:!0,ee:!0},{x:1,y:1,sax:0,say:0,eax:-.285,eay:0,se:!1,ee:!0}]),this._AddPredifinedEase(\"easeinquad\",[{x:0,y:0,sax:.4,say:0,eax:0,eay:0,se:!0,ee:!1},{x:1,y:1,sax:0,say:0,eax:-.178,eay:-.392,se:!1,ee:!0}]),this._AddPredifinedEase(\"easeoutquad\",[{x:0,y:0,sax:.178,say:.392,eax:0,eay:0,se:!0,ee:!1},{x:1,y:1,sax:0,say:0,eax:-.4,eay:0,se:!1,ee:!0}]),this._AddPredifinedEase(\"easeinoutquad\",[{x:0,y:0,sax:.25,say:0,eax:0,eay:0,se:!0,ee:!1},{x:.5,y:.5,sax:.03,say:.065,eax:-.03,eay:-.065,se:!0,ee:!0},{x:1,y:1,sax:0,say:0,eax:-.25,eay:0,se:!1,ee:!0}]),this._AddPredifinedEase(\"easeinquart\",[{x:0,y:0,sax:.25,say:1,eax:0,eay:0,se:!0,ee:!1},{x:1,y:1,sax:0,say:0,eax:-.5,eay:0,se:!1,ee:!0}]),this._AddPredifinedEase(\"easeoutquart\",[{x:0,y:0,sax:.5,say:0,eax:0,eay:0,se:!0,ee:!1},{x:1,y:1,sax:0,say:0,eax:-.25,eay:-1,se:!1,ee:!0}]),this._AddPredifinedEase(\"easeinoutquart\",[{x:0,y:0,sax:.765,say:.03,eax:0,eay:0,se:!0,ee:!1},{x:1,y:1,sax:0,say:0,eax:-.765,eay:-.03,se:!1,ee:!0}]),this._AddPredifinedEase(\"easeinquint\",[{x:0,y:0,sax:.6,say:0,eax:0,eay:0,se:!0,ee:!1},{x:1,y:1,sax:0,say:0,eax:-.2,eay:-1,se:!1,ee:!0}]),this._AddPredifinedEase(\"easeoutquint\",[{x:0,y:0,sax:.2,say:1,eax:0,eay:0,se:!0,ee:!1},{x:1,y:1,sax:0,say:0,eax:-.6,eay:0,se:!1,ee:!0}]),this._AddPredifinedEase(\"easeinoutquint\",[{eax:0,eay:0,ee:!1,sax:.84,say:0,se:!0,x:0,y:0},{eax:-.84,eay:0,ee:!0,sax:0,say:0,se:!1,x:1,y:1}]),this._AddPredifinedEase(\"easeincirc\",[{x:0,y:0,sax:.25,say:0,eax:0,eay:0,se:!0,ee:!1},{x:1,y:1,sax:0,say:0,eax:-.024,eay:-.808,se:!1,ee:!0}]),this._AddPredifinedEase(\"easeoutcirc\",[{x:0,y:0,sax:.024,say:.808,eax:0,eay:0,se:!0,ee:!1},{x:1,y:1,sax:0,say:0,eax:-.25,eay:0,se:!1,ee:!0}]),this._AddPredifinedEase(\"easeinoutcirc\",[{x:0,y:0,sax:.125,say:0,eax:0,eay:0,se:!0,ee:!1},{x:.5,y:.5,sax:.02,say:.428,eax:-.02,eay:-.428,se:!0,ee:!0},{x:1,y:1,sax:0,say:0,eax:-.125,eay:0,se:!1,ee:!0}]),this._AddPredifinedEase(\"easeinexpo\",[{x:0,y:0,sax:.66,say:0,eax:0,eay:0,se:!0,ee:!1},{x:1,y:1,sax:0,say:0,eax:-.14,eay:-1,se:!1,ee:!0}]),this._AddPredifinedEase(\"easeoutexpo\",[{x:0,y:0,sax:.14,say:1,eax:0,eay:0,se:!0,ee:!1},{x:1,y:1,sax:0,say:0,eax:-.66,eay:0,se:!1,ee:!0}]),this._AddPredifinedEase(\"easeinoutexpo\",[{eax:0,eay:0,ee:!1,sax:.345,say:0,se:!0,x:0,y:0},{eax:-.06,eay:-.5,ee:!0,sax:.06,say:.5,se:!0,x:.5,y:.5},{eax:-.335,eay:0,ee:!0,sax:0,say:0,se:!1,x:1,y:1}]),this._AddPrivateCustomEase(\"cubicbezier\",this.EaseCubicBezier),this._AddPrivateCustomEase(\"spline\",this.EaseSpline))}static _AddPredifinedEase(e,t,s=!1){if(\"function\"==typeof t)rt._AddEase(e,t,\"predefined\");else{if(!Le.IsArray(t))throw new Error(\"unexpected arguments\");if(self.BuiltInTransition){const r=Le.New(self.BuiltInTransition,e,s);r.SetFromJson(t),rt._AddEase(e,(e,t,s,i)=>r.Interpolate(e,t,s,i),\"predefined\"),Xe.set(e,r)}else{const n=Le.New(Le.Transition,[e,t.map(e=>[e.x,e.y,e.sax,e.say,e.eax,e.eay,e.se,e.ee])],!1);n.MakeLinear(s),rt._AddEase(e,(e,t,s,i)=>n.Interpolate(e,t,s,i),\"predefined\")}}}static _AddPrivateCustomEase(e,t){rt._AddEase(e,t,\"private\")}static AddCustomEase(e,t,s,i){this._CreateEaseMap(),rt._AddEase(e,t,\"custom\",s,i)}static RemoveCustomEase(e,t){if(!this.IsNamePredefined(e)&&![...He.keys()].includes(e)){const s=We.get(t),i=(s&&s.delete(e),Ve.get(t));i&&i.delete(e)}}static _AddEase(e,t,s,i,r){switch(s){case\"predefined\":ke.set(e,t),Ne.set(e,t);break;case\"custom\":if(i){We.has(i)||We.set(i,new Map),Ve.has(i)||Ve.set(i,new Map);const n=We.get(i),a=(n.set(e,t),Ve.get(i));a.set(e,r)}else Ue.set(e,t),je.set(e,r);break;case\"private\":ke.set(e,t),He.set(e,t);break;default:throw new Error(\"unexpected ease mode\")}}static NoEase(e,t,s,i){return 0===i?t:s*e/i+t}static EaseCubicBezier(e,t,s,i,r){const n=t,a=3*e*(s-t),o=3*e**2*(t+i-2*s),h=e**3*(r-t+3*s-3*i);return n+a+o+h}static EaseSpline(e,t,s,i,r,n,a,o,h,l){if(i===r&&n===a)return e;const c=it(e,t,i,n,o,l),u=Qe(s,r,a,h),_=$e(s,r,a,h),d=et(s,r,a,h);return tt(c,u,_,d)}static GetBezierSamples(e,t,s,i){const r=[],n=Qe(e,t,s,i),a=$e(e,t,s,i),o=et(e,t,s,i);for(let e=0;e<Je;++e){const h=tt(e*Ze,n,a,o);r.push(h)}return r}},11),Ze=1/(Je-1),Qe=(e,t,s,i)=>i-3*s+3*t-e,$e=(e,t,s,i)=>3*s-6*t+3*e,et=(e,t,s,i)=>3*(t-e),tt=(e,t,s,i)=>((t*e+s)*e+i)*e,st=(e,t,s,i)=>3*t*e*e+2*s*e+i,it=(a,e,t,s,i,r)=>{if(1==a)return 1;let o=0,n=1,h=r[n],l=Je-1;for(Je;n!=l&&h<=a;)n++,h=r[n],o+=Ze;n--;let c=(a-(h=r[n]))/(r[n+1]-h),u=o+c*Ze,_=Qe(e,t,s,i),d=$e(e,t,s,i),p=et(e,t,s,i),f=st(u,_,d,p);if(0===f)return u;if(.01<=f){for(let e=0;e<4;++e){const m=tt(u,_,d,p)-a,g=st(u,_,d,p);u-=m/g}return u}{let t=o,s=o+Ze,i=0,r,n;do{u=t+(s-t)/2;let e=tt(u,_,d,p)-a;0<e?s=u:t=u,r=1e-7<Math.abs(e),n=++i<10}while(r&&n);return u}}}{let o=function(e){nt.IsString(e)};o;const nt=self.C3;nt.ProbabilityTable=class{constructor(e){this._items=[],this._name=e||\"\",this._totalWeight=0}Release(){this.Clear(),this._items=null}GetName(){return this._name}Clear(){nt.clear2DArray(this._items),this._totalWeight=0}GetTotalWeight(){return this._totalWeight}Sample(e=Math.random()*this.GetTotalWeight()){let t=0;for(const[s,i]of this._items)if(e<(t+=s))return i;return 0}AddItem(e,t){o(t),this._totalWeight+=e,this._items.push([e,t])}RemoveItem(t,s){o(s);const i=0===t;for(let e=0;e<this._items.length;e++){const r=this._items[e],n=i||r[0]===t,a=r[1]===s;if(n&&a){this._items.splice(e,1),this._totalWeight-=r[0];break}}}asJSON(){return JSON.stringify(this._items)}static fromJSON(e,t){const s=new nt.ProbabilityTable(t),i=JSON.parse(e);for(const r of i){const n=r[0],a=r[1];s.AddItem(n,a)}return s}}}{let e=self.C3,s=0;e.ScreenReaderText=class{constructor(e,t){this._runtime=e,this._text=t,this._id=s++,this._runtime.PostComponentMessageToDOM(\"runtime\",\"screen-reader-text\",{type:\"create\",id:this._id,text:this._text})}Release(){this._runtime.PostComponentMessageToDOM(\"runtime\",\"screen-reader-text\",{type:\"release\",id:this._id}),this._runtime=null,this._text=\"\",this._id=-1}SetText(e){this._text!==e&&(this._text=e,this._runtime.PostComponentMessageToDOM(\"runtime\",\"screen-reader-text\",{type:\"update\",id:this._id,text:this._text}))}}}{const at=self.C3;at.Event=class{constructor(e,t){this.type=e,this.cancelable=!!t,this.defaultPrevented=!1,this.propagationStopped=!1,this.isAsync=!1}preventDefault(){if(!this.cancelable)throw new Error(`event '${this.type}' is not cancelable`);this.defaultPrevented=!0}stopPropagation(){if(!this.cancelable)throw new Error(`event '${this.type}' cannot be stopped`);if(this.isAsync)throw new Error(`cannot stop async event '${this.type}' propagation`);this.propagationStopped=!0}}}{const ot=self.C3;ot.Event.Handler=class extends ot.DefendedBase{constructor(e){super(),this._type=e,this._captureListeners=[],this._captureListenersSet=new Set,this._listeners=[],this._listenersSet=new Set,this._fireDepth=0,this._queueModifyListeners=[]}Release(){0<this._fireDepth||(ot.clearArray(this._captureListeners),this._captureListenersSet.clear(),ot.clearArray(this._listeners),this._listenersSet.clear(),ot.clearArray(this._queueModifyListeners),ot.Release(this))}_AddListener(e,t){this._IsFiring()?this._queueModifyListeners.push({op:\"add\",func:e,capture:t}):t?this._captureListenersSet.has(e)||(this._captureListeners.push(e),this._captureListenersSet.add(e)):this._listenersSet.has(e)||(this._listeners.push(e),this._listenersSet.add(e))}_RemoveListener(e,t){this._IsFiring()?this._queueModifyListeners.push({op:\"remove\",func:e,capture:t}):t?this._captureListenersSet.has(e)&&(this._captureListenersSet.delete(e),ot.arrayFindRemove(this._captureListeners,e)):this._listenersSet.has(e)&&(this._listenersSet.delete(e),ot.arrayFindRemove(this._listeners,e))}_IsEmpty(){return!this._captureListeners.length&&!this._listeners.length}_IsFiring(){return 0<this._fireDepth}_ProcessQueuedListeners(){const e=new Set,t=new Set;for(const s of this._queueModifyListeners)if(\"add\"===s.op)this._AddListener(s.func,s.capture),(s.capture?t:e).delete(s.func);else{if(\"remove\"!==s.op)throw new Error(\"invalid op\");(s.capture?(this._captureListenersSet.delete(s.func),t):(this._listenersSet.delete(s.func),e)).add(s.func)}ot.arrayRemoveAllInSet(this._listeners,e),ot.arrayRemoveAllInSet(this._captureListeners,t),ot.clearArray(this._queueModifyListeners)}_FireCancellable(s){this._IncreaseFireDepth();let i=!1;for(let e=0,t=this._captureListeners.length;e<t;++e)if(this._captureListeners[e](s),s.propagationStopped){i=!0;break}if(!i)for(let e=0,t=this._listeners.length;e<t&&(this._listeners[e](s),!s.propagationStopped);++e);return this._DecreaseFireDepth(),!s.defaultPrevented}_FireNonCancellable(s){this._IncreaseFireDepth();for(let e=0,t=this._captureListeners.length;e<t;++e)this._captureListeners[e](s);for(let e=0,t=this._listeners.length;e<t;++e)this._listeners[e](s);return this._DecreaseFireDepth(),!0}_IncreaseFireDepth(){this._fireDepth++}_DecreaseFireDepth(){this._fireDepth--,0===this._fireDepth&&0<this._queueModifyListeners.length&&this._ProcessQueuedListeners()}SetDelayRemoveEventsEnabled(e){e?this._IncreaseFireDepth():this._DecreaseFireDepth()}_FireAsync(s){let i=[];for(let t=0,e=this._captureListeners.length;t<e;++t){let e=this._captureListeners[t];i.push(ot.Asyncify(()=>e(s)))}for(let t=0,e=this._listeners.length;t<e;++t){let e=this._listeners[t];i.push(ot.Asyncify(()=>e(s)))}return Promise.all(i).then(()=>!s.defaultPrevented)}_FireAndWait_AsyncOptional(s){const i=[];this._IncreaseFireDepth();for(let e=0,t=this._captureListeners.length;e<t;++e){const r=this._captureListeners[e](s);r instanceof Promise&&i.push(r)}for(let e=0,t=this._listeners.length;e<t;++e){const n=this._listeners[e](s);n instanceof Promise&&i.push(n)}return this._DecreaseFireDepth(),i.length?Promise.all(i).then(()=>!s.defaultPrevented):!s.defaultPrevented}async _FireAndWaitAsync(e){return this._FireAndWait_AsyncOptional(e)}async _FireAndWaitAsyncSequential(s){this._IncreaseFireDepth();for(let e=0,t=this._captureListeners.length;e<t;++e){const i=this._captureListeners[e](s);i instanceof Promise&&await i}for(let e=0,t=this._listeners.length;e<t;++e){const r=this._listeners[e](s);r instanceof Promise&&await r}return this._DecreaseFireDepth(),!s.defaultPrevented}*_FireAsGenerator(s){this._IncreaseFireDepth();for(let e=0,t=this._captureListeners.length;e<t;++e){const i=this._captureListeners[e](s);ot.IsIterator(i)&&(yield*i)}for(let e=0,t=this._listeners.length;e<t;++e){const r=this._listeners[e](s);ot.IsIterator(r)&&(yield*r)}this._DecreaseFireDepth()}}}{const ht=self.C3;ht.Event.Dispatcher=class extends ht.DefendedBase{constructor(){super(),this._eventHandlers=new Map,this._dispatcherWasReleased=!1}Release(){if(this._dispatcherWasReleased)throw new Error(\"already released\");this.ClearEvents(),this._dispatcherWasReleased=!0,ht.Release(this)}WasReleased(){return this._dispatcherWasReleased}ClearEvents(){if(this._eventHandlers){for(let e of this._eventHandlers.values())e.Release();this._eventHandlers.clear()}}_GetHandlerByType(e,t){let s=this._eventHandlers.get(e);return s||(t?(s=ht.New(ht.Event.Handler,e),this._eventHandlers.set(e,s),s):null)}HasAnyHandlerFor(e){return this._eventHandlers.has(e)}addEventListener(e,t,s){let i=this._GetHandlerByType(e,!0);i._AddListener(t,!!s)}removeEventListener(e,t,s){let i=this._GetHandlerByType(e,!1);i&&(i._RemoveListener(t,!!s),i._IsEmpty())&&this._eventHandlers.delete(e)}dispatchEvent(e){const t=this._GetHandlerByType(e.type,!1);return!t||(e.cancelable?t._FireCancellable(e):t._FireNonCancellable(e))}dispatchEventAsync(e){const t=this._GetHandlerByType(e.type,!1);return t?(e.isAsync=!0,t._FireAsync(e)):Promise.resolve(!0)}async dispatchEventAndClearAsync(e){const t=this._GetHandlerByType(e.type,!1);if(!t)return!0;this._eventHandlers.delete(e.type),e.isAsync=!0;const s=await t._FireAsync(e);return t.Release(),s}async dispatchEventAndWaitAsync(e){const t=this._GetHandlerByType(e.type,!1);return!t||t._FireAndWaitAsync(e)}dispatchEventAndWait_AsyncOptional(e){const t=this._GetHandlerByType(e.type,!1);return!t||t._FireAndWait_AsyncOptional(e)}async dispatchEventAndWaitAsyncSequential(e){const t=this._GetHandlerByType(e.type,!1);return!t||t._FireAndWaitAsyncSequential(e)}dispatchGeneratorEvent(e){const t=this._GetHandlerByType(e.type,!1);if(!t)return null;if(e.cancelable)throw new Error(\"not supported\");return t._FireAsGenerator(e)}SetDelayRemoveEventsEnabled(e){for(const t of this._eventHandlers.values())t.SetDelayRemoveEventsEnabled(e)}}}{let n=function(e){u=l&&0===_?requestIdleCallback(t,{timeout:s}):setTimeout(t,0<_?1:e)},t=function(r){if(u=-1,c.length){let s=performance.now(),i=s,e=0,t;for(;a(c.shift()),i=performance.now(),++e,t=(i-s)/e*1.1,c.length&&(l&&0===_&&void 0!==r?t<r.timeRemaining():i-s+t<o););if(-1===u&&c.length){let e=i-s,t=Math.max(h-e,4);n(t)}}},a=function(t){let e;try{e=t.func()}catch(e){return void t.reject(e)}t.resolve(e)},e=(n,t,a,self.C3),o=12,h=16,s=35,l=\"undefined\"!=typeof requestIdleCallback,c=[],u=-1,_=0,r=e.QueryString.Has(\"disable-asyncify\");r&&console.warn(\"[Asyncify] Asyncify has been disabled due to disable-asyncify in the query string. Some work will now be done synchronously.\"),e.Asyncify=function(s){let i=null;return e.isDebug&&(i=e.GetCallStack()),new Promise((e,t)=>{c.push({func:s,resolve:e,reject:t,stack:i}),r?a(c.pop()):-1===u&&n(h)})},e.Asyncify.SetHighThroughputMode=function(e){if(e)++_;else if(--_<0)throw new Error(\"already turned off high throughput mode\")}}{let e=function(){n=-1},t=function(){a=-1,o=-1;let s=Date.now();for(let t of h)if(t._CheckTimeout(s)){let e=t._GetDeadline();(-1===o||e<o)&&(o=e)}else h.delete(t);if(-1!==o){let e=Math.max(o-s+r,i);a=self.setTimeout(t,e)}},s=(e,t,self.C3),i=1e3,r=100,n=-1,a=(s.FastGetDateNow=function(){return-1===n&&(n=Date.now(),self.setTimeout(e,16)),n},-1),o=-1,h=new Set;s.IdleTimeout=class{constructor(e,t){this._callback=e,this._timeout=1e3*t,this._deadline=0,this._isActive=!1}Reset(){let e=s.FastGetDateNow();this._deadline=e+this._timeout,this._isActive||(h.add(this),this._isActive=!0),-1===a?(o=this._deadline,a=self.setTimeout(t,this._timeout+r)):this._deadline<o&&o>e+i&&(self.clearTimeout(a),o=this._deadline,a=self.setTimeout(t,this._timeout+r))}_CheckTimeout(e){return!(e>=this._deadline)||(this._callback()?(this._deadline=e+this._timeout,!0):this._isActive=!1)}_GetDeadline(){return this._deadline}Cancel(){this._isActive&&(h.delete(this),this._isActive=!1,0===h.size)&&-1!==a&&(self.clearTimeout(a),a=-1,o=-1)}Release(){this.Cancel(),this._callback=null}}}{const lt=self.C3;lt.Disposable=class ct{constructor(e){this._disposed=!1,this._disposeAction=e}Dispose(){this._disposed||(this._disposed=!0,this._disposeAction&&(this._disposeAction(),this._disposeAction=null))}IsDisposed(){return this._disposed}Release(){this.Dispose()}static Release(e){return new ct(()=>e.Release())}static From(t,s,i,r,e){if(null==r)r=!1;else if(\"boolean\"!=typeof r&&\"object\"!=typeof r)throw new TypeError(\"invalid event listener options\");if(e&&(i=i.bind(e)),s.includes(\" \")){s=s.split(\" \");const n=new lt.CompositeDisposable;for(let e of s)t.addEventListener(e,i,r),n.Add(lt.New(lt.Disposable,()=>t.removeEventListener(e,i,r)));return n}return t.addEventListener(s,i,r),lt.New(lt.Disposable,()=>t.removeEventListener(s,i,r))}},lt.StubDisposable=class extends lt.Disposable{SetAction(e){this._disposeAction=e}},lt.CompositeDisposable=class extends lt.Disposable{constructor(...t){super(),this._disposables=new Set;for(let e of t)this.Add(e)}Add(...t){if(this._disposed)throw new Error(\"already disposed\");for(let e of t)this._disposables.add(e)}Remove(e){if(this._disposed)throw new Error(\"already disposed\");this._disposables.delete(e)}RemoveAll(){if(this._disposed)throw new Error(\"already disposed\");if(this._disposables){for(let e of this._disposables)e.Dispose();this._disposables.clear()}}IsDisposed(){return this._disposed}Dispose(){if(this._disposed)throw new Error(\"already disposed\");this._disposed=!0;for(let e of this._disposables)e.Dispose();this._disposables.clear(),this._disposables=null}Release(){this.Dispose()}}}{const ut=self.C3;ut.KahanSum=class extends ut.DefendedBase{constructor(){super(),this._c=0,this._y=0,this._t=0,this._sum=0}Add(e){this._y=(e=+e)-this._c,this._t=this._sum+this._y,this._c=this._t-this._sum-this._y,this._sum=this._t}Subtract(e){this._sum-=+e}Get(){return this._sum}Reset(){this._c=0,this._y=0,this._t=0,this._sum=0}Set(e){this._c=0,this._y=0,this._t=0,this._sum=+e}Copy(e){this._c=e._c,this._y=e._y,this._t=e._t,this._sum=e._sum}Release(){}}}{const _t=self.C3,a={};a.RBnode=function(e){this.tree=e,this.right=this.tree.sentinel,this.left=this.tree.sentinel,this.parent=null,this.color=!1,this.key=null},a.RedBlackSet=function(e){this.size=0,this.sentinel=new a.RBnode(this),this.sentinel.color=!1,this.root=this.sentinel,this.root.parent=this.sentinel,this.compare=e||this.default_compare},a.RedBlackSet.prototype.default_compare=function(e,t){return e<t?-1:t<e?1:0},a.RedBlackSet.prototype.clone=function(){var e=new a.RedBlackSet(this.compare);return e.insertAll(this),e},a.RedBlackSet.prototype.clear=function(){this.size=0,this.sentinel=new a.RBnode(this),this.sentinel.color=!1,this.root=this.sentinel,this.root.parent=this.sentinel},a.RedBlackSet.prototype.leftRotate=function(e){var t=e.right;e.right=t.left,t.left!=this.sentinel&&(t.left.parent=e),t.parent=e.parent,e.parent==this.sentinel?this.root=t:e==e.parent.left?e.parent.left=t:e.parent.right=t,(t.left=e).parent=t},a.RedBlackSet.prototype.rightRotate=function(e){var t=e.left;e.left=t.right,t.right!=this.sentinel&&(t.right.parent=e),t.parent=e.parent,e.parent==this.sentinel?this.root=t:e==e.parent.right?e.parent.right=t:e.parent.left=t,(t.right=e).parent=t},a.RedBlackSet.prototype.insert=function(e){if(this.contains(e))this.get_(e).key=e;else{for(var t=new a.RBnode(this),s=(t.key=e,this.sentinel),i=this.root;i!=this.sentinel;)s=i,i=this.compare(t.key,i.key)<0?i.left:i.right;(t.parent=s)==this.sentinel?this.root=t:this.compare(t.key,s.key)<0?s.left=t:s.right=t,t.left=this.sentinel,t.right=this.sentinel,t.color=!0,this.insertFixup(t),this.size++}},a.RedBlackSet.prototype.insertFixup=function(e){for(;e!=this.sentinel&&e!=this.root&&1==e.parent.color;){var t;e.parent==e.parent.parent.left?1==(t=e.parent.parent.right).color?(e.parent.color=!1,t.color=!1,e.parent.parent.color=!0,e=e.parent.parent):(e==e.parent.right&&(e=e.parent,this.leftRotate(e)),e.parent.color=!1,e.parent.parent.color=!0,e.parent.parent!=this.sentinel&&this.rightRotate(e.parent.parent)):1==(t=e.parent.parent.left).color?(e.parent.color=!1,t.color=!1,e.parent.parent.color=!0,e=e.parent.parent):(e==e.parent.left&&(e=e.parent,this.rightRotate(e)),e.parent.color=!1,e.parent.parent.color=!0,e.parent.parent!=this.sentinel&&this.leftRotate(e.parent.parent))}this.root.color=!1},a.RedBlackSet.prototype.delete_=function(e){var t=e.left==this.sentinel||e.right==this.sentinel?e:this.successor_(e),s=t.left!=this.sentinel?t.left:t.right;s.parent=t.parent,t.parent==this.sentinel?this.root=s:t==t.parent.left?t.parent.left=s:t.parent.right=s,t!=e&&(e.key=t.key),0==t.color&&this.deleteFixup(s),this.size--},a.RedBlackSet.prototype.deleteFixup=function(e){for(;e!=this.root&&0==e.color;){var t;e=e==e.parent.left?(1==(t=e.parent.right).color&&(t.color=!1,e.parent.color=!0,this.leftRotate(e.parent),t=e.parent.right),0==t.left.color&&0==t.right.color?(t.color=!0,e.parent):(0==t.right.color&&(t.left.color=!1,t.color=!0,this.rightRotate(t),t=e.parent.right),t.color=e.parent.color,e.parent.color=!1,t.right.color=!1,this.leftRotate(e.parent),this.root)):(1==(t=e.parent.left).color&&(t.color=!1,e.parent.color=!0,this.rightRotate(e.parent),t=e.parent.left),0==t.right.color&&0==t.left.color?(t.color=!0,e.parent):(0==t.left.color&&(t.right.color=!1,t.color=!0,this.leftRotate(t),t=e.parent.left),t.color=e.parent.color,e.parent.color=!1,t.left.color=!1,this.rightRotate(e.parent),this.root))}e.color=!1},a.RedBlackSet.prototype.remove=function(e){var t;return(e=this.get_(e))!=this.sentinel?(t=e.key,this.delete_(e),t):null},a.RedBlackSet.prototype.removeSwapped=function(e,t){this.remove(t)},a.RedBlackSet.prototype.min=function(e){for(;e.left!=this.sentinel;)e=e.left;return e},a.RedBlackSet.prototype.max=function(e){for(;e.right!=this.sentinel;)e=e.right;return e},a.RedBlackSet.prototype.successor_=function(e){if(e.right!=this.sentinel)return this.min(e.right);for(var t=e.parent;t!=this.sentinel&&e==t.right;)t=(e=t).parent;return t},a.RedBlackSet.prototype.predeccessor_=function(e){if(e.left!=this.sentinel)return this.max(e.left);for(var t=e.parent;t!=this.sentinel&&e==t.left;)t=(e=t).parent;return t},a.RedBlackSet.prototype.successor=function(e){if(0<this.size){var t=this.get_(e);if(t==this.sentinel)return null;if(t.right!=this.sentinel)return this.min(t.right).key;for(var s=t.parent;s!=this.sentinel&&t==s.right;)s=(t=s).parent;return s!=this.sentinel?s.key:null}return null},a.RedBlackSet.prototype.predecessor=function(e){if(0<this.size){var t=this.get_(e);if(t==this.sentinel)return null;if(t.left!=this.sentinel)return this.max(t.left).key;for(var s=t.parent;s!=this.sentinel&&t==s.left;)s=(t=s).parent;return s!=this.sentinel?s.key:null}return null},a.RedBlackSet.prototype.getMin=function(){return this.min(this.root).key},a.RedBlackSet.prototype.getMax=function(){return this.max(this.root).key},a.RedBlackSet.prototype.get_=function(e){for(var t=this.root;t!=this.sentinel&&0!=this.compare(t.key,e);)t=this.compare(e,t.key)<0?t.left:t.right;return t},a.RedBlackSet.prototype.contains=function(e){return null!=this.get_(e).key},a.RedBlackSet.prototype.getValues=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},a.RedBlackSet.prototype.insertAll=function(e){if(\"array\"==a.typeOf(e))for(var t=0;t<e.length;t++)this.insert(e[t]);else if(\"function\"==a.typeOf(e.forEach))e.forEach(this.insert,this);else if(\"function\"==a.typeOf(e.getValues))for(var s=e.getValues(),t=0;t<s.length;t++)this.insert(s[t]);else if(\"object\"==a.typeOf(e))for(var i in e)this.insert(e[i])},a.RedBlackSet.prototype.removeAll=function(e){if(\"array\"==a.typeOf(e))for(var t=0;t<e.length;t++)this.remove(e[t]);else if(\"function\"==a.typeOf(e.forEach))e.forEach(this.removeSwapped,this);else if(\"function\"==a.typeOf(e.getValues))for(var s=e.getValues(),t=0;t<s.length;t++)this.remove(s[t]);else if(\"object\"==a.typeOf(e))for(var i in e)this.remove(e[i])},a.RedBlackSet.prototype.containsAll=function(e){if(\"array\"==a.typeOf(e)){for(var t=0;t<e.length;t++)if(!this.contains(e[t]))return!1;return!0}if(\"function\"==a.typeOf(e.forEach))return e.every(this.contains,this);if(\"function\"==a.typeOf(e.getValues)){for(var s=e.getValues(),t=0;t<s.length;t++)if(!this.contains(s[t]))return!1;return!0}if(\"object\"==a.typeOf(e)){for(var i in e)if(!this.contains(e[i]))return!1;return!0}},a.RedBlackSet.prototype.range=function(e,t){var s=[];return this.traverseFromTo(function(e){s.push(e)},e,t),s},a.RedBlackSet.prototype.traverse=function(e,t){if(!this.isEmpty())for(var s=this.min(this.root);s!=this.sentinel;){if(e.call(t,s.key,this))return;s=this.successor_(s)}},a.RedBlackSet.prototype.traverseFrom=function(e,t,s){if(!this.isEmpty())for(var i=this.get_(t);i!=this.sentinel;){if(e.call(s,i.key,this))return;i=this.successor_(i)}},a.RedBlackSet.prototype.traverseTo=function(e,t,s){if(!this.isEmpty())for(var i=this.min(this.root),r=this.get_(t);i!=r;){if(e.call(s,i.key,this))return;i=this.successor_(i)}},a.RedBlackSet.prototype.traverseFromTo=function(e,t,s,i){if(!this.isEmpty())for(var r=this.get_(t),n=this.get_(s);r!=n;){if(e.call(i,r.key,this))return;r=this.successor_(r)}},a.RedBlackSet.prototype.traverseBackwards=function(e,t){if(!this.isEmpty())for(var s=this.max(this.root);s!=this.sentinel;){if(e.call(t,s.key,this))return;s=this.predeccessor_(s)}},a.RedBlackSet.prototype.forEach=function(e,t){if(!this.isEmpty())for(var s=this.min(this.root);s!=this.sentinel;s=this.successor_(s))e.call(t,s.key,s.key,this)},a.RedBlackSet.prototype.some=function(e,t){if(!this.isEmpty())for(var s=this.min(this.root);s!=this.sentinel;s=this.successor_(s))if(e.call(t,s.key,s.key,this))return!0;return!1},a.RedBlackSet.prototype.every=function(e,t){if(this.isEmpty())return!1;for(var s=this.min(this.root);s!=this.sentinel;s=this.successor_(s))if(!e.call(t,s.key,s.key,this))return!1;return!0},a.RedBlackSet.prototype.map=function(e,t){var s=[];if(!this.isEmpty())for(var i=this.min(this.root);i!=this.sentinel;i=this.successor_(i))s.push(e.call(t,i.key,i.key,this));return s},a.RedBlackSet.prototype.filter=function(e,t){var s=[];if(!this.isEmpty())for(var i=this.min(this.root);i!=this.sentinel;i=this.successor_(i))e.call(t,i.key,i.key,this)&&s.push(i.key);return s},a.RedBlackSet.prototype.getCount=function(){return this.size},a.RedBlackSet.prototype.isEmpty=function(){return 0==this.size},a.RedBlackSet.prototype.isSubsetOf=function(e){var t=a.getCount(e);if(this.getCount()>t)return!1;var s=0;if(this.isEmpty())return!0;for(var i=this.min(this.root);i!=this.sentinel;i=this.successor_(i))a.contains.call(e,e,i.key)&&s++;return s==this.getCount()},a.RedBlackSet.prototype.intersection=function(e){var t=new a.RedBlackSet(this.compare);if(!this.isEmpty())for(var s=this.min(this.root);s!=this.sentinel;s=this.successor_(s))e.contains.call(e,s.key,s.key,this)&&t.insert(s.key);return t},_t.RedBlackSet=class extends _t.DefendedBase{constructor(e){super(),this._rbSet=new a.RedBlackSet(e),this._enableQueue=!1,this._queueInsert=new Set,this._queueRemove=new Set}Add(e){this._enableQueue?this._rbSet.contains(e)?this._queueRemove.delete(e):this._queueInsert.add(e):this._rbSet.insert(e)}Remove(e){this._enableQueue?this._rbSet.contains(e)?this._queueRemove.add(e):this._queueInsert.delete(e):this._rbSet.remove(e)}Has(e){return this._enableQueue?!!this._queueInsert.has(e)||!this._queueRemove.has(e)&&this._rbSet.contains(e):this._rbSet.contains(e)}Clear(){this._rbSet.clear(),this._queueInsert.clear(),this._queueRemove.clear()}toArray(){if(this._enableQueue)throw new Error(\"cannot be used in queueing mode\");return this._rbSet.getValues()}GetSize(){return this._rbSet.getCount()+this._queueInsert.size-this._queueRemove.size}IsEmpty(){return 0===this.GetSize()}Front(){if(this.IsEmpty())throw new Error(\"empty set\");if(this._enableQueue)throw new Error(\"cannot be used in queueing mode\");const e=this._rbSet,t=e.min(e.root);return t.key}Shift(){if(this.IsEmpty())throw new Error(\"empty set\");if(this._enableQueue)throw new Error(\"cannot be used in queueing mode\");const e=this.Front();return this.Remove(e),e}SetQueueingEnabled(e){if(this._enableQueue!==(e=!!e)&&!(this._enableQueue=e)){for(const t of this._queueRemove)this._rbSet.remove(t);this._queueRemove.clear();for(const s of this._queueInsert)this._rbSet.insert(s);this._queueInsert.clear()}}ForEach(e){this._rbSet.forEach(e)}*values(){if(!this.IsEmpty()){const t=this._rbSet;for(let e=t.min(t.root);e!=t.sentinel;e=t.successor_(e))yield e.key}}[Symbol.iterator](){return this.values()}}}{const dt=self.C3;dt.PromiseThrottle=class{constructor(e=dt.hardwareConcurrency){this._maxParallel=e,this._queue=[],this._activeCount=0}Add(s){return new Promise((e,t)=>{this._queue.push({func:s,resolve:e,reject:t}),this._MaybeStartNext()})}_FindInQueue(s){for(let e=0,t=this._queue.length;e<t;++e)if(this._queue[e].func===s)return e;return-1}RemoveAndResolve(e,t){const s=this._FindInQueue(e);if(-1===s)throw new Error(\"cannot find promise to resolve\");this._queue[s].resolve(t),this._queue.splice(s,1)}RemoveAndReject(e,t){const s=this._FindInQueue(e);if(-1===s)throw new Error(\"cannot find promise to reject\");this._queue[s].reject(t),this._queue.splice(s,1)}async _MaybeStartNext(){if(this._queue.length&&!(this._activeCount>=this._maxParallel)){this._activeCount++;const t=this._queue.shift();try{const e=await t.func();t.resolve(e)}catch(e){t.reject(e)}this._activeCount--,this._MaybeStartNext()}}static async Batch(e,t){let s=[],i=!1,r=[];for(;e--;)r.push((async()=>{let e;for(;e=t.pop();){if(i)return;try{s.push(await e())}catch(e){throw i=!0,e}}})());return await Promise.all(r),s}}}{const pt=self.C3;pt.RateLimiter=class{constructor(e,t,s){this._callback=e,this._interval=t,this._intervalOnBattery=s||2*t,this._timerId=-1,this._lastCallTime=-1/0,this._timerCallFunc=()=>this._OnTimer(),this._ignoreReset=!1,this._canRunImmediate=!1,this._callbackArguments=null}SetCanRunImmediate(e){this._canRunImmediate=!!e}_GetInterval(){return void 0!==pt.Battery&&pt.Battery.IsOnBatteryPower()?this._intervalOnBattery:this._interval}Call(...i){if(-1===this._timerId){this._callbackArguments=i;let e=pt.FastGetDateNow(),t=e-this._lastCallTime,s=this._GetInterval();s<=t&&this._canRunImmediate?(this._lastCallTime=e,this._RunCallback()):this._timerId=self.setTimeout(this._timerCallFunc,Math.max(s-t,4))}}_RunCallback(){this._ignoreReset=!0;const e=this._callbackArguments;this._callbackArguments=null,e?this._callback(...e):this._callback(),this._ignoreReset=!1}Reset(){this._ignoreReset||(this._CancelTimer(),this._callbackArguments=null,this._lastCallTime=pt.FastGetDateNow())}_OnTimer(){this._timerId=-1,this._lastCallTime=pt.FastGetDateNow(),this._RunCallback()}_CancelTimer(){-1!==this._timerId&&(self.clearTimeout(this._timerId),this._timerId=-1)}Release(){this._CancelTimer(),this._callback=null,this._callbackArguments=null,this._timerCallFunc=null}}}{const ft=self.C3;ft.SVGRasterManager=class{constructor(){this._images=new Map,this._allowNpotSurfaces=!1,this._getBaseSizeCallback=null,this._rasterAtSizeCallback=null,this._releaseResultCallback=null,this._redrawCallback=null}SetNpotSurfaceAllowed(e){this._allowNpotSurfaces=!!e}IsNpotSurfaceAllowed(){return this._allowNpotSurfaces}SetGetBaseSizeCallback(e){this._getBaseSizeCallback=e}GetBaseSize(e){if(this._getBaseSizeCallback)return this._getBaseSizeCallback(e);throw new Error(\"no get base size callback set\")}SetRasterAtSizeCallback(e){this._rasterAtSizeCallback=e}RasterAtSize(e,t,s,i,r,n){if(this._rasterAtSizeCallback)return this._rasterAtSizeCallback(e,t,s,i,r,n);throw new Error(\"no raster at size callback set\")}SetReleaseResultCallback(e){this._releaseResultCallback=e}ReleaseResult(e){if(!this._releaseResultCallback)throw new Error(\"no release result callback set\");this._releaseResultCallback(e)}SetRedrawCallback(e){this._redrawCallback=e}Redraw(){if(!this._redrawCallback)throw new Error(\"no redraw callback set\");this._redrawCallback()}AddImage(e){let t=this._images.get(e);return t||(t=ft.New(ft.SVGRasterImage,this,e),this._images.set(e,t)),t.IncReference(),t}_RemoveImage(e){this._images.delete(e.GetDataSource())}OnTexturesChanged(){for(const e of this._images.values())e.ReleaseRasterizedResult(),e.ForceRasterAgain()}}}{const mt=self.C3;mt.SVGRasterImage=class{constructor(e,t){this._manager=e,this._dataSource=t,this._refCount=0,this._baseWidth=0,this._baseHeight=0,this._getBaseSizePromise=this._manager.GetBaseSize(t).then(e=>{this._manager&&(this._baseWidth=e[0],this._baseHeight=e[1],this._manager.Redraw())}).catch(e=>{console.error(\"[SVG] Error loading SVG: \",e),this._hadError=!0,this._manager&&this._manager.Redraw()}),this._rasterSurfaceWidth=0,this._rasterSurfaceHeight=0,this._rasterImageWidth=0,this._rasterImageHeight=0,this._isRasterizing=!1,this._rasterizedResult=null,this._forceRaster=!1,this._hadError=!1}Release(){if(this._refCount<=0)throw new Error(\"already released\");this._refCount--,0===this._refCount&&this._Release()}ReleaseRasterizedResult(){this._rasterizedResult&&(this._manager.ReleaseResult(this._rasterizedResult),this._rasterizedResult=null)}_Release(){this.ReleaseRasterizedResult(),this._manager._RemoveImage(this),this._manager=null}GetDataSource(){return this._dataSource}IncReference(){this._refCount++}HasReferences(){return 0<this._refCount}GetRasterizedResult(){return this._rasterizedResult}ForceRasterAgain(){this._forceRaster=!0}async StartRasterForSize(i,r,n){if(0!==r&&0!==n&&!this._hadError&&!this._isRasterizing){let e=mt.nextHighestPowerOfTwo(Math.ceil(r)),t=mt.nextHighestPowerOfTwo(Math.ceil(n)),s=Math.max(e,t);if(4096<s){const a=4096/s;r*=a,n*=a,e=Math.min(Math.ceil(e*a),4096),t=Math.min(Math.ceil(t*a),4096)}if(r<e&&n<t){const o=r/n,h=e/t;n=o<h?(r=t*o,t):(r=e)/o}if(this._manager.IsNpotSurfaceAllowed()&&(e=Math.ceil(r),t=Math.ceil(n)),!(e<=this._rasterSurfaceWidth&&t<=this._rasterSurfaceHeight)||this._forceRaster){this._isRasterizing=!0,this._rasterSurfaceWidth=e,this._rasterSurfaceHeight=t;const l=await this._manager.RasterAtSize(this._dataSource,i,this._rasterSurfaceWidth,this._rasterSurfaceHeight,r,n);this._manager&&(this.ReleaseRasterizedResult(),this._rasterizedResult=l,this._rasterImageWidth=r,this._rasterImageHeight=n,this._isRasterizing=!1,this._forceRaster=!1,this._manager.Redraw())}}}WhenBaseSizeReady(){return this._getBaseSizePromise}GetBaseWidth(){return this._baseWidth}GetBaseHeight(){return this._baseHeight}GetRasterWidth(){return this._rasterImageWidth}GetRasterHeight(){return this._rasterImageHeight}HadError(){return this._hadError}}}{let t=function(e){return Gt.get(e)};t;const u=self.C3,gt=(u.UTF8_BOM=\"\\ufeff\",new Set(\"0123456789\")),St=(u.IsNumericChar=function(e){return gt.has(e)},new Set(\" \\t\\n\\r            ​\\u2028\\u2029  　\"));u.IsWhitespaceChar=function(e){return St.has(e)},u.FilterWhitespace=function(e){return[...e].filter(e=>!u.IsWhitespaceChar(e)).join(\"\")},u.IsStringAllWhitespace=function(e){for(const t of e)if(!u.IsWhitespaceChar(t))return!1;return!0},u.IsCharArrayAllWhitespace=function(e){for(const t of e)if(!u.IsWhitespaceChar(t))return!1;return!0},u.IsUnprintableChar=function(e){return 1===e.length&&e.charCodeAt(0)<32},u.FilterUnprintableChars=function(e){return[...e].filter(e=>!u.IsUnprintableChar(e)).join(\"\")};let s=null;try{s=new RegExp(\"\\\\p{P}(?<=[\\\\u3000-\\\\u303F\\\\uFF00-\\\\uFFEF])\",\"u\")}catch(e){console.warn(\"Unable to detect CJK punctuation: \",e)}u.IsCJKPunctuationChar=function(e){return!u.IsWhitespaceChar(e)&&s&&s.test(e)};const yt=new Set(\"0123456789.+-e\"),Gt=(u.IsStringNumber=function(t){if(!(t=t.trim()).length)return!1;let e=t.charAt(0);if(\"-\"!==e&&!gt.has(e))return!1;for(let e of t)if(!yt.has(e))return!1;return!0},u.RemoveTrailingDigits=function(t){let s=t.length;for(;0<s;){let e=t.charAt(s-1);if(!u.IsNumericChar(e))break;--s}return t.substr(0,s)},u.IncrementNumberAtEndOf=function(e){let t=u.RemoveTrailingDigits(e),s=e.substr(t.length);return t+(s?(parseInt(s,10)+1).toString():\"2\")},new Map([[\"&\",\"&amp;\"],[\"<\",\"&lt;\"],[\">\",\"&gt;\"],['\"',\"&quot;\"],[\"'\",\"&#39;\"]])),It=/[&<>\"']/g,Tt=(u.EscapeHTML=function(e){return e.replace(It,t)},u.EscapeJS=function(e){let t=u.ReplaceAll(e,\"\\\\\",\"\\\\\\\\\");return t=u.ReplaceAll(t,'\"','\\\\\"'),t=u.ReplaceAll(t,\"\\t\",\"\\\\t\"),t=u.ReplaceAll(t,\"\\r\",\"\"),u.ReplaceAll(t,\"\\n\",\"\\\\n\")},u.EscapeXML=function(e){let t=u.ReplaceAll(e,\"&\",\"&amp;\");return t=u.ReplaceAll(t,\"<\",\"&lt;\"),t=u.ReplaceAll(t,\">\",\"&gt;\"),u.ReplaceAll(t,'\"',\"&quot;\")},/[-[\\]{}()*+?.,\\\\^$|#\\s]/g),Ct=(u.EscapeRegex=function(e){return e.replace(Tt,\"\\\\$&\")},u.CountCharsInString=function(e,t){let s=0;for(const i of e)i===t&&++s;return s},u.FindAll=function(e,t,s=!1){if(!t)return[];s||(e=e.toLowerCase(),t=t.toLowerCase());let i=t.length,r=0,n,a=[];for(;-1<(n=e.indexOf(t,r));)a.push(n),r=n+i;return a},u.ReplaceAll=function(e,t,s){return e.replaceAll(t,()=>s)},u.ReplaceAllCaseInsensitive=function(e,t,s){return e.replace(new RegExp(u.EscapeRegex(t),\"gi\"),()=>s)},u.SetElementContent=function(e,t){\"string\"==typeof t?e.textContent=t:t.isPlainText()?e.textContent=t.toString():(e.innerHTML=t.toHTML(),t instanceof u.BBString&&t.attachLinkHandlers(e))},u.StringLikeEquals=function(e,t){return e instanceof u.HtmlString||e instanceof u.BBString?e.equals(t):t instanceof u.HtmlString||t instanceof u.BBString?t.equals(e):e===t},u.StringSubstitute=function(s,...i){let r=s;for(let e=0,t=i.length;e<t;++e){const n=`{${e}}`;if(!s.includes(n))throw new Error(`missing placeholder '${n}' in string substitution`);r=r.replace(n,i[e].toString())}return r},u.StringSubstituteAllowMissing=function(s,...i){let r=s,n=-1,a=-1;for(let e=0,t=i.length;e<t;++e){const o=`{${e}}`;s.includes(o)?(a=e,r=r.replace(o,i[e].toString())):-1===n&&(n=e)}if(0<=n&&0<=a&&n<a)throw new Error(`missing placeholder '${n}' in string substitution`);return r},u.StringSubstituteMap=function(e,s){let i=e;for(let[e,t]of Object.entries(s))i=i.replaceAll(e,t.toString());return i},u.SortAZ=function(e,t){return t<e?1:e<t?-1:0},u.SortAZCaseInsensitive=function(e,t){let s=e.toLowerCase(),i=t.toLowerCase();return i<s?1:s<i?-1:0},new self.Intl.Segmenter),bt=(u.SplitGraphemes=function(e){const t=[];for(const s of Ct.segment(e))t.push(s.segment);return t},u.IterateGraphemes=function*(e){for(const t of Ct.segment(e))yield t.segment},u.CountGraphemes=function(e){let t=0;for(const s of Ct.segment(e))++t;return t},1073741824),wt=1024*bt,xt={approximate:!(u.FormatDataSize=function(t,e){let s=\"common.\"+(e?\"dataRates\":\"dataSizes\")+\".\",i=self.langSub;if(t<1024)return i(s+\"bytes\",t);if(t<1048576){let e=t/1024;return e=e<10?Math.round(10*e)/10:Math.round(e),i(s+\"kilobytes\",e)}if(t<bt){let e=t/1048576;return e=e<10?Math.round(10*e)/10:Math.round(e),i(s+\"megabytes\",e)}if(t<wt){let e=t/bt;return e=e<10?Math.round(10*e)/10:Math.round(e),i(s+\"gigabytes\",e)}{let e=t/wt;return e=e<10?Math.round(10*e)/10:Math.round(e),i(s+\"terabytes\",e)}}),days:!0,hours:!0,minutes:!0,seconds:!0};u.FormatTime=function(e,t){t=Object.assign({},xt,t),u.Lang.PushContext(\"common.time\");const s=[],i=self.lang,r=self.langPluralSub;if(t.days){const a=Math.floor(e/86400);0<a&&(e-=24*a*3600,s.push(r(\".days\",null,a)))}if(t.hours){const o=Math.floor(e/3600);(0<o||s.length)&&(e-=3600*o,s.push(r(\".hours\",null,o)))}if(t.minutes){const h=Math.floor(e/60);(0<h||s.length||!t.seconds)&&(e-=60*h,s.push(r(\".minutes\",null,h)))}if(t.seconds){const l=Math.floor(e%60);s.push(r(\".seconds\",null,l))}const n=(t.approximate?i(\".approx-prefix\"):\"\")+s.join(i(\".separator\"));return u.Lang.PopContext(),n},u.ZeroPad=function(e,t){let s=e<0?\"-\":\"\",i=(e=Math.abs(e)).toString(),r=t-i.length;for(let e=0;e<r;++e)s+=\"0\";return s+i},u.StringToTitleCase=function(e){return e.toLowerCase().replace(/\\b\\w/g,e=>e.toUpperCase())},u.CompareVersionStrings=function(e,t){let s=e.split(\".\").map(e=>e.trim()),i=t.split(\".\").map(e=>e.trim());u.resizeArray(s,4,\"0\"),u.resizeArray(i,4,\"0\"),s=s.map(e=>parseInt(e,10)),i=i.map(e=>parseInt(e,10));for(let e=0;e<4;++e){const r=s[e]-i[e];if(0!=r)return r<0?-1:1}return 0},u.CreateGUID=function(){return\"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g,e=>{const t=Math.floor(16*Math.random()),s=\"x\"===e?t:3&t|8;return s.toString(16)})},u.StringHammingDistance=function(s,i){if(s.length!==i.length)throw new Error(\"strings must be same length\");let r=0;for(let e=0,t=s.length;e<t;++e)s.charAt(e)!==i.charAt(e)&&++r;return r},u.StringLevenshteinDistance=function(e,t){if(0===e.length)return t.length;if(0===t.length)return e.length;let s,i,r,n,a,o;for(t.length<e.length&&(s=e,e=t,t=s),o=Array(e.length+1),i=0;i<=e.length;i++)o[i]=i;for(i=1;i<=t.length;i++){for(n=i,r=1;r<=e.length;r++)a=t[i-1]===e[r-1]?o[r-1]:Math.min(o[r-1]+1,Math.min(n+1,o[r]+1)),o[r-1]=n,n=a;o[e.length]=n}return o[e.length]}}{let t=function(e,s,i){const r=o.get(i);if(!r)return\"class\"===i?s?\"</span>\":`<span class=\"bbclass${c++}\">`:e;if(\"string\"==typeof r){if(\"a\"===r&&0===h.length||\"abbr\"===r&&0===l.length)return e;if(\"a\"!==r||s){if(\"abbr\"!==r||s)return\"<\"+s+r+\">\";{const n=parseInt(i.substring(3),10)-1;if(n<0||n>=l.length)throw new Error(\"invalid bbcode tip substitution\");let e=l[n],t=\"\";if(\"string\"==typeof e?t=e:\"function\"==typeof e&&(t=e()),\"string\"!=typeof t)throw new TypeError(\"invalid bbcode tip\");return`<abbr title=\"${_.ReplaceAll(t,'\"',\"&quot;\")}\">`}}{const t=parseInt(i.substring(1),10)-1;if(t<0||t>=h.length)throw new Error(\"invalid bbcode link substitution\");const a=h[t];if(\"string\"==typeof a)return`<a href=\"${h[t]}\">`;if(\"function\"==typeof a)return`<a class=\"bblink${t}\">`;throw new TypeError(\"invalid bbcode link action\")}}if(Array.isArray(r)){let e=r[0],t=r[1];return s?\"</\"+e+\">\":`<${e} class=\"${t}\">`}},_=(t,self.C3),o=new Map([[\"b\",\"strong\"],[\"i\",\"em\"],[\"s\",\"s\"],[\"u\",\"u\"],[\"sub\",\"sub\"],[\"sup\",\"sup\"],[\"small\",\"small\"],[\"mark\",\"mark\"],[\"code\",\"code\"],[\"a1\",\"a\"],[\"a2\",\"a\"],[\"a3\",\"a\"],[\"a4\",\"a\"],[\"a5\",\"a\"],[\"a6\",\"a\"],[\"a7\",\"a\"],[\"a8\",\"a\"],[\"a9\",\"a\"],[\"tip1\",\"abbr\"],[\"tip2\",\"abbr\"],[\"tip3\",\"abbr\"],[\"tip4\",\"abbr\"],[\"tip5\",\"abbr\"],[\"tip6\",\"abbr\"],[\"tip7\",\"abbr\"],[\"tip8\",\"abbr\"],[\"tip9\",\"abbr\"],[\"bad\",[\"span\",\"bbCodeBad\"]],[\"good\",[\"span\",\"bbCodeGood\"]],[\"info\",[\"span\",\"bbCodeInfo\"]],[\"h1\",[\"span\",\"bbCodeH1\"]],[\"h2\",[\"span\",\"bbCodeH2\"]],[\"h3\",[\"span\",\"bbCodeH3\"]],[\"h4\",[\"span\",\"bbCodeH4\"]],[\"item\",[\"span\",\"bbCodeItem\"]]]),d=new Set([\"icon\"]),s=/\\[(\\/?)([a-zA-Z0-9]+)\\]/g,p=/\\[(\\/?)([^\\[\\n]*?)\\]/g,h=null,l=null,c=0,i=/\\n/g;_.BBString=class{constructor(e,t){if(this._bbstr=t&&t.noEscape?e:_.EscapeHTML(e),this._htmlstr=\"\",this._convertLineBreaks=!1,this._linkActions=[],this._tipList=[],t){if(this._convertLineBreaks=!!t.convertLineBreaks,t.links){if(9<t.links.length)throw new Error(\"too many links\");this._linkActions=t.links}if(t.tips){if(9<t.tips.length)throw new Error(\"too many tips\");this._tipList=t.tips}}this._hasAnyBBtags=this._bbstr.includes(\"[\"),this._needsLineBreakConversion=this._convertLineBreaks&&this._bbstr.includes(\"\\n\"),this._isPlain=!this._hasAnyBBtags&&!this._needsLineBreakConversion&&!this._bbstr.includes(\"&\"),this._hasParsedFragments=!1,this._fragments=[]}toString(){return this._bbstr}valueOf(){return this._bbstr}isPlainText(){return this._isPlain}toPlainText(){return this._hasAnyBBtags?this._bbstr.replace(s,\"\"):this._bbstr}toHTML(){if(this._isPlain)return this._bbstr;if(!this._htmlstr&&this._bbstr){let e=this._bbstr;this._hasAnyBBtags&&(c=0,h=this._linkActions,l=this._tipList,e=e.replace(s,t),h=null,l=null),this._needsLineBreakConversion&&(e=e.replace(i,\"<br>\")),this._htmlstr=e}return this._htmlstr}attachLinkHandlers(s){if(this._linkActions.length)for(let e=0,t=this._linkActions.length;e<t;++e){const i=this._linkActions[e];if(\"function\"==typeof i){const r=s.querySelector(\".bblink\"+e);if(!r)throw new Error(\"unable to attach BBString link handler\");r.onclick=i}}}equals(e){return e instanceof _.HtmlString?this.toHTML()===e.toHTML():e instanceof _.BBString?this._bbstr===e._bbstr:this._bbstr===e}toFragmentList(){if(!this._hasParsedFragments){let i=[],e=this._bbstr,r=[],t=p.lastIndex=0,s;for(;null!==(s=p.exec(e));){const n=s.index;if(!(0<n&&\"\\\\\"===e.charAt(n-1))){const a=s[0],o=s[1],h=s[2],l=e.substring(t,n);if(t=n+a.length,l&&i.push({text:l,styles:r.slice(0)}),h)if(o){const c=h.toLowerCase();for(let e=r.length-1;0<=e;--e)if(r[e].tag===c){r.splice(e,1);break}}else{let e=h,t=null,s=h.indexOf(\"=\");if(-1!==s?(e=h.substring(0,s).toLowerCase(),t=h.substring(s+1)):e=e.toLowerCase(),d.has(e)){if(\"icon\"!==e)throw new Error(\"unknown self-closing tag \"+e);i.push({icon:t,styles:r.slice(0)})}else r.push({tag:e,param:t})}}}t<e.length&&i.push({text:e.substring(t),styles:r.slice(0)});for(const u of i)u.text&&(u.text=this._ProcessBBCodeEscapeSequences(u.text));this._fragments=i.map(e=>e.icon?_.New(_.IconFragment,{icon:e.icon,styles:e.styles}):_.New(_.TextFragment,{chArr:_.SplitGraphemes(e.text),styles:e.styles})),this._hasParsedFragments=!0}return this._fragments}_ProcessBBCodeEscapeSequences(e){return e=_.ReplaceAll(e,\"\\\\[\",\"[\"),_.ReplaceAll(e,\"\\\\\\\\\",\"\\\\\")}static StripTags(e){return _.New(_.BBString,e,{noEscape:!0}).toPlainText()}static StripAnyTags(e){return e.replace(p,\"\")}}}{let l=function(e){return\" \"!==e&&\" \"!==e&&S.IsWhitespaceChar(e)},h=function(e){return vt.has(e)},c=function(e){return S.IsCJKPunctuationChar(e)&&!h(e)},u=function(e){for(;0<e.length&&l(e.at(-1));)e.pop()},g=function(e){return\"\\n\"===e||\"\\r\\n\"===e};l,h,c,u,g;const S=self.C3,vt=new Set(\"〈《「『【〔〖〘〚〝\");S.WordWrap=class{constructor(){this._lines=[],this._iconSet=null}GetLines(){return this._lines}GetLineCount(){return this._lines.length}SetIconSet(e){this._iconSet=e}_MeasureLine(e,t){let s=0,i=0,r=0,n=0,a=0;for(const o of e){if(-1===o.GetWidth()){const h=t(o);o.SetHeight(h.height),o.SetFontBoundingBoxAscent(h.fontBoundingBoxAscent||0),o.SetFontBoundingBoxDescent(h.fontBoundingBoxDescent||0),o.SetTopToAlphabeticDistance(h.topToAlphabeticDistance||0),o.IsText()?o.SetWidth(h.width):o.IsIcon()&&o.CalculateWidthFromHeight(this._iconSet)}s+=o.GetWidth(),i=Math.max(i,o.GetHeight()),r=Math.max(r,o.GetFontBoundingBoxAscent()),n=Math.max(n,o.GetFontBoundingBoxDescent()),a=Math.max(a,o.GetTopToAlphabeticDistance())}return{width:s,height:i,fontBoundingBoxAscent:r,fontBoundingBoxDescent:n,topToAlphabeticDistance:a}}_AddLine(e,t,s,i,r,n){this._lines.push(S.New(S.WordWrap.Line,{fragments:e,width:t,height:s,fontBoundingBoxAscent:i,fontBoundingBoxDescent:r,topToAlphabeticDistance:n}))}WordWrap(t,n,a,s,o){if(\"string\"==typeof t&&(t=[S.New(S.TextFragment,{chArr:S.SplitGraphemes(t)})]),S.clearArray(this._lines),!(!t.length||1===t.length&&t[0].IsText()&&t[0].IsEmpty()||a<2)){if(1===t.length){const h=t[0];if(h.IsText()&&h.GetLength()<=100&&!h.HasNewLine()){let{width:e,height:t,fontBoundingBoxAscent:s,fontBoundingBoxDescent:i,topToAlphabeticDistance:r}=n(h);if(e+=o,h.SetWidth(e),h.SetHeight(t),h.SetFontBoundingBoxAscent(s||0),h.SetFontBoundingBoxDescent(i||0),h.SetTopToAlphabeticDistance(r||0),e<=a)return void this._AddLine([h],e,t,s,i,r)}}let e;e=\"word\"===s?this._TokeniseByWord(t):\"cjk\"===s?this._TokeniseByCJK(t):this._TokeniseByChar(t),this._WrapText(e,n,a,o)}}_TokeniseByWord(e){let t=[],s=[],i=!1;for(const r of e){const n=r.GetStyles();if(r.IsIcon())0<s.length&&t.push(s),t.push([r]),s=[];else for(const a of r.GetCharacterArray())if(g(a))0<s.length&&t.push(s),t.push([S.New(S.TextFragment,{chArr:[\"\\n\"],styles:n})]),s=[];else if(0===s.length)s.push(S.New(S.TextFragment,{chArr:[a],styles:n})),i=l(a);else{const o=l(a);if(o===i){const h=s.at(-1);h.GetStyles()===n?h._AppendChar(a):s.push(S.New(S.TextFragment,{chArr:[a],styles:n}))}else t.push(s),s=[S.New(S.TextFragment,{chArr:[a],styles:n})],i=o}}return 0<s.length&&t.push(s),t}_TokeniseByCJK(e){let t=[],s=[],i=!1;for(const r of e){const n=r.GetStyles();if(r.IsIcon())0<s.length&&t.push(s),t.push([r]),s=[];else for(const a of r.GetCharacterArray())if(g(a))0<s.length&&t.push(s),t.push([S.New(S.TextFragment,{chArr:[\"\\n\"],styles:n})]),s=[];else{if(0===s.length)s.push(S.New(S.TextFragment,{chArr:[a],styles:n}));else if(i||c(a)){const o=s.at(-1);o.GetStyles()===n?o._AppendChar(a):s.push(S.New(S.TextFragment,{chArr:[a],styles:n}))}else t.push(s),s=[S.New(S.TextFragment,{chArr:[a],styles:n})];i=h(a)}}return 0<s.length&&t.push(s),t}_TokeniseByChar(e){const t=[];for(const s of e)if(s.IsText()){const i=s.GetCharacterArray();S.appendArray(t,i.map(e=>[S.New(S.TextFragment,{chArr:[e],styles:s.GetStyles()})]))}else t.push([s]);return t}_CopyLine(e){return e.map(e=>e._Clone())}_AddWordToLine(t,s){let e=t.length?t.at(-1):null,i=0;e&&e.IsText()&&s[0].IsText()&&s[0].GetStyles()===e.GetStyles()&&(e._Append(s[0].GetCharacterArray()),i=1);for(let e=s.length;i<e;++i){const r=s[i];t.push(r._Clone())}}_WrapText(e,t,s,i){let r=[],n=0,a=0,o=0,h=0,l=0;for(const c of e)if(1===c.length&&c[0].IsText()&&1===c[0].GetLength()&&g(c[0].GetCharacterArray()[0])){if(0===a){const u=S.New(S.TextFragment,{chArr:[\" \"],styles:c[0].GetStyles()}),_=t(u);a=_.height,o=_.fontBoundingBoxAscent||0,h=_.fontBoundingBoxDescent||0,l=_.topToAlphabeticDistance||0}this._AddLine(r,n,a,o,h,l),r=[],n=0,a=0,o=0,h=0,l=0}else{const d=this._CopyLine(r),p=(this._AddWordToLine(d,c),this._MeasureLine(d,t)),f=p.width;if(s<=f)if(0<r.length&&this._AddLine(r,n,a,o,h,l),r=[],c[0].IsText()&&S.IsCharArrayAllWhitespace(c[0].GetCharacterArray()))n=0,a=0,o=0,h=0,l=0;else{this._AddWordToLine(r,c);const m=this._MeasureLine(r,t);n=m.width,a=m.height,o=m.fontBoundingBoxAscent,h=m.fontBoundingBoxDescent,l=m.topToAlphabeticDistance}else r=d,n=f,a=p.height,o=p.fontBoundingBoxAscent,h=p.fontBoundingBoxDescent,l=p.topToAlphabeticDistance}0<r.length&&this._AddLine(r,n,a,o,h,l),this._TrimLinesTrailingWhitespace(t,i)}_TrimLinesTrailingWhitespace(t,s){for(const i of this._lines){const r=i._GetFragmentsArray();if(r.length){let e=r.at(-1);if(e.IsText()){const n=e.GetCharacterArray(),a=n.slice(0);if(u(a),0===a.length)i.OffsetWidth(-e.GetWidth()),r.pop();else if(a.length<n.length){e.SetCharacterArray(a);const o=t(e).width,h=e.GetWidth()-o;e.SetWidth(o),i.OffsetWidth(-h)}0!==s&&0<r.length&&((e=r.at(-1)).OffsetWidth(s),i.OffsetWidth(s))}}}}Clear(){S.clearArray(this._lines)}GetMaxLineWidth(){return this._lines.reduce((e,t)=>Math.max(e,t.GetWidth()),0)}GetTotalLineHeight(){return this._lines.reduce((e,t)=>e+t.GetHeight(),0)}}}{const Pt=self.C3;Pt.WordWrap.Line=class{constructor(e){this._fragments=e.fragments||[],this._width=e.width||-1,this._height=e.height||-1,this._fontBoundingBoxAscent=e.fontBoundingBoxAscent||-1,this._fontBoundingBoxDescent=e.fontBoundingBoxDescent||-1,this._topToAlphabeticDistance=e.topToAlphabeticDistance||-1,this._posX=0,this._posY=0}fragments(){return this._fragments.values()}*fragmentsReverse(){const t=this._fragments;for(let e=t.length-1;0<=e;--e)yield t[e]}_GetFragmentsArray(){return this._fragments}OffsetWidth(e){this._width+=e}GetWidth(){return this._width}GetHeight(){return this._height}GetFoundBoundingBoxAscent(){return this._fontBoundingBoxAscent}GetFontBoundingBoxDescent(){return this._fontBoundingBoxDescent}GetTopToAlphabeticDistance(){return this._topToAlphabeticDistance}SetPosX(e){this._posX=e}GetPosX(){return this._posX}SetPosY(e){this._posY=e}GetPosY(){return this._posY}}}{const Rt=self.C3;Rt.FragmentBase=class{constructor(e){this._styles=e.styles||[],this._width=e.width||-1,this._height=e.height||-1,this._fontBoundingBoxAscent=e.fontBoundingBoxAscent||-1,this._fontBoundingBoxDescent=e.fontBoundingBoxDescent||-1,this._topToAlphabeticDistance=e.topToAlphabeticDistance||-1,this._posX=0,this._posY=0}IsText(){return!1}IsIcon(){return!1}GetStyles(){return this._styles}GetStyleTag(t){const s=this._styles;for(let e=s.length-1;0<=e;--e){const i=s[e];if(i.tag===t)return i}return null}HasStyleTag(e){return!!this.GetStyleTag(e)}GetStyleMap(){const e=new Map;for(const t of this._styles)e.set(t.tag,t.param);return e}OffsetWidth(e){this._width+=e}SetWidth(e){this._width=e}GetWidth(){return this._width}SetHeight(e){this._height=e}GetHeight(){return this._height}SetFontBoundingBoxAscent(e){this._fontBoundingBoxAscent=e}GetFontBoundingBoxAscent(){return this._fontBoundingBoxAscent}SetFontBoundingBoxDescent(e){this._fontBoundingBoxDescent=e}GetFontBoundingBoxDescent(){return this._fontBoundingBoxDescent}SetTopToAlphabeticDistance(e){this._topToAlphabeticDistance=e}GetTopToAlphabeticDistance(){return this._topToAlphabeticDistance}SetPosX(e){this._posX=e}GetPosX(){return this._posX}SetPosY(e){this._posY=e}GetPosY(){return this._posY}}}{const At=self.C3;At.TextFragment=class extends At.FragmentBase{constructor(e){super(e),this._chArr=e.chArr}IsText(){return!0}_Append(e){At.appendArray(this._chArr,e),this._width=-1,this._height=-1,this._fontBoundingBoxAscent=-1,this._fontBoundingBoxDescent=-1,this._topToAlphabeticDistance=-1}_AppendChar(e){this._chArr.push(e)}_Clone(){return At.New(At.TextFragment,{chArr:this._chArr.slice(0),styles:this._styles,width:this._width,height:this._height,fontBoundingBoxAscent:this._fontBoundingBoxAscent,fontBoundingBoxDescent:this._fontBoundingBoxDescent,topToAlphabeticDistance:this._topToAlphabeticDistance})}GetCharacterArray(){return this._chArr}SetCharacterArray(e){this._chArr=e}GetLength(){return this._chArr.length}IsEmpty(){return 0===this._chArr.length}HasNewLine(){return this._chArr.includes(\"\\n\")}}}{const Mt=self.C3;Mt.IconFragment=class extends Mt.FragmentBase{constructor(e){super(e),this._icon=e.icon}IsIcon(){return!0}GetIconParameter(){return this._icon}_Clone(){return Mt.New(Mt.IconFragment,{icon:this._icon,styles:this._styles,width:this._width,height:this._height,fontBoundingBoxAscent:this._fontBoundingBoxAscent,fontBoundingBoxDescent:this._fontBoundingBoxDescent,topToAlphabeticDistance:this._topToAlphabeticDistance})}GetTextIcon(e){if(!e)return null;let t=Number(this._icon);return String(t)===this._icon?(t=Math.floor(t),e.GetTextIconByIndex(t)):e.GetTextIconByTag(this._icon)}CalculateWidthFromHeight(e){const t=this.GetTextIcon(e);this._width=t?this._height*t.GetWidth()/t.GetHeight():0}GetDrawable(e){const t=this.GetTextIcon(e);return t?t.GetDrawable():null}GetLength(){return 1}}}{const Dt=self.C3;Dt.TextIconManager=class{constructor(e){this._iconSets=new Map,this._getIconSetMetaCallback=e.getIconSetMeta,this._getIconSetContentCallback=e.getIconSetContent}Release(){for(const e of this._iconSets.values())e.Release();this._iconSets.clear()}GetIconSet(e){let t=this._iconSets.get(e);if(!t){const s=this._getIconSetMetaCallback(e);t=Dt.New(Dt.TextIconSet,this,{source:e,iconMeta:s}),this._iconSets.set(e,t)}return t}HasIconSet(e){return this._iconSets.has(e)}DeleteIconSet(e){const t=this._iconSets.get(e);t&&t.Release(),this._iconSets.delete(e)}async _GetIconSetContent(e){return this._getIconSetContentCallback(e)}}}{const Et=self.C3;Et.TextIconSet=class{constructor(e,t){this._textIconManager=e,this._source=t.source,this._iconsArray=[],this._iconsByTag=new Map,this._hasStartedLoad=!1,this._isLoading=!1,this._loadPromise=null;const s=t.iconMeta.icons;for(let e=0,t=s.length;e<t;++e){const i=s[e],r=Et.New(Et.TextIcon,this,{index:e,tag:i.tag,source:i.source,width:i.width,height:i.height});this._iconsArray.push(r),i.tag&&this._iconsByTag.set(i.tag.toLowerCase(),r)}}Release(){for(const e of this._iconsArray)e.Release();Et.clearArray(this._iconsArray),this._iconsByTag.clear(),this._textIconManager=null,this._source=null}HasLoaded(){return this._hasStartedLoad}IsLoading(){return this._isLoading}LoadContent(){return this._loadPromise||(this._loadPromise=this._DoLoadContent()),this._loadPromise}async _DoLoadContent(){if(!this._hasStartedLoad){this._hasStartedLoad=!0,this._isLoading=!0;const e=await this._textIconManager._GetIconSetContent(this._source);if(this._textIconManager){const s=e.icons;for(let e=0,t=Math.min(s.length,this._iconsArray.length);e<t;++e){const i=s[e].drawable;this._iconsArray[e]._SetDrawable(i)}this._isLoading=!1}}}GetTextIconByIndex(e){return(e=Math.floor(e))<0||e>=this._iconsArray.length?null:this._iconsArray[e]}GetTextIconByTag(e){return this._iconsByTag.get(e.toLowerCase())||null}}}{const Ft=self.C3;Ft.TextIcon=class{constructor(e,t){this._textIconSet=e,this._source=t.source||null,this._index=t.index,this._tag=t.tag,this._width=t.width,this._height=t.height,this._drawable=null}Release(){this._width=0,this._height=0,this._textIconSet=null}GetSource(){return this._source}GetWidth(){return this._width}GetHeight(){return this._height}_SetDrawable(e){this._drawable=e}GetDrawable(){return this._drawable}}}{let i=function(e,t,s,i){const r=Nt;br.subtract(Lt,s,t),br.subtract(kt,e,t),br.cross(r,Lt,kt),br.normalize(r,r),i.set(r[0],r[1],r[2],br.dot(e,r))},a=function(e,t,s,i,r,n,a){const o=a.x,h=a.y,l=a.z,c=a.w,u=a.xF,_=a.yF,d=a.zF,p=1-u,f=1-_,m=1-d,g=o*e*u+o*i*p+h*t*_+h*r*f+l*s*d+l*n*m;if(c<=g)return!0;const S=o*i*u+o*e*p+h*r*_+h*t*f+l*n*d+l*s*m;return c<S},r=function(e,t,s,i){const r=i.x,n=i.y,a=i.z,o=i.w,h=r*e+n*t+a*s;return o<=h};i,a,r;const Bt=self.C3,Ot=self.glMatrix,br=Ot.vec3,Ur=Ot.vec4,Cr=Ot.mat4,Lt=br.create(),kt=br.create(),Nt=br.create(),Wt=Ur.create(),Vt=Cr.create(),Ut=br.create(),jt=br.create(),Ht=br.create(),Xt=br.create(),zt=br.create(),Yt=br.create(),qt=br.create(),Kt=br.create(),Jt=Ur.fromValues(0,0,1,1);Bt.Gfx={Project(e,t,s,i,r,n,a){let o=i[0]*e+i[4]*t+i[8]*s+i[12],h=i[1]*e+i[5]*t+i[9]*s+i[13],l=i[2]*e+i[6]*t+i[10]*s+i[14],c=i[3]*e+i[7]*t+i[11]*s+i[15],u=r[0]*o+r[4]*h+r[8]*l+r[12]*c,_=r[1]*o+r[5]*h+r[9]*l+r[13]*c,d=r[2]*o+r[6]*h+r[10]*l+r[14]*c,p=r[3]*o+r[7]*h+r[11]*l+r[15]*c;return 0!=p&&(_*=p=1/p,d*=p,a[0]=(.5*(u*=p)+.5)*n[2]+n[0],a[1]=(.5*_+.5)*n[3]+n[1],a[2]=.5*(1+d),!0)},Unproject(e,t,s,i,r,n,a){const o=Vt,h=Wt;return Cr.multiply(o,r,i),null!==Cr.invert(o,o)&&(h[0]=(e-n[0])/n[2]*2-1,h[1]=(t-n[1])/n[3]*2-1,h[2]=2*s-1,h[3]=1,Ur.transformMat4(h,h,o),0!==h[3])&&(h[3]=1/h[3],a[0]=h[0]*h[3],a[1]=h[1]*h[3],a[2]=h[2]*h[3],!0)},UnprojectScreenToWorldZ(e,t,s,i,r,n,a){const o=Lt,h=kt;if(!Bt.Gfx.Unproject(e,t,0,i,r,n,o))return!1;if(!Bt.Gfx.Unproject(e,t,1,i,r,n,h))return!1;let l=kt,c=(br.subtract(l,h,o),Nt),u=(br.set(c,0,0,1),-s),_=br.dot(c,l),d=0;if(0===_){const p=br.dot(c,o)+u;if(0!==p)return!1}else if((d=-(br.dot(o,c)+u)/_)<0)return!1;return br.scaleAndAdd(a,o,l,d),!0}};class Zt{constructor(){this.x=NaN,this.y=NaN,this.z=NaN,this.w=NaN,this.xF=NaN,this.yF=NaN,this.zF=NaN}set(e,t,s,i){this.x=e,this.y=t,this.z=s,this.w=i,this.xF=0<e?1:0,this.yF=0<t?1:0,this.zF=0<s?1:0}}Bt.Gfx.ViewFrustum=class{constructor(){this._leftP=new Zt,this._topP=new Zt,this._rightP=new Zt,this._bottomP=new Zt,this._nearP=new Zt,this._farP=new Zt}CalculatePlanes(e,t){const s=Jt;Bt.Gfx.Unproject(0,1,0,e,t,s,Ut),Bt.Gfx.Unproject(1,1,0,e,t,s,jt),Bt.Gfx.Unproject(0,0,0,e,t,s,Ht),Bt.Gfx.Unproject(1,0,0,e,t,s,Xt),Bt.Gfx.Unproject(0,1,1,e,t,s,zt),Bt.Gfx.Unproject(1,1,1,e,t,s,Yt),Bt.Gfx.Unproject(0,0,1,e,t,s,qt),Bt.Gfx.Unproject(1,0,1,e,t,s,Kt),i(Ht,Ut,zt,this._leftP),i(Ut,jt,Yt,this._topP),i(jt,Xt,Kt,this._rightP),i(Xt,Ht,qt,this._bottomP),i(qt,zt,Yt,this._farP),i(Xt,jt,Ut,this._nearP)}ContainsAABB(e,t,s,i,r,n){return a(e,t,s,i,r,n,this._leftP)&&a(e,t,s,i,r,n,this._topP)&&a(e,t,s,i,r,n,this._rightP)&&a(e,t,s,i,r,n,this._bottomP)&&a(e,t,s,i,r,n,this._nearP)&&a(e,t,s,i,r,n,this._farP)}IsBehindNearPlane(e,t,s){return!r(e,t,s,this._nearP)}}}{const Qt=self.C3,$t=self.glMatrix,br=$t.vec3,Ur=$t.vec4,Cr=$t.mat4,es=Cr.create(),ts=br.fromValues(0,0,0),ss=br.fromValues(0,0,0),is=br.fromValues(0,0,0),rs=br.fromValues(0,1,0),ns=(Ur.fromValues(0,0,0,0),new Qt.Quad),as=new Qt.Rect,os=new Qt.Quad(0,0,1,0,1,1,0,1),hs={nearZ:1,farZ:1e4},ls=Cr.fromValues(1,0,0,0,0,1,0,0,0,0,.5,0,0,0,.5,1);Qt.Gfx.RendererBase=class{constructor(e){e=Object.assign({},hs,e),this._width=0,this._height=0,this._fovY=Qt.toRadians(45),this._tan_fovY_2=Math.tan(this._fovY/2),this._matP=Cr.create(),this._matMV=Cr.create(),this._zAxisScale=!1,this._nearZ=e.nearZ,this._farZ=e.farZ,this._allShaderPrograms=[],this._shaderProgramsByName=new Map,this._spTextureFill=null,this._spPoints=null,this._spTilemapFill=null,this._spTileRandomization=null,this._spColorFill=null,this._spLinearGradientFill=null,this._spPenumbraFill=null,this._spHardEllipseFill=null,this._spHardEllipseOutline=null,this._spSmoothEllipseFill=null,this._spSmoothEllipseOutline=null,this._spSmoothLineFill=null,this._stateGroups=new Map,this._currentStateGroup=null,this._blendModeTable=[],this._namedBlendModeMap=new Map,this._baseZ=0,this._currentZ=0,this._lineWidth=1,this._lineWidthStack=[this._lineWidth],this._lineCap=1,this._lineCapStack=[this._lineCap],this._lineOffset=.5,this._lineOffsetStack=[this._lineOffset],this._frameNumber=0,this._enableMipmaps=!0,this._hasMajorPerformanceCaveat=!1}FillIndexBufferData(e){let t=0,s=e.length,i=0;for(;t<s;)e[t++]=i,e[t++]=i+1,e[t++]=i+2,e[t++]=i,e[t++]=i+2,e[t++]=i+3,i+=4}_ClearState(){this._baseZ=0,this._currentZ=0,this._spTextureFill=null,this._spPoints=null,this._spTilemapFill=null,this._spTileRandomization=null,this._spColorFill=null,this._spLinearGradientFill=null,this._spPenumbraFill=null,this._spHardEllipseFill=null,this._spHardEllipseOutline=null,this._spSmoothEllipseFill=null,this._spSmoothEllipseOutline=null,this._spSmoothLineFill=null,this._ClearAllShaderPrograms()}InitState(){this._ClearState(),this._currentStateGroup=null}OnDeviceOrContextLost(){for(const e of this._allShaderPrograms)e.Release();this._ClearState()}GetWidth(){return this._width}GetHeight(){return this._height}GetDefaultCameraZ(e){return this.IsZAxisScaleNormalized()?100:e/(2*this._GetTanFovYDiv2())}GetZAxisScaleFactor(e){if(this.IsZAxisScaleNormalized()){const t=e/(2*this._GetTanFovYDiv2());return t/this.GetDefaultCameraZ(e)}return 1}SetNearZ(e){this._nearZ=e}GetNearZ(){return this._nearZ}SetFarZ(e){this._farZ=e}GetFarZ(){return this._farZ}SetFovY(e){this._fovY=e,this._tan_fovY_2=Math.tan(this._fovY/2)}GetFovY(){return this._fovY}_GetTanFovYDiv2(){return this._tan_fovY_2}SetZAxisScaleNormalized(){this._zAxisScale=!1}SetZAxisScaleRegular(){this._zAxisScale=!0}IsZAxisScaleNormalized(){return!this._zAxisScale}IsZAxisScaleRegular(){return this._zAxisScale}CalculatePerspectiveMatrix(e,t,s=.5,i=.5){const r=this.GetNearZ(),n=this.GetFarZ(),a=this.GetFovY();if(.5===s&&.5===i)this.IsWebGPU()?Cr.perspectiveZO(e,a,t,r,n):Cr.perspective(e,a,t,r,n);else{const o=2*(s=1-s)-2,h=2*s,l=2*i-2,c=2*i,u=this._GetTanFovYDiv2()*r,_=u*t;Cr.frustum(e,o*_,h*_,l*u,c*u,r,n),this.IsWebGPU()&&Cr.mul(e,ls,e)}}CalculateOrthographicMatrix(e,t,s,i=1){const r=self.devicePixelRatio,n=2*this.GetDefaultCameraZ(s)*r*this._GetTanFovYDiv2()/s,a=t*n/(2*r*i),o=s*n/(2*r*i),h=-a,l=a,c=-o,u=o;this.IsWebGPU()?Cr.orthoZO(e,h,l,c,u,this.GetNearZ(),this.GetFarZ()):Cr.ortho(e,h,l,c,u,this.GetNearZ(),this.GetFarZ())}CalculateLookAtModelView(e,t,s,i,r,n=1){let a=1;this.IsZAxisScaleNormalized()&&(a=200*this._GetTanFovYDiv2()/r);const o=is,h=(br.set(o,a,-a,1),ts),l=ss;br.multiply(h,t,o),br.multiply(l,s,o),Cr.lookAt(e,h,l,i||rs),o[2]=n,Cr.scale(e,e,o)}CalculateLookAtModelView2(e,t,s,i,r,n,a,o){return br.set(ts,e,t,s),br.set(ss,i,r,n),this.CalculateLookAtModelView(es,ts,ss,rs,a,o),es}_AddShaderProgram(e){this._allShaderPrograms.push(e),this._shaderProgramsByName.set(e.GetName(),e)}_RemoveShaderProgram(e){const t=this._allShaderPrograms.indexOf(e);-1!==t&&this._allShaderPrograms.splice(t,1),this._shaderProgramsByName.delete(e.GetName())}_ClearAllShaderPrograms(){Qt.clearArray(this._allShaderPrograms),this._shaderProgramsByName.clear()}GetShaderProgramByName(e){return this._shaderProgramsByName.get(e)||null}GetTextureFillShaderProgram(){return this._spTextureFill}SetTextureFillMode(){this.SetProgram(this._spTextureFill)}GetPointsRenderingProgram(){return this._spPoints}SetPointsRenderingProgram(){this.SetProgram(this._spPoints)}SetTilemapFillMode(){this.SetProgram(this._spTilemapFill)}SetTileRandomizationMode(){this.SetProgram(this._spTileRandomization)}SetColorFillMode(){this.SetProgram(this._spColorFill)}SetLinearGradientFillMode(){this.SetProgram(this._spLinearGradientFill)}SetPenumbraFillMode(){this.SetProgram(this._spPenumbraFill)}SetHardEllipseFillMode(){this.SetProgram(this._spHardEllipseFill)}SetHardEllipseOutlineMode(){this.SetProgram(this._spHardEllipseOutline)}SetSmoothEllipseFillMode(){this.SetProgram(this._spSmoothEllipseFill)}SetSmoothEllipseOutlineMode(){this.SetProgram(this._spSmoothEllipseOutline)}SetSmoothLineFillMode(){this.SetProgram(this._spSmoothLineFill)}_SetCurrentStateGroup(e){this._currentStateGroup=e}GetCurrentStateGroup(){return this._currentStateGroup}AcquireStateGroup(e,t,s,i){let r=Qt.Gfx.StateGroup.MakeKey(e,t,s,i),n=this._stateGroups.get(r);return n||(n=Qt.New(Qt.Gfx.StateGroup,this,e,t,s,i),this._stateGroups.set(r,n)),n.AddRef(),n}ReleaseStateGroup(e){e.DecRef(),0===e._GetRefCount()&&(this._currentStateGroup===e&&(this._currentStateGroup=null),this._stateGroups.delete(e.GetKey()),e.Release())}_InitBlendModeData(e){Qt.clearArray(this._blendModeTable),this._namedBlendModeMap.clear();let t=0;for(const s of e){const i=s[0],r=s[1],n=s[2];this._blendModeTable.push([r,n]),this._namedBlendModeMap.set(i,{number:t,srcBlend:r,destBlend:n}),t++}}_GetBlendByIndex(e){return this._blendModeTable[e]}GetSrcBlendByIndex(e){return this._GetBlendByIndex(e)[0]}GetDestBlendByIndex(e){return this._GetBlendByIndex(e)[1]}GetNamedBlend(e){const t=this._namedBlendModeMap.get(e);if(void 0===t)throw new Error(\"invalid blend name\");return t}NamedBlendToNumber(e){const t=this._namedBlendModeMap.get(e);if(void 0===t)throw new Error(\"invalid blend name\");return t.number}SetBaseZ(e){this._baseZ=e}GetBaseZ(){return this._baseZ}SetCurrentZ(e){this._currentZ=e,this._currentStateGroup=null}GetCurrentZ(){return this._currentZ}Line(e,t,s,i){const r=Qt.angleTo(e,t,s,i),n=Math.sin(r),a=Math.cos(r),o=.5*this._lineWidth,h=n*o,l=a*o,c=this._lineCap;2===c?this.LinePreCalc_LineCap2(e,t,0,s,i,0,h,l):1===c?this.LinePreCalc_LineCap1(e,t,0,s,i,0,h,l):this.LinePreCalc_LineCap0(e,t,0,s,i,0,h,l)}Line3D(e,t,s,i,r,n){const a=Qt.angleTo(e,t,i,r),o=Math.sin(a),h=Math.cos(a),l=.5*this._lineWidth,c=o*l,u=h*l,_=this._lineCap;2===_?this.LinePreCalc_LineCap2(e,t,s,i,r,n,c,u):1===_?this.LinePreCalc_LineCap1(e,t,s,i,r,n,c,u):this.LinePreCalc_LineCap0(e,t,s,i,r,n,c,u)}LinePreCalc_LineCap2(e,t,s,i,r,n,a,o){const h=this._lineOffset,l=e+h-o,c=t+h-a,u=i+h+o,_=r+h+a,d=2*o,p=2*a,f=l+a,m=c-o,g=l-a+d,S=c+o+p,y=u+a,G=_-o,I=u-a-d,T=_+o-p;this.Quad3D2(f,m,s,y,G,n,I,T,n,g,S,s,os)}LinePreCalc_LineCap1(e,t,s,i,r,n,a,o){const h=this._lineOffset,l=e+h-o,c=t+h-a,u=i+h+o,_=r+h+a,d=l+a,p=c-o,f=l-a,m=c+o,g=u+a,S=_-o,y=u-a,G=_+o;this.Quad3D2(d,p,s,g,S,n,y,G,n,f,m,s,os)}LinePreCalc_LineCap0(e,t,s,i,r,n,a,o){const h=this._lineOffset,l=e+h,c=t+h,u=i+h,_=r+h,d=l+a,p=c-o,f=l-a,m=c+o,g=u+a,S=_-o,y=u-a,G=_+o;this.Quad3D2(d,p,s,g,S,n,y,G,n,f,m,s,os)}TexturedLine(e,t,s,i,r,n){const a=Qt.angleTo(e,t,s,i),o=Math.sin(a),h=Math.cos(a),l=.5*this._lineWidth,c=o*l,u=h*l,_=this._lineCap;2===_?this.TexturedLinePreCalc_LineCap2(e,t,s,i,c,u,r,n):1===_?this.TexturedLinePreCalc_LineCap1(e,t,s,i,c,u,r,n):this.TexturedLinePreCalc_LineCap0(e,t,s,i,c,u,r,n)}TexturedLinePreCalc_LineCap2(e,t,s,i,r,n,a,o){const h=this._lineOffset,l=e+h-n,c=t+h-r,u=s+h+n,_=i+h+r,d=2*n,p=2*r,f=l+r,m=c-n,g=l-r+d,S=c+n+p,y=u+r,G=_-n,I=u-r-d,T=_+n-p;ns.set(f,m,y,G,I,T,g,S),as.set(a,0,o,0),this.Quad3(ns,as)}TexturedLinePreCalc_LineCap1(e,t,s,i,r,n,a,o){const h=this._lineOffset,l=e+h-n,c=t+h-r,u=s+h+n,_=i+h+r,d=l+r,p=c-n,f=l-r,m=c+n,g=u+r,S=_-n,y=u-r,G=_+n;ns.set(d,p,g,S,y,G,f,m),as.set(a,0,o,0),this.Quad3(ns,as)}TexturedLinePreCalc_LineCap0(e,t,s,i,r,n,a,o){const h=this._lineOffset,l=e+h,c=t+h,u=s+h,_=i+h,d=l+r,p=c-n,f=l-r,m=c+n,g=u+r,S=_-n,y=u-r,G=_+n;ns.set(d,p,g,S,y,G,f,m),as.set(a,0,o,0),this.Quad3(ns,as)}LineRect(e,t,s,i){const r=.5*this._lineWidth,n=this._lineCap;2===n?this._LineRectPreCalc_LineCap2(e,t,s,i,r):1===n?this._LineRectPreCalc_LineCap1(e,t,s,i,r):this._LineRectPreCalc_LineCap0(e,t,s,i,r)}_LineRectPreCalc_LineCap2(e,t,s,i,r){this.LinePreCalc_LineCap2(e,t,0,s,t,0,0,r),this.LinePreCalc_LineCap2(s,t,0,s,i,0,r,0),this.LinePreCalc_LineCap2(s,i,0,e,i,0,0,-r),this.LinePreCalc_LineCap2(e,i,0,e,t,0,-r,0)}_LineRectPreCalc_LineCap1(e,t,s,i,r){this.LinePreCalc_LineCap1(e,t,0,s,t,0,0,r),this.LinePreCalc_LineCap1(s,t,0,s,i,0,r,0),this.LinePreCalc_LineCap1(s,i,0,e,i,0,0,-r),this.LinePreCalc_LineCap1(e,i,0,e,t,0,-r,0)}_LineRectPreCalc_LineCap0(e,t,s,i,r){this.LinePreCalc_LineCap0(e,t,0,s,t,0,0,r),this.LinePreCalc_LineCap0(s,t,0,s,i,0,r,0),this.LinePreCalc_LineCap0(s,i,0,e,i,0,0,-r),this.LinePreCalc_LineCap0(e,i,0,e,t,0,-r,0)}LineRect2(e){this.LineRect(e.getLeft(),e.getTop(),e.getRight(),e.getBottom())}LineQuad(e){const t=Qt.angleTo(e.getTlx(),e.getTly(),e.getTrx(),e.getTry()),s=Math.sin(t),i=Math.cos(t),r=.5*this._lineWidth,n=s*r,a=i*r,o=this._lineCap;2===o?this._LineQuadPreCalc_LineCap2(e,n,a):1===o?this._LineQuadPreCalc_LineCap1(e,n,a):this._LineQuadPreCalc_LineCap0(e,n,a)}_LineQuadPreCalc_LineCap2(e,t,s){this.LinePreCalc_LineCap2(e.getTlx(),e.getTly(),0,e.getTrx(),e.getTry(),0,t,s),this.LinePreCalc_LineCap2(e.getTrx(),e.getTry(),0,e.getBrx(),e.getBry(),0,s,-t),this.LinePreCalc_LineCap2(e.getBrx(),e.getBry(),0,e.getBlx(),e.getBly(),0,-t,-s),this.LinePreCalc_LineCap2(e.getBlx(),e.getBly(),0,e.getTlx(),e.getTly(),0,-s,t)}_LineQuadPreCalc_LineCap1(e,t,s){this.LinePreCalc_LineCap1(e.getTlx(),e.getTly(),0,e.getTrx(),e.getTry(),0,t,s),this.LinePreCalc_LineCap1(e.getTrx(),e.getTry(),0,e.getBrx(),e.getBry(),0,s,-t),this.LinePreCalc_LineCap1(e.getBrx(),e.getBry(),0,e.getBlx(),e.getBly(),0,-t,-s),this.LinePreCalc_LineCap1(e.getBlx(),e.getBly(),0,e.getTlx(),e.getTly(),0,-s,t)}_LineQuadPreCalc_LineCap0(e,t,s){this.LinePreCalc_LineCap0(e.getTlx(),e.getTly(),0,e.getTrx(),e.getTry(),0,t,s),this.LinePreCalc_LineCap0(e.getTrx(),e.getTry(),0,e.getBrx(),e.getBry(),0,s,-t),this.LinePreCalc_LineCap0(e.getBrx(),e.getBry(),0,e.getBlx(),e.getBly(),0,-t,-s),this.LinePreCalc_LineCap0(e.getBlx(),e.getBly(),0,e.getTlx(),e.getTly(),0,-s,t)}SetLineWidth(e){this._lineWidth=e,this._lineWidthStack[this._lineWidthStack.length-1]=e}GetLineWidth(){return this._lineWidth}PushLineWidth(e){if(100<=this._lineWidthStack.length)throw new Error(\"pushed too many line widths - check push/pop pairs\");this._lineWidthStack.push(e),this._lineWidth=e}PopLineWidth(){if(this._lineWidthStack.length<=1)throw new Error(\"cannot pop last line width - check push/pop pairs\");this._lineWidthStack.pop(),this._lineWidth=this._lineWidthStack.at(-1)}SetLineCapButt(){this._lineCap=0,this._lineCapStack[this._lineCapStack.length-1]=0}SetLineCapSquare(){this._lineCap=1,this._lineCapStack[this._lineCapStack.length-1]=0}SetLineCapZag(){this._lineCap=2,this._lineCapStack[this._lineCapStack.length-1]=0}PushLineCap(e){if(\"butt\"===e)this.PushLineCapButt();else if(\"square\"===e)this.PushLineCapSquare();else{if(\"zag\"!==e)throw new Error(\"invalid line cap\");this.PushLineCapZag()}}PushLineCapButt(){if(100<=this._lineCapStack.length)throw new Error(\"pushed too many line caps - check push/pop pairs\");this._lineCapStack.push(0),this._lineCap=0}PushLineCapSquare(){if(100<=this._lineCapStack.length)throw new Error(\"pushed too many line caps - check push/pop pairs\");this._lineCapStack.push(1),this._lineCap=1}PushLineCapZag(){if(100<=this._lineCapStack.length)throw new Error(\"pushed too many line caps - check push/pop pairs\");this._lineCapStack.push(2),this._lineCap=2}PopLineCap(){if(this._lineCapStack.length<=1)throw new Error(\"cannot pop last line cap - check push/pop pairs\");this._lineCapStack.pop(),this._lineCap=this._lineCapStack.at(-1)}SetLineOffset(e){this._lineOffset=e,this._lineOffsetStack[this._lineOffsetStack.length-1]=e}GetLineOffset(){return this._lineOffset}PushLineOffset(e){if(100<=this._lineOffsetStack.length)throw new Error(\"pushed too many line offsets - check push/pop pairs\");this._lineOffsetStack.push(e),this._lineOffset=e}PopLineOffset(){if(this._lineOffsetStack.length<=1)throw new Error(\"cannot pop last line offset - check push/pop pairs\");this._lineOffsetStack.pop(),this._lineOffset=this._lineOffsetStack.at(-1)}ConvexPoly(t){const e=t.length/2;if(e<3)throw new Error(\"need at least 3 points\");const s=e-2,i=s-1,r=t[0],n=t[1];for(let e=0;e<s;e+=2){const a=2*e,o=t[2+a],h=t[3+a],l=t[4+a],c=t[5+a];if(e===i)this.Quad2(r,n,o,h,l,c,l,c);else{const u=t[6+a],_=t[7+a];this.Quad2(r,n,o,h,l,c,u,_)}}}GetNumVertexComponents(){return 3}Finish(){this.EndBatch(!0),this._frameNumber++}GetFrameNumber(){return this._frameNumber}IncrementFrameNumber(){this._frameNumber++}SetMipmapsEnabled(e){this._enableMipmaps=!!e}AreMipmapsEnabled(){return this._enableMipmaps}SetHasMajorPerformanceCaveat(e){this._hasMajorPerformanceCaveat=!!e}HasMajorPerformanceCaveat(){return this._hasMajorPerformanceCaveat}IsWebGL(){return!1}IsWebGPU(){return!1}GetEstimatedBackBufferMemoryUsage(){}GetEstimatedRenderBufferMemoryUsage(){}GetEstimatedTextureMemoryUsage(){}GetEstimatedTotalMemoryUsage(){return this.GetEstimatedBackBufferMemoryUsage()+this.GetEstimatedRenderBufferMemoryUsage()+this.GetEstimatedTextureMemoryUsage()}CreateRendererText(){return Qt.New(Qt.Gfx.RendererText,this)}}}{const cs=self.C3;cs.Gfx.ShaderProgramBase=class{constructor(e,t){this._name=t.name,this._renderer=e,this._extendBoxHorizontal=t.extendBoxHorizontal||0,this._extendBoxVertical=t.extendBoxVertical||0,this._crossSampling=!!t.crossSampling,this._mustPreDraw=!!t.mustPreDraw,this._preservesOpaqueness=!!t.preservesOpaqueness,this._supports3dDirectRendering=!!t.supports3dDirectRendering,this._animated=!!t.animated,this._blendsBackground=!!t.blendsBackground,this._usesDepth=!!t.usesDepth,this._usesAnySrcRectOrPixelSize=!1,this._needsPostDrawOrExtendBox=this._crossSampling||this._blendsBackground||0!==this._extendBoxHorizontal||0!==this._extendBoxVertical}Release(){this._renderer=null}GetRenderer(){return this._renderer}GetName(){return this._name}ExtendsBox(){return 0!==this._extendBoxHorizontal||0!==this._extendBoxVertical}GetBoxExtendHorizontal(){return this._extendBoxHorizontal}GetBoxExtendVertical(){return this._extendBoxVertical}UsesCrossSampling(){return this._crossSampling}MustPreDraw(){return this._mustPreDraw}PreservesOpaqueness(){return this._preservesOpaqueness}Supports3DDirectRendering(){return this._supports3dDirectRendering}IsAnimated(){return this._animated}BlendsBackground(){return this._blendsBackground}UsesDepth(){return this._usesDepth}UsesAnySrcRectOrPixelSize(){return this._usesAnySrcRectOrPixelSize}NeedsPostDrawOrExtendsBox(){return this._needsPostDrawOrExtendBox}UsesIsSrcTexRotated(){return!1}}}{const us=self.C3;us.Gfx.StateGroup=class{constructor(e,t,s,i,r){this._renderer=e,this._refCount=0,this._shaderProgram=null,this._shaderProgramName=\"\",this._blendMode=s,this._color=us.New(us.Color),this._color.set(i),this._zElevation=r,\"string\"==typeof t?this._shaderProgramName=t:(this._shaderProgram=t,this._shaderProgramName=this._shaderProgram.GetName())}Release(){if(0<this._refCount)throw new Error(\"releasing state group still in use\");this._renderer=null,this._shaderProgram=null,this._shaderProgramName=\"\"}Apply(){const e=this._renderer;e.SetProgram(this._shaderProgram),e.SetBlendMode(this._blendMode),e.SetColor(this._color),e.SetCurrentZ(this._zElevation),e._SetCurrentStateGroup(this)}GetKey(){return us.Gfx.StateGroup.MakeKey(this._shaderProgramName,this._blendMode,this._color,this._zElevation)}AddRef(){++this._refCount}DecRef(){--this._refCount}_GetRefCount(){return this._refCount}OnContextLost(){this._shaderProgram=null}OnContextRestored(e){if(this._shaderProgram=e.GetShaderProgramByName(this._shaderProgramName),!this._shaderProgram)throw new Error(\"failed to restore shader program\")}static MakeKey(e,t,s,i){const r=\"string\"==typeof e?e:e.GetName();return r+\",\"+t+\",\"+s.getR()+\",\"+s.getG()+\",\"+s.getB()+\",\"+s.getA()+\",\"+i}}}{let i=function(e,t,s){const i=s.getTlx(),r=s.getTly(),n=s.getTrx()-i,a=s.getTry()-r,o=s.getBlx()-i,h=s.getBly()-r,l=n*e,c=a*e,u=o*t,_=h*t;return[i+l+u,r+c+_]};i;const x=self.C3,_s=x.New(x.Quad);x.Gfx.MeshPoint=class{constructor(e,t,s){this._mesh=e,this._col=t,this._row=s,this._x=NaN,this._y=NaN,this._zElevation=NaN,this._u=NaN,this._v=NaN,this._x=0,this._y=0,this._zElevation=0,this._u=0,this._v=0}_Init(e,t,s,i){this._x=e,this._y=t,this._u=s,this._v=i}GetX(){return this._x}SetX(e){this._x!==e&&(this._x=e,this._mesh._SetPointsChanged())}GetY(){return this._y}SetY(e){this._y!==e&&(this._y=e,this._mesh._SetPointsChanged())}GetZElevation(){return this._zElevation}SetZElevation(e){this._zElevation!==e&&(this._zElevation=Math.max(e,0),this._mesh._SetPointsChanged())}GetU(){return this._u}SetU(e){this._u=e}GetV(){return this._v}SetV(e){this._v=e}_Interpolate_TexRect(e,t,s){[this._x,this._y]=i(e._x,e._y,t),this._zElevation=e._zElevation,this._u=x.lerp(s.getLeft(),s.getRight(),e._u),this._v=x.lerp(s.getTop(),s.getBottom(),e._v)}_Interpolate_TexQuad(e,t,s){[this._x,this._y]=i(e._x,e._y,t),this._zElevation=e._zElevation,[this._u,this._v]=i(e._u,e._v,s)}SaveToJson(){return{x:this.GetX(),y:this.GetY(),z:this.GetZElevation(),u:this.GetU(),v:this.GetV()}}LoadFromJson(e){this.SetX(e.x),this.SetY(e.y),e.hasOwnProperty(\"z\")&&this.SetZElevation(e.z),this.SetU(e.u),this.SetV(e.v)}GetMesh(){return this._mesh}GetColumn(){return this._col}GetRow(){return this._row}},x.Gfx.Mesh=class{constructor(s,e,t){if(s<2||e<2)throw new Error(\"invalid mesh size\");this._hsize=s,this._vsize=e,this._owner=t||null,this._pts=[],this._minX=0,this._minY=0,this._maxX=1,this._maxY=1,this._maxZ=0,this._pointsChanged=!1;const i=s-1,r=e-1;for(let t=0;t<e;++t){const n=[];for(let e=0;e<s;++e){const a=x.New(x.Gfx.MeshPoint,this,e,t),o=e/i,h=t/r;a._Init(o,h,o,h),n.push(a)}this._pts.push(n)}}Release(){x.clearArray(this._pts)}GetHSize(){return this._hsize}GetVSize(){return this._vsize}GetOwner(){return this._owner}_GetPoints(){return this._pts}_SetPointsChanged(){this._pointsChanged=!0}_MaybeComputeBounds(){if(this._pointsChanged){let e=1/0,t=1/0,s=-1/0,i=-1/0,r=0;for(const n of this._pts)for(const a of n){const o=a.GetX(),h=a.GetY();e=Math.min(e,o),t=Math.min(t,h),s=Math.max(s,o),i=Math.max(i,h),r=Math.max(r,a.GetZElevation())}this._minX=e,this._minY=t,this._maxX=s,this._maxY=i,this._maxZ=r,this._pointsChanged=!1}}GetMinX(){return this._MaybeComputeBounds(),this._minX}GetMinY(){return this._MaybeComputeBounds(),this._minY}GetMaxX(){return this._MaybeComputeBounds(),this._maxX}GetMaxY(){return this._MaybeComputeBounds(),this._maxY}GetMaxZ(){return this._MaybeComputeBounds(),this._maxZ}HasAnyZElevation(){return 0<this.GetMaxZ()}GetMeshPointAt(e,t){return e=Math.floor(e),t=Math.floor(t),e<0||e>=this._hsize||t<0||t>=this._vsize?null:this._pts[t][e]}CalculateTransformedMesh(e,s,i){const r=i instanceof x.Rect;if(e.GetHSize()!==this.GetHSize()||e.GetVSize()!==this.GetVSize())throw new Error(\"source mesh wrong size\");const n=e._pts,a=this._pts;for(let e=0,t=a.length;e<t;++e){const o=n[e],h=a[e];for(let e=0,t=h.length;e<t;++e){const l=o[e],c=h[e];r?c._Interpolate_TexRect(l,s,i):c._Interpolate_TexQuad(l,s,i)}}}Draw(n){let a=this._pts,o=a[0];for(let e=1,t=a.length;e<t;++e){let s=a[e],i=o[0],r=s[0];for(let e=1,t=s.length;e<t;++e){const h=o[e],l=s[e];_s.set(i.GetU(),i.GetV(),h.GetU(),h.GetV(),l.GetU(),l.GetV(),r.GetU(),r.GetV()),n.Quad3D2(i.GetX(),i.GetY(),i.GetZElevation(),h.GetX(),h.GetY(),h.GetZElevation(),l.GetX(),l.GetY(),l.GetZElevation(),r.GetX(),r.GetY(),r.GetZElevation(),_s),i=h,r=l}o=s}}Outline(o,h){h=h||((e,t,s)=>[e,t,s]);let e=this._pts,l=e[0];for(let n=1,a=e.length;n<a;++n){let s=e[n],i=l[0],r=s[0];for(let e=1,t=s.length;e<t;++e){const c=l[e],u=s[e],[_,d,p]=h(i.GetX(),i.GetY(),i.GetZElevation()),[f,m,g]=h(c.GetX(),c.GetY(),c.GetZElevation()),[S,y,G]=h(u.GetX(),u.GetY(),u.GetZElevation()),[I,T,C]=h(r.GetX(),r.GetY(),r.GetZElevation());o.Line3D(_,d,p,f,m,g),o.Line3D(_,d,p,S,y,G),o.Line3D(_,d,p,I,T,C),e===t-1&&o.Line3D(f,m,g,S,y,G),n===a-1&&o.Line3D(I,T,C,S,y,G),i=c,r=u}l=s}}InsertPolyMeshVertices(e){let s=.99999999,i=e.pointsArr(),r=[],n=this.GetHSize()-1,a=this.GetVSize()-1,o=1/n,h=1/a,l=n-1,c=a-1,u=i[0],_=i[1],d=x.clamp(Math.floor(u*n),0,l),p=x.clamp(Math.floor(_*a),0,c),f=!0,m=0,g=0,S=0,y=-1,G=()=>{u=x.clamp(x.lerp(u,m,S),0,1),_=x.clamp(x.lerp(_,g,S),0,1),r.push(u,_)};for(let e=0,t=i.length;e<t;e+=2){u=i[e],_=i[e+1],r.push(u,_),d=x.clamp(Math.floor(u*n),0,l),p=x.clamp(Math.floor(_*a),0,c);const I=(e+2)%t;for(m=i[I],g=i[1+I],y=-1;;){if(1e6<r.length)throw new Error(\"Too many mesh poly points\");const T=d*o,C=p*h,b=(d+1)*o,w=(p+1)*h;if(f=x.isPointInTriangleInclusive(u,_,T,C,b,C,b,w),0!==y&&0<=(S=x.rayIntersectExtended(u,_,m,g,T,C,b,w,-.001))&&S<=s)G(),f=!f,y=0;else if(0<p&&2!==y&&0<=(S=x.rayIntersectExtended(u,_,m,g,T,C,b,C,.001))&&S<=s)G(),p--,f=!1,y=4;else if(d<l&&3!==y&&0<=(S=x.rayIntersectExtended(u,_,m,g,b,C,b,w,.001))&&S<=s)G(),d++,f=!1,y=1;else if(0<d&&1!==y&&0<=(S=x.rayIntersectExtended(u,_,m,g,T,C,T,w,.001))&&S<=s)G(),d--,f=!0,y=3;else{if(!(p<c&&4!==y&&0<=(S=x.rayIntersectExtended(u,_,m,g,T,w,b,w,.001))&&S<=s))break;G(),p++,f=!0,y=2}}}return x.New(x.CollisionPoly,r)}TransformCollisionPoly(e,t){const s=this._TransformPolyPoints(e);this._SimplifyPoly(s),t.setPoints(s)}_TransformPolyPoints(e){const s=[],i=e.pointsArr();for(let e=0,t=i.length;e<t;e+=2){const r=i[e],n=i[e+1],[a,o]=this.TransformPoint(r,n);s.push(a,o)}return s}TransformPoint(e,t){const s=this.GetHSize()-1,i=this.GetVSize()-1,r=1/s,n=1/i,a=x.clamp(Math.floor(e*s),0,s-1),o=x.clamp(Math.floor(t*i),0,i-1),h=a*r,l=o*n,c=(a+1)*r,u=(o+1)*n,_=this.GetMeshPointAt(a,o),d=this.GetMeshPointAt(a+1,o+1),p=x.isPointInTriangleInclusive(e,t,h,l,c,l,c,u),f=p?h+r:h,m=p?l:l+n,g=this.GetMeshPointAt(a+(p?1:0),o+(p?0:1)),[S,y,G]=x.triangleCartesianToBarycentric(e,t,h,l,f,m,c,u);return x.triangleBarycentricToCartesian3d(S,y,G,_.GetX(),_.GetY(),_.GetZElevation(),g.GetX(),g.GetY(),g.GetZElevation(),d.GetX(),d.GetY(),d.GetZElevation())}_SimplifyPoly(s){let i=[],r=s[0],n=s[1],a=r-s.at(-2),o=n-s.at(-1);for(let e=0,t=s.length;e<t;e+=2){const h=(e+2)%t,l=s[h],c=s[1+h],u=l-r,_=c-n,d=Math.abs(u)<1e-7&&Math.abs(a)<1e-7&&Math.sign(_)===Math.sign(o),p=Math.abs(_)<1e-7&&Math.abs(o)<1e-7&&Math.sign(u)===Math.sign(a);(!d&&!p&&.001<Math.abs(u/a-_/o)||0==u&&0==_)&&i.push(r,n),r=l,n=c,a=u,o=_}6<=i.length&&i.length<s.length&&x.shallowAssignArray(s,i)}SaveToJson(){return{cols:this.GetHSize(),rows:this.GetVSize(),points:this._pts.map(e=>e.map(e=>e.SaveToJson()))}}LoadFromJson(e){const s=this.GetHSize(),i=this.GetVSize();if(e.cols!==s||e.rows!==i)throw new Error(\"mesh data wrong size\");const r=e.points;for(let t=0;t<i;++t){const n=r[t];for(let e=0;e<s;++e){const a=this.GetMeshPointAt(e,t);a.LoadFromJson(n[e])}}}}}{let d=function(e,t){let s,i,r,n;switch(e){case\"rgba8\":s=t.RGBA8,i=t.RGBA,r=t.RGBA,n=t.UNSIGNED_BYTE;break;case\"rgb8\":s=t.RGB8,i=t.RGB,r=t.RGB,n=t.UNSIGNED_BYTE;break;case\"rgba4\":s=t.RGBA4,i=t.RGBA,r=t.RGBA,n=t.UNSIGNED_SHORT_4_4_4_4;break;case\"rgb5_a1\":s=t.RGB5_A1,i=t.RGBA,r=t.RGBA,n=t.UNSIGNED_SHORT_5_5_5_1;break;case\"rgb565\":s=t.RGB565,i=t.RGB,r=t.RGB,n=t.UNSIGNED_SHORT_5_6_5;break;default:throw new Error(\"invalid pixel format\")}return{sizedinternalformat:s,internalformat:i,format:r,type:n}};d;const ds=self.C3,ps=new Set([\"rgba8\",\"rgb8\",\"rgba4\",\"rgb5_a1\",\"rgb565\"]),fs=new Set([\"nearest\",\"bilinear\",\"trilinear\"]),ms=new Set([\"default\",\"low\",\"high\"]),gs=new Set([\"clamp-to-edge\",\"repeat\",\"mirror-repeat\"]),Ss={wrapX:\"clamp-to-edge\",wrapY:\"clamp-to-edge\",sampling:\"trilinear\",anisotropy:0,pixelFormat:\"rgba8\",mipMap:!0,mipMapQuality:\"default\",premultiplyAlpha:!0,isSvg:!1,width:-1,height:-1},ys={premultiplyAlpha:!0,flipY:!1},Gs=new Set;ds.Gfx.WebGLRendererTexture=class{constructor(e){this._renderer=e,this._texture=null,this._width=0,this._height=0,this._isStatic=!0,this._wrapX=\"clamp-to-edge\",this._wrapY=\"clamp-to-edge\",this._sampling=\"trilinear\",this._anisotropy=0,this._pixelFormat=\"rgba8\",this._isMipMapped=!1,this._mipMapQuality=\"default\",this._refCount=0}_CreateStatic(t,e){if(!(\"undefined\"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||\"undefined\"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||\"undefined\"!=typeof ImageBitmap&&t instanceof ImageBitmap||\"undefined\"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas||t instanceof ImageData||t instanceof ArrayBuffer||null===t))throw new Error(\"invalid texture source\");if(e=Object.assign({},Ss,e),this._texture)throw new Error(\"already created texture\");if(this._wrapX=e.wrapX,this._wrapY=e.wrapY,this._sampling=e.sampling,this._anisotropy=e.anisotropy,this._pixelFormat=e.pixelFormat,this._isMipMapped=!!e.mipMap&&this._renderer.AreMipmapsEnabled(),this._mipMapQuality=e.mipMapQuality,!gs.has(this._wrapX)||!gs.has(this._wrapY))throw new Error(\"invalid wrap mode\");if(!fs.has(this._sampling))throw new Error(\"invalid sampling\");if(!ps.has(this._pixelFormat))throw new Error(\"invalid pixel format\");if(!ms.has(this._mipMapQuality))throw new Error(\"invalid mipmap quality\");if(this._isStatic=!0,t instanceof ArrayBuffer||null===t||e.isSvg){if(this._width=e.width,this._height=e.height,t instanceof ArrayBuffer&&t.byteLength!==this._width*this._height*4)throw new Error(\"ArrayBuffer wrong size\")}else this._width=t.width,this._height=t.height;if(this._width<=0||this._height<=0)throw new Error(\"invalid texture data size\");if(e.isSvg){const o=ds.CreateCanvas(this._width,this._height),h=o.getContext(\"2d\");h.drawImage(t,0,0,this._width,this._height),t=o}const s=ds.isPOT(this._width)&&ds.isPOT(this._height),i=this._renderer.GetMaxTextureSize();if(this._width>i||this._height>i)throw new Error(\"texture data exceeds maximum texture size\");const r=this._renderer.GetContext(),n=this._renderer.GetWebGLVersionNumber(),a=(this._texture=r.createTexture(),r.bindTexture(r.TEXTURE_2D,this._texture),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!1),d(this._pixelFormat,r));if(this._renderer.SupportsNPOTTextures()||s||!this._IsTiled())if(2<=n){let e;e=this._isMipMapped?Math.floor(Math.log2(Math.max(this._width,this._height))+1):1,r.texStorage2D(r.TEXTURE_2D,e,a.sizedinternalformat,this._width,this._height),t instanceof ArrayBuffer?r.texSubImage2D(r.TEXTURE_2D,0,0,0,this._width,this._height,a.format,a.type,new Uint8Array(t)):null!==t&&r.texSubImage2D(r.TEXTURE_2D,0,0,0,a.format,a.type,t)}else t instanceof ArrayBuffer?r.texImage2D(r.TEXTURE_2D,0,a.internalformat,this._width,this._height,0,a.format,a.type,new Uint8Array(t)):null===t?r.texImage2D(r.TEXTURE_2D,0,a.internalformat,this._width,this._height,0,a.format,a.type,null):r.texImage2D(r.TEXTURE_2D,0,a.internalformat,a.format,a.type,t);else{if(null===t)throw new Error(\"cannot pass null data when creating a NPOT tiled texture without NPOT support\");if((t=t instanceof ArrayBuffer?new ImageData(new Uint8ClampedArray(t),this._width,this._height):t)instanceof ImageData){const u=ds.CreateCanvas(this._width,this._height),_=u.getContext(\"2d\");_.putImageData(t,0,0),t=u}const l=ds.CreateCanvas(ds.nextHighestPowerOfTwo(this._width),ds.nextHighestPowerOfTwo(this._height)),c=l.getContext(\"2d\");c.imageSmoothingEnabled=\"nearest\"!==this._sampling,c.drawImage(t,0,0,this._width,this._height,0,0,l.width,l.height),r.texImage2D(r.TEXTURE_2D,0,a.internalformat,a.format,a.type,l)}null!==t&&this._SetTextureParameters(r),r.bindTexture(r.TEXTURE_2D,null),this._renderer._ResetLastTexture(),this._refCount=1,Gs.add(this)}_CreateDynamic(e,t,s){if(s=Object.assign({},Ss,s),this._texture)throw new Error(\"already created texture\");if(this._wrapX=s.wrapX,this._wrapY=s.wrapY,this._sampling=s.sampling,this._pixelFormat=s.pixelFormat,this._isMipMapped=!!s.mipMap&&this._renderer.AreMipmapsEnabled(),this._mipMapQuality=s.mipMapQuality,!gs.has(this._wrapX)||!gs.has(this._wrapY))throw new Error(\"invalid wrap mode\");if(!fs.has(this._sampling))throw new Error(\"invalid sampling\");if(!ps.has(this._pixelFormat))throw new Error(\"invalid pixel format\");if(!ms.has(this._mipMapQuality))throw new Error(\"invalid mipmap quality\");this._isStatic=!1,this._width=Math.floor(e),this._height=Math.floor(t);const i=ds.isPOT(this._width)&&ds.isPOT(this._height),r=this._renderer.GetMaxTextureSize();if(this._width<=0||this._height<=0)throw new Error(\"invalid texture size\");if(this._width>r||this._height>r)throw new Error(\"texture exceeds maximum texture size\");if(!this._renderer.SupportsNPOTTextures()&&this._IsTiled()&&!i)throw new Error(\"non-power-of-two tiled textures not supported\");const n=this._renderer.GetContext(),a=this._renderer.GetWebGLVersionNumber(),o=(this._texture=n.createTexture(),n.bindTexture(n.TEXTURE_2D,this._texture),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s.premultiplyAlpha),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1),d(this._pixelFormat,n)),h=2<=a?o.sizedinternalformat:o.internalformat;n.texImage2D(n.TEXTURE_2D,0,h,this._width,this._height,0,o.format,o.type,null),this._SetTextureParameters(n),n.bindTexture(n.TEXTURE_2D,null),this._renderer._ResetLastTexture(),this._refCount=1,Gs.add(this)}_GetMipMapHint(e){if(\"default\"===this._mipMapQuality)return this._isStatic?e.NICEST:e.FASTEST;if(\"low\"===this._mipMapQuality)return e.FASTEST;if(\"high\"===this._mipMapQuality)return e.NICEST;throw new Error(\"invalid mipmap quality\")}_IsTiled(){return\"clamp-to-edge\"!==this._wrapX||\"clamp-to-edge\"!==this._wrapY}_GetTextureWrapMode(e,t){if(\"clamp-to-edge\"===t)return e.CLAMP_TO_EDGE;if(\"repeat\"===t)return e.REPEAT;if(\"mirror-repeat\"===t)return e.MIRRORED_REPEAT;throw new Error(\"invalid wrap mode\")}_SetTextureParameters(e){const t=ds.isPOT(this._width)&&ds.isPOT(this._height);if(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,this._GetTextureWrapMode(e,this._wrapX)),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,this._GetTextureWrapMode(e,this._wrapY)),\"nearest\"===this._sampling)e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),this._isMipMapped=!1;else if(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),(t||this._renderer.SupportsNPOTTextures())&&this._isMipMapped){e.hint(e.GENERATE_MIPMAP_HINT,this._GetMipMapHint(e)),e.generateMipmap(e.TEXTURE_2D);const i=\"trilinear\"===this._sampling&&!this._renderer.HasMajorPerformanceCaveat();e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,i?e.LINEAR_MIPMAP_LINEAR:e.LINEAR_MIPMAP_NEAREST)}else e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),this._isMipMapped=!1;const s=this._renderer._GetAnisotropicExtension();s&&0<this._anisotropy&&\"nearest\"!==this._sampling&&e.texParameterf(e.TEXTURE_2D,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(this._anisotropy,this._renderer._GetMaxAnisotropy()))}_Update(e,t){if(!(\"undefined\"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||\"undefined\"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement||\"undefined\"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||\"undefined\"!=typeof ImageBitmap&&e instanceof ImageBitmap||\"undefined\"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas||e instanceof ImageData))throw new Error(\"invalid texture source\");if(!this._texture||this._refCount<=0)throw new Error(\"texture not created\");if(this._isStatic)throw new Error(\"cannot update static texture\");t=Object.assign({},ys,t);const s=e.width||e.videoWidth,i=e.height||e.videoHeight,r=this._renderer.GetWebGLVersionNumber(),n=this._renderer.GetContext(),a=(n.bindTexture(n.TEXTURE_2D,this._texture),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!!t.flipY),d(this._pixelFormat,n)),o=2<=r?a.sizedinternalformat:a.internalformat;try{if(this._width===s&&this._height===i){const h=ds.isPOT(this._width)&&ds.isPOT(this._height);n.texSubImage2D(n.TEXTURE_2D,0,0,0,a.format,a.type,e),(h||this._renderer.SupportsNPOTTextures())&&this._isMipMapped&&(n.hint(n.GENERATE_MIPMAP_HINT,this._GetMipMapHint(n)),n.generateMipmap(n.TEXTURE_2D))}else{this._width=s,this._height=i;const l=ds.isPOT(this._width)&&ds.isPOT(this._height);if(!this._renderer.SupportsNPOTTextures()&&this._IsTiled()&&!l)throw new Error(\"non-power-of-two tiled textures not supported\");n.texImage2D(n.TEXTURE_2D,0,o,a.format,a.type,e),(l||this._renderer.SupportsNPOTTextures())&&this._isMipMapped&&(n.hint(n.GENERATE_MIPMAP_HINT,this._GetMipMapHint(n)),n.generateMipmap(n.TEXTURE_2D))}}catch(e){console.error(\"Error updating WebGL texture: \",e)}n.bindTexture(n.TEXTURE_2D,null),this._renderer._ResetLastTexture()}_Delete(){if(0<this._refCount)throw new Error(\"texture still has references\");if(!this._texture)throw new Error(\"already deleted texture\");Gs.delete(this);const e=this._renderer.GetContext();e.deleteTexture(this._texture),this._texture=null}IsValid(){return!!this._texture}_GetTexture(){return this._texture}GetRenderer(){return this._renderer}AddReference(){this._refCount++}SubtractReference(){if(this._refCount<=0)throw new Error(\"no more references\");this._refCount--}GetReferenceCount(){return this._refCount}GetWidth(){return this._width}GetHeight(){return this._height}IsStatic(){return this._isStatic}GetEstimatedMemoryUsage(){let e=this._width*this._height;switch(this._pixelFormat){case\"rgba8\":e*=4;break;case\"rgb8\":e*=3;break;case\"rgba4\":case\"rgb5_a1\":case\"rgb565\":e*=2}return this._isMipMapped&&(e+=Math.floor(e/3)),e}static OnContextLost(){Gs.clear()}static allTextures(){return Gs.values()}}}{const Is=self.C3,Ts=self.glMatrix,br=Ts.vec3,Cr=Ts.mat4,Cs=new Set([\"nearest\",\"bilinear\",\"trilinear\"]),bs={sampling:\"trilinear\",alpha:!0,depth:!1,isSampled:!0,isDefaultSize:!0,multisampling:0},ws=new Set;Is.Gfx.WebGLRenderTarget=class{constructor(e){this._renderer=e,this._frameBuffer=null,this._frameBufferNoDepth=null,this._texture=null,this._renderBuffer=null,this._width=0,this._height=0,this._isDefaultSize=!0,this._sampling=\"trilinear\",this._alpha=!0,this._depth=!1,this._isSampled=!0,this._multisampling=0,this._projectionMatrix=Cr.create(),this._lastFov=0,this._lastNearZ=0,this._lastFarZ=0}_Create(e,t,s){s=Object.assign({},bs,s);const i=this._renderer.GetWebGLVersionNumber();if(this._texture||this._renderBuffer)throw new Error(\"already created render target\");if(this._sampling=s.sampling,this._alpha=!!s.alpha,this._depth=!!s.depth,this._isSampled=!!s.isSampled,this._isDefaultSize=!!s.isDefaultSize,this._multisampling=s.multisampling,!Cs.has(this._sampling))throw new Error(\"invalid sampling\");if(0<this._multisampling&&(i<2||this._isSampled))throw new Error(\"invalid use of multisampling\");if(i<2&&(this._isSampled=!0),this._width=e,this._height=t,this._width<=0||this._height<=0)throw new Error(\"invalid render target size\");this._CalculateProjection();const r=this._renderer.GetContext();if(this._frameBuffer=r.createFramebuffer(),this._depth&&(this._frameBufferNoDepth=r.createFramebuffer()),this._isSampled){this._texture=this._renderer.CreateDynamicTexture(this._width,this._height,{sampling:this._sampling,pixelFormat:this._alpha?\"rgba8\":\"rgb8\",mipMap:!1});const a=this._texture._GetTexture();r.bindFramebuffer(r.FRAMEBUFFER,this._frameBuffer),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,a,0),this._depth&&(r.bindFramebuffer(r.FRAMEBUFFER,this._frameBufferNoDepth),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,a,0))}else{this._renderBuffer=r.createRenderbuffer(),r.bindRenderbuffer(r.RENDERBUFFER,this._renderBuffer);const o=this._alpha?r.RGBA8:r.RGB8;if(0<this._multisampling){const h=r.getInternalformatParameter(r.RENDERBUFFER,o,r.SAMPLES);if(h&&h[0]){const l=h[0];this._multisampling>l&&(this._multisampling=l)}else this._multisampling=0}0===this._multisampling?r.renderbufferStorage(r.RENDERBUFFER,o,this._width,this._height):r.renderbufferStorageMultisample(r.RENDERBUFFER,this._multisampling,o,this._width,this._height),r.bindFramebuffer(r.FRAMEBUFFER,this._frameBuffer),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.RENDERBUFFER,this._renderBuffer),this._depth&&(r.bindFramebuffer(r.FRAMEBUFFER,this._frameBufferNoDepth),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.RENDERBUFFER,this._renderBuffer)),r.bindRenderbuffer(r.RENDERBUFFER,null)}const n=this._renderer._GetDepthBuffer();this._depth&&n&&(r.bindFramebuffer(r.FRAMEBUFFER,this._frameBuffer),this._renderer._CanSampleDepth()?r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.TEXTURE_2D,n,0):r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,n)),r.bindFramebuffer(r.FRAMEBUFFER,null),ws.add(this)}_Resize(e,t){if(this._width!==e||this._height!==t){this._width=e,this._height=t,this._CalculateProjection();const s=this._renderer.GetContext(),i=(s.bindFramebuffer(s.FRAMEBUFFER,this._frameBuffer),this._texture?this._texture._Update(new ImageData(this._width,this._height)):(s.bindRenderbuffer(s.RENDERBUFFER,this._renderBuffer),s.renderbufferStorage(s.RENDERBUFFER,this._alpha?s.RGBA8:s.RGB8,this._width,this._height),s.bindRenderbuffer(s.RENDERBUFFER,null)),this._renderer._GetDepthBuffer());this._depth&&i&&(this._renderer._CanSampleDepth()?s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.TEXTURE_2D,i,0):s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,i)),s.bindFramebuffer(s.FRAMEBUFFER,null)}}_Delete(){if(!this._texture&&!this._renderBuffer)throw new Error(\"already deleted render target\");ws.delete(this);const e=this._renderer.GetContext(),t=(this._texture?(e.bindFramebuffer(e.FRAMEBUFFER,this._frameBuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0),this._depth&&(e.bindFramebuffer(e.FRAMEBUFFER,this._frameBufferNoDepth),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)),this._renderer.DeleteTexture(this._texture),this._texture=null):this._renderBuffer&&(e.bindFramebuffer(e.FRAMEBUFFER,this._frameBuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,null),this._depth&&(e.bindFramebuffer(e.FRAMEBUFFER,this._frameBufferNoDepth),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,null)),e.deleteRenderbuffer(this._renderBuffer),this._renderBuffer=null),e.bindFramebuffer(e.FRAMEBUFFER,null),2<=this._renderer.GetWebGLVersionNumber()&&(e.bindFramebuffer(e.READ_FRAMEBUFFER,null),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null)),e.deleteFramebuffer(this._frameBuffer),this._depth&&e.deleteFramebuffer(this._frameBufferNoDepth),this._renderer.GetBatchState());t.currentFramebuffer=null,this._frameBuffer=t.currentFramebufferNoDepth=null}_CalculateProjection(){this._renderer.CalculatePerspectiveMatrix(this._projectionMatrix,this._width/this._height),this._lastFov=this._renderer.GetFovY(),this._lastNearZ=this._renderer.GetNearZ(),this._lastFarZ=this._renderer.GetFarZ()}_GetFramebuffer(){return this._frameBuffer}_GetFramebufferNoDepth(){return this._frameBufferNoDepth}GetRenderer(){return this._renderer}GetTexture(){return this._texture}GetProjectionMatrix(){return this._renderer.GetFovY()===this._lastFov&&this._renderer.GetNearZ()===this._lastNearZ&&this._renderer.GetFarZ()===this._lastFarZ||this._CalculateProjection(),this._projectionMatrix}IsLinearSampling(){return\"nearest\"!==this._sampling}HasAlpha(){return this._alpha}IsSampled(){return this._isSampled}HasDepthBuffer(){return this._depth}GetWidth(){return this._width}GetHeight(){return this._height}IsDefaultSize(){return this._isDefaultSize}GetMultisampling(){return this._multisampling}GetOptions(){const e={sampling:this._sampling,alpha:this._alpha,isSampled:this._isSampled};return this._isDefaultSize||(e.width=this._width,e.height=this._height),e}IsCompatibleWithOptions(e){return\"nearest\"!==(e=Object.assign({},bs,e)).sampling===this.IsLinearSampling()&&!!e.alpha===this.HasAlpha()&&!!e.depth===this.HasDepthBuffer()&&!(2<=this._renderer.GetWebGLVersionNumber()&&!!e.isSampled!==this.IsSampled())&&(\"number\"==typeof e.width||\"number\"==typeof e.height?!this.IsDefaultSize()&&this.GetWidth()===Math.floor(e.width)&&this.GetHeight()===Math.floor(e.height):this.IsDefaultSize())}_GetWebGLTexture(){return this._texture?this._texture._GetTexture():null}GetEstimatedMemoryUsage(){return this._texture?this._texture.GetEstimatedMemoryUsage():this._width*this._height*(this._alpha?4:3)}static async DebugReadPixelsToBlob(e,t){const s=await e.ReadBackRenderTargetToImageData(t,!0);return Is.ImageDataToBlob(s)}static OnContextLost(){ws.clear()}static allRenderTargets(){return ws.values()}static ResizeAll(e,t){for(const s of ws)s.IsDefaultSize()&&s._Resize(e,t)}}}{const f=self.C3,xs=self.glMatrix,br=xs.vec3,Cr=xs.mat4,vs=new Set([\"aPos\",\"aTex\",\"aPoints\",\"matP\",\"matMV\",\"samplerFront\",\"samplerBack\",\"samplerDepth\",\"destStart\",\"destEnd\",\"srcStart\",\"srcEnd\",\"srcOriginStart\",\"srcOriginEnd\",\"pixelSize\",\"seconds\",\"devicePixelRatio\",\"layerScale\",\"layerAngle\",\"layoutStart\",\"layoutEnd\",\"color\",\"color2_\",\"pointTexStart\",\"pointTexEnd\",\"zElevation\",\"tileSize\",\"tileSpacing\",\"outlineThickness\",\"zNear\",\"zFar\"]);f.Gfx.WebGLShaderProgram=class extends f.Gfx.ShaderProgramBase{static async Compile(e,t){const s=e.GetContext(),i=t.src,r=t.vertexSrc,n=t.name,a=s.createShader(s.FRAGMENT_SHADER),o=(s.shaderSource(a,i),s.compileShader(a),s.createShader(s.VERTEX_SHADER)),h=(s.shaderSource(o,r),s.compileShader(o),s.createProgram()),l=(s.attachShader(h,a),s.attachShader(h,o),s.bindAttribLocation(h,0,\"aPos\"),s.bindAttribLocation(h,1,\"aTex\"),s.bindAttribLocation(h,2,\"aPoints\"),s.linkProgram(h),e._GetParallelShaderCompileExtension());if(l?await e._WaitForObjectReady(()=>s.getProgramParameter(h,l.COMPLETION_STATUS_KHR)):await f.Wait(5),!s.getShaderParameter(a,s.COMPILE_STATUS)){const u=s.getShaderInfoLog(a);throw s.deleteShader(a),s.deleteShader(o),s.deleteProgram(h),new Error(\"Error compiling fragment shader: \"+u)}if(!s.getShaderParameter(o,s.COMPILE_STATUS)){const _=s.getShaderInfoLog(o);throw s.deleteShader(a),s.deleteShader(o),s.deleteProgram(h),new Error(\"Error compiling vertex shader: \"+_)}if(!s.getProgramParameter(h,s.LINK_STATUS)){const d=s.getProgramInfoLog(h);throw s.deleteShader(a),s.deleteShader(o),s.deleteProgram(h),new Error(\"Error linking shader program: \"+d)}const c=f.FilterUnprintableChars(s.getProgramInfoLog(h)||\"\").trim();return c&&!f.IsStringAllWhitespace(c)&&console.info(`[WebGL] Shader program '${n}' compilation log: `,c),s.deleteShader(a),s.deleteShader(o),h}static async Create(e,t){const s=await f.Gfx.WebGLShaderProgram.Compile(e,t);return new f.Gfx.WebGLShaderProgram(e,s,t)}constructor(e,t,s){super(e,s);const i=e.GetContext(),r=e.GetBatchState(),n=(e.EndBatch(),i.useProgram(t),this._gl=i,this._shaderProgram=t,this._isDeviceTransform=\"<default-device-transform>\"===s.name,i.getAttribLocation(t,\"aPos\")),a=i.getAttribLocation(t,\"aTex\"),o=(this._locAPoints=i.getAttribLocation(t,\"aPoints\"),-1!==n&&(i.bindBuffer(i.ARRAY_BUFFER,e._vertexBuffer),i.vertexAttribPointer(n,e.GetNumVertexComponents(),i.FLOAT,!1,0,0),i.enableVertexAttribArray(n)),-1!==a&&(i.bindBuffer(i.ARRAY_BUFFER,e._texcoordBuffer),i.vertexAttribPointer(a,2,i.FLOAT,!1,0,0),i.enableVertexAttribArray(a)),-1!==this._locAPoints&&(i.bindBuffer(i.ARRAY_BUFFER,e._pointBuffer),i.vertexAttribPointer(this._locAPoints,4,i.FLOAT,!1,0,0),i.enableVertexAttribArray(this._locAPoints)),i.bindBuffer(i.ARRAY_BUFFER,null),this._uMatP=new f.Gfx.WebGLShaderUniform(this,\"matP\",\"mat4\"),this._uMatMV=new f.Gfx.WebGLShaderUniform(this,\"matMV\",\"mat4\"),this._uColor=new f.Gfx.WebGLShaderUniform(this,\"color\",\"vec4\"),this._uSamplerFront=new f.Gfx.WebGLShaderUniform(this,\"samplerFront\",\"sampler\"),this._uPointTexStart=new f.Gfx.WebGLShaderUniform(this,\"pointTexStart\",\"vec2\"),this._uPointTexEnd=new f.Gfx.WebGLShaderUniform(this,\"pointTexEnd\",\"vec2\"),this._uZElevation=new f.Gfx.WebGLShaderUniform(this,\"zElevation\",\"float\"),this._uTileSize=new f.Gfx.WebGLShaderUniform(this,\"tileSize\",\"vec2\"),this._uTileSpacing=new f.Gfx.WebGLShaderUniform(this,\"tileSpacing\",\"vec2\"),this._uColor2=new f.Gfx.WebGLShaderUniform(this,\"color2_\",\"vec4\"),this._uOutlineThickness=new f.Gfx.WebGLShaderUniform(this,\"outlineThickness\",\"float\"),this._uSamplerBack=new f.Gfx.WebGLShaderUniform(this,\"samplerBack\",\"sampler\"),this._uSamplerDepth=new f.Gfx.WebGLShaderUniform(this,\"samplerDepth\",\"sampler\"),this._uDestStart=new f.Gfx.WebGLShaderUniform(this,\"destStart\",\"vec2\"),this._uDestEnd=new f.Gfx.WebGLShaderUniform(this,\"destEnd\",\"vec2\"),this._uSrcStart=new f.Gfx.WebGLShaderUniform(this,\"srcStart\",\"vec2\"),this._uSrcEnd=new f.Gfx.WebGLShaderUniform(this,\"srcEnd\",\"vec2\"),this._uSrcOriginStart=new f.Gfx.WebGLShaderUniform(this,\"srcOriginStart\",\"vec2\"),this._uSrcOriginEnd=new f.Gfx.WebGLShaderUniform(this,\"srcOriginEnd\",\"vec2\"),this._uPixelSize=new f.Gfx.WebGLShaderUniform(this,\"pixelSize\",\"vec2\"),this._uSeconds=new f.Gfx.WebGLShaderUniform(this,\"seconds\",\"float\"),this._uDevicePixelRatio=new f.Gfx.WebGLShaderUniform(this,\"devicePixelRatio\",\"float\"),this._uLayerScale=new f.Gfx.WebGLShaderUniform(this,\"layerScale\",\"float\"),this._uLayerAngle=new f.Gfx.WebGLShaderUniform(this,\"layerAngle\",\"float\"),this._uLayoutStart=new f.Gfx.WebGLShaderUniform(this,\"layoutStart\",\"vec2\"),this._uLayoutEnd=new f.Gfx.WebGLShaderUniform(this,\"layoutEnd\",\"vec2\"),this._uZNear=new f.Gfx.WebGLShaderUniform(this,\"zNear\",\"float\"),this._uZFar=new f.Gfx.WebGLShaderUniform(this,\"zFar\",\"float\"),this._hasAnyOptionalUniforms=!!(this._uPixelSize.IsUsed()||this._uSeconds.IsUsed()||this._uSamplerBack.IsUsed()||this._uDestStart.IsUsed()||this._uDestEnd.IsUsed()||this._uSrcStart.IsUsed()||this._uSrcEnd.IsUsed()||this._uSrcOriginStart.IsUsed()||this._uSrcOriginEnd.IsUsed()||this._uDevicePixelRatio.IsUsed()||this._uLayerScale.IsUsed()||this._uLayerAngle.IsUsed()||this._uLayoutStart.IsUsed()||this._uLayoutEnd.IsUsed()),s.parameters||[]);this._uCustomParameters=[],this._usesAnySrcRectOrPixelSize=this._uPixelSize.IsUsed()||this._uSrcStart.IsUsed()||this._uSrcEnd.IsUsed()||this._uSrcOriginStart.IsUsed()||this._uSrcOriginEnd.IsUsed(),this._hasCurrentMatP=!1,this._hasCurrentMatMV=!1,this._uColor.Init4f(1,1,1,1),this._uColor2.Init4f(1,1,1,1),this._uSamplerFront.Init1i(0),this._uSamplerBack.Init1i(1),this._uSamplerDepth.Init1i(2),this._uPointTexStart.Init2f(0,0),this._uPointTexEnd.Init2f(1,1),this._uZElevation.Init1f(0),this._uTileSize.Init2f(0,0),this._uTileSpacing.Init2f(0,0),this._uDestStart.Init2f(0,0),this._uDestEnd.Init2f(1,1),this._uSrcStart.Init2f(0,0),this._uSrcEnd.Init2f(0,0),this._uSrcOriginStart.Init2f(0,0),this._uSrcOriginEnd.Init2f(0,0),this._uPixelSize.Init2f(0,0),this._uDevicePixelRatio.Init1f(1),this._uZNear.Init1f(e.GetNearZ()),this._uZFar.Init1f(e.GetFarZ()),this._uLayerScale.Init1f(1),this._uLayerAngle.Init1f(0),this._uSeconds.Init1f(0),this._uLayoutStart.Init2f(0,0),this._uLayoutEnd.Init2f(0,0),this._uOutlineThickness.Init1f(1);for(const l of o){const c=l[0],u=l[2],_=new f.Gfx.WebGLShaderUniform(this,c,u);\"color\"===u?_.Init3f(0,0,0):_.Init1f(0),this._uCustomParameters.push(_)}this._isDeviceTransform?this._UpdateDeviceTransformUniforms(r.currentMatP):(this.UpdateMatP(r.currentMatP,!0),this.UpdateMatMV(r.currentMV,!0));const h=r.currentShader;i.useProgram(h?h._shaderProgram:null)}Release(){this._gl.deleteProgram(this._shaderProgram),this._shaderProgram=null,this._renderer._RemoveShaderProgram(this),this._gl=null,super.Release()}GetWebGLContext(){return this._gl}GetShaderProgram(){return this._shaderProgram}GetParameterCount(){return this._uCustomParameters.length}GetParameterType(e){return e<0||e>=this._uCustomParameters.length?null:this._uCustomParameters[e].GetType()}AreCustomParametersAlreadySetInBatch(s){for(let e=0,t=s.length;e<t;++e)if(!this._uCustomParameters[e].IsSetToCustomInBatch(s[e]))return!1;return!0}SetCustomParametersInBatch(s){for(let e=0,t=s.length;e<t;++e)this._uCustomParameters[e].SetBatchValueCustom(s[e])}AreOptionalUniformsAlreadySetInBatch(e,t,s,i,r,n,a,o,h,l){return!this._uSamplerBack.IsUsed()&&!(this._uPixelSize.IsUsed()&&!this._uPixelSize.IsSetTo2InBatch(r,n)||this._uDestStart.IsUsed()&&!this._uDestStart.IsSetTo2InBatch(e.getLeft(),e.getTop())||this._uDestEnd.IsUsed()&&!this._uDestEnd.IsSetTo2InBatch(e.getRight(),e.getBottom())||this._uDevicePixelRatio.IsUsed()&&!this._uDevicePixelRatio.IsSetTo1InBatch(a)||this._uLayerScale.IsUsed()&&!this._uLayerScale.IsSetTo1InBatch(o)||this._uLayerAngle.IsUsed()&&!this._uLayerAngle.IsSetTo1InBatch(h)||this._uSrcStart.IsUsed()&&!this._uSrcStart.IsSetTo2InBatch(t.getLeft(),t.getTop())||this._uSrcEnd.IsUsed()&&!this._uSrcEnd.IsSetTo2InBatch(t.getRight(),t.getBottom())||this._uSrcOriginStart.IsUsed()&&!this._uSrcOriginStart.IsSetTo2InBatch(s.getLeft(),s.getTop())||this._uSrcOriginEnd.IsUsed()&&!this._uSrcOriginEnd.IsSetTo2InBatch(s.getRight(),s.getBottom())||this._uLayoutStart.IsUsed()&&!this._uLayoutStart.IsSetTo2InBatch(i.getLeft(),i.getTop())||this._uLayoutEnd.IsUsed()&&!this._uLayoutEnd.IsSetTo2InBatch(i.getTop(),i.getBottom())||this._uSeconds.IsUsed()&&!this._uSeconds.IsSetTo1InBatch(l))}SetOptionalUniformsInBatch(e,t,s,i,r,n,a,o,h,l){this._uSamplerBack.IsUsed()||(this._uPixelSize.IsUsed()&&this._uPixelSize.SetBatch2(r,n),this._uDestStart.IsUsed()&&this._uDestStart.SetBatch2(e.getLeft(),e.getTop()),this._uDestEnd.IsUsed()&&this._uDestEnd.SetBatch2(e.getRight(),e.getBottom()),this._uDevicePixelRatio.IsUsed()&&this._uDevicePixelRatio.SetBatch1(a),this._uLayerScale.IsUsed()&&this._uLayerScale.SetBatch1(o),this._uLayerAngle.IsUsed()&&this._uLayerAngle.SetBatch1(h),this._uSrcStart.IsUsed()&&this._uSrcStart.SetBatch2(t.getLeft(),t.getTop()),this._uSrcEnd.IsUsed()&&this._uSrcEnd.SetBatch2(t.getRight(),t.getBottom()),this._uSrcOriginStart.IsUsed()&&this._uSrcOriginStart.SetBatch2(s.getLeft(),s.getTop()),this._uSrcOriginEnd.IsUsed()&&this._uSrcOriginEnd.SetBatch2(s.getRight(),s.getBottom()),this._uLayoutStart.IsUsed()&&this._uLayoutStart.SetBatch2(i.getLeft(),i.getTop()),this._uLayoutEnd.IsUsed()&&this._uLayoutEnd.SetBatch2(i.getTop(),i.getBottom()),this._uSeconds.IsUsed()&&this._uSeconds.SetBatch1(l))}UpdateMatP(e,t){this._hasCurrentMatP&&!t||this._isDeviceTransform||(this._uMatP.IsUsed()&&this._uMatP.UpdateMatrix4fv(e),this._hasCurrentMatP=!0)}SetMatPStale(){this._hasCurrentMatP=!1}UpdateMatMV(e,t){this._hasCurrentMatMV&&!t||this._isDeviceTransform||(this._uMatMV.IsUsed()&&this._uMatMV.UpdateMatrix4fv(e),this._hasCurrentMatMV=!0)}SetMatMVStale(){this._hasCurrentMatMV=!1}_UpdateDeviceTransformUniforms(e){if(!this._isDeviceTransform)throw new Error(\"not device transform shader\");this._uMatP.UpdateMatrix4fv(e);const t=this._renderer,s=t.GetWidth()/2,i=t.GetHeight()/2,r=t.CalculateLookAtModelView2(s,i,t.GetDefaultCameraZ(t.GetHeight()),s,i,0,t.GetHeight());this._uMatMV.UpdateMatrix4fv(r)}UpdateColor(e){this._uColor.IsUsed()&&this._uColor.Update4f(e[0],e[1],e[2],e[3])}static GetReservedUniformNames(){return vs}static GetDefaultVertexShaderSource(e){const t=e?\"highmedp\":\"mediump\";return[\"#ifdef GL_FRAGMENT_PRECISION_HIGH\",\"#define highmedp highp\",\"#else\",\"#define highmedp mediump\",\"#endif\",\"attribute highp vec3 aPos;\",`attribute ${t} vec2 aTex;`,`varying ${t} vec2 vTex;`,\"uniform highp mat4 matP;\",\"uniform highp mat4 matMV;\",\"void main(void) {\",`\tgl_Position = matP * matMV * vec4(aPos, 1.0);`,`\tvTex = aTex;`,\"}\"].join(\"\\n\")}static GetDefaultVertexShaderSource_WebGL2(e){const t=e?\"highp\":\"mediump\";return[\"#version 300 es\",\"in highp vec3 aPos;\",`in ${t} vec2 aTex;`,`out ${t} vec2 vTex;`,\"uniform highp mat4 matP;\",\"uniform highp mat4 matMV;\",\"void main(void) {\",`\tgl_Position = matP * matMV * vec4(aPos, 1.0);`,`\tvTex = aTex;`,\"}\"].join(\"\\n\")}static GetTextureFillFragmentShaderSource_WebGL1_NoFragDepth(){return[\"varying mediump vec2 vTex;\",\"uniform lowp vec4 color;\",\"uniform lowp sampler2D samplerFront;\",\"void main(void) {\",\"\\tgl_FragColor = texture2D(samplerFront, vTex) * color;\",\"}\"].join(\"\\n\")}static GetTextureFillFragmentShaderSource_WebGL1_FragDepthEXT(){return[\"#extension GL_EXT_frag_depth : enable\",\"varying mediump vec2 vTex;\",\"uniform lowp vec4 color;\",\"uniform lowp sampler2D samplerFront;\",\"void main(void) {\",\"\\tgl_FragColor = texture2D(samplerFront, vTex) * color;\",\"\\tgl_FragDepthEXT = (gl_FragColor.a == 0.0 ? 1.0 : gl_FragCoord.z);\",\"}\"].join(\"\\n\")}static GetTextureFillFragmentShaderSource_WebGL2(){return[\"#version 300 es\",\"in mediump vec2 vTex;\",\"out lowp vec4 outColor;\",\"uniform lowp vec4 color;\",\"uniform lowp sampler2D samplerFront;\",\"void main(void) {\",\"\\toutColor = texture(samplerFront, vTex) * color;\",\"\\tgl_FragDepth = (outColor.a == 0.0 ? 1.0 : gl_FragCoord.z);\",\"}\"].join(\"\\n\")}static GetTilemapFragmentShaderSource_WebGL1_NoFragDepth(){return[\"#ifdef GL_FRAGMENT_PRECISION_HIGH\",\"#define highmedp highp\",\"#else\",\"#define highmedp mediump\",\"#endif\",\"varying highmedp vec2 vTex;\",\"uniform lowp vec4 color;\",\"uniform lowp sampler2D samplerFront;\",\"uniform highmedp vec2 srcStart;\",\"uniform highmedp vec2 pixelSize;\",\"uniform highmedp vec2 tileSize;\",\"uniform highmedp vec2 tileSpacing;\",\"void main(void) {\",\"\\thighmedp vec2 tile = floor(vTex);\",\"\\thighmedp vec2 tex = fract(vTex);\",\"\\thighmedp vec2 tileOrigin = srcStart + tile * (tileSize + tileSpacing);\",\"\\thighmedp vec2 lowerBound = tileOrigin + pixelSize / 2.0;\",\"\\thighmedp vec2 upperBound = tileOrigin + tileSize - pixelSize / 2.0;\",\"\\tgl_FragColor = texture2D(samplerFront, clamp(tex, lowerBound, upperBound), -16.0) * color;\",\"}\"].join(\"\\n\")}static GetTilemapFragmentShaderSource_WebGL1_FragDepthEXT(){return[\"#extension GL_EXT_frag_depth : enable\",\"#ifdef GL_FRAGMENT_PRECISION_HIGH\",\"#define highmedp highp\",\"#else\",\"#define highmedp mediump\",\"#endif\",\"varying highmedp vec2 vTex;\",\"uniform lowp vec4 color;\",\"uniform lowp sampler2D samplerFront;\",\"uniform highmedp vec2 srcStart;\",\"uniform highmedp vec2 pixelSize;\",\"uniform highmedp vec2 tileSize;\",\"uniform highmedp vec2 tileSpacing;\",\"void main(void) {\",\"\\thighmedp vec2 tile = floor(vTex);\",\"\\thighmedp vec2 tex = fract(vTex);\",\"\\thighmedp vec2 tileOrigin = srcStart + tile * (tileSize + tileSpacing);\",\"\\thighmedp vec2 lowerBound = tileOrigin + pixelSize / 2.0;\",\"\\thighmedp vec2 upperBound = tileOrigin + tileSize - pixelSize / 2.0;\",\"\\tgl_FragColor = texture2D(samplerFront, clamp(tex, lowerBound, upperBound), -16.0) * color;\",\"\\tgl_FragDepthEXT = (gl_FragColor.a == 0.0 ? 1.0 : gl_FragCoord.z);\",\"}\"].join(\"\\n\")}static GetTilemapFragmentShaderSource_WebGL2(){return[\"#version 300 es\",\"in highp vec2 vTex;\",\"out lowp vec4 outColor;\",\"uniform lowp vec4 color;\",\"uniform lowp sampler2D samplerFront;\",\"uniform highp vec2 srcStart;\",\"uniform highp vec2 pixelSize;\",\"uniform highp vec2 tileSize;\",\"uniform highp vec2 tileSpacing;\",\"void main(void) {\",\"\\thighp vec2 tile = floor(vTex);\",\"\\thighp vec2 tex = fract(vTex);\",\"\\thighp vec2 tileOrigin = srcStart + tile * (tileSize + tileSpacing);\",\"\\thighp vec2 lowerBound = tileOrigin + pixelSize / 2.0;\",\"\\thighp vec2 upperBound = tileOrigin + tileSize - pixelSize / 2.0;\",\"\\toutColor = texture(samplerFront, clamp(tex, lowerBound, upperBound), -16.0) * color;\",\"\\tgl_FragDepth = (outColor.a == 0.0 ? 1.0 : gl_FragCoord.z);\",\"}\"].join(\"\\n\")}static GetTileRandomizationFragmentShaderSource(e,t,s){let i=\"\";return 2<=e?i=\"#version 300 es\\n\":(t&&(i=\"#extension GL_EXT_frag_depth : enable\\n\"),s&&(i+=\"#extension GL_EXT_shader_texture_lod : enable\\n#extension GL_OES_standard_derivatives : enable\\n\")),i+`\n#ifdef GL_FRAGMENT_PRECISION_HIGH\n#define highmedp highp\n#else\n#define highmedp mediump\n#endif\nprecision highmedp float;\n${2<=e?\"in\":\"varying\"} vec2 vTex;\n${2<=e?\"out lowp vec4 outColor;\":\"\"}\nuniform lowp vec4 color;\nuniform lowp sampler2D samplerFront;\nuniform vec2 pixelSize;\n\nuniform vec2 tileSize;\nuniform vec2 tileSpacing;\nuniform float outlineThickness;\n\nconst float PI = 3.1415926;\n\nlowp vec4 cospVec4(lowp vec4 a, lowp vec4 b, float x)\n{\n\treturn (a + b + (a - b) * cos(x * PI)) / 2.0;\n}\n\nvec3 randVec3(vec2 seed)\n{\n\treturn vec3(fract(sin(dot(seed.xy + vec2(0.1, 0.1), vec2(12.9898,78.233))) * 43758.5453),\n\t\t\t\tfract(sin(dot(seed.yx + vec2(0.1, 0.1), vec2(12.9898,-78.233))) * 43758.5453),\n\t\t\t\tfract(sin(dot(seed.xy + vec2(0.1, 0.1), vec2(-12.9898,-78.233))) * 43758.5453));\n}\n\nlowp vec4 sampleTile(vec2 tile, vec2 uv, vec2 ddx, vec2 ddy)\n{\n\tvec2 posRandom = tileSize;\n\tfloat angleRandom = outlineThickness;\n\t\n\tvec3 rand = (randVec3(floor(tile + 0.5)) - 0.5) * 2.0;\n\t\n\tfloat angle = angleRandom * rand.z * PI;\n\tfloat sin_a = sin(angle);\n\tfloat cos_a = cos(angle);\n\tfloat aspect = pixelSize.x / pixelSize.y;\n\n\tvec2 mid = tile + vec2(0.5, 0.5);\n\tvec2 dp = uv - mid;\n\tdp.x /= aspect;\n\tvec2 r = vec2(dp.x * cos_a - dp.y * sin_a,\n\t\t\t\t  dp.y * cos_a + dp.x * sin_a);\n\tr.x *= aspect;\n\n\tvec2 p = mid + r + (posRandom * rand.xy / 2.0);\n\t\n\t${2<=e?\"return textureGrad(samplerFront, p, ddx, ddy);\":\"\"}\n\t${e<2&&s?\"return texture2DGradEXT(samplerFront, p, ddx, ddy);\":\"\"}\n\t${e<2&&!s?\"return texture2D(samplerFront, p);\":\"\"}\n}\n\nvoid main(void) {\n\t\n\t${e<2?\"lowp vec4 outColor;\":\"\"}\n\t\n\tfloat blendMarginX = tileSpacing.x;\n\tfloat blendMarginY = tileSpacing.y;\n\t\n\tvec2 tile = floor(vTex);\n\tvec2 tex = fract(vTex);\n\tvec2 ddx = ${2<=e||s?\"dFdx(vTex)\":\"vec2(0.0, 0.0)\"};\n\tvec2 ddy = ${2<=e||s?\"dFdy(vTex)\":\"vec2(0.0, 0.0)\"};\n\t\n\tvec4 curTile = sampleTile(tile, vTex, ddx, ddy);\n\t\n\tbool inLeftMargin = (tex.x < blendMarginX);\n\tbool inRightMargin = (tex.x > 1.0 - blendMarginX);\n\tbool inTopMargin = (tex.y < blendMarginY);\n\tbool inBottomMargin = (tex.y > 1.0 - blendMarginY);\n\t\n\tif (inLeftMargin)\n\t{\n\t\tlowp vec4 leftTile = sampleTile(tile + vec2(-1.0, 0.0), vTex, ddx, ddy);\n\t\tfloat leftMix = (tex.x / (blendMarginX * 2.0)) + 0.5;\n\t\tlowp vec4 leftMixedTile = cospVec4(leftTile, curTile, leftMix);\n\t\t\n\t\tif (inTopMargin)\n\t\t{\n\t\t\tlowp vec4 topTile =     sampleTile(tile + vec2(0.0,  -1.0), vTex, ddx, ddy);\n\t\t\tlowp vec4 topLeftTile = sampleTile(tile + vec2(-1.0, -1.0), vTex, ddx, ddy);\n\t\t\tlowp vec4 topLeftMixedTile = cospVec4(topLeftTile, topTile, leftMix);\n\t\t\t\n\t\t\toutColor = cospVec4(topLeftMixedTile, leftMixedTile, (tex.y / (blendMarginY * 2.0)) + 0.5);\n\t\t}\n\t\telse if (inBottomMargin)\n\t\t{\n\t\t\tlowp vec4 bottomTile =     sampleTile(tile + vec2(0.0,  1.0), vTex, ddx, ddy);\n\t\t\tlowp vec4 bottomLeftTile = sampleTile(tile + vec2(-1.0, 1.0), vTex, ddx, ddy);\n\t\t\tlowp vec4 bottomLeftMixedTile = cospVec4(bottomLeftTile, bottomTile, leftMix);\n\t\t\t\n\t\t\toutColor = cospVec4(leftMixedTile, bottomLeftMixedTile, (tex.y - (1.0 - blendMarginY)) / (blendMarginY * 2.0));\n\t\t}\n\t\telse\n\t\t{\n\t\t\toutColor = leftMixedTile;\n\t\t}\n\t}\n\telse if (inRightMargin)\n\t{\n\t\tlowp vec4 rightTile = sampleTile(tile + vec2(1.0, 0.0), vTex, ddx, ddy);\n\t\tfloat rightMix = (tex.x - (1.0 - blendMarginX)) / (blendMarginX * 2.0);\n\t\tlowp vec4 rightMixedTile = cospVec4(curTile, rightTile, rightMix);\n\t\t\n\t\tif (inTopMargin)\n\t\t{\n\t\t\tlowp vec4 topTile =      sampleTile(tile + vec2(0.0, -1.0), vTex, ddx, ddy);\n\t\t\tlowp vec4 topRightTile = sampleTile(tile + vec2(1.0, -1.0), vTex, ddx, ddy);\n\t\t\tlowp vec4 topRightMixedTile = cospVec4(topTile, topRightTile, rightMix);\n\t\t\t\n\t\t\toutColor = cospVec4(topRightMixedTile, rightMixedTile, (tex.y / (blendMarginY * 2.0)) + 0.5);\n\t\t}\n\t\telse if (inBottomMargin)\n\t\t{\n\t\t\tlowp vec4 bottomTile =      sampleTile(tile + vec2(0.0, 1.0), vTex, ddx, ddy);\n\t\t\tlowp vec4 bottomRightTile = sampleTile(tile + vec2(1.0, 1.0), vTex, ddx, ddy);\n\t\t\tlowp vec4 bottomRightMixedTile = cospVec4(bottomTile, bottomRightTile, rightMix);\n\t\t\t\n\t\t\toutColor = cospVec4(rightMixedTile, bottomRightMixedTile, (tex.y - (1.0 - blendMarginY)) / (blendMarginY * 2.0));\n\t\t}\n\t\telse\n\t\t{\n\t\t\toutColor = rightMixedTile;\n\t\t}\n\t}\n\telse if (inTopMargin)\n\t{\n\t\tlowp vec4 topTile = sampleTile(tile + vec2(0.0, -1.0), vTex, ddx, ddy);\n\t\toutColor = cospVec4(topTile, curTile, (tex.y / (blendMarginY * 2.0)) + 0.5);\n\t}\n\telse if (inBottomMargin)\n\t{\n\t\tlowp vec4 bottomTile = sampleTile(tile + vec2(0.0, 1.0), vTex, ddx, ddy);\n\t\toutColor = cospVec4(curTile, bottomTile, (tex.y - (1.0 - blendMarginY)) / (blendMarginY * 2.0));\n\t}\n\telse\n\t{\n\t\toutColor = curTile;\n\t}\n\t\n\toutColor *= color;\n\t${e<2?\"gl_FragColor = outColor;\":\"\"}\n\t${2<=e?\"gl_FragDepth = (outColor.a == 0.0 ? 1.0 : gl_FragCoord.z);\":\"\"}\n\t${e<2&&t?\"gl_FragDepthEXT = (outColor.a == 0.0 ? 1.0 : gl_FragCoord.z);\":\"\"}\n}\n`}static GetPointVertexShaderSource_WebGL1(){return[\"attribute vec4 aPoints;\",\"varying float pointOpacity;\",\"uniform float zElevation;\",\"uniform mat4 matP;\",\"uniform mat4 matMV;\",\"void main(void) {\",\"\\tgl_Position = matP * matMV * vec4(aPoints.xy, zElevation, 1.0);\",\"\\tgl_PointSize = aPoints.z;\",\"\\tpointOpacity = aPoints.w;\",\"}\"].join(\"\\n\")}static GetPointVertexShaderSource_WebGL2(){return[\"#version 300 es\",\"in vec4 aPoints;\",\"out float pointOpacity;\",\"uniform float zElevation;\",\"uniform mat4 matP;\",\"uniform mat4 matMV;\",\"void main(void) {\",\"\\tgl_Position = matP * matMV * vec4(aPoints.xy, zElevation, 1.0);\",\"\\tgl_PointSize = aPoints.z;\",\"\\tpointOpacity = aPoints.w;\",\"}\"].join(\"\\n\")}static GetPointFragmentShaderSource_WebGL1_NoFragDepth(){return[\"uniform lowp sampler2D samplerFront;\",\"varying lowp float pointOpacity;\",\"uniform mediump vec2 pointTexStart;\",\"uniform mediump vec2 pointTexEnd;\",\"uniform lowp vec4 color;\",\"void main(void) {\",\"\\tmediump vec2 pointTexMin = min(pointTexStart, pointTexEnd);\",\"\\tmediump vec2 pointTexMax = max(pointTexStart, pointTexEnd);\",\"\\tmediump vec2 pointCoord = (pointTexEnd.x > pointTexStart.x ? gl_PointCoord : vec2(1.0 - gl_PointCoord.y, gl_PointCoord.x));\",\"\\tgl_FragColor = texture2D(samplerFront, mix(pointTexMin, pointTexMax, pointCoord)) * color * pointOpacity;\",\"}\"].join(\"\\n\")}static GetPointFragmentShaderSource_WebGL1_FragDepthEXT(){return[\"#extension GL_EXT_frag_depth : enable\",\"uniform lowp sampler2D samplerFront;\",\"varying lowp float pointOpacity;\",\"uniform mediump vec2 pointTexStart;\",\"uniform mediump vec2 pointTexEnd;\",\"uniform lowp vec4 color;\",\"void main(void) {\",\"\\tmediump vec2 pointTexMin = min(pointTexStart, pointTexEnd);\",\"\\tmediump vec2 pointTexMax = max(pointTexStart, pointTexEnd);\",\"\\tmediump vec2 pointCoord = (pointTexEnd.x > pointTexStart.x ? gl_PointCoord : vec2(1.0 - gl_PointCoord.y, gl_PointCoord.x));\",\"\\tgl_FragColor = texture2D(samplerFront, mix(pointTexMin, pointTexMax, pointCoord)) * color * pointOpacity;\",\"\\tgl_FragDepthEXT = (gl_FragColor.a == 0.0 ? 1.0 : gl_FragCoord.z);\",\"}\"].join(\"\\n\")}static GetPointFragmentShaderSource_WebGL2(){return[\"#version 300 es\",\"uniform lowp sampler2D samplerFront;\",\"in lowp float pointOpacity;\",\"uniform mediump vec2 pointTexStart;\",\"uniform mediump vec2 pointTexEnd;\",\"uniform lowp vec4 color;\",\"out lowp vec4 outColor;\",\"void main(void) {\",\"\\tmediump vec2 pointTexMin = min(pointTexStart, pointTexEnd);\",\"\\tmediump vec2 pointTexMax = max(pointTexStart, pointTexEnd);\",\"\\tmediump vec2 pointCoord = (pointTexEnd.x > pointTexStart.x ? gl_PointCoord : vec2(1.0 - gl_PointCoord.y, gl_PointCoord.x));\",\"\\toutColor = texture(samplerFront, mix(pointTexMin, pointTexMax, pointCoord)) * color * pointOpacity;\",\"\\tgl_FragDepth = (outColor.a == 0.0 ? 1.0 : gl_FragCoord.z);\",\"}\"].join(\"\\n\")}static GetColorFillFragmentShaderSource(){return[\"uniform lowp vec4 color;\",\"void main(void) {\",\"\\tgl_FragColor = color;\",\"}\"].join(\"\\n\")}static GetLinearGradientFillFragmentShaderSource(){return[\"precision lowp float;\",\"varying mediump vec2 vTex;\",\"uniform vec4 color;\",\"uniform vec4 color2_;\",\"vec3 fromLinear(vec3 linearRGB)\",\"{\",\"\\tbvec3 cutoff = lessThan(linearRGB, vec3(0.0031308));\",\"\\tvec3 higher = vec3(1.055) * pow(abs(linearRGB), vec3(1.0/2.4)) - vec3(0.055);\",\"\\tvec3 lower = linearRGB * vec3(12.92);\",\"\\treturn mix(higher, lower, vec3(cutoff));\",\"}\",\"vec3 toLinear(vec3 sRGB)\",\"{\",\"\\tbvec3 cutoff = lessThan(sRGB, vec3(0.04045));\",\"\\tvec3 higher = pow(abs((sRGB + vec3(0.055))/vec3(1.055)), vec3(2.4));\",\"\\tvec3 lower = sRGB/vec3(12.92);\",\"\\treturn mix(higher, lower, vec3(cutoff));\",\"}\",\"void main(void) {\",\"\\tvec3 linearGrad = mix(toLinear(color.rgb), toLinear(color2_.rgb), vTex.x);\",\"\\tfloat a = mix(color.a, color2_.a, vTex.x);\",\"\\tgl_FragColor = vec4(fromLinear(linearGrad) * a, a);\",\"}\"].join(\"\\n\")}static GetPenumbraFillFragmentShaderSource(){return[\"#ifdef GL_FRAGMENT_PRECISION_HIGH\",\"#define highmedp highp\",\"#else\",\"#define highmedp mediump\",\"#endif\",\"precision lowp float;\",\"varying highmedp vec2 vTex;\",\"uniform vec4 color;\",\"void main(void) {\",`\thighmedp float grad = vTex.x / (1.0 - vTex.y);`,`\tgl_FragColor = color * (1.0 - (cos(grad * 3.141592653589793) + 1.0) / 2.0);`,\"}\"].join(\"\\n\")}static GetSmoothLineFillFragmentShaderSource(){return[\"varying mediump vec2 vTex;\",\"uniform lowp vec4 color;\",\"void main(void) {\",\"\\tlowp float f = 1.0 - abs(vTex.y - 0.5) * 2.0;\",\"\\tgl_FragColor = color * f;\",\"}\"].join(\"\\n\")}static GetHardEllipseFillFragmentShaderSource(){return[\"varying mediump vec2 vTex;\",\"uniform lowp vec4 color;\",\"void main(void) {\",\"\\tmediump vec2 diff = vTex - vec2(0.5, 0.5);\",\"\\tmediump vec2 diffSq = diff * diff;\",\"\\tmediump float f = step(diffSq.x + diffSq.y, 0.25);\",\"\\tgl_FragColor = color * f;\",\"}\"].join(\"\\n\")}static GetHardEllipseOutlineFragmentShaderSource(){return[\"varying mediump vec2 vTex;\",\"uniform lowp vec4 color;\",\"uniform mediump vec2 pixelSize;\",\"uniform mediump float outlineThickness;\",\"void main(void) {\",\"\\tmediump vec2 diff = vTex - vec2(0.5, 0.5);\",\"\\tmediump vec2 diffSq = diff * diff;\",\"\\tmediump float distSq = diffSq.x + diffSq.y;\",\"\\tmediump vec2 norm = normalize(diff);\",\"\\tmediump vec2 halfNorm = norm * 0.5;\",\"\\tmediump float innerF = step(distSq, 0.25);\",\"\\tmediump vec2 innerEdge = halfNorm - pixelSize * norm * outlineThickness;\",\"\\tmediump vec2 innerEdgeSq = innerEdge * innerEdge;\",\"\\tmediump float outerF = step(innerEdgeSq.x + innerEdgeSq.y, distSq);\",\"\\tgl_FragColor = color * innerF * outerF;\",\"}\"].join(\"\\n\")}static GetSmoothEllipseFillFragmentShaderSource(){return[\"varying mediump vec2 vTex;\",\"uniform lowp vec4 color;\",\"uniform mediump vec2 pixelSize;\",\"void main(void) {\",\"\\tmediump vec2 diff = vTex - vec2(0.5, 0.5);\",\"\\tmediump vec2 diffSq = diff * diff;\",\"\\tmediump vec2 norm = normalize(diff);\",\"\\tmediump vec2 halfNorm = norm * 0.5;\",\"\\tmediump vec2 halfNormSq = halfNorm * halfNorm;\",\"\\tmediump vec2 innerEdge = halfNorm - pixelSize * norm;\",\"\\tmediump vec2 innerEdgeSq = innerEdge * innerEdge;\",\"\\tmediump float f = smoothstep(halfNormSq.x + halfNormSq.y, innerEdgeSq.x + innerEdgeSq.y, diffSq.x + diffSq.y);\",\"\\tgl_FragColor = color * f;\",\"}\"].join(\"\\n\")}static GetSmoothEllipseOutlineFragmentShaderSource(){return[\"varying mediump vec2 vTex;\",\"uniform lowp vec4 color;\",\"uniform mediump vec2 pixelSize;\",\"uniform mediump float outlineThickness;\",\"void main(void) {\",\"\\tmediump vec2 diff = vTex - vec2(0.5, 0.5);\",\"\\tmediump vec2 diffSq = diff * diff;\",\"\\tmediump float distSq = diffSq.x + diffSq.y;\",\"\\tmediump vec2 norm = normalize(diff);\",\"\\tmediump vec2 halfNorm = norm * 0.5;\",\"\\tmediump vec2 halfNormSq = halfNorm * halfNorm;\",\"\\tmediump vec2 pxNorm = pixelSize * norm;\",\"\\tmediump vec2 innerEdge1 = halfNorm - pxNorm;\",\"\\tmediump vec2 innerEdge1Sq = innerEdge1 * innerEdge1;\",\"\\tmediump float innerF = smoothstep(halfNormSq.x + halfNormSq.y, innerEdge1Sq.x + innerEdge1Sq.y, distSq);\",\"\\tmediump vec2 innerEdge2 = halfNorm - pxNorm * outlineThickness;\",\"\\tmediump vec2 innerEdge2Sq = innerEdge2 * innerEdge2;\",\"\\tmediump vec2 innerEdge3 = halfNorm - pxNorm * (outlineThickness + 1.0);\",\"\\tmediump vec2 innerEdge3Sq = innerEdge3 * innerEdge3;\",\"\\tmediump float outerF = smoothstep(innerEdge3Sq.x + innerEdge3Sq.y, innerEdge2Sq.x + innerEdge2Sq.y, distSq);\",\"\\tgl_FragColor = color * innerF * outerF;\",\"}\"].join(\"\\n\")}}}{const Ps=self.C3,Rs=self.glMatrix,Cr=Rs.mat4,As=new Map([[\"float\",1],[\"percent\",1],[\"sampler\",1],[\"vec2\",2],[\"vec3\",3],[\"color\",3],[\"vec4\",4],[\"mat4\",16]]);Ps.Gfx.WebGLShaderUniform=class{constructor(e,t,s){if(!As.has(s))throw new Error(\"invalid uniform type\");this._owner=e,this._gl=this._owner.GetWebGLContext(),this._name=t,this._type=s,this._isColorType=\"color\"===this._type,this._location=this._gl.getUniformLocation(this._owner.GetShaderProgram(),t),this._isUsed=!!this._location;const i=As.get(s);this._lastValue=new Float32Array(i),this._lastBatchValue=new Float32Array(i)}Release(){this._owner=null,this._gl=null,this._location=null}IsUsed(){return this._isUsed}GetType(){return this._type}IsColorType(){return this._isColorType}Init1f(e){this.IsUsed()&&(this._lastValue[0]=e,this._lastBatchValue.set(this._lastValue),this._gl.uniform1f(this._location,e))}Init1i(e){this.IsUsed()&&(this._lastValue[0]=e,this._lastBatchValue.set(this._lastValue),this._gl.uniform1i(this._location,e))}Init2f(e,t){this.IsUsed()&&(this._lastValue[0]=e,this._lastValue[1]=t,this._lastBatchValue.set(this._lastValue),this._gl.uniform2f(this._location,e,t))}Init3f(e,t,s){this.IsUsed()&&(this._lastValue[0]=e,this._lastValue[1]=t,this._lastValue[2]=s,this._lastBatchValue.set(this._lastValue),this._gl.uniform3f(this._location,e,t,s))}Init4f(e,t,s,i){this.IsUsed()&&(this._lastValue[0]=e,this._lastValue[1]=t,this._lastValue[2]=s,this._lastValue[3]=i,this._lastBatchValue.set(this._lastValue),this._gl.uniform4f(this._location,e,t,s,i))}Update1f(e){e=Math.fround(e);const t=this._lastValue;t[0]!==e&&(t[0]=e,this._gl.uniform1f(this._location,e))}Update1i(e){const t=this._lastValue;t[0]!==e&&this._gl.uniform1i(this._location,t[0]=e)}Update2f(e,t){e=Math.fround(e),t=Math.fround(t);const s=this._lastValue;s[0]===e&&s[1]===t||(s[0]=e,s[1]=t,this._gl.uniform2f(this._location,e,t))}Update3f(e,t,s){e=Math.fround(e),t=Math.fround(t),s=Math.fround(s);const i=this._lastValue;i[0]===e&&i[1]===t&&i[2]===s||(i[0]=e,i[1]=t,i[2]=s,this._gl.uniform3f(this._location,e,t,s))}Update4f(e,t,s,i){e=Math.fround(e),t=Math.fround(t),s=Math.fround(s),i=Math.fround(i);const r=this._lastValue;r[0]===e&&r[1]===t&&r[2]===s&&r[3]===i||(r[0]=e,r[1]=t,r[2]=s,r[3]=i,this._gl.uniform4f(this._location,e,t,s,i))}UpdateMatrix4fv(e){const t=this._lastValue;Cr.exactEquals(t,e)||(Ps.typedArraySet16(t,e,0),this._gl.uniformMatrix4fv(this._location,!1,e))}IsSetToCustomInBatch(e){const t=this._lastBatchValue;return this.IsColorType()?t[0]===Math.fround(e.getR())&&t[1]===Math.fround(e.getG())&&t[2]===Math.fround(e.getB()):t[0]===Math.fround(e)}SetBatchValueCustom(e){const t=this._lastBatchValue;this.IsColorType()?(t[0]=e.getR(),t[1]=e.getG(),t[2]=e.getB()):t[0]=e}IsSetTo1InBatch(e){return this._lastBatchValue[0]===Math.fround(e)}IsSetTo2InBatch(e,t){const s=this._lastBatchValue;return s[0]===Math.fround(e)&&s[1]===Math.fround(t)}SetBatch1(e){this._lastBatchValue[0]=e}SetBatch2(e,t){const s=this._lastBatchValue;s[0]=e,s[1]=t}}}{const Ms=self.C3,Ds=self.glMatrix,Ur=Ds.vec4,Cr=Ds.mat4;Ms.Gfx.BatchState=class{constructor(e){this.renderer=e,this.currentMV=Cr.create(),this.currentMatP=Cr.create(),this.currentFramebuffer=null,this.currentFramebufferNoDepth=null,this.isDepthSamplingEnabled=!1,this.currentColor=Ur.fromValues(1,1,1,1),this.currentShader=null,this.pointTexCoords=new Ms.Rect,this.clearColor=Ms.New(Ms.Color,0,0,0,0)}},Ms.Gfx.WebGLBatchJob=class{constructor(e){const t=new ArrayBuffer(96);this._type=0,this._batchState=e,this._gl=e.renderer.GetContext(),this._startIndex=0,this._indexCount=0,this._texParam=null,this._mat4param=new Float32Array(t,0,16),this._colorParam=new Float32Array(t,64,4),this._srcOriginRect=new Float32Array(t,80,4),this._shaderParams=[]}InitQuad(e,t){this._type=1,this._startIndex=e,this._indexCount=t}DoQuad(){const e=this._gl;e.drawElements(e.TRIANGLES,this._indexCount,e.UNSIGNED_SHORT,this._startIndex)}InitSetTexture(e){this._type=2,this._texParam=e}DoSetTexture(){const e=this._gl,t=this._texParam;e.bindTexture(e.TEXTURE_2D,t?t._GetTexture():null)}InitSetColor(e){this._type=3,e.writeToTypedArray(this._colorParam,0)}DoSetColor(){const e=this._colorParam,t=this._batchState;Ur.copy(t.currentColor,e),t.currentShader.UpdateColor(e)}InitSetGradientColor(e){this._type=21,e.writeToTypedArray(this._colorParam,0)}DoSetGradientColor(){const e=this._colorParam,t=this._batchState.currentShader;t._uColor2.IsUsed()&&t._uColor2.Update4f(e[0],e[1],e[2],e[3])}InitSetBlend(e,t){this._type=4,this._startIndex=e,this._indexCount=t}DoSetBlend(){this._gl.blendFunc(this._startIndex,this._indexCount)}InitSetViewport(e,t,s,i){this._type=5;const r=this._colorParam;r[0]=e,r[1]=t,r[2]=s,r[3]=i}DoSetViewport(){const e=this._colorParam;this._gl.viewport(e[0],e[1],e[2],e[3])}InitSetProjection(e){this._type=6,Cr.copy(this._mat4param,e)}DoSetProjection(){const e=this._batchState,s=e.renderer._allShaderPrograms,i=e.currentShader,r=this._mat4param;for(let e=0,t=s.length;e<t;++e){const n=s[e];n===i?n.UpdateMatP(r,!0):n.SetMatPStale()}Cr.copy(e.currentMatP,r)}InitSetModelView(e){this._type=7,Cr.copy(this._mat4param,e)}DoSetModelView(){const e=this._batchState,s=e.renderer._allShaderPrograms,i=e.currentShader,r=this._mat4param;for(let e=0,t=s.length;e<t;++e){const n=s[e];n===i?n.UpdateMatMV(r,!0):n.SetMatMVStale()}Cr.copy(e.currentMV,r)}InitSetRenderTarget(e){this._type=8,this._texParam=e}DoSetRenderTarget(){const e=this._gl,t=this._texParam,s=this._batchState;t?(s.currentFramebuffer=t._GetFramebuffer(),s.currentFramebufferNoDepth=t._GetFramebufferNoDepth(),s.isDepthSamplingEnabled&&s.currentFramebufferNoDepth?e.bindFramebuffer(e.FRAMEBUFFER,s.currentFramebufferNoDepth):e.bindFramebuffer(e.FRAMEBUFFER,s.currentFramebuffer)):(s.currentFramebuffer=null,s.currentFramebufferNoDepth=null,e.bindFramebuffer(e.FRAMEBUFFER,null))}InitClearSurface(e){this._type=9,e.writeToTypedArray(this._mat4param,0)}InitClearSurface2(e,t,s,i){this._type=9;const r=this._mat4param;r[0]=e,r[1]=t,r[2]=s,r[3]=i}DoClearSurface(){const e=this._gl,t=this._mat4param,s=this._batchState,i=s.clearColor,r=t[0],n=t[1],a=t[2],o=t[3];i.equalsRgba(r,n,a,o)||(e.clearColor(r,n,a,o),i.setRgba(r,n,a,o)),e.clear(e.COLOR_BUFFER_BIT)}InitSetPointTexCoords(e){this._type=15,e.writeToTypedArray(this._mat4param,0)}DoSetPointTextureCoords(){const e=this._mat4param;this._batchState.pointTexCoords.set(e[0],e[1],e[2],e[3])}InitPoints(e,t){this._type=10,this._startIndex=e,this._indexCount=1,this._mat4param[0]=t}DoPoints(){const e=this._gl,t=this._batchState,s=t.renderer,i=s._spPoints,r=(e.useProgram(i._shaderProgram),i.UpdateMatP(t.currentMatP,!1),i.UpdateMatMV(t.currentMV,!1),t.pointTexCoords),n=(i._uPointTexStart.IsUsed()&&i._uPointTexStart.Update2f(r.getLeft(),r.getTop()),i._uPointTexEnd.IsUsed()&&i._uPointTexEnd.Update2f(r.getRight(),r.getBottom()),this._mat4param[0]);if(i._uZElevation.IsUsed()&&i._uZElevation.Update1f(n),i._uColor.IsUsed()){const a=t.currentColor;i._uColor.Update4f(a[0],a[1],a[2],a[3])}e.drawArrays(e.POINTS,this._startIndex/4,this._indexCount),e.useProgram(t.currentShader._shaderProgram)}InitSetProgram(e){this._type=11,this._texParam=e}DoSetProgram(){const e=this._gl,t=this._batchState,s=this._texParam;if(t.currentShader=s,e.useProgram(s._shaderProgram),s.UpdateMatP(t.currentMatP,!1),s.UpdateMatMV(t.currentMV,!1),s._uColor.IsUsed()){const i=t.currentColor;s._uColor.Update4f(i[0],i[1],i[2],i[3])}}InitSetProgramParameters(){this._type=12}DoSetProgramParameters(){const e=this._batchState.currentShader,t=this._gl,s=this._mat4param,i=this._colorParam,r=this._srcOriginRect;if(e._uSamplerBack.IsUsed()){const n=this._batchState.renderer,a=this._texParam;n._lastTexture1!==a&&(t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,a?a._GetTexture():null),n._lastTexture1=a,t.activeTexture(t.TEXTURE0))}e._uPixelSize.IsUsed()&&e._uPixelSize.Update2f(s[0],s[1]),e._uDestStart.IsUsed()&&e._uDestStart.Update2f(s[2],s[3]),e._uDestEnd.IsUsed()&&e._uDestEnd.Update2f(s[4],s[5]),e._uDevicePixelRatio.IsUsed()&&e._uDevicePixelRatio.Update1f(this._indexCount),e._uLayerScale.IsUsed()&&e._uLayerScale.Update1f(s[6]),e._uLayerAngle.IsUsed()&&e._uLayerAngle.Update1f(s[7]),e._uSrcStart.IsUsed()&&e._uSrcStart.Update2f(s[12],s[13]),e._uSrcEnd.IsUsed()&&e._uSrcEnd.Update2f(s[14],s[15]),e._uSrcOriginStart.IsUsed()&&e._uSrcOriginStart.Update2f(r[0],r[1]),e._uSrcOriginEnd.IsUsed()&&e._uSrcOriginEnd.Update2f(r[2],r[3]),e._uLayoutStart.IsUsed()&&e._uLayoutStart.Update2f(i[0],i[1]),e._uLayoutEnd.IsUsed()&&e._uLayoutEnd.Update2f(i[2],i[3]),e._uSeconds.IsUsed()&&e._uSeconds.Update1f(this._startIndex)}InitSetProgramCustomParameters(){this._type=13}DoSetProgramCustomParameters(){const e=this._batchState.currentShader,s=e._uCustomParameters,i=this._shaderParams;for(let e=0,t=s.length;e<t;++e){const r=s[e],n=i[e];r.IsColorType()?r.Update3f(n.getR(),n.getG(),n.getB()):r.Update1f(n)}}InitInvalidateFramebuffer(e){this._type=14,this._texParam=e}DoInvalidateFramebuffer(){const e=this._gl,t=this._texParam,s=this._batchState.currentFramebuffer;t!==s&&e.bindFramebuffer(e.FRAMEBUFFER,t),e.invalidateFramebuffer(e.FRAMEBUFFER,[e.COLOR_ATTACHMENT0]),t!==s&&e.bindFramebuffer(e.FRAMEBUFFER,s)}InitBlitFramebuffer(e,t,s){this._type=17;const i=this._mat4param,r=this._batchState.renderer,n=(i[0]=e.GetWidth(),i[1]=e.GetHeight(),i[2]=(t||r).GetWidth(),i[3]=(t||r).GetHeight(),i[4]=e.IsLinearSampling()?1:0,i[5]=\"stretch\"===s,this._shaderParams);Ms.clearArray(n),n.push(e._GetFramebuffer()),n.push(t?t._GetFramebuffer():null)}DoBlitFramebuffer(){const e=this._mat4param,t=this._shaderParams,s=this._gl,i=e[0],r=e[1],n=e[2],a=e[3],o=0!==e[4],h=0!==e[5],l=t[0],c=t[1];if(s.bindFramebuffer(s.READ_FRAMEBUFFER,l),s.bindFramebuffer(s.DRAW_FRAMEBUFFER,c),h)s.blitFramebuffer(0,0,i,r,0,0,n,a,s.COLOR_BUFFER_BIT,o?s.LINEAR:s.NEAREST);else{const u=Math.min(i,n),_=Math.min(r,a),d=Math.max(r-a,0),p=Math.max(a-r,0);s.blitFramebuffer(0,d,u,_+d,0,p,u,_+p,s.COLOR_BUFFER_BIT,s.NEAREST)}}InitStartQuery(e){this._type=18,this._texParam=e}DoStartQuery(){this._texParam.BeginTimeElapsed(),this._texParam=null}InitEndQuery(e){this._type=19,this._texParam=e}DoEndQuery(){this._texParam.EndTimeElapsed(),this._texParam=null}InitSetEllipseParams(e,t,s){this._type=20;const i=this._mat4param;i[0]=e,i[1]=t,i[2]=s}DoSetEllipseParams(){const e=this._batchState.currentShader,t=this._mat4param;e._uPixelSize.IsUsed()&&e._uPixelSize.Update2f(t[0],t[1]),e._uOutlineThickness.IsUsed()&&e._uOutlineThickness.Update1f(t[2])}InitSetTilemapInfo(e,t,s,i,r,n,a){this._type=16;const o=this._mat4param;e.writeToTypedArray(o,0),o[4]=1/t,o[5]=1/s,o[6]=i/t,o[7]=r/s,o[8]=n/t,o[9]=a/s}DoSetTilemapInfo(){const e=this._batchState.currentShader,t=this._mat4param;e._uSrcStart.IsUsed()&&e._uSrcStart.Update2f(t[0],t[1]),e._uPixelSize.IsUsed()&&e._uPixelSize.Update2f(t[4],t[5]),e._uTileSize.IsUsed()&&e._uTileSize.Update2f(t[6],t[7]),e._uTileSpacing.IsUsed()&&e._uTileSpacing.Update2f(t[8],t[9])}InitSetTileRandomizationInfo(e,t,s,i,r,n,a){this._type=29;const o=this._mat4param;o[0]=1/e,o[1]=1/t,o[2]=s,o[3]=i,o[4]=r,o[5]=n,o[6]=a}DoSetTileRandomizationInfo(){const e=this._batchState.currentShader,t=this._mat4param;e._uPixelSize.IsUsed()&&e._uPixelSize.Update2f(t[0],t[1]),e._uTileSize.IsUsed()&&e._uTileSize.Update2f(t[2],t[3]),e._uOutlineThickness.IsUsed()&&e._uOutlineThickness.Update1f(t[4]),e._uTileSpacing.IsUsed()&&e._uTileSpacing.Update2f(t[5],t[6])}InitClearDepth(e){this._type=22,this._startIndex=e?1:0}DoClearDepth(){const e=this._gl,t=0!==this._startIndex;t||e.depthMask(!0),e.clear(e.DEPTH_BUFFER_BIT),t||e.depthMask(!1)}InitSetDepthEnabled(e){this._type=23,this._startIndex=e?1:0}DoSetDepthEnabled(){const e=this._gl;0===this._startIndex?(e.disable(e.DEPTH_TEST),e.depthMask(!1)):(e.enable(e.DEPTH_TEST),e.depthMask(!0))}InitSetDepthSamplingEnabled(e){this._type=24,this._startIndex=e?1:0}DoSetDepthSamplingEnabled(){const e=this._gl,t=this._batchState,s=t.renderer,i=0!==this._startIndex;t.isDepthSamplingEnabled=i,e.activeTexture(e.TEXTURE2),i?(t.currentFramebufferNoDepth&&e.bindFramebuffer(e.FRAMEBUFFER,t.currentFramebufferNoDepth),e.bindTexture(e.TEXTURE_2D,s._GetDepthBuffer())):(e.bindTexture(e.TEXTURE_2D,null),t.currentFramebufferNoDepth&&e.bindFramebuffer(e.FRAMEBUFFER,t.currentFramebuffer)),e.activeTexture(e.TEXTURE0)}InitCoplanarStartStencilPass(){this._type=25}DoCoplanarStartStencilPass(){const e=this._gl;e.clear(e.STENCIL_BUFFER_BIT),e.enable(e.STENCIL_TEST),e.stencilFunc(e.ALWAYS,1,1),e.stencilOp(e.KEEP,e.KEEP,e.REPLACE),e.colorMask(!1,!1,!1,!1)}InitCoplanarStartColorPass(){this._type=26}DoCoplanarStartColorPass(){const e=this._gl;e.colorMask(!0,!0,!0,!0),e.stencilFunc(e.EQUAL,1,1),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)}InitCoplanarRestore(){this._type=27}DoCoplanarRestore(){const e=this._gl;e.disable(e.STENCIL_TEST)}InitSetScissor(e,t,s,i,r){this._type=28,this._startIndex=e?1:0;const n=this._mat4param;n[0]=t,n[1]=s,n[2]=i,n[3]=r}DoSetScissor(){const e=this._gl,t=this._mat4param;1===this._startIndex?(e.enable(e.SCISSOR_TEST),e.scissor(t[0],t[1],t[2],t[3])):e.disable(e.SCISSOR_TEST)}Run(){switch(this._type){case 1:return void this.DoQuad();case 2:return void this.DoSetTexture();case 3:return void this.DoSetColor();case 4:return void this.DoSetBlend();case 5:return void this.DoSetViewport();case 6:return void this.DoSetProjection();case 7:return void this.DoSetModelView();case 8:return void this.DoSetRenderTarget();case 9:return void this.DoClearSurface();case 10:return void this.DoPoints();case 11:return void this.DoSetProgram();case 12:return void this.DoSetProgramParameters();case 13:return void this.DoSetProgramCustomParameters();case 14:return void this.DoInvalidateFramebuffer();case 15:return void this.DoSetPointTextureCoords();case 16:return void this.DoSetTilemapInfo();case 17:return void this.DoBlitFramebuffer();case 18:return void this.DoStartQuery();case 19:return void this.DoEndQuery();case 20:return void this.DoSetEllipseParams();case 21:return void this.DoSetGradientColor();case 22:return void this.DoClearDepth();case 23:return void this.DoSetDepthEnabled();case 24:return void this.DoSetDepthSamplingEnabled();case 25:return void this.DoCoplanarStartStencilPass();case 26:return void this.DoCoplanarStartColorPass();case 27:return void this.DoCoplanarRestore();case 28:return void this.DoSetScissor();case 29:return void this.DoSetTileRandomizationInfo()}}}}{let v=function(e,t,s,i,r,n){t?e.strokeRect(s,i,r,n):e.fillRect(s,i,r,n)},e=function(e){return e*(4/3)},o=function(e,t){e=e.trim();const s=parseFloat(e);return isFinite(s)?e.endsWith(\"%\")?t*s/100:s:0};v,e,o;const Es=self.C3,Fs=new Set([\"serif\",\"sans-serif\",\"monospace\",\"cursive\",\"fantasy\",\"system-ui\",\"ui-serif\",\"ui-sans-serif\",\"ui-monospace\",\"ui-rounded\",\"math\",\"emoji\",\"fangsong\"]),Bs={timeout:60},Os=new Es.Color(0,0,0,1),Ls=new Set([\"left\",\"center\",\"right\"]),ks=new Set([\"top\",\"center\",\"bottom\"]),Ns=new Set([\"word\",\"cjk\",\"character\"]),Ws=new Set([\"ltr\",\"rtl\"]),Vs=new Set;Es.FontManager&&Es.FontManager.addEventListener(\"fontload\",e=>{const t=e.font.GetName();for(const s of Vs)(s.IsBBCodeEnabled()||Es.equalsNoCase(s.GetFontName(),t))&&s._SetWordWrapChanged()});let t=!1,s=!1;Es.Gfx.RendererText=class{constructor(e,t){t=Object.assign({},Bs,t),this._renderer=e,this._fontName=\"Arial\",this._fontSize=16,this._fontSizeScale=1,this._lineHeight=0,this._isBold=!1,this._isItalic=!1,this._colorStr=\"black\",this._isBBcodeEnabled=!1,this._iconSet=null,this._iconSmoothing=!0,this.onloadfont=null,this._alreadyLoadedFonts=new Set,this._horizontalAlign=\"left\",this._verticalAlign=\"top\",this._text=\"\",this._bbString=null,this._wrappedText=Es.New(Es.WordWrap),this._wrapMode=\"word\",this._textDirection=\"ltr\",this._wordWrapChanged=!1,this._textLayoutChanged=!1,this._drawChanged=!1,this._drawMaxCharCount=-1,this._drawCharCount=0,this._cssWidth=0,this._cssHeight=0,this._width=0,this._height=0,this._zoom=1,this._textCanvas=null,this._textContext=null,this._measureContext=null,this._measureContextTop=null,this._lastCanvasWidth=-1,this._lastCanvasHeight=-1,this._lastTextCanvasFont=\"\",this._lastMeasureCanvasFont=\"\",this._lastTextCanvasFillStyle=\"\",this._lastTextCanvasOpacity=1,this._lastTextCanvasLineWidth=1,this._measureTextCallback=e=>this._MeasureText(e),this._texture=null,this._rcTex=new Es.Rect,this._scaleFactor=1,this._textureTimeout=new Es.IdleTimeout(()=>{this.ReleaseTexture(),this._SetTextCanvasSize(8,8)},t.timeout),this.ontextureupdate=null,this._wasReleased=!1,Vs.add(this)}Release(){this.onloadfont=null,this._alreadyLoadedFonts.clear(),this._iconSet=null,this._bbString=null,this._textCanvas=null,this._textContext=null,this._measureContext=null,this._measureContextTop=null,this._measureTextCallback=null,this._textureTimeout.Release(),this.ontextureupdate=null,this.ReleaseTexture(),this._wrappedText.Clear(),this._wrappedText=null,this._renderer=null,this._wasReleased=!0,Vs.delete(this)}_SetDrawChanged(){this._drawChanged=!0}_SetTextLayoutChanged(){this._SetDrawChanged(),this._textLayoutChanged=!0}_SetWordWrapChanged(){this._SetTextLayoutChanged(),this._wordWrapChanged=!0}SetBBCodeEnabled(e){if(this._isBBcodeEnabled!==(e=!!e)){this._isBBcodeEnabled=e;const t=this._isBBcodeEnabled?\"alphabetic\":\"top\";this._textContext&&(this._textContext.textBaseline=t),this._measureContext&&(this._measureContext.textBaseline=t),this._SetWordWrapChanged()}}IsBBCodeEnabled(){return this._isBBcodeEnabled}SetIconSet(e){this._iconSet!==e&&(this._iconSet=e,this._wrappedText.SetIconSet(e),this._iconSet&&this._iconSet.IsLoading()&&this._iconSet.LoadContent().then(()=>this._SetDrawChanged()),this._SetWordWrapChanged())}SetIconSmoothing(e){this._iconSmoothing!==(e=!!e)&&(this._iconSmoothing=e,this._SetDrawChanged())}SetFontName(e){this._fontName!==(e=e||\"serif\")&&(this._fontName=e,this._SetWordWrapChanged())}GetFontName(){return this._fontName}SetFontSize(e){this._fontSize!==(e=e<.1?.1:e)&&(this._fontSize=e,this._SetWordWrapChanged())}GetFontSize(){return this._fontSize}SetFontSizeScale(e){this._fontSizeScale!==e&&(this._fontSizeScale=e,this._SetWordWrapChanged())}SetLineHeight(e){this._lineHeight!==e&&(this._lineHeight=e,this._SetTextLayoutChanged())}GetLineHeight(){return this._lineHeight}SetBold(e){this._isBold!==(e=!!e)&&(this._isBold=e,this._SetWordWrapChanged())}IsBold(){return this._isBold}SetItalic(e){this._isItalic!==(e=!!e)&&(this._isItalic=e,this._SetWordWrapChanged())}IsItalic(){return this._isItalic}SetDrawMaxCharacterCount(e){e=Math.floor(e),this._drawMaxCharCount!==e&&(this._drawMaxCharCount=e,this._SetDrawChanged())}GetDrawMaxCharacterCount(){return this._drawMaxCharCount}_GetFontString(e,t){let s=[];(this._isBold||t.HasStyleTag(\"b\"))&&s.push(\"bold\"),(this._isItalic||t.HasStyleTag(\"i\"))&&s.push(\"italic\");const i=t.GetStyleTag(\"size\"),r=(i?parseFloat(i.param):this._fontSize)*this._fontSizeScale;s.push(e?r+\"pt\":r*this.GetDrawScale()+\"pt\");let n=this._fontName,a=t.GetStyleTag(\"font\");return a&&a.param&&(n=a.param,this.onloadfont)&&!this._alreadyLoadedFonts.has(n)&&(this.onloadfont(n),this._alreadyLoadedFonts.add(n)),n&&(Fs.has(n)?s.push(n):s.push('\"'+n+'\"')),s.join(\" \")}SetColor(e){e instanceof Es.Color&&(e=e.getCssRgb()),this._colorStr!==e&&(this._colorStr=e,this._SetDrawChanged())}SetColorRgb(e,t,s){Os.setRgb(e,t,s),this.SetColor(Os)}SetHorizontalAlignment(e){if(!Ls.has(e))throw new Error(\"invalid horizontal alignment\");this._horizontalAlign!==e&&(this._horizontalAlign=e,this._SetTextLayoutChanged())}GetHorizontalAlignment(){return this._horizontalAlign}SetVerticalAlignment(e){if(!ks.has(e))throw new Error(\"invalid vertical alignment\");this._verticalAlign!==e&&(this._verticalAlign=e,this._SetTextLayoutChanged())}GetVerticalAlignment(){return this._verticalAlign}SetWordWrapMode(e){if(!Ns.has(e))throw new Error(\"invalid word wrap mode\");this._wrapMode!==e&&(this._wrapMode=e,this._SetWordWrapChanged())}GetWordWrapMode(){return this._wrapMode}SetTextDirection(e){if(!Ws.has(e))throw new Error(\"invalid text direction\");this._textDirection!==e&&(this._textDirection=e,this._textContext&&(this._textContext.direction=this._textDirection),this._measureContext&&(this._measureContext.direction=this._textDirection),this._SetWordWrapChanged())}GetTextDirection(){return this._textDirection}SetText(e){this._text!==e&&(this._text=e,this._SetWordWrapChanged())}GetText(){return this._text}GetDrawScale(){return this._scaleFactor*this._zoom*self.devicePixelRatio}SetSize(n,a,o){if(void 0===o&&(o=1),!(n<=0||this._cssWidth===n&&this._cssHeight===a&&this._zoom===o)){let e=this._cssWidth,t=(this._cssWidth=n,this._cssHeight=a,this._zoom=o,self.devicePixelRatio),s=(this._width=this._cssWidth*this._zoom*t,this._height=this._cssHeight*this._zoom*t,Math.max(this._width,this._height)),i=Math.min(this._renderer.GetMaxTextureSize(),4096),r=1;i<s&&(r=i/s,this._width=Math.min(this._width*r,i),this._height=Math.min(this._height*r,i)),this._scaleFactor=r,this._cssWidth!==e?this._SetWordWrapChanged():this._SetTextLayoutChanged()}}GetWidth(){return this._width}GetHeight(){return this._height}GetZoom(){return this._zoom}GetTextWidth(){return this._UpdateTextMeasurements(),this._wrappedText.GetMaxLineWidth()}GetTextHeight(){return this._UpdateTextMeasurements(),this._wrappedText.GetTotalLineHeight()+this._wrappedText.GetLineCount()*(this._lineHeight+4)-this._lineHeight}GetLengthInGraphemes(){this._UpdateTextMeasurements();let e=0;for(const t of this._wrappedText.GetLines())for(const s of t.fragments())e+=s.GetLength();return e}GetTexture(){return this._textureTimeout.Reset(),this._MaybeUpdate(),this._texture}HitTestFragment(e,t){this._UpdateTextMeasurements();const s=this.GetDrawScale(),i=this._wrappedText.GetLines();for(const r of i){const n=r.GetFontBoundingBoxDescent()*s;if(t>=r.GetPosY()-r.GetHeight()*s+n&&t<r.GetPosY()+n)for(const a of r.fragments())if(e>=a.GetPosX()&&e<a.GetPosX()+a.GetWidth()*s)return a}return null}*fragmentsWithTag(e){this._UpdateTextMeasurements();const t=this._wrappedText.GetLines();for(const s of t)for(const i of s.fragments()){const r=i.GetStyleTag(\"tag\");r&&Es.equalsNoCase(r.param,e)&&(yield i)}}FindFragmentWithTag(e,t){for(const s of this.fragmentsWithTag(e)){if(0===t)return s;--t}return null}CountFragmentsWithTag(e){let t=0;for(const s of this.fragmentsWithTag(e))++t;return t}_MaybeUpdate(){this._texture&&!this._drawChanged&&!this._textLayoutChanged&&!this._wordWrapChanged||this._wasReleased||this._width<=0||this._height<=0||(this._drawChanged=!1,this._DoUpdate())}_DoUpdate(){this._wasReleased||(this._UpdateTextMeasurements(),this._SetTextCanvasSize(Math.max(Es.nextHighestPowerOfTwo(Math.ceil(this._width)),128),Math.max(Es.nextHighestPowerOfTwo(Math.ceil(this._height)),64)),this._DrawTextToCanvas(),this._UpdateTexture(),this._textureTimeout.Reset())}_SetTextCanvasSize(e,t){this._textCanvas||(this._textCanvas=Es.CreateCanvas(16,16));let s=!1;this._lastCanvasWidth===e&&this._lastCanvasHeight===t||(this._lastCanvasWidth=e,this._lastCanvasHeight=t,this._textCanvas.width=e,this._textCanvas.height=t,s=!0),this._textContext||(this._textContext=this._textCanvas.getContext(\"2d\"),s=!0),s?(this._textContext.textBaseline=this._isBBcodeEnabled?\"alphabetic\":\"top\",this._textContext.direction=this._textDirection,this._textContext.font=this._lastTextCanvasFont,this._textContext.fillStyle=this._lastTextCanvasFillStyle,this._textContext.strokeStyle=this._lastTextCanvasFillStyle,this._textContext.globalAlpha=this._lastTextCanvasOpacity,this._textContext.lineWidth=this._lastTextCanvasLineWidth):this._textContext.clearRect(0,0,e,t)}_MaybeCreateMeasureContext(){this._measureContext||(this._measureContext=Es.CreateCanvas(16,16).getContext(\"2d\"),this._measureContextTop=Es.CreateCanvas(16,16).getContext(\"2d\"),this._measureContext.textBaseline=this._isBBcodeEnabled?\"alphabetic\":\"top\",this._measureContextTop.textBaseline=\"top\",this._measureContext.direction=this._textDirection,this._measureContextTop.direction=this._textDirection)}_SetMeasureFontString(e){this._lastMeasureCanvasFont!==e&&(this._lastMeasureCanvasFont=e,this._measureContext.font=e,this._measureContextTop.font=e)}_SupportsFontBoundingBoxMeasurements(){if(!t){t=!0,this._MaybeCreateMeasureContext();const e=this._measureContext.measureText(\"test\");s=\"number\"==typeof e.fontBoundingBoxAscent&&\"number\"==typeof e.fontBoundingBoxDescent}return s}_UpdateTextMeasurements(){this._UpdateWordWrap(),this._UpdateTextLayout()}_UpdateWordWrap(){this._wordWrapChanged&&(this._MaybeCreateMeasureContext(),!this._isBBcodeEnabled||this._bbString&&this._bbString.toString()===this._text||(this._bbString=new Es.BBString(this._text,{noEscape:!0})),this._wrappedText.WordWrap(this._isBBcodeEnabled?this._bbString.toFragmentList():this._text,this._measureTextCallback,this._cssWidth,this._wrapMode,0),this._wordWrapChanged=!1)}_UpdateTextLayout(){this._textLayoutChanged&&(this._LayoutText(),this._textLayoutChanged=!1)}_MeasureText(e){let t=e.IsText()?e.GetCharacterArray().join(\"\"):\" \",s=(this._SetMeasureFontString(this._GetFontString(!0,e)),e.GetStyleTag(\"size\")),i=(s?parseFloat(s.param):this._fontSize)*this._fontSizeScale,r=this._measureContext.measureText(t),n=0;if(this._isBBcodeEnabled&&this._SupportsFontBoundingBoxMeasurements()){const a=this._measureContextTop.measureText(t);n=r.fontBoundingBoxAscent-a.fontBoundingBoxAscent}return{width:r.width,height:4/3*i,fontBoundingBoxAscent:r.fontBoundingBoxAscent||0,fontBoundingBoxDescent:r.fontBoundingBoxDescent||0,topToAlphabeticDistance:n}}_SetDrawFontString(e){this._lastTextCanvasFont!==e&&(this._lastTextCanvasFont=e,this._textContext.font=e)}_SetDrawCanvasColor(e){this._lastTextCanvasFillStyle!==e&&(this._lastTextCanvasFillStyle=e,this._textContext.fillStyle=e,this._textContext.strokeStyle=e)}_SetDrawCanvasOpacity(e){this._lastTextCanvasOpacity!==e&&(this._lastTextCanvasOpacity=e,this._textContext.globalAlpha=e)}_SetDrawCanvasLineWith(e){this._lastTextCanvasLineWidth!==e&&(this._lastTextCanvasLineWidth=e,this._textContext.lineWidth=e)}_LayoutText(){let i=this.GetDrawScale(),r=(4+this._lineHeight)*i,n=0,a=this._wrappedText.GetLines();if(0!==a.length){for(const t of a){t.SetPosX(NaN),t.SetPosY(NaN);for(const o of t.fragments())o.SetPosX(NaN),o.SetPosY(NaN)}let e=this._isBBcodeEnabled&&this._SupportsFontBoundingBoxMeasurements(),s=a[0].GetHeight()*i;if(\"center\"===this._verticalAlign){const h=a.reduce((e,t)=>e+t.GetHeight()*i+r,0)-r;n=Math.max(this._height/2-h/2,0),e&&(s=a[0].GetTopToAlphabeticDistance()*i)}else if(\"bottom\"===this._verticalAlign){const l=a.reduce((e,t)=>e+t.GetHeight()*i+r,0)-this._lineHeight*i,c=e?a.at(-1).GetFontBoundingBoxDescent()*i:0;n=this._height-l-c-2}for(let e=0,t=a.length;e<t;++e){const u=a[e],_=u.GetHeight()*i,d=n;if(this._isBBcodeEnabled){if(n+=0===e?s:_,0<e&&n>this._height-4*i)break}else if(0<e&&n>=this._height-_)break;0<=d&&this._LayoutTextLine(u,n,i),this._isBBcodeEnabled||(n+=_),n+=r}}}_LayoutTextLine(e,t,s){let i=0;\"center\"===this._horizontalAlign?i=Math.floor((this._width-e.GetWidth()*s)/2):\"right\"===this._horizontalAlign&&(i=this._width-e.GetWidth()*s),e.SetPosX(i),e.SetPosY(t);for(const r of\"ltr\"===this._textDirection?e.fragments():e.fragmentsReverse())this._LayoutFragment(r,i,t,s),i+=r.GetWidth()*s}_LayoutFragment(e,t,s,i){const r=e.GetStyleTag(\"offsetx\"),n=(t+=r?o(r.param,e.GetHeight())*i:0,e.GetStyleTag(\"offsety\"));if(s+=n?o(n.param,e.GetHeight())*i:0,e.IsIcon()){const a=e.GetStyleTag(\"iconoffsety\");s+=a?o(a.param,e.GetHeight())*i:.2*e.GetHeight()*i}e.SetPosX(t),e.SetPosY(s)}_DrawTextToCanvas(){this._textContext.imageSmoothingEnabled=this._iconSmoothing,this._textContext.imageSmoothingQuality=\"high\",this._drawCharCount=0;const e=this.GetDrawScale(),t=this._wrappedText.GetLines();for(const s of t)this._DrawTextLine(s,e)}_DrawTextLine(e,t){const s=e.GetPosX(),i=e.GetPosY();if(Number.isFinite(s)&&Number.isFinite(i))for(const r of\"ltr\"===this._textDirection?e.fragments():e.fragmentsReverse())this._DrawFragment(r,t,e.GetHeight())}_DrawFragment(a,o,h){const l=this._textContext,c=a.GetPosX(),u=a.GetPosY();if(Number.isFinite(c)&&Number.isFinite(u)){let e=h/16,t=a.GetWidth()*o,s=a.GetHeight()*o,i=a.GetHeight()/16,r=(4+this._lineHeight)*o,n=a.IsText()?a.GetCharacterArray():null;if(-1!==this._drawMaxCharCount){if(this._drawCharCount>=this._drawMaxCharCount)return;a.IsText()&&this._drawCharCount+n.length>this._drawMaxCharCount&&(n=n.slice(0,this._drawMaxCharCount-this._drawCharCount),t=this._MeasureText(a).width*o),this._drawCharCount+=a.GetLength()}const _=a.GetStyleTag(\"background\"),d=a.HasStyleTag(\"u\"),p=a.HasStyleTag(\"s\");if((!a.IsText()||!Es.IsCharArrayAllWhitespace(n)||_||d||p)&&!a.HasStyleTag(\"hide\")){const f=a.GetStyleTag(\"color\"),m=a.GetStyleTag(\"opacity\"),g=(this._SetDrawCanvasOpacity(m?parseFloat(m.param)/100:1),_&&(this._SetDrawCanvasColor(_.param),l.fillRect(c,u-s,t,s+r)),a.GetStyleTag(\"linethickness\")),S=g?parseFloat(g.param):1,y=a.HasStyleTag(\"stroke\");if(y&&this._SetDrawCanvasLineWith(.5*i*S*this.GetDrawScale()),a.IsText()){const G=n.join(\"\");if(this._SetDrawFontString(this._GetFontString(!1,a)),!y){this._SetDrawCanvasLineWith(.5*i*S*this.GetDrawScale());const I=a.GetStyleTag(\"outlineback\");I&&(this._SetDrawCanvasColor(I.param),this._FillOrStrokeText(!0,G,c,u,t))}if(this._SetDrawCanvasColor(f?f.param:this._colorStr),this._FillOrStrokeText(y,G,c,u,t),!y){this._SetDrawCanvasLineWith(.5*i*S*this.GetDrawScale());const T=a.GetStyleTag(\"outline\");T&&(this._SetDrawCanvasColor(T.param),this._FillOrStrokeText(!0,G,c,u,t))}}else if(a.IsIcon()&&0<a.GetWidth()){const C=a.GetDrawable(this._iconSet);C&&l.drawImage(C,c,u-s,t,s)}if(this._SetDrawCanvasColor(f?f.param:this._colorStr),d&&v(l,y,c,u+o*e,t,o*e*S),p){const b=u-s/4,w=o*i,x=b+w/2;l.fillRect(c,x-w*S/2,t,w*S)}}}}_FillOrStrokeText(e,t,s,i,r){\"rtl\"===this._textDirection&&(s+=r),e?\"Gecko\"===Es.Platform.BrowserEngine?this._textContext.strokeText(t,s,i,r):this._textContext.strokeText(t,s,i):\"Gecko\"===Es.Platform.BrowserEngine?this._textContext.fillText(t,s,i,r):this._textContext.fillText(t,s,i)}_UpdateTexture(){this._renderer.IsContextLost()||(this._texture||(this._texture=this._renderer.CreateDynamicTexture(this._textCanvas.width,this._textCanvas.height,{mipMap:!0,mipMapQuality:\"high\"})),this._renderer.UpdateTexture(this._textCanvas,this._texture),this._rcTex.set(0,0,this._width/this._texture.GetWidth(),this._height/this._texture.GetHeight()),this.ontextureupdate&&this.ontextureupdate())}GetTexRect(){return this._rcTex}ReleaseTexture(){this._texture&&(this._renderer.IsContextLost()||this._renderer.DeleteTexture(this._texture),this._texture=null)}static OnContextLost(){for(const e of Vs)e.ReleaseTexture()}static GetAll(){return Vs.values()}}}{const Us=self.C3;class js{constructor(e){this._gl=e.GetContext(),this._version=e.GetWebGLVersionNumber(),this._timerExt=e._GetDisjointTimerQueryExtension(),this._query=null,this._isActive=!1,this._hasResult=!1,this._result=0,1===this._version?this._query=this._timerExt.createQueryEXT():this._query=this._gl.createQuery()}Release(){this._DeleteQueryObject(),this._gl=null,this._timerExt=null,this._hasResult=!1}_DeleteQueryObject(){this._query&&(1===this._version?this._timerExt.deleteQueryEXT(this._query):this._gl.deleteQuery(this._query),this._query=null)}BeginTimeElapsed(){if(this._isActive)throw new Error(\"query already active\");1===this._version?this._timerExt.beginQueryEXT(this._timerExt.TIME_ELAPSED_EXT,this._query):this._gl.beginQuery(this._timerExt.TIME_ELAPSED_EXT,this._query),this._isActive=!0}EndTimeElapsed(){if(!this._isActive)throw new Error(\"query not active\");1===this._version?this._timerExt.endQueryEXT(this._timerExt.TIME_ELAPSED_EXT):this._gl.endQuery(this._timerExt.TIME_ELAPSED_EXT),this._isActive=!1}CheckForResult(){if(this._query&&!this._hasResult&&!this._isActive){let e;e=1===this._version?this._timerExt.getQueryObjectEXT(this._query,this._timerExt.QUERY_RESULT_AVAILABLE_EXT):this._gl.getQueryParameter(this._query,this._gl.QUERY_RESULT_AVAILABLE);const t=this._gl.getParameter(this._timerExt.GPU_DISJOINT_EXT);e&&!t&&(1===this._version?this._result=this._timerExt.getQueryObjectEXT(this._query,this._timerExt.QUERY_RESULT_EXT):this._result=this._gl.getQueryParameter(this._query,this._gl.QUERY_RESULT),this._result/=1e9,this._hasResult=!0),(e||t)&&this._DeleteQueryObject()}}HasResult(){return this._hasResult}GetResult(){if(this._hasResult)return this._result;throw new Error(\"no result available\")}}Us.Gfx.WebGLTimeElapsedQuery=class{constructor(e){this._renderer=e,this._frameNumber=e.GetFrameNumber(),this._isActive=!1,this._parentQuery=null,this._isNested=!1,this._realQuery=null,this._queries=[]}Release(){for(const e of this._queries)e instanceof js&&e.Release();Us.clearArray(this._queries),this._parentQuery=null,this._realQuery=null,this._renderer=null}BeginTimeElapsed(){if(this._isActive)throw new Error(\"query already active\");const e=this._renderer._GetTimeQueryStack();0<e.length?(this._isNested=!0,this._parentQuery=e.at(-1),this._parentQuery._EndReal(),this._parentQuery._queries.push(this)):(this._isNested=!1,this._parentQuery=null),this._isActive=!0,e.push(this),this._StartReal()}EndTimeElapsed(){if(!this._isActive)throw new Error(\"query not active\");const e=this._renderer._GetTimeQueryStack().pop();if(e!==this)throw new Error(\"can only end most nested query\");this._isActive=!1,this._EndReal(),this._parentQuery&&(this._parentQuery._StartReal(),this._parentQuery=null)}_StartReal(){this._realQuery=Us.New(js,this._renderer),this._queries.push(this._realQuery),this._realQuery.BeginTimeElapsed()}_EndReal(){this._realQuery.EndTimeElapsed(),this._realQuery=null}CheckForResult(){for(const e of this._queries)e.CheckForResult()}IsNested(){return this._isNested}HasResult(){return this._queries.every(e=>e.HasResult())}GetResult(){return this._queries.reduce((e,t)=>e+t.GetResult(),0)}GetFrameNumber(){return this._frameNumber}}}{const Hs=self.C3;Hs.Gfx.WebGLQueryResultBuffer=class{constructor(e,t=1e3){this._renderer=e,this._maxQueries=t,this._buffer=[],this._renderer._AddQueryResultBuffer(this)}Release(){this.Clear(),this._renderer._RemoveQueryResultBuffer(this),this._renderer=null}Clear(){for(const e of this._buffer)e.Release();Hs.clearArray(this._buffer)}AddTimeElapsedQuery(){const e=new Hs.Gfx.WebGLTimeElapsedQuery(this._renderer);if(this._buffer.push(e),this._buffer.length>this._maxQueries){const t=this._buffer.shift();t.Release()}return e}CheckForResults(e){for(const t of this._buffer){if(t.GetFrameNumber()>=e)return;if(t.IsNested())return;t.CheckForResult()}}GetFrameRangeResultSum(e,t){if(t<=e)return NaN;let s=0;for(const i of this._buffer){if(i.GetFrameNumber()>=t)break;if(!(i.GetFrameNumber()<e)){if(!i.HasResult())return NaN;s+=i.GetResult()}}return s}DeleteAllBeforeFrameNumber(s){for(let e=0,t=this._buffer.length;e<t;++e){const i=this._buffer[e];if(!(i.GetFrameNumber()<s))return void(0<e&&this._buffer.splice(0,e));i.Release()}}}}{let s=function(){r=-1;for(const e of i)e.checkFunc()&&(e.resolve(),i.delete(e));0<i.size&&(r=self.requestAnimationFrame(s))},G=(s,self.C3),e=self.glMatrix,I=(e.vec3,e.vec4),g=e.mat4,n={powerPreference:\"default\",enableGpuProfiling:!0,alpha:!1,depth:!1,canSampleDepth:!1,maxWebGLVersion:2,failIfMajorPerformanceCaveat:!1},a=new Set([\"default\",\"low-power\",\"high-performance\"]),u=new G.Quad(0,0,1,0,1,1,0,1),S=g.create(),y=g.create(),T=new G.Quad,C=new G.Rect,b=null,i=(G.isDebug&&(self.debug_lose_webgl_context=function(){b?b.loseContext():console.warn(\"WEBGL_lose_context not supported\")},self.debug_restore_webgl_context=function(){b?b.restoreContext():console.warn(\"WEBGL_lose_context not supported\")}),new Set),r=-1;G.Gfx.WebGLRenderer=class extends G.Gfx.RendererBase{constructor(e,t){if(super(t),t=Object.assign({},n,t),!a.has(t.powerPreference))throw new Error(\"invalid power preference\");let s={alpha:!!t.alpha,depth:!1,antialias:!1,powerPreference:t.powerPreference,failIfMajorPerformanceCaveat:!!t.failIfMajorPerformanceCaveat},i=null,r=0;if(2<=t.maxWebGLVersion&&(i=e.getContext(\"webgl2\",s),r=2),i||(i=e.getContext(\"webgl\",s),r=1),!i)throw new Error(\"renderer-unavailable (could not get WebGL context)\");this._gl=i,this._attribs=i.getContextAttributes(),this._versionString=i.getParameter(i.VERSION),this._version=r,this._viewport=I.create(),this._didChangeTransform=!1,this._bbProjectionMatrix=g.create(),this._usesDepthBuffer=!!t.depth,this._canSampleDepth=!(!t.depth||!t.canSampleDepth),this._isDepthEnabled=this._usesDepthBuffer,this._isDepthSamplingEnabled=!1,this._depthBuffer=null,this._isAutoSizeDepthBuffer=!0,this._depthBufferWidth=0,this._depthBufferHeight=0,this._vertexBuffer=null,this._texcoordBuffer=null,this._indexBuffer=null,this._pointBuffer=null,this._vertexData=new Float32Array(8e3*this.GetNumVertexComponents()),this._indexData=new Uint16Array(12e3),this._texcoordData=new Float32Array(16e3),this._pointData=new Float32Array(32e3),this._vertexPtr=0,this._texPtr=0,this._pointPtr=0,this._lastVertexPtr=0,this._lastProgram=null,this._spDeviceTransformTextureFill=null,this._batch=[],this._batchPtr=0,this._topOfBatch=0,this._currentRenderTarget=null,this._lastPointZ=0,this._batchState=G.New(G.Gfx.BatchState,this),this._lastColor=G.New(G.Color,1,1,1,1),this._lastTexture0=null,this._lastTexture1=null,this._lastSrcBlend=0,this._lastDestBlend=0,this._lastPointTexCoords=new G.Rect,this._lastScissorRect=G.New(G.Rect,0,0,-1,-1),this._coplanarMode=0,this._maxTextureSize=-1,this._minPointSize=0,this._maxPointSize=0,this._highpPrecision=0,this._unmaskedVendor=\"(unavailable)\",this._unmaskedRenderer=\"(unavailable)\",this._extensions=[],this._isInitialisingAfterContextRestored=!1,this._parallelShaderCompileExt=null,this._anisotropicExt=null,this._depthTextureExt=null,this._fragDepthExt=null,this._stdDerivativesExt=null,this._textureLodExt=null,this._maxAnisotropy=0,this._isGpuProfilingEnabled=!!t.enableGpuProfiling,this._timerExt=null,this._allQueryResultBuffers=new Set,this._timeQueryStack=[],this.FillIndexBufferData(this._indexData)}IsWebGL(){return!0}async InitState(){super.InitState();const e=this._gl,t=this.GetNumVertexComponents(),s=(this._lastColor.setRgba(1,1,1,1),this._lastTexture0=null,this._lastTexture1=null,this._vertexPtr=0,this._pointPtr=0,this._lastVertexPtr=8e3*t-4*t,G.clearArray(this._batch),this._batchPtr=0,this._topOfBatch=0,this._lastProgram=null,this._currentRenderTarget=null,this._lastPointTexCoords.set(0,0,1,1),this._lastPointZ=0,this._batchState),i=(s.currentShader=null,s.currentFramebuffer=null,s.currentFramebufferNoDepth=null,I.set(s.currentColor,1,1,1,1),s.clearColor.setRgba(0,0,0,0),s.pointTexCoords.set(0,0,1,1),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),e.enable(e.BLEND),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),this._lastSrcBlend=e.ONE,this._lastDestBlend=e.ONE_MINUS_SRC_ALPHA,this._InitBlendModes(e),e.disable(e.CULL_FACE),e.disable(e.STENCIL_TEST),e.disable(e.DITHER),this._usesDepthBuffer?(e.enable(e.DEPTH_TEST),e.depthMask(!0),e.depthFunc(e.LEQUAL)):(e.disable(e.DEPTH_TEST),e.depthMask(!1)),this._isDepthEnabled=this._usesDepthBuffer,this._isDepthSamplingEnabled=!1,this._pointBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this._pointBuffer),e.bufferData(e.ARRAY_BUFFER,this._pointData.byteLength,e.DYNAMIC_DRAW),this._vertexBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this._vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this._vertexData.byteLength,e.DYNAMIC_DRAW),this._texcoordBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this._texcoordBuffer),e.bufferData(e.ARRAY_BUFFER,this._texcoordData.byteLength,e.DYNAMIC_DRAW),this._indexBuffer=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this._indexData,e.STATIC_DRAW),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,null),this._maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),e.getParameter(e.ALIASED_POINT_SIZE_RANGE)),r=(this._minPointSize=i[0],this._maxPointSize=i[1],e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT)),n=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT),a=(this._highpPrecision=r&&n?Math.min(r.precision,n.precision):0,2048<this._maxPointSize&&(this._maxPointSize=2048),this._extensions=e.getSupportedExtensions(),e.getExtension(\"WEBGL_debug_renderer_info\"));if(a&&(this._unmaskedVendor=e.getParameter(a.UNMASKED_VENDOR_WEBGL),this._unmaskedRenderer=e.getParameter(a.UNMASKED_RENDERER_WEBGL)),this._parallelShaderCompileExt=e.getExtension(\"KHR_parallel_shader_compile\"),G.isDebug&&(b=e.getExtension(\"WEBGL_lose_context\")),this._isGpuProfilingEnabled&&(1===this.GetWebGLVersionNumber()?this._timerExt=e.getExtension(\"EXT_disjoint_timer_query\"):this._timerExt=e.getExtension(\"EXT_disjoint_timer_query_webgl2\")||e.getExtension(\"EXT_disjoint_timer_query\")),this._anisotropicExt=e.getExtension(\"EXT_texture_filter_anisotropic\"),this._anisotropicExt?this._maxAnisotropy=e.getParameter(this._anisotropicExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT):this._maxAnisotropy=0,this.GetWebGLVersionNumber()<2&&this._usesDepthBuffer&&this._canSampleDepth&&(this._depthTextureExt=e.getExtension(\"WEBGL_depth_texture\"),!this._depthTextureExt))throw new Error(\"no depth texture support\");this.GetWebGLVersionNumber()<2&&(this._fragDepthExt=e.getExtension(\"EXT_frag_depth\"),this._stdDerivativesExt=e.getExtension(\"OES_standard_derivatives\"),this._textureLodExt=e.getExtension(\"EXT_shader_texture_lod\"));let o=G.Gfx.WebGLShaderProgram,h=o.GetDefaultVertexShaderSource(!1),l=o.GetTextureFillFragmentShaderSource_WebGL1_NoFragDepth(),c=h,u=o.GetPointFragmentShaderSource_WebGL1_NoFragDepth(),_=o.GetPointVertexShaderSource_WebGL1(),d=o.GetTilemapFragmentShaderSource_WebGL1_NoFragDepth(),p=o.GetDefaultVertexShaderSource(!0),f=!1;this._usesDepthBuffer&&(this.GetWebGLVersionNumber()<2?this._fragDepthExt&&(l=o.GetTextureFillFragmentShaderSource_WebGL1_FragDepthEXT(),u=o.GetPointFragmentShaderSource_WebGL1_FragDepthEXT(),d=o.GetTilemapFragmentShaderSource_WebGL1_FragDepthEXT(),f=!0):(c=o.GetDefaultVertexShaderSource_WebGL2(),l=o.GetTextureFillFragmentShaderSource_WebGL2(),u=o.GetPointFragmentShaderSource_WebGL2(),_=o.GetPointVertexShaderSource_WebGL2(),d=o.GetTilemapFragmentShaderSource_WebGL2(),p=o.GetDefaultVertexShaderSource_WebGL2(!0)));const m=o.GetTileRandomizationFragmentShaderSource(this.GetWebGLVersionNumber(),f,this._stdDerivativesExt&&this._textureLodExt),g=2<=this.GetWebGLVersionNumber()?o.GetDefaultVertexShaderSource_WebGL2():h,S=[[l,c,\"<default>\"],[l,c,\"<default-device-transform>\"],[u,_,\"<point>\"],[o.GetColorFillFragmentShaderSource(),h,\"<fill>\"],[o.GetLinearGradientFillFragmentShaderSource(),h,\"<lineargradient>\"],[o.GetPenumbraFillFragmentShaderSource(),h,\"<penumbra>\"],[o.GetHardEllipseFillFragmentShaderSource(),h,\"<hardellipse>\"],[o.GetHardEllipseOutlineFragmentShaderSource(),h,\"<hardellipseoutline>\"],[o.GetSmoothEllipseFillFragmentShaderSource(),h,\"<smoothellipse>\"],[o.GetSmoothEllipseOutlineFragmentShaderSource(),h,\"<smoothellipseoutline>\"],[o.GetSmoothLineFillFragmentShaderSource(),h,\"<smoothline>\"],[d,p,\"<tilemap>\"],[m,g,\"<tilerandomization>\"]],y=await Promise.all(S.map(e=>this.CreateShaderProgram({src:e[0],vertexSrc:e[1],name:e[2]})));this._spTextureFill=y[0],this._spDeviceTransformTextureFill=y[1],this._spPoints=y[2],this._spColorFill=y[3],this._spLinearGradientFill=y[4],this._spPenumbraFill=y[5],this._spHardEllipseFill=y[6],this._spHardEllipseOutline=y[7],this._spSmoothEllipseFill=y[8],this._spSmoothEllipseOutline=y[9],this._spSmoothLineFill=y[10],this._spTilemapFill=y[11],this._spTileRandomization=y[12],this.SetTextureFillMode()}async CreateShaderProgram(e){const t=await G.Gfx.WebGLShaderProgram.Create(this,e);return this._AddShaderProgram(t),t}ResetLastProgram(){this._lastProgram=null}SetSize(e,t,s){if(this._width!==e||this._height!==t||s){this.EndBatch();const i=this._gl,r=this._batchState;this._width=e,this._height=t,this._SetViewport(0,0,e,t),this.CalculatePerspectiveMatrix(this._bbProjectionMatrix,e/t),this.SetProjectionMatrix(this._bbProjectionMatrix),this._spDeviceTransformTextureFill&&(i.useProgram(this._spDeviceTransformTextureFill.GetShaderProgram()),this._spDeviceTransformTextureFill._UpdateDeviceTransformUniforms(this._matP),this._lastProgram=this._spDeviceTransformTextureFill,this._batchState.currentShader=this._spDeviceTransformTextureFill),i.bindTexture(i.TEXTURE_2D,null),i.activeTexture(i.TEXTURE1),i.bindTexture(i.TEXTURE_2D,null),i.activeTexture(i.TEXTURE0),this._lastTexture0=null,this._lastTexture1=null,this._usesDepthBuffer&&this._isAutoSizeDepthBuffer&&this._SetDepthBufferSize(this._width,this._height),this._currentRenderTarget&&this._currentRenderTarget._Resize(this._width,this._height),i.bindFramebuffer(i.FRAMEBUFFER,null),this._currentRenderTarget=null,r.currentFramebuffer=null,r.currentFramebufferNoDepth=null}}_SetDepthBufferSize(e,t){const s=this._gl;this._depthBuffer&&this._depthBufferWidth===e&&this._depthBufferHeight===t||(this._canSampleDepth?(this._depthBuffer&&s.deleteTexture(this._depthBuffer),this._depthBuffer=s.createTexture(),s.bindTexture(s.TEXTURE_2D,this._depthBuffer),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.NEAREST),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.NEAREST),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),2<=this.GetWebGLVersionNumber()?s.texImage2D(s.TEXTURE_2D,0,s.DEPTH24_STENCIL8,e,t,0,s.DEPTH_STENCIL,s.UNSIGNED_INT_24_8,null):this._depthTextureExt&&s.texImage2D(s.TEXTURE_2D,0,s.DEPTH_STENCIL,e,t,0,s.DEPTH_STENCIL,this._depthTextureExt.UNSIGNED_INT_24_8_WEBGL,null),s.bindTexture(s.TEXTURE_2D,null)):(this._depthBuffer&&s.deleteRenderbuffer(this._depthBuffer),this._depthBuffer=s.createRenderbuffer(),s.bindRenderbuffer(s.RENDERBUFFER,this._depthBuffer),s.renderbufferStorage(s.RENDERBUFFER,2<=this._version?s.DEPTH24_STENCIL8:s.DEPTH_STENCIL,e,t),s.bindRenderbuffer(s.RENDERBUFFER,null)),this._depthBufferWidth=e,this._depthBufferHeight=t)}SetFixedSizeDepthBuffer(e,t){this._usesDepthBuffer&&(this._isAutoSizeDepthBuffer=!1,this._SetDepthBufferSize(e,t))}SetAutoSizeDepthBuffer(){this._usesDepthBuffer&&(this._isAutoSizeDepthBuffer=!0,this._SetDepthBufferSize(this._width,this._height))}_SetViewport(e,t,s,i){const r=this._viewport;if(r[0]!==e||r[1]!==t||r[2]!==s||r[3]!==i){const n=this.PushBatch();n.InitSetViewport(e,t,s,i),I.set(r,e,t,s,i),this._topOfBatch=0}}SetFovY(e){super.SetFovY(e),this.CalculatePerspectiveMatrix(this._bbProjectionMatrix,this._width/this._height)}SetNearZ(e){super.SetNearZ(e),this.CalculatePerspectiveMatrix(this._bbProjectionMatrix,this._width/this._height)}SetFarZ(e){super.SetFarZ(e),this.CalculatePerspectiveMatrix(this._bbProjectionMatrix,this._width/this._height)}SetProjectionMatrix(e){if(!g.exactEquals(this._matP,e)){const t=this.PushBatch();t.InitSetProjection(e),g.copy(this._matP,e),this._topOfBatch=0,this._didChangeTransform=!0}}SetDefaultRenderTargetProjectionState(){let e,t,s,i=this._currentRenderTarget;s=(null===i?(e=this._bbProjectionMatrix,t=this.GetWidth(),this):(e=i.GetProjectionMatrix(),t=i.GetWidth(),i)).GetHeight(),this.SetProjectionMatrix(e),this._SetViewport(0,0,t,s)}SetModelViewMatrix(e){if(!g.exactEquals(this._matMV,e)){const t=this.PushBatch();t.InitSetModelView(e),g.copy(this._matMV,e),this._topOfBatch=0,this._didChangeTransform=!0}}ResetDidChangeTransformFlag(){this._didChangeTransform=!1}DidChangeTransform(){return this._didChangeTransform}GetBatchState(){return this._batchState}PushBatch(){const e=this._batch;return this._batchPtr===e.length&&e.push(new G.Gfx.WebGLBatchJob(this._batchState)),e[this._batchPtr++]}EndBatch(){0===this._batchPtr||this.IsContextLost()||(this._WriteBuffers(),this._ExecuteBatch(),this._batchPtr=0,this._vertexPtr=0,this._texPtr=0,this._pointPtr=0,this._topOfBatch=0)}_WriteBuffers(){const e=this._gl;0<this._pointPtr&&(e.bindBuffer(e.ARRAY_BUFFER,this._pointBuffer),e.bufferSubData(e.ARRAY_BUFFER,0,this._pointData.subarray(0,this._pointPtr))),0<this._vertexPtr&&(e.bindBuffer(e.ARRAY_BUFFER,this._vertexBuffer),e.bufferSubData(e.ARRAY_BUFFER,0,this._vertexData.subarray(0,this._vertexPtr)),e.bindBuffer(e.ARRAY_BUFFER,this._texcoordBuffer),e.bufferSubData(e.ARRAY_BUFFER,0,this._texcoordData.subarray(0,this._texPtr)))}_ExecuteBatch(){const s=this._batch;for(let e=0,t=this._batchPtr;e<t;++e)s[e].Run()}GetOpacity(){return this._lastColor.getA()}SetColorRgba(e,t,s,i){const r=this._lastColor;if(!r.equalsRgba(e,t,s,i)){r.setRgba(e,t,s,i);const n=this.PushBatch();n.InitSetColor(r),this._topOfBatch=0,this._currentStateGroup=null}}SetOpacity(e){const t=this._lastColor;if(t.getA()!==e){t.setA(e);const s=this.PushBatch();s.InitSetColor(t),this._topOfBatch=0,this._currentStateGroup=null}}SetColor(e){const t=this._lastColor;if(!t.equals(e)){t.set(e);const s=this.PushBatch();s.InitSetColor(t),this._topOfBatch=0,this._currentStateGroup=null}}ResetColor(){this.SetColorRgba(1,1,1,1)}GetColor(){return this._lastColor}SetTexture(e){if(e!==this._lastTexture0){const t=this.PushBatch();t.InitSetTexture(e),this._lastTexture0=e,this._topOfBatch=0}}_ResetLastTexture(){this._lastTexture0=null}SetBlendMode(e){const t=this._GetBlendByIndex(e);this._SetBlend(t[0],t[1])}SetNamedBlendMode(e){const t=this.GetNamedBlend(e);this._SetBlend(t.srcBlend,t.destBlend)}_SetBlend(e,t){if(e!==this._lastSrcBlend||t!==this._lastDestBlend){const s=this.PushBatch();s.InitSetBlend(e,t),this._lastSrcBlend=e,this._lastDestBlend=t,this._topOfBatch=0,this._currentStateGroup=null}}IsPremultipliedAlphaBlend(){return this._lastSrcBlend===this._gl.ONE&&this._lastDestBlend===this._gl.ONE_MINUS_SRC_ALPHA}SetAlphaBlend(){this._SetBlend(this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA)}SetNoPremultiplyAlphaBlend(){this._SetBlend(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA)}SetCopyBlend(){this._SetBlend(this._gl.ONE,this._gl.ZERO)}Rect(e){this.Rect2(e.getLeft(),e.getTop(),e.getRight(),e.getBottom())}Rect2(e,t,s,i){this.Quad2(e,t,s,t,s,i,e,i)}_ExtendQuadBatch(){let e=this._vertexPtr;if(e>=this._lastVertexPtr&&(this.EndBatch(),e=0),1===this._topOfBatch)this._batch[this._batchPtr-1]._indexCount+=6;else{const t=this.PushBatch();t.InitQuad(e,6),this._topOfBatch=1}}_WriteQuadToVertexBuffer(e){e.writeToTypedArray3D(this._vertexData,this._vertexPtr,this._baseZ+this._currentZ),this._vertexPtr+=12}Quad(e){this._ExtendQuadBatch(),this._WriteQuadToVertexBuffer(e),u.writeToTypedArray(this._texcoordData,this._texPtr),this._texPtr+=8}Quad2(e,t,s,i,r,n,a,o){this._ExtendQuadBatch();let h=this._vertexData,l=this._vertexPtr,c=this._baseZ+this._currentZ;h[l++]=e,h[l++]=t,h[l++]=c,h[l++]=s,h[l++]=i,h[l++]=c,h[l++]=r,h[l++]=n,h[l++]=c,h[l++]=a,h[l++]=o,h[l++]=c,this._vertexPtr=l,u.writeToTypedArray(this._texcoordData,this._texPtr),this._texPtr+=8}Quad3(e,t){this._ExtendQuadBatch(),this._WriteQuadToVertexBuffer(e),t.writeAsQuadToTypedArray(this._texcoordData,this._texPtr),this._texPtr+=8}Quad4(e,t){this._ExtendQuadBatch(),this._WriteQuadToVertexBuffer(e),t.writeToTypedArray(this._texcoordData,this._texPtr),this._texPtr+=8}Quad3D(e,t,s,i,r,n,a,o,h,l,c,u,_){this._ExtendQuadBatch();let d=this._vertexData,p=this._vertexPtr,f=this._baseZ+this._currentZ;d[p++]=e,d[p++]=t,d[p++]=f+s,d[p++]=i,d[p++]=r,d[p++]=f+n,d[p++]=a,d[p++]=o,d[p++]=f+h,d[p++]=l,d[p++]=c,d[p++]=f+u,this._vertexPtr=p,_.writeAsQuadToTypedArray(this._texcoordData,this._texPtr),this._texPtr+=8}Quad3D2(e,t,s,i,r,n,a,o,h,l,c,u,_){this._ExtendQuadBatch();let d=this._vertexData,p=this._vertexPtr,f=this._baseZ+this._currentZ;d[p++]=e,d[p++]=t,d[p++]=f+s,d[p++]=i,d[p++]=r,d[p++]=f+n,d[p++]=a,d[p++]=o,d[p++]=f+h,d[p++]=l,d[p++]=c,d[p++]=f+u,this._vertexPtr=p,_.writeToTypedArray(this._texcoordData,this._texPtr),this._texPtr+=8}DrawMesh(i,r,n){const a=this._vertexData,o=this._texcoordData;if(n.length%3!=0)throw new Error(\"invalid index buffer length\");for(let s=0,e=n.length;s<e;){const h=n[s++],l=n[s++],c=n[s++],u=3*h,_=3*l,d=3*c,p=2*h,f=2*l,m=2*c;this._ExtendQuadBatch();let e=this._vertexPtr,t=this._texPtr;a[e++]=i[0+u],a[e++]=i[1+u],a[e++]=i[2+u],a[e++]=i[0+_],a[e++]=i[1+_],a[e++]=i[2+_],a[e++]=i[0+d],a[e++]=i[1+d],a[e++]=i[2+d],a[e++]=i[0+d],a[e++]=i[1+d],a[e++]=i[2+d],o[t++]=r[0+p],o[t++]=r[1+p],o[t++]=r[0+f],o[t++]=r[1+f],o[t++]=r[0+m],o[t++]=r[1+m],o[t++]=r[0+m],o[t++]=r[1+m],this._vertexPtr=e,this._texPtr=t}}FullscreenQuad(e,t){this.SetCurrentZ(0),g.copy(S,this._matP),g.copy(y,this._matMV),this.SetDefaultRenderTargetProjectionState();const[s,i]=this.GetRenderTargetSize(this._currentRenderTarget),r=this.CalculateLookAtModelView2(0,0,this.GetDefaultCameraZ(i),0,0,0,i);if(this.SetModelViewMatrix(r),\"crop\"===e&&this._currentRenderTarget&&t){const n=this._width/2,a=this._height/2,o=t.GetWidth(),h=t.GetHeight(),l=this._currentRenderTarget.GetWidth(),c=this._currentRenderTarget.GetHeight(),u=Math.min(l,o),_=Math.min(c,h),d=Math.max(h-c,0),p=Math.max(c-h,0);C.set(-n,a-p,-n+u,a-_-p),T.setFromRect(C),C.set(0,d,u,_+d),C.divide(o,h),this.Quad3(T,C)}else{const f=s/2,m=i/2;this.Rect2(-f,m,f,-m)}this.SetProjectionMatrix(S),this.SetModelViewMatrix(y)}StartRenderingPoints(e){if(!this._lastPointTexCoords.equals(e)){this._lastPointTexCoords.copy(e);const t=this.PushBatch();t.InitSetPointTexCoords(e),this._topOfBatch=0}}FinishRenderingPoints(){}Point(e,t,s,i){7996<=this._pointPtr&&this.EndBatch();let r=this._pointPtr,n=this._baseZ+this._currentZ;if(2===this._topOfBatch&&this._lastPointZ===n)this._batch[this._batchPtr-1]._indexCount++;else{const o=this.PushBatch();o.InitPoints(r,n),this._topOfBatch=2,this._lastPointZ=n}const a=this._pointData;a[r++]=e,a[r++]=t,a[r++]=s,a[r++]=i,this._pointPtr=r}SetProgram(e){if(this._lastProgram!==e){const t=this.PushBatch();t.InitSetProgram(e),this._lastProgram=e,this._topOfBatch=0,this._currentStateGroup=null}}GetProgram(){return this._lastProgram}SetDeviceTransformTextureFillMode(){this.SetProgram(this._spDeviceTransformTextureFill)}SetGradientColor(e){const t=this.PushBatch();t.InitSetGradientColor(e),this._topOfBatch=0}SetEllipseParams(e,t,s=1){const i=this.PushBatch();i.InitSetEllipseParams(e,t,s),this._topOfBatch=0}SetTilemapInfo(e,t,s,i,r,n,a){if(this._lastProgram!==this._spTilemapFill)throw new Error(\"must set tilemap fill mode first\");const o=this.PushBatch();o.InitSetTilemapInfo(e,t,s,i,r,n,a),this._topOfBatch=0}SetTileRandomizationInfo(e,t,s,i,r,n,a){if(this._lastProgram!==this._spTileRandomization)throw new Error(\"must set tile randomization mode first\");const o=this.PushBatch();o.InitSetTileRandomizationInfo(e,t,s,i,r,n,a),this._topOfBatch=0}SetProgramParameters(e,t,s,i,r,n,a,o,h,l,c){const u=this._lastProgram;if(c%=10800,u._hasAnyOptionalUniforms&&!u.AreOptionalUniformsAlreadySetInBatch(t,s,i,r,n,a,o,h,l,c)){const _=this.PushBatch(),d=(_.InitSetProgramParameters(),u.SetOptionalUniformsInBatch(t,s,i,r,n,a,o,h,l,c),_._mat4param),p=(d[0]=n,d[1]=a,t.writeToTypedArray(d,2),d[6]=h,d[7]=l,s.writeToTypedArray(d,12),_._colorParam),f=(r.writeToTypedArray(p,0),p[1]);p[1]=p[3],p[3]=f,i.writeToTypedArray(_._srcOriginRect,0),_._startIndex=c,_._indexCount=o,u._uSamplerBack.IsUsed()?_._texParam=e?e.GetTexture():null:_._texParam=null,this._topOfBatch=0}}SetProgramCustomParameters(e){const t=this._lastProgram;if(0!==e.length&&!t.AreCustomParametersAlreadySetInBatch(e)){const s=this.PushBatch();s.InitSetProgramCustomParameters(),t.SetCustomParametersInBatch(e),G.shallowAssignArray(s._shaderParams,e),this._topOfBatch=0}}ClearRgba(e,t,s,i){const r=this.PushBatch();r.InitClearSurface2(e,t,s,i),this._topOfBatch=0}Clear(e){const t=this.PushBatch();t.InitClearSurface(e),this._topOfBatch=0}Start(){}Finish(){super.Finish(),this._gl.flush()}ClearDepth(){if(this._usesDepthBuffer&&this._currentRenderTarget&&this._currentRenderTarget.HasDepthBuffer()){const e=this.PushBatch();e.InitClearDepth(this._isDepthEnabled),this._topOfBatch=0}}SetDepthEnabled(e){if(this._isDepthEnabled!==(e=!!e)&&this._usesDepthBuffer){this._isDepthEnabled=e;const t=this.PushBatch();t.InitSetDepthEnabled(e),this._topOfBatch=0}}IsDepthEnabled(){return this._isDepthEnabled}_GetDepthBuffer(){return this._depthBuffer}_CanSampleDepth(){return this._canSampleDepth}SetDepthSamplingEnabled(e){if(e=!!e,this._canSampleDepth&&this._isDepthSamplingEnabled!==e){if(e&&this.IsDepthEnabled())throw new Error(\"depth still enabled\");this._isDepthSamplingEnabled=e;const t=this.PushBatch();t.InitSetDepthSamplingEnabled(e),this._topOfBatch=0}}SetScissorRect(e,t,s,i,r=0){if(e=Math.floor(e),t=Math.floor(t),s=Math.floor(s),i=Math.floor(i),!this._lastScissorRect.equalsWH(e,t,s,i)){this._lastScissorRect.setWH(e,t,s,i);const n=r||this.GetRenderTargetSize(this.GetRenderTarget())[1],a=(t=n-t-i,this.PushBatch());a.InitSetScissor(!0,e,t,s,i),this._topOfBatch=0}}RemoveScissorRect(){if(-1!==this._lastScissorRect.getRight()){this._lastScissorRect.set(0,0,-1,-1);const e=this.PushBatch();e.InitSetScissor(!1,0,0,0,0),this._topOfBatch=0}}CheckForQueryResults(){for(const e of this._allQueryResultBuffers)e.CheckForResults(this._frameNumber)}IsContextLost(){return!this._gl||this._gl.isContextLost()||this._isInitialisingAfterContextRestored}OnContextLost(){super.OnDeviceOrContextLost(),G.Gfx.WebGLRendererTexture.OnContextLost(),G.Gfx.WebGLRenderTarget.OnContextLost(),G.Gfx.RendererText.OnContextLost();for(const e of this._allQueryResultBuffers)e.Clear();this._extensions=[],this._timerExt=null,this._parallelShaderCompileExt=null,this._anisotropicExt=null,this._depthTextureExt=null,this._fragDepthExt=null,this._stdDerivativesExt=null,this._textureLodExt=null,this._maxAnisotropy=0,this._unmaskedVendor=\"(unavailable)\",this._unmaskedRenderer=\"(unavailable)\",this._lastProgram=null,this._spDeviceTransformTextureFill=null,this._depthBuffer=null;for(const t of this._stateGroups.values())t.OnContextLost()}async OnContextRestored(){this._isInitialisingAfterContextRestored=!0,await this.InitState(),this._isInitialisingAfterContextRestored=!1;for(const e of this._stateGroups.values())e.OnContextRestored(this);this.SetSize(this._width,this._height,!0)}CreateStaticTexture(e,t){if(this.IsContextLost())throw new Error(\"context lost\");this.EndBatch();const s=G.New(G.Gfx.WebGLRendererTexture,this);return s._CreateStatic(e,t),s}async CreateStaticTextureAsync(i,r){if(this.IsContextLost())throw new Error(\"context lost\");if(r=Object.assign({},r),G.Supports.ImageBitmapOptions){let e=await createImageBitmap(i,{premultiplyAlpha:\"premultiply\"}),t=r.wrapX&&\"clamp-to-edge\"!==r.wrapX||r.wrapY&&\"clamp-to-edge\"!==r.wrapY,s=G.isPOT(e.width)&&G.isPOT(e.height);return this.SupportsNPOTTextures()||s||!t?r.premultiplyAlpha=!1:G.Supports.ImageBitmapOptionsResize?(e=await createImageBitmap(i,{premultiplyAlpha:\"premultiply\",resizeWidth:G.nextHighestPowerOfTwo(e.width),resizeHeight:G.nextHighestPowerOfTwo(e.height)}),r.premultiplyAlpha=!1):e=await createImageBitmap(i,{premultiplyAlpha:\"none\"}),G.Asyncify(()=>this.CreateStaticTexture(e,r))}if(i instanceof Blob){if(\"undefined\"==typeof Image)throw new Error(\"texture upload variant not supported in worker\");const e=await G.BlobToImage(i);i=e}return G.Asyncify(()=>this.CreateStaticTexture(i,r))}CreateDynamicTexture(e,t,s){this.EndBatch();const i=G.New(G.Gfx.WebGLRendererTexture,this);return i._CreateDynamic(e,t,s),i}UpdateTexture(e,t,s){this.EndBatch(),t._Update(e,s)}DeleteTexture(e){e&&(e.SubtractReference(),0<e.GetReferenceCount()||(this.EndBatch(),e===this._lastTexture0&&(this._gl.bindTexture(this._gl.TEXTURE_2D,null),this._lastTexture0=null),e===this._lastTexture1&&(this._gl.activeTexture(this._gl.TEXTURE1),this._gl.bindTexture(this._gl.TEXTURE_2D,null),this._gl.activeTexture(this._gl.TEXTURE0),this._lastTexture1=null),e._Delete()))}CreateRenderTarget(e){let t=this._width,s=this._height,i=!0;if(e&&(\"number\"==typeof e.width&&(t=Math.floor(e.width),i=!1),\"number\"==typeof e.height)&&(s=Math.floor(e.height),i=!1),t<=0||s<=0)throw new Error(\"invalid size\");this.EndBatch();const r=G.New(G.Gfx.WebGLRenderTarget,this);return r._Create(t,s,Object.assign({isDefaultSize:i},e)),this._currentRenderTarget=null,this._batchState.currentFramebuffer=null,this._batchState.currentFramebufferNoDepth=null,r}SetRenderTarget(e,t=!0){if(e!==this._currentRenderTarget){e&&e.IsDefaultSize()&&e._Resize(this._width,this._height);const s=this.PushBatch();s.InitSetRenderTarget(e),this._currentRenderTarget=e,this._topOfBatch=0,t&&this.SetDefaultRenderTargetProjectionState()}}GetRenderTarget(){return this._currentRenderTarget}GetRenderTargetSize(e){return e?[e.GetWidth(),e.GetHeight()]:[this._width,this._height]}CopyRenderTarget(e,t=\"stretch\"){if(this._version<2||this._currentRenderTarget&&0<this._currentRenderTarget.GetMultisampling())this.SetCopyBlend(),this.ResetColor(),this.DrawRenderTarget(e,t);else{const s=this.PushBatch();s.InitBlitFramebuffer(e,this._currentRenderTarget,t),this._topOfBatch=0}}DrawRenderTarget(e,t=\"stretch\"){const s=e.GetTexture();if(!s)throw new Error(\"not a texture-backed render target\");this.SetTexture(s),this.FullscreenQuad(t,s)}InvalidateRenderTarget(e){if(!(this._version<2)){const t=this.PushBatch();t.InitInvalidateFramebuffer(e._GetFramebuffer()),this._topOfBatch=0}}DeleteRenderTarget(e){this.SetRenderTarget(null),this.EndBatch();const t=e.GetTexture();t===this._lastTexture0&&(this._gl.bindTexture(this._gl.TEXTURE_2D,null),this._lastTexture0=null),t===this._lastTexture1&&(this._gl.activeTexture(this._gl.TEXTURE1),this._gl.bindTexture(this._gl.TEXTURE_2D,null),this._gl.activeTexture(this._gl.TEXTURE0),this._lastTexture1=null),e._Delete()}async ReadBackRenderTargetToImageData(e,t,s){this.EndBatch();let i=this._currentRenderTarget,r,n,a,o=(a=e?(r=e.GetWidth(),n=e.GetHeight(),e._GetFramebuffer()):(r=this.GetWidth(),n=this.GetHeight(),null),0),h=0,l=r,c=n;if(s){o=G.clamp(Math.floor(s.getLeft()),0,r-1),h=G.clamp(Math.floor(s.getTop()),0,n-1);let e=s.width(),t=(e=0===e?r-o:G.clamp(Math.floor(e),0,r-o),s.height());t=0===t?n-h:G.clamp(Math.floor(t),0,n-h),l=e,c=t,h=n-(h+c)}let u=this._gl,_=(u.bindFramebuffer(u.FRAMEBUFFER,a),()=>{u.bindFramebuffer(u.FRAMEBUFFER,null),this._currentRenderTarget=null,this._batchState.currentFramebuffer=null,this._batchState.currentFramebufferNoDepth=null,this.SetRenderTarget(i)}),d;if(!t&&2<=this.GetWebGLVersionNumber()){u.bindFramebuffer(u.READ_FRAMEBUFFER,a);const p=u.createBuffer(),f=l*c*4,m=u.PIXEL_PACK_BUFFER,g=(u.bindBuffer(m,p),u.bufferData(m,f,u.STREAM_READ),u.readPixels(o,h,l,c,u.RGBA,u.UNSIGNED_BYTE,0),u.bindFramebuffer(u.READ_FRAMEBUFFER,null),u.bindBuffer(m,null),_(),u.fenceSync(u.SYNC_GPU_COMMANDS_COMPLETE,0));await this._WaitForObjectReady(()=>u.getSyncParameter(g,u.SYNC_STATUS)===u.SIGNALED),u.deleteSync(g),d=new ImageData(l,c),u.bindBuffer(m,p),u.getBufferSubData(m,0,new Uint8Array(d.data.buffer),0,f),u.bindBuffer(m,null),u.deleteBuffer(p)}else d=new ImageData(l,c),u.readPixels(o,h,l,c,u.RGBA,u.UNSIGNED_BYTE,new Uint8Array(d.data.buffer)),_();return d}CoplanarStartStencilPass(){this.SetDepthEnabled(!0);const e=this.PushBatch();e.InitCoplanarStartStencilPass(),this._topOfBatch=0,this._coplanarMode=1}CoplanarStartColorPass(){this.SetDepthEnabled(!1);const e=this.PushBatch();e.InitCoplanarStartColorPass(),this._topOfBatch=0,this._coplanarMode=2}IsCoplanarColorPass(){return 2===this._coplanarMode}CoplanarRestoreStandardRendering(){this.SetDepthEnabled(!0);const e=this.PushBatch();e.InitCoplanarRestore(),this._topOfBatch=0,this._coplanarMode=0}StartQuery(e){if(this.SupportsGPUProfiling()){const t=this.PushBatch();t.InitStartQuery(e),this._topOfBatch=0}}EndQuery(e){if(this.SupportsGPUProfiling()){const t=this.PushBatch();t.InitEndQuery(e),this._topOfBatch=0}}_WaitForObjectReady(t){const e=new Promise(e=>i.add({resolve:e,checkFunc:t}));return-1===r&&(r=self.requestAnimationFrame(s)),e}GetEstimatedBackBufferMemoryUsage(){return this._width*this._height*(this._attribs.alpha?4:3)}GetEstimatedRenderBufferMemoryUsage(){let e=0;for(const t of G.Gfx.WebGLRenderTarget.allRenderTargets())t.GetTexture()||(e+=t.GetEstimatedMemoryUsage());return e}GetEstimatedTextureMemoryUsage(){let e=0;for(const t of G.Gfx.WebGLRendererTexture.allTextures())e+=t.GetEstimatedMemoryUsage();return e}GetWebGLVersionString(){return this._versionString}GetWebGLVersionNumber(){return this._version}GetDisplayName(){return\"webgl\"+this.GetWebGLVersionNumber()}SupportsNPOTTextures(){return 2<=this.GetWebGLVersionNumber()}GetMaxTextureSize(){return this._maxTextureSize}GetMinPointSize(){return this._minPointSize}GetMaxPointSize(){return this._maxPointSize}SupportsHighP(){return 0!==this._highpPrecision}GetHighPPrecision(){return this._highpPrecision}GetUnmaskedVendor(){return this._unmaskedVendor}GetUnmaskedRenderer(){return this._unmaskedRenderer}GetWebGLExtensionsAnalyticsString(){if(2<=this.GetWebGLVersionNumber())return\"webgl2\";{const e=[];return this._fragDepthExt&&e.push(\"EXT_frag_depth\"),this._stdDerivativesExt&&e.push(\"OES_standard_derivatives\"),this._textureLodExt&&e.push(\"EXT_shader_texture_lod\"),0<e.length?\"webgl1:\"+e.join(\",\"):\"webgl1:none\"}}GetExtensions(){return this._extensions}SupportsGPUProfiling(){return!!this._timerExt}_GetDisjointTimerQueryExtension(){return this._timerExt}_GetParallelShaderCompileExtension(){return this._parallelShaderCompileExt}_GetAnisotropicExtension(){return this._anisotropicExt}_GetMaxAnisotropy(){return this._maxAnisotropy}_AddQueryResultBuffer(e){this._allQueryResultBuffers.add(e)}_RemoveQueryResultBuffer(e){this._allQueryResultBuffers.delete(e)}_GetTimeQueryStack(){return this._timeQueryStack}GetContext(){return this._gl}_InitBlendModes(e){this._InitBlendModeData([[\"normal\",e.ONE,e.ONE_MINUS_SRC_ALPHA],[\"additive\",e.ONE,e.ONE],[\"xor\",e.ONE,e.ONE_MINUS_SRC_ALPHA],[\"copy\",e.ONE,e.ZERO],[\"destination-over\",e.ONE_MINUS_DST_ALPHA,e.ONE],[\"source-in\",e.DST_ALPHA,e.ZERO],[\"destination-in\",e.ZERO,e.SRC_ALPHA],[\"source-out\",e.ONE_MINUS_DST_ALPHA,e.ZERO],[\"destination-out\",e.ZERO,e.ONE_MINUS_SRC_ALPHA],[\"source-atop\",e.DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],[\"destination-atop\",e.ONE_MINUS_DST_ALPHA,e.SRC_ALPHA]])}CreateWebGLText(){return this.CreateRendererText()}}}{const Xs=self.C3,zs={getDrawSize:null,getRenderTarget:null,releaseRenderTarget:null,getTime:null,redraw:null};Xs.Gfx.EffectChainManager=class{constructor(e){e=Object.assign({},zs,e),this._cbGetDrawSize=e.getDrawSize,this._cbGetRenderTarget=e.getRenderTarget,this._cbReleaseRenderTarget=e.releaseRenderTarget,this._cbGetTime=e.getTime,this._cbRedraw=e.redraw,this._webgpuBackTexture=null,this._allEffectChains=new Set}_AddEffectChain(e){this._allEffectChains.add(e)}_RemoveEffectChain(e){this._allEffectChains.delete(e)}OnContextLost(){this._webgpuBackTexture=null;for(const e of this._allEffectChains)e.OnContextLost()}GetDrawSize(e){return this._cbGetDrawSize?this._cbGetDrawSize(e):[e.GetWidth(),e.GetHeight()]}GetRenderTarget(e){return this._cbGetRenderTarget(e)}ReleaseRenderTarget(e,t){this._cbReleaseRenderTarget(e,t)}GetTime(){return this._cbGetTime()}Redraw(e){this._cbRedraw(e)}_GetWebGPUBackTexture(e,t,s){return t=Math.floor(t),s=Math.floor(s),!this._webgpuBackTexture||this._webgpuBackTexture.GetWidth()===t&&this._webgpuBackTexture.GetHeight()===s||(e.DeleteTexture(this._webgpuBackTexture),this._webgpuBackTexture=null),null===this._webgpuBackTexture&&(this._webgpuBackTexture=e.CreateStaticTexture(null,{width:t,height:s,sampling:\"nearest\",mipMap:!1})),this._webgpuBackTexture}}}{const o=self.C3,Ys=self.glMatrix,Cr=Ys.mat4,qs=o.New(o.Rect),Ks=o.New(o.Rect),Js=o.New(o.Rect),Zs=o.New(o.Rect),Qs=Cr.create(),$s=Cr.create(),ei={drawContent:null,getSourceTextureInfo:null,getShaderParameters:null,invalidateRenderTargets:!1},ti={indexMap:null,forcePreDraw:!1,forcePostDraw:!1,is3D:!1,isSourceTextureRotated:!1,isRotatedOrNegativeSizeInstance:!1,useFullSurface:!1};o.Gfx.EffectChain=class{constructor(e,t){t=Object.assign({},ei,t),this._manager=e,this._cbDrawContent=t.drawContent,this._cbGetSourceTextureInfo=t.getSourceTextureInfo,this._cbGetShaderParameters=t.getShaderParameters,this._cbDrawContentHook=null,this._shaderProgramList=[],this._shaderProgramIndices=[],this._steps=[],this._needsRebuild=!1,this._blendMode=0,this._isAnyShaderAnimated=!1,this._isAnyShaderDepthSampling=!1,this._isAnyShaderBackgroundBlending=!1,this._isAnyShaderCrossSampling=!1,this._isAnyIsSrcTexRotated=!1,this._useCopyTextureBackgroundSampling=!1,this._didChangeTransform=!1,this._depthEnabledAtStart=!1,this._coplanarColorPassAtStart=!1,this._canUseFastPath=!1,this._useFullSurface=!1,this._isSourceTextureRotated=!1,this._numTempSurfacesRequired=0,this._renderTargets=[null,null,null],this._invalidateRenderTargets=!!t.invalidateRenderTargets,this._boxExtendHorizontal=0,this._boxExtendVertical=0,this._drawWidth=0,this._drawHeight=0,this._contentObject=null,this._contextObject=null,this._layoutRect=o.New(o.Rect),this._drawSurfaceRect=o.New(o.Rect),this._rcTexOriginal=o.New(o.Rect),this._rcTexBounce=o.New(o.Rect),this._rcTexDest=o.New(o.Rect),this._devicePixelRatio=1,this._layerScale=1,this._layerAngle=0,this._time=0,this._destRenderTarget=null,this._backTex=null,this._compositOffX=0,this._compositOffY=0,this._updateOwnProjection=!1,this._projectionMatrix=Cr.create(),this._modelViewMatrix=Cr.create(),this._manager._AddEffectChain(this)}Release(){this._manager._RemoveEffectChain(this),o.clearArray(this._steps),o.clearArray(this._shaderProgramList),o.clearArray(this._shaderProgramIndices),this._contentObject=null,this._contextObject=null,this._cbDrawContent=null,this._cbGetSourceTextureInfo=null,this._cbGetShaderParameters=null}OnContextLost(){this._needsRebuild=!0,o.clearArray(this._steps),o.clearArray(this._shaderProgramList),o.clearArray(this._shaderProgramIndices)}NeedsRebuild(){return this._needsRebuild}BuildSteps(r,e){if(e=Object.assign({},ti,e),o.clearArray(this._steps),this._boxExtendHorizontal=0,this._boxExtendVertical=0,this._isAnyShaderAnimated=!1,this._isAnyShaderDepthSampling=!1,this._isAnyShaderBackgroundBlending=!1,this._isAnyShaderCrossSampling=!1,this._isAnyIsSrcTexRotated=!1,this._useCopyTextureBackgroundSampling=!1,this._numTempSurfacesRequired=0,this._isSourceTextureRotated=!!e.isSourceTextureRotated,this._useFullSurface=!!e.useFullSurface,this._needsRebuild=!1,o.shallowAssignArray(this._shaderProgramList,r),0!==r.length){if(e.indexMap){if(e.indexMap.length!==r.length)throw new Error(\"incorrect indexMap length\");o.shallowAssignArray(this._shaderProgramIndices,e.indexMap)}else{o.clearArray(this._shaderProgramIndices);for(let e=0,t=r.length;e<t;++e)this._shaderProgramIndices.push(e)}for(const t of r)this._boxExtendHorizontal+=t.GetBoxExtendHorizontal(),this._boxExtendVertical+=t.GetBoxExtendVertical(),t.IsAnimated()&&(this._isAnyShaderAnimated=!0),t.UsesDepth()&&(this._isAnyShaderDepthSampling=!0),t.BlendsBackground()&&(this._isAnyShaderBackgroundBlending=!0),t.UsesCrossSampling()&&(this._isAnyShaderCrossSampling=!0),t.UsesIsSrcTexRotated()&&(this._isAnyIsSrcTexRotated=!0);this._useCopyTextureBackgroundSampling=this._ShouldUseCopyTextureBackgroundSampling(r[0].GetRenderer());const n=this._ShouldPreDraw(r[0],e),a=this._ShouldPostDraw(r.at(-1),e);if(1!==r.length||n||a){this._canUseFastPath=!1;let i=0;n&&(this._numTempSurfacesRequired=1,this._steps.push(o.New(o.Gfx.EffectChain.Step.PreDraw,this,-1,1)),i=1);for(let t=0,s=r.length;t<s;++t)if(0!==t||n){let e=1===i?2:1;t!==s-1||a||(e=0),this._numTempSurfacesRequired=Math.max(this._numTempSurfacesRequired,e),this._steps.push(o.New(o.Gfx.EffectChain.Step.Bounce,this,i,e,t)),i=e}else this._numTempSurfacesRequired=1,this._steps.push(o.New(o.Gfx.EffectChain.Step.FirstBounce,this,-1,1,t)),i=1;a&&this._steps.push(o.New(o.Gfx.EffectChain.Step.PostDraw,this,i,0))}else this._canUseFastPath=!0}}_ShouldPreDraw(e,t){return!!(t.forcePreDraw||e.MustPreDraw()||t.is3D&&!e.Supports3DDirectRendering()||e.UsesDepth()&&!this._useFullSurface||0!==this._boxExtendHorizontal||0!==this._boxExtendVertical)||(e.GetRenderer().IsWebGL()?e.BlendsBackground()&&(t.isRotatedOrNegativeSizeInstance||t.isSourceTextureRotated)||e.UsesAnySrcRectOrPixelSize()&&t.isSourceTextureRotated:e.BlendsBackground()&&!this._useCopyTextureBackgroundSampling&&t.isRotatedOrNegativeSizeInstance)}_ShouldPostDraw(e,t){return!!t.forcePostDraw||(e.GetRenderer().IsWebGL()?e.BlendsBackground()||e.UsesCrossSampling():(e.BlendsBackground()||e.UsesCrossSampling())&&this._UseRenderTargetBackgroundSampling())}_ShouldUseCopyTextureBackgroundSampling(e){return e.IsWebGPU()&&this._isAnyShaderBackgroundBlending&&!this._isAnyShaderCrossSampling}Render(e,t,s){e.IsWebGPU()&&null===t&&(t=e.GetBackbufferRenderTarget()),this._destRenderTarget=t,this._contentObject=s.contentObject||null,this._contextObject=s.contextObject||null,this._blendMode=s.blendMode||0,this._devicePixelRatio=s.devicePixelRatio||1,this._layerScale=s.layerScale||1,this._layerAngle=s.layerAngle||0,this._time=\"number\"==typeof s.time?s.time:this._manager.GetTime(),this._didChangeTransform=!1,e.ResetDidChangeTransformFlag(),this._isAnyShaderAnimated&&this._Redraw();let i=!1;if(this._UseCopyTextureBackgroundSampling()&&(this._CalculateDrawSizeAndRectangles(e,s),i=!0,this._backTex=this._manager._GetWebGPUBackTexture(e,this._drawWidth,this._drawHeight),qs.copy(this._drawSurfaceRect),qs.roundOuter(),e.IsWebGPU()&&e._MaybeDoPendingClearRenderPass(this._destRenderTarget),e.CopyTextureToTexture(this._destRenderTarget.GetTexture(),this._backTex,qs.getLeft(),qs.getTop(),qs.width(),qs.height())),this._canUseFastPath)this._Render_FastPath(e,s);else if(i||this._CalculateDrawSizeAndRectangles(e,s),0!==this._rcTexOriginal.width()||0!==this._rcTexOriginal.height()){e.SetAlphaBlend(),e.ResetColor(),e.SetBaseZ(0),e.SetCurrentZ(0),this._cbDrawContentHook=s.drawContentHook||null,this._compositOffX=s.compositOffX||0,this._compositOffY=s.compositOffY||0,this._updateOwnProjection=!!s.updateOwnProjection,this._OnBeforeStartEffectChain(e),this._renderTargets[0]=t,this._renderTargets[1]=1<=this._numTempSurfacesRequired?this._GetRenderTarget():null,this._renderTargets[2]=2===this._numTempSurfacesRequired?this._GetRenderTarget():null;for(const r of this._steps){const n=this._GetRenderTargetForId(r.GetSrcTargetId()),a=this._GetRenderTargetForId(r.GetDestTargetId());e.IsWebGPU()?r.Run_WebGPU(e,n,a):r.Run_WebGL(e,n,a)}e.SetTexture(null),this._renderTargets[1]&&this._ReleaseRenderTarget(this._renderTargets[1]),this._renderTargets[2]&&this._ReleaseRenderTarget(this._renderTargets[2]),this._renderTargets.fill(null),this._OnAfterEndEffectChain(e),this._destRenderTarget=null,this._backTex=null,this._contentObject=null,this._contextObject=null,this._cbDrawContentHook=null}}_CalculateDrawSizeAndRectangles(e,t){const[s,i]=this._manager.GetDrawSize(e);this._SetDrawSize(e,s,i),this._CalculateRectangles(t)}_SetDrawSize(e,t,s){if(t<=0||s<=0)throw new Error(\"invalid draw size\");this._drawWidth===t&&this._drawHeight===s||this._CalculateDeviceTransformMatrices(e,t,s,0,0,this._projectionMatrix,this._modelViewMatrix),this._drawWidth=t,this._drawHeight=s}_CalculateDeviceTransformMatrices(e,t,s,i,r,n,a){const o=t/2+i,h=s/2+r,l=(e.CalculatePerspectiveMatrix(n,t/s),e.CalculateLookAtModelView2(o,h,e.GetDefaultCameraZ(s),o,h,0,s));Cr.copy(a,l)}_CalculateRectangles(e){this._layoutRect.copy(e.layoutRect),e.drawSurfaceRect?this._drawSurfaceRect.copy(e.drawSurfaceRect):this._drawSurfaceRect.set(0,0,this._drawWidth,this._drawHeight),this._rcTexOriginal.copy(this._drawSurfaceRect),this._rcTexOriginal.divide(this._drawWidth,this._drawHeight);const t=this._layerScale*this._devicePixelRatio;this._drawSurfaceRect.inflate(this._boxExtendHorizontal*t,this._boxExtendVertical*t),this._rcTexDest.copy(this._drawSurfaceRect),this._rcTexDest.divide(this._drawWidth,this._drawHeight),this._drawSurfaceRect.clampBoth(0,0,this._drawWidth,this._drawHeight),this._rcTexBounce.copy(this._drawSurfaceRect),this._rcTexBounce.divide(this._drawWidth,this._drawHeight)}_OnBeforeStartEffectChain(e){if(this._depthEnabledAtStart=e.IsDepthEnabled(),this._coplanarColorPassAtStart=e.IsCoplanarColorPass(),this._useFullSurface)e.SetDepthEnabled(!1),this._isAnyShaderDepthSampling&&e.SetDepthSamplingEnabled(!0);else{if(qs.copy(this._drawSurfaceRect),e.IsWebGL()){const t=this._layerScale*this._devicePixelRatio;qs.inflate(Math.max(this._boxExtendHorizontal,1)*t,Math.max(this._boxExtendVertical,1)*t),qs.roundOuter(),qs.clamp(0,0,this._drawWidth,this._drawHeight)}else qs.roundOuter();e.SetScissorRect(qs.getLeft(),qs.getTop(),qs.width(),qs.height(),this._drawHeight)}}_OnAfterEffectChainDrawContent(e){e.ResetColor(),this._useFullSurface||(this._coplanarColorPassAtStart&&e.CoplanarRestoreStandardRendering(),e.SetDepthEnabled(!1),this._isAnyShaderDepthSampling&&e.SetDepthSamplingEnabled(!0)),e.IsWebGPU()&&e.SetNormalizedCoordsProgramVariant(!0)}_OnAfterEndEffectChain(e){e.SetDepthSamplingEnabled(!1),this._coplanarColorPassAtStart&&e.CoplanarStartColorPass(),e.SetDepthEnabled(this._depthEnabledAtStart),this._useFullSurface||e.RemoveScissorRect(),e.IsWebGPU()&&e.SetNormalizedCoordsProgramVariant(!1),this._didChangeTransform=e.DidChangeTransform()}_ClampRcTexDest(){this._rcTexDest.clamp(0,0,1,1)}_GetRenderTargetForId(e){return e<0?null:this._renderTargets[e]}_GetRenderTarget(){return this._manager.GetRenderTarget(this)}_GetDestRenderTarget(){return this._destRenderTarget}_ReleaseRenderTarget(e){this._manager.ReleaseRenderTarget(e,this)}_GetShaderProgramAt(e){return this._shaderProgramList[e]}_DrawContent(e){this._cbDrawContentHook?this._cbDrawContentHook(this,e,()=>this._cbDrawContent(e,this)):this._cbDrawContent(e,this),this._canUseFastPath||this._OnAfterEffectChainDrawContent(e)}_IsRenderTargetSameSizeAndOffset(e){if(this._useFullSurface)return!0;if(0!==this._compositOffX||0!==this._compositOffY)return!1;const[t,s]=e.GetRenderTargetSize(e.GetRenderTarget());return t===this._drawWidth&&s===this._drawHeight}_SetDeviceTransform(e,t){let s=this._projectionMatrix,i=this._modelViewMatrix;if(t&&!this._IsRenderTargetSameSizeAndOffset(e)){s=Qs,i=$s;const[r,n]=e.GetRenderTargetSize(e.GetRenderTarget());this._CalculateDeviceTransformMatrices(e,r,n,this._compositOffX,this._compositOffY,s,i),this._useFullSurface||e.RemoveScissorRect()}e.SetProjectionMatrix(s),e.SetModelViewMatrix(i)}_Redraw(){this._manager.Redraw(this)}_GetShaderParameters(e,t){return this._cbGetShaderParameters(this._shaderProgramIndices[e],t)}_SetProgramParameters(e,t){let s=this._rcTexDest,i=this._rcTexBounce,r=this._rcTexOriginal;e.IsWebGL()&&(Ks.copy(s),Ks.flipAround(1),s=Ks,Js.copy(i),Js.flipAround(1),i=Js,Zs.copy(r),Zs.flipAround(1),r=Zs),this._DoSetProgramParameters(e,t,i,r,s,1/this._drawWidth,1/this._drawHeight)}_SetFirstBounceProgramParameters(e,t){let i=this._rcTexBounce,r=this._rcTexOriginal,n=1/this._drawWidth,a=1/this._drawHeight;if(this._cbGetSourceTextureInfo){let{srcTexRect:e,srcWidth:t,srcHeight:s}=this._cbGetSourceTextureInfo(this._contentObject);e||(qs.set(0,0,0,0),e=qs),t=t||this._drawWidth,s=s||this._drawHeight,i=e,r=e,n=1/t,a=1/s}else e.IsWebGL()&&(Js.copy(i),Js.flipAround(1),i=Js,Zs.copy(r),Zs.flipAround(1),r=Zs);let s=this._rcTexDest;e.IsWebGL()&&((s=Ks).copy(this._rcTexDest),s.flipAround(1)),this._DoSetProgramParameters(e,t,i,r,s,n,a),e.IsWebGPU()&&this._isAnyIsSrcTexRotated&&e.SetProgramParameter_IsSrcTexRotated(this._isSourceTextureRotated)}_GetBackTex(e){return this._isAnyShaderBackgroundBlending?e.IsWebGPU()?this._UseCopyTextureBackgroundSampling()?this._backTex:this._destRenderTarget.GetTexture():this._destRenderTarget:null}_DoSetProgramParameters(e,t,s,i,r,n,a){e.SetProgramParameters(this._GetBackTex(e),r,s,i,this._layoutRect,n,a,this._devicePixelRatio,this._layerScale,this._layerAngle,this._time),e.SetProgramCustomParameters(this._GetShaderParameters(t,e))}_Render_FastPath(e,t){const s=this._shaderProgramList[0],i=e.IsDepthEnabled(),r=s.UsesDepth();r&&(e.SetDepthEnabled(!1),e.SetDepthSamplingEnabled(!0),this._rcTexDest.set(0,0,1,1),this._rcTexOriginal.set(0,0,1,1)),e.SetProgram(s),e.SetBlendMode(this._blendMode),e.SetRenderTarget(this._destRenderTarget);let n=0,a=1;if(this._rcTexOriginal.set(0,0,1,1),s.UsesAnySrcRectOrPixelSize()&&this._cbGetSourceTextureInfo){const{srcTexRect:o,srcWidth:h,srcHeight:l}=this._cbGetSourceTextureInfo(this._contentObject);o&&this._rcTexOriginal.copy(o),n=Number.isFinite(h)?1/h:0,a=Number.isFinite(l)?1/l:0}else{const[c,u]=this._manager.GetDrawSize(e);n=1/c,a=1/u}t.layoutRect?this._layoutRect.copy(t.layoutRect):this._layoutRect.set(0,0,0,0),e.SetProgramParameters(this._GetBackTex(e),this._rcTexDest,this._rcTexOriginal,this._rcTexOriginal,this._layoutRect,n,a,this._devicePixelRatio,this._layerScale,this._layerAngle,this._time),e.SetProgramCustomParameters(this._GetShaderParameters(0,e)),e.IsWebGPU()&&this._isAnyIsSrcTexRotated&&e.SetProgramParameter_IsSrcTexRotated(this._isSourceTextureRotated),e.SetBaseZ(0),this._DrawContent(e),r&&(e.SetDepthSamplingEnabled(!1),e.SetDepthEnabled(i))}_UseCopyTextureBackgroundSampling(){return this._useCopyTextureBackgroundSampling}_UseRenderTargetBackgroundSampling(){return!this._useCopyTextureBackgroundSampling}IsAnyShaderBackgroundBlending(){return this._isAnyShaderBackgroundBlending}CanSkipCalculatingDrawSurfaceRect(){return!!this._canUseFastPath&&!this._UseCopyTextureBackgroundSampling()}UseFullSurface(){return this._useFullSurface}GetContentObject(){return this._contentObject}GetContextObject(){return this._contextObject}_GetBlendMode(){return this._blendMode}_UpdateOwnProjection(){return this._updateOwnProjection}DidChangeTransform(){return this._didChangeTransform}_GetDrawSurfaceRect(){return this._drawSurfaceRect}_GetRcTexBounce(){return this._rcTexBounce}_ShouldInvalidateRenderTargets(){return this._invalidateRenderTargets}async DebugLogRenderTargetContents(e,t,s){}}}{const si=self.C3;si.Gfx.EffectChain.Step=class{constructor(e,t,s,i=-1){this._effectChain=e,this._srcTargetId=t,this._destTargetId=s,this._index=i}GetEffectChain(){return this._effectChain}GetSrcTargetId(){return this._srcTargetId}GetDestTargetId(){return this._destTargetId}GetIndex(){return this._index}GetShaderProgram(){return this.GetEffectChain()._GetShaderProgramAt(this.GetIndex())}Run_WebGL(e,t,s){}Run_WebGPU(e,t,s){}}}{const ii=self.C3;ii.Gfx.EffectChain.Step.PreDraw=class extends ii.Gfx.EffectChain.Step{constructor(e,t,s,i){super(e,t,s,i)}Run_WebGL(e,t,s){const i=this.GetEffectChain();e.SetAlphaBlend(),e.SetTextureFillMode(),e.SetRenderTarget(s,i._UpdateOwnProjection()),e.ClearRgba(0,0,0,0),i._DrawContent(e),i._ClampRcTexDest()}Run_WebGPU(e,t,s){const i=this.GetEffectChain();e.SetAlphaBlend(),e.SetTextureFillMode(),e.SetRenderTarget(s,!1),e.ClearRgba(0,0,0,0),i._DrawContent(e),i._ClampRcTexDest()}}}{const ri=self.C3,ni=ri.New(ri.Rect),ai=ri.New(ri.Quad);ri.Gfx.EffectChain.Step.PostDraw=class extends ri.Gfx.EffectChain.Step{constructor(e,t,s,i){super(e,t,s,i)}Run_WebGL(e,t,s){const i=this.GetEffectChain();e.SetTextureFillMode(),e.SetRenderTarget(s),i._SetDeviceTransform(e,!0),e.SetBlendMode(i._GetBlendMode()),e.SetTexture(t.GetTexture()),ai.setFromRect(i._GetDrawSurfaceRect()),ni.copy(i._GetRcTexBounce()),ni.flipAround(1),e.Quad3(ai,ni),i._ShouldInvalidateRenderTargets()&&e.InvalidateRenderTarget(t)}Run_WebGPU(e,t,s){const i=this.GetEffectChain();e.SetTextureFillMode(),e.SetRenderTarget(s,!1),i._IsRenderTargetSameSizeAndOffset(e)?ai.setFromRect(i._GetRcTexBounce()):(e.SetNormalizedCoordsProgramVariant(!1),i._SetDeviceTransform(e,!0),ai.setFromRect(i._GetDrawSurfaceRect())),e.SetBackTexture(null),e.SetBlendMode(i._GetBlendMode()),e.SetTexture(t.GetTexture()),i.UseFullSurface()?e.FullscreenQuad():e.Quad3(ai,i._GetRcTexBounce())}}}{const oi=self.C3;oi.Gfx.EffectChain.Step.FirstBounce=class extends oi.Gfx.EffectChain.Step{constructor(e,t,s,i){super(e,t,s,i)}Run_WebGL(e,t,s){const i=this.GetEffectChain();e.SetRenderTarget(s,i._UpdateOwnProjection()),e.ClearRgba(0,0,0,0),e.SetCopyBlend(),e.SetProgram(this.GetShaderProgram()),i._SetFirstBounceProgramParameters(e,this.GetIndex()),i._DrawContent(e),i._ClampRcTexDest()}Run_WebGPU(e,t,s){const i=this.GetEffectChain();e.SetRenderTarget(s,!1),e.ClearRgba(0,0,0,0),e.SetCopyBlend(),e.SetProgram(this.GetShaderProgram()),i._SetFirstBounceProgramParameters(e,this.GetIndex()),i._DrawContent(e),i._ClampRcTexDest()}}}{const hi=self.C3,li=hi.New(hi.Rect),ci=hi.New(hi.Quad);hi.Gfx.EffectChain.Step.Bounce=class extends hi.Gfx.EffectChain.Step{constructor(e,t,s,i){super(e,t,s,i)}Run_WebGL(e,t,s){const i=this.GetEffectChain(),r=(e.SetRenderTarget(s),0===this.GetDestTargetId());r?e.SetBlendMode(i._GetBlendMode()):(e.ClearRgba(0,0,0,0),e.SetCopyBlend()),e.SetProgram(this.GetShaderProgram()),i._SetProgramParameters(e,this.GetIndex()),e.SetTexture(t.GetTexture()),i._SetDeviceTransform(e,r),ci.setFromRect(i._GetDrawSurfaceRect()),li.copy(i._GetRcTexBounce()),li.flipAround(1),e.Quad3(ci,li),i._ShouldInvalidateRenderTargets()&&e.InvalidateRenderTarget(t)}Run_WebGPU(e,t,s){const i=this.GetEffectChain(),r=(e.SetRenderTarget(s,!1),0===this.GetDestTargetId());r?(e.SetBlendMode(i._GetBlendMode()),e.SetBackTexture(null),i._IsRenderTargetSameSizeAndOffset(e)?ci.setFromRect(i._GetRcTexBounce()):(e.SetNormalizedCoordsProgramVariant(!1),i._SetDeviceTransform(e,!0),ci.setFromRect(i._GetDrawSurfaceRect()))):(e.ClearRgba(0,0,0,0),e.SetCopyBlend(),ci.setFromRect(i._GetRcTexBounce())),e.SetProgram(this.GetShaderProgram()),i._SetProgramParameters(e,this.GetIndex()),e.SetTexture(t.GetTexture()),i.UseFullSurface()?e.FullscreenQuad():e.Quad3(ci,i._GetRcTexBounce())}}}{let c=function(e,t){const s=e[0],i=t[0],r=s-i;if(0!=r)return r;const n=e[1],a=t[1];return n-a},u=(c,self.C3),_=self.C3X,d=null,t=new Set,p=[],f=[],s=!1,e=!1,i=new Set([\"vsync\",\"unlimited-tick\",\"unlimited-frame\"]);self.IRuntime=class{constructor(e){d=e,Object.defineProperties(this,{assets:{value:d.GetAssetManager().GetIAssetManager(),writable:!1},collisions:{value:d.GetCollisionEngine().GetICollisionEngine(),writable:!1},objects:{value:{},writable:!1},globalVars:{value:{},writable:!1},projectName:{value:d.GetProjectName(),writable:!1},projectVersion:{value:d.GetProjectVersion(),writable:!1},storage:{value:new self.IStorage(d),writable:!1},isInWorker:{value:d.IsInWorker(),writable:!1},viewportWidth:{value:d.GetOriginalViewportWidth(),writable:!1},viewportHeight:{value:d.GetOriginalViewportHeight(),writable:!1},sampling:{value:d.GetSampling(),writable:!1},isPixelRoundingEnabled:{value:d.IsPixelRoundingEnabled(),writable:!1},platformInfo:{value:new self.IPlatformInfo(e),writable:!1},sdk:{value:new self.ISDKUtils(e),writable:!1}}),d.UserScriptDispatcher().addEventListener(\"keydown\",e=>{t.has(e.key)?e.stopPropagation():t.add(e.key)}),d.UserScriptDispatcher().addEventListener(\"keyup\",e=>t.delete(e.key)),d.Dispatcher().addEventListener(\"window-blur\",()=>t.clear()),d.IsInWorker()&&(self.alert=e=>(s||(s=!0,console.warn(\"[Construct] alert() was called from a Web Worker, because the project 'Use worker' setting is enabled. This method is not normally available in a Web Worker. Construct has implemented the alert for you, but note that other features may be missing in worker mode. You may wish to disable 'Use worker', or use a more convenient function like console.log(). For more information please refer to the scripting section of the manual.\")),this.alert(e)))}_InitObjects(e){Object.defineProperties(this.objects,e)}_InitGlobalVars(e){Object.defineProperties(this.globalVars,e)}addEventListener(e,t){d.UserScriptDispatcher().addEventListener(e,t)}removeEventListener(e,t){d.UserScriptDispatcher().removeEventListener(e,t)}callFunction(e,...t){_.RequireString(e);const s=d.GetEventSheetManager(),i=s.GetFunctionBlockByName(e);if(!i)throw new Error(`cannot find function name '${e}'`);if(!i.IsEnabled())return i.GetDefaultReturnValue();if(t.length<i.GetFunctionParameterCount())throw new Error(`not enough function parameters passed for '${e}' (${t.length} passed, ${i.GetFunctionParameterCount()} expected)`);let r=i.GetEventBlock(),n=r.GetSolModifiersIncludingParents(),a=s.GetCurrentEvent();if(a){n=n.slice(0);const h=new Set(n);for(const l of a.GetSolModifiersIncludingParents())h.has(l)||(n.push(l),h.add(l));for(const c of s.GetDynamicSolModifiersSet())h.has(c)||(n.push(c),h.add(c))}const o=r.RunAsExpressionFunctionCall(n,i.IsCopyPicked(),i.GetReturnType(),i.GetDefaultReturnValue(),...t);return o}setReturnValue(e){const t=d.GetEventStack().GetCurrentExpFuncStackFrame();if(!t)throw new Error(\"not in a function which returns a value\");switch(t.GetFunctionReturnType()){case 1:\"number\"==typeof e&&t.SetFunctionReturnValue(e);break;case 2:\"string\"==typeof e&&t.SetFunctionReturnValue(e);break;case 3:\"number\"!=typeof e&&\"string\"!=typeof e||t.SetFunctionReturnValue(e)}}signal(e){_.RequireString(e),d.GetEventSheetManager().Signal(e)}waitForSignal(e){return _.RequireString(e),d.GetEventSheetManager().WaitForSignal(e)}getViewportSize(){return[d.GetOriginalViewportWidth(),d.GetOriginalViewportHeight()]}get isSuspended(){return d.IsSuspended()}get dt(){return d.GetDt()}get dtRaw(){return d.GetDtRaw()}get gameTime(){return d.GetGameTime()}get wallTime(){return d.GetWallTime()}get timeScale(){return d.GetTimeScale()}set timeScale(e){_.RequireFiniteNumber(e),d.SetTimeScale(e)}get fps(){return e||(console.warn(\"IRuntime.fps is deprecated. Use IRuntime.framesPerSecond instead.\"),e=!0),d.GetFramesPerSecond()}get framesPerSecond(){return d.GetFramesPerSecond()}get ticksPerSecond(){return d.GetTicksPerSecond()}get cpuUtilisation(){return d.GetMainThreadTime()}get gpuUtilisation(){return d.GetGPUUtilisation()}get framerateMode(){return d.GetFramerateMode()}set framerateMode(e){if(!i.has(e))throw new Error(\"invalid framerate mode\");d._SetFramerateMode(e)}get minDt(){return d.GetMinDt()}set minDt(e){_.RequireFiniteNumber(e),d.SetMinDt(e)}get maxDt(){return d.GetMaxDt()}set maxDt(e){d.SetMaxDt(e)}random(){return d.Random()}get layout(){const e=d.GetMainRunningLayout();if(e)return e.GetILayout();throw new Error(\"no layout is running - make sure a layout is loaded before accessing\")}getLayout(e){let t=d.GetLayoutManager(),s=null;if(\"number\"!=typeof e&&\"string\"!=typeof e)throw new TypeError(\"expected string or number\");if(s=t.GetLayout(e))return s.GetILayout();throw new Error(\"invalid layout\")}getAllLayouts(){return d.GetLayoutManager().GetAllLayouts().map(e=>e.GetILayout())}goToLayout(e){let t=d.GetLayoutManager(),s;if(\"number\"!=typeof e&&\"string\"!=typeof e)throw new TypeError(\"expected string or number\");if(!(s=t.GetLayout(e)))throw new Error(\"invalid layout\");t.IsPendingChangeMainLayout()||t.ChangeMainLayout(s)}get keyboard(){const e=d._GetCommonScriptInterfaces().keyboard;if(e)return e;throw new Error(\"runtime.keyboard used but Keyboard object missing - add it to your project first\")}get mouse(){const e=d._GetCommonScriptInterfaces().mouse;if(e)return e;throw new Error(\"runtime.mouse used but Mouse object missing - add it to your project first\")}get touch(){const e=d._GetCommonScriptInterfaces().touch;if(e)return e;throw new Error(\"runtime.touch used but Touch object missing - add it to your project first\")}get timelineController(){const e=d._GetCommonScriptInterfaces().timelineController;if(e)return e;throw new Error(\"runtime.timelineController used but Timeline Controller object missing - add it to your project first\")}invokeDownload(e,t){_.RequireString(e),_.RequireString(t),d.InvokeDownload(e,t)}getInstanceByUid(e){_.RequireFiniteNumber(e);const t=d.GetInstanceByUID(e);return t?t.GetInterfaceClass():null}sortZOrder(e,i){_.RequireFunction(i);const r=d.GetCurrentLayout();for(const t of e){const s=d._UnwrapIWorldInstance(t),n=s.GetWorldInfo();p.push([n.GetLayer().GetIndex(),n.GetZIndex()]),f.push(s)}if(0!==p.length){p.sort(c),f.sort((e,t)=>i(e.GetInterfaceClass(),t.GetInterfaceClass()));let s=!1;for(let e=0,t=p.length;e<t;++e){const a=f[e],o=r.GetLayerByIndex(p[e][0]),h=p[e][1],l=o._GetInstances();l[h]!==a&&((l[h]=a).GetWorldInfo()._SetLayer(o,!0),o.SetZIndicesChanged(a),s=!0)}s&&d.UpdateRender(),u.clearArray(p),u.clearArray(f)}}async createWorker(e,t){const s=new MessageChannel,i=s.port1,r=s.port2;return await d.PostComponentMessageToDOMAsync(\"runtime\",\"script-create-worker\",{url:e,opts:t,port2:r},[r]),i}alert(e){return d.PostComponentMessageToDOMAsync(\"runtime\",\"alert\",{message:e+(d.IsInWorker()?\" [via Web Worker]\":\"\")})}getHTMLLayer(e){return _.RequireFiniteNumber(e),d._GetHTMLLayerWrapElement(e)}addLoadPromise(e){d.AddLoadPromise(e)}}}{let t=self.C3,a=null;self.IAssetManager=class{constructor(e){a=e,Object.defineProperties(this,{isWebMOpusSupported:{value:a.IsAudioFormatSupported(\"audio/webm; codecs=opus\"),writable:!1}})}loadImageAsset(e){const t=self.IImageInfo._Unwrap(e);if(!t)throw new Error(\"invalid IImageInfo\");t.LoadAsset(a.GetRuntime())}fetchText(e){return a.FetchText(e)}fetchJson(e){return a.FetchJson(e)}fetchBlob(e){return a.FetchBlob(e)}fetchArrayBuffer(e){return a.FetchArrayBuffer(e)}getProjectFileUrl(e){return a.GetProjectFileUrl(e)}getMediaFileUrl(e){return\"flat\"===a.GetFileStructure()&&t.IsRelativeURL(e)&&(e=e.toLowerCase()),a.GetMediaFileUrl(e)}get mediaFolder(){return a.GetMediaSubfolder()}async decodeWebMOpus(e,t){if(this.isWebMOpusSupported)throw new Error(\"decodeWebMOpus(): not supported because WebM Opus is supported by the platform\");const s=await a.GetRuntime()._WasmDecodeWebMOpus(t),i=new Float32Array(s),r=e.createBuffer(1,i.length,48e3),n=r.getChannelData(0);return n.set(i),r}loadScripts(...e){return a.LoadScripts(...e)}compileWebAssembly(e){return a.CompileWebAssembly(e)}loadStyleSheet(e){return a.LoadStyleSheet(e)}}}{let a=self.C3,s=self.C3X,o=null;self.ICollisionEngine=class{constructor(e){o=e,Object.defineProperties(this,{runtime:{value:o.GetRuntime(),writable:!1}})}testOverlap(e,t){const s=o.GetRuntime(),i=s._UnwrapIWorldInstance(e),r=s._UnwrapIWorldInstance(t);return o.TestOverlap(i,r)}testOverlapAny(e,t){const s=o.GetRuntime(),i=s._UnwrapIWorldInstance(e);for(const r of t){const n=s._UnwrapIWorldInstance(r);if(o.TestOverlap(i,n))return r}return null}testOverlapSolid(e){const t=o.GetRuntime()._UnwrapIWorldInstance(e),s=o.TestOverlapSolid(t);return s?s.GetInterfaceClass():null}setCollisionCellSize(e,t){if(s.RequireFiniteNumber(e),s.RequireFiniteNumber(t),e=Math.floor(e),t=Math.floor(t),e<=0||t<=0)throw new Error(\"invalid cell size\");o.SetCollisionCellSize(e,t)}getCollisionCellSize(){return o.GetCollisionCellSize()}getCollisionCandidates(e,t){let s=o.GetRuntime(),i;i=Array.isArray(e)?e.map(e=>s._UnwrapIObjectClass(e)):[s._UnwrapIObjectClass(e)];const r=a.Rect.FromObject(t),n=[];return o.GetObjectClassesCollisionCandidates(null,i,r,n),n.map(e=>e.GetInterfaceClass())}}}{let t=self.C3,s=null,i=new Map([[\"Windows\",\"windows\"],[\"macOS\",\"macos\"],[\"Linux\",\"linux\"],[\"Chrome OS\",\"chrome-os\"],[\"Android\",\"android\"],[\"iOS\",\"ios\"]]),r=new Map([[\"Chrome\",\"chrome\"],[\"Chromium\",\"chromium\"],[\"Edge\",\"edge\"],[\"Opera\",\"opera\"],[\"NW.js\",\"nwjs\"],[\"Firefox\",\"firefox\"],[\"Safari\",\"safari\"]]),n=new Map([[\"Chromium\",\"chromium\"],[\"Gecko\",\"gecko\"],[\"WebKit\",\"webkit\"]]);self.IPlatformInfo=class{constructor(e){s=e,Object.defineProperties(this,{isMobile:{value:t.Platform.IsMobile,writable:!1},os:{value:i.get(t.Platform.OS)||\"unknown\",writable:!1},osVersion:{value:t.Platform.OSVersion,writable:!1},browser:{value:r.get(t.Platform.Browser)||\"unknown\",writable:!1},browserVersion:{value:t.Platform.BrowserVersion,writable:!1},browserEngine:{value:n.get(t.Platform.BrowserEngine)||\"unknown\",writable:!1}})}get exportType(){let e=s.GetExportType();return s.IsNWjs()?e=\"nwjs\":s.IsWindowsWebView2()?e=\"windows-webview2\":\"cordova\"===e?e=\"Android\"===t.Platform.OS?\"cordova-android\":\"cordova-ios\":\"playable-ad-single-file\"!==e&&\"playable-ad-zip\"!==e||(e=\"playable-ad\"),e}get renderer(){return s.GetCanvasManager().GetRendererString()}get rendererDetail(){return s.GetCanvasManager().GetRendererDetailString()}get canvasCssWidth(){return s.GetCanvasManager().GetCssWidth()}get canvasCssHeight(){return s.GetCanvasManager().GetCssHeight()}get canvasDeviceWidth(){return s.GetCanvasManager().GetDeviceWidth()}get canvasDeviceHeight(){return s.GetCanvasManager().GetDeviceHeight()}get devicePixelRatio(){return s.GetDevicePixelRatio()}}}{const ui=self.C3X;self.IStorage=class{constructor(e){this._storage=e._GetProjectStorage()}getItem(e){return ui.RequireString(e),this._storage.getItem(e)}setItem(e,t){return ui.RequireString(e),this._storage.setItem(e,t)}removeItem(e){return ui.RequireString(e),this._storage.removeItem(e)}clear(){return this._storage.clear()}keys(){return this._storage.keys()}}}{const _i=self.C3,di=_i._GetInternalAPIToken();self.IPlugin=class{#private;constructor(){const e=_i.AddonManager._GetInitObject2(di);this.#private=e,Object.defineProperties(this,{runtime:{value:e.GetRuntime().GetIRuntime(),writable:!1},isSingleGlobal:{value:e.IsSingleGlobal(),writable:!1},isWorldType:{value:e.IsWorldType(),writable:!1},isHTMLElementType:{value:e.IsHTMLElementType(),writable:!1},isRotatable:{value:e.IsRotatable(),writable:!1},hasEffects:{value:e.HasEffects(),writable:!1},is3d:{value:e.Is3D(),writable:!1},supportsHierarchies:{value:e.SupportsSceneGraph(),writable:!1},supportsMesh:{value:e.SupportsMesh(),writable:!1}})}static getByConstructor(e){if(!e)return null;const t=_i.AddonManager.GetPluginByConstructorFunction(e);return t?t.GetIPlugin():null}getSingleGlobalObjectType(){return this.#private.GetSingleGlobalObjectClass().GetIObjectClass()}getSingleGlobalInstance(){return this.#private.GetSingleGlobalInstance().GetInterfaceClass()}}}{const pi=self.C3,fi=self.C3X,mi=pi._GetInternalAPIToken();self.IObjectClass=class{#private;constructor(){const e=pi.AddonManager._GetInitObject2(mi);this.#private=e,Object.defineProperties(this,{name:{value:e.GetName(),writable:!1},runtime:{value:e.GetRuntime().GetIRuntime(),writable:!1},plugin:{value:e.GetPlugin().GetIPlugin(),writable:!1}}),e.GetRuntime()._MapScriptInterface(this,e)}addEventListener(e,t){fi.RequireString(e),fi.RequireFunction(t),this.#private.UserScriptDispatcher().addEventListener(e,t)}removeEventListener(e,t){fi.RequireString(e),fi.RequireFunction(t),this.#private.UserScriptDispatcher().removeEventListener(e,t)}getAllInstances(){return[...this.instances()]}getFirstInstance(){return pi.first(this.instances())}getPickedInstances(){return[...this.pickedInstances()]}getFirstPickedInstance(){return pi.first(this.pickedInstances())}getPairedInstance(e){const t=this.#private,s=t.GetRuntime()._UnwrapIInstance(e),i=t.GetPairedInstance(s);return i?i.GetInterfaceClass():null}*instances(){for(const e of this.#private.instancesIncludingPendingCreate())yield e.GetInterfaceClass()}*pickedInstances(){for(const e of this.#private.GetCurrentSol().GetInstances())yield e.GetInterfaceClass()}setInstanceClass(e){fi.RequireFunction(e);const t=this.#private;if(0<t.GetInstanceCount())throw new Error(\"setInstanceClass() called too late, because instances have already been created - call in runOnStartup\");t._SetUserScriptInstanceClass(e)}createInstance(e,t,s,i,r){if(fi.RequireNumber(t),fi.RequireNumber(s),\"number\"!=typeof e&&\"string\"!=typeof e)throw new TypeError(\"invalid layer parameter\");const n=this.#private,a=n.GetRuntime(),o=a.GetMainRunningLayout().GetLayer(e);if(!o)throw new Error(\"invalid layer\");const h=a.CreateInstance(n,o,t,s,i,r),l=(i&&o.SortAndAddInstancesByZIndex(h),a.GetEventSheetManager());return l.BlockFlushingInstances(!0),h._TriggerOnCreatedOnSelfAndRelated(),l.BlockFlushingInstances(!1),l.IsInEventEngine()||a.GetLayoutManager().IsEndingLayout()||a.FlushPendingInstances(),h.GetInterfaceClass()}}}{const gi=self.C3X,l=new WeakMap,Si=[\"above\",\"below\",\"top-sublayer\",\"bottom-sublayer\"];self.ILayout=class{constructor(e){l.set(this,e);const t=[],s=e.GetEffectList(),i=s.GetAllEffectTypes().length;for(let e=0;e<i;++e)t.push(new self.IEffectInstance(s,e));Object.defineProperties(this,{name:{value:e.GetName(),writable:!1},index:{value:e.GetIndex(),writable:!1},effects:{value:t,writable:!1}})}addEventListener(e,t){gi.RequireString(e),gi.RequireFunction(t),l.get(this).UserScriptDispatcher().addEventListener(e,t)}removeEventListener(e,t){gi.RequireString(e),gi.RequireFunction(t),l.get(this).UserScriptDispatcher().removeEventListener(e,t)}get width(){return l.get(this).GetWidth()}set width(e){gi.RequireFiniteNumber(e),l.get(this).SetWidth(e)}get height(){return l.get(this).GetHeight()}set height(e){gi.RequireFiniteNumber(e),l.get(this).SetHeight(e)}setSize(e,t){gi.RequireFiniteNumber(e),gi.RequireFiniteNumber(t);const s=l.get(this);s.SetWidth(e),s.SetHeight(t)}getSize(){const e=l.get(this);return[e.GetWidth(),e.GetHeight()]}set scale(e){gi.RequireFiniteNumber(e),l.get(this).SetScale(e)}get scale(){return l.get(this).GetScale()}set angle(e){gi.RequireFiniteNumber(e),l.get(this).SetAngle(e)}get angle(){return l.get(this).GetAngle()}set scrollX(e){gi.RequireNumber(e),l.get(this).SetScrollX(e)}get scrollX(){return l.get(this).GetScrollX()}set scrollY(e){gi.RequireNumber(e),l.get(this).SetScrollY(e)}get scrollY(){return l.get(this).GetScrollY()}scrollTo(e,t){gi.RequireNumber(e),gi.RequireNumber(t);const s=l.get(this);s.SetScrollX(e),s.SetScrollY(t)}getScrollPosition(){const e=l.get(this);return[e.GetScrollX(),e.GetScrollY()]}getLayer(e){let t=l.get(this),s=null;if(\"number\"!=typeof e&&\"string\"!=typeof e)throw new TypeError(\"expected string or number\");return(s=t.GetLayer(e))?s.GetILayer():null}getAllLayers(){return l.get(this).GetLayers().map(e=>e.GetILayer())}*allLayers(){for(const e of l.get(this).allLayers())yield e.GetILayer()}addLayer(e,t,s){const i=l.get(this),r=self.ILayer,n=(gi.RequireString(e),gi.RequireOptionalInstanceOf(t,r),t?i.GetRuntime()._UnwrapScriptInterface(t):null),a=Si.indexOf(s);if(a<0)throw new Error(\"invalid location\");i.AddLayer(e,n,a)}moveLayer(e,t,s){const i=l.get(this),r=i.GetRuntime(),n=self.ILayer,a=(gi.RequireInstanceOf(e,n),r._UnwrapScriptInterface(e));if(!a)throw new Error(\"invalid layer\");gi.RequireOptionalInstanceOf(t,n);const o=t?r._UnwrapScriptInterface(t):null,h=Si.indexOf(s);if(h<0)throw new Error(\"invalid location\");i.MoveLayer(a,o,h)}removeLayer(e){const t=l.get(this),s=self.ILayer,i=(gi.RequireInstanceOf(e,s),t.GetRuntime()._UnwrapScriptInterface(e));if(!i)throw new Error(\"invalid layer\");const r=i.GetRuntime();t.RemoveLayer(i),r.GetEventSheetManager().IsInEventEngine()||r.FlushPendingInstances()}removeAllDynamicLayers(){const e=l.get(this),t=e.GetRuntime();e.RemoveAllDynamicLayers(),t.GetEventSheetManager().IsInEventEngine()||t.FlushPendingInstances()}setVanishingPoint(e,t){gi.RequireFiniteNumber(e),gi.RequireFiniteNumber(t),l.get(this).SetVanishingPointXY(e,t)}getVanishingPoint(){return l.get(this)._GetVanishingPoint()}set projection(e){gi.RequireString(e);const t=l.get(this);if(\"perspective\"===e)t.SetPerspectiveProjection();else{if(\"orthographic\"!==e)throw new Error(\"invalid projection\");t.SetOrthographicProjection()}}get projection(){return l.get(this).IsOrthographicProjection()?\"orthographic\":\"perspective\"}}}{const yi=self.C3,_=self.C3X,d=new WeakMap,Gi=new Map([[\"normal\",0],[\"additive\",1],[\"copy\",3],[\"destination-over\",4],[\"source-in\",5],[\"destination-in\",6],[\"source-out\",7],[\"destination-out\",8],[\"source-atop\",9],[\"destination-atop\",10]]),Ii=new Map([...Gi.entries()].map(e=>[e[1],e[0]])),Ti=yi.New(yi.Color);self.ILayer=class{constructor(e){d.set(this,e);const t=[],s=e.GetEffectList(),i=s.GetAllEffectTypes().length;for(let e=0;e<i;++e)t.push(new self.IEffectInstance(s,e));Object.defineProperties(this,{name:{value:e.GetName(),writable:!1},layout:{value:e.GetLayout().GetILayout(),writable:!1},effects:{value:t,writable:!1}}),e.GetRuntime()._MapScriptInterface(this,e)}get parentLayer(){const e=d.get(this).GetParentLayer();return e?e.GetILayer():null}*parentLayers(){for(const e of d.get(this).parentLayers())yield e.GetILayer()}*subLayers(){for(const e of d.get(this).GetSubLayers())yield e.GetILayer()}*allSubLayers(){for(const e of d.get(this).GetSubLayers())for(const t of e.selfAndAllSubLayers())yield t.GetILayer()}get index(){return d.get(this).GetIndex()}get isVisible(){return d.get(this)._IsVisibleFlagSet()}set isVisible(e){d.get(this).SetVisible(e)}get isSelfAndParentsVisible(){return d.get(this).IsVisible()}get isInteractive(){return d.get(this).IsInteractive()}set isInteractive(e){d.get(this).SetInteractive(e)}get isHTMLElementsLayer(){return d.get(this).IsHTMLElementsLayer()}set isHTMLElementsLayer(e){d.get(this).SetIsHTMLElementsLayer(!!e)}get isSelfAndParentsInteractive(){return d.get(this).IsSelfAndParentsInteractive()}get opacity(){return d.get(this).GetOpacity()}set opacity(e){e=yi.clamp(+e,0,1),isNaN(e)||d.get(this).SetOpacity(e)}set scale(e){_.RequireFiniteNumber(e),d.get(this).SetOwnScale(e)}get scale(){return d.get(this).GetOwnScale()}set scaleRate(e){_.RequireFiniteNumber(e),d.get(this).SetScaleRate(e)}get scaleRate(){return d.get(this).GetScaleRate()}set angle(e){_.RequireFiniteNumber(e),d.get(this).SetAngle(e)}get angle(){return d.get(this).GetOwnAngle()}set parallaxX(e){_.RequireFiniteNumber(e),d.get(this).SetParallaxX(e)}get parallaxX(){return d.get(this).GetParallaxX()}set parallaxY(e){_.RequireFiniteNumber(e),d.get(this).SetParallaxY(e)}get parallaxY(){return d.get(this).GetParallaxY()}set zElevation(e){_.RequireFiniteNumber(e),d.get(this).SetZElevation(e)}get zElevation(){return d.get(this).GetZElevation()}set isTransparent(e){d.get(this).SetTransparent(e)}get isTransparent(){return d.get(this).IsTransparent()}set isForceOwnTexture(e){d.get(this).SetForceOwnTexture(e)}get isForceOwnTexture(){return d.get(this).IsForceOwnTexture()}set blendMode(e){_.RequireString(e);const t=Gi.get(e);if(\"number\"!=typeof t)throw new Error(\"invalid blend mode\");d.get(this).SetBlendMode(t)}get blendMode(){return Ii.get(d.get(this).GetBlendMode())}set backgroundColor(e){if(_.RequireArray(e),e.length<3)throw new Error(\"expected 3 elements\");Ti.setRgb(e[0],e[1],e[2]);const t=d.get(this),s=t.GetBackgroundColor();s.equalsIgnoringAlpha(Ti)||(s.copyRgb(Ti),t.GetRuntime().UpdateRender())}get backgroundColor(){const e=d.get(this).GetBackgroundColor();return[e.getR(),e.getG(),e.getB()]}set scrollX(e){_.RequireNumber(e);const t=d.get(this);t.SetOwnScrollPositionEnabled(!0),t.SetScrollX(e)}get scrollX(){return d.get(this).GetScrollX()}set scrollY(e){_.RequireNumber(e);const t=d.get(this);t.SetOwnScrollPositionEnabled(!0),t.SetScrollY(e)}get scrollY(){return d.get(this).GetScrollY()}scrollTo(e,t){_.RequireNumber(e),_.RequireNumber(t);const s=d.get(this);s.SetOwnScrollPositionEnabled(!0),s.SetScrollX(e),s.SetScrollY(t)}getScrollPosition(){const e=d.get(this);return[e.GetScrollX(),e.GetScrollY()]}restoreScrollPosition(){d.get(this).SetOwnScrollPositionEnabled(!1)}getViewport(){return d.get(this).GetViewport().toDOMRect()}cssPxToLayer(e,t,s=0){_.RequireNumber(e),_.RequireNumber(t),_.RequireNumber(s);const i=d.get(this),r=i.GetRuntime();return i.CanvasCssToLayer(e-r.GetCanvasClientX(),t-r.GetCanvasClientY(),s)}layerToCssPx(e,t,s=0){_.RequireNumber(e),_.RequireNumber(t),_.RequireNumber(s);const i=d.get(this),r=i.GetRuntime(),[n,a]=i.LayerToCanvasCss(e,t,s);return[n+r.GetCanvasClientX(),a+r.GetCanvasClientY()]}drawSurfaceToLayer(e,t,s=0){return _.RequireNumber(e),_.RequireNumber(t),_.RequireNumber(s),d.get(this).DrawSurfaceToLayer(e,t,s)}layerToDrawSurface(e,t,s=0){return _.RequireNumber(e),_.RequireNumber(t),_.RequireNumber(s),d.get(this).LayerToDrawSurface(e,t,s)}get renderScale(){return d.get(this).GetRenderScale()}}}{let i=function(e){let t=wi.get(e);return t||(t=Ci.New(Ci.Event.Dispatcher),wi.set(e,t)),t};i;const Ci=self.C3,bi=self.C3X,wi=new WeakMap,xi=Ci._GetInternalAPIToken();self.IInstance=class{#private;constructor(){const e=Ci.AddonManager._GetInitObject2(xi),t={runtime:{value:(this.#private=e).GetRuntime().GetIRuntime(),writable:!1},objectType:{value:e.GetObjectClass().GetIObjectClass(),writable:!1},plugin:{value:e.GetPlugin().GetIPlugin(),writable:!1}};e._GetInstVarsScriptDescriptor(t),e._GetBehaviorsScriptDescriptor(t),Object.defineProperties(this,t),e.GetRuntime()._MapScriptInterface(this,e)}static _GetInitInst(){return Ci.AddonManager._GetInitObject()}_release(){const e=wi.get(this);e&&(e.Release(),wi.delete(this))}addEventListener(e,t,s){bi.RequireString(e),bi.RequireFunction(t),i(this).addEventListener(e,t,s)}removeEventListener(e,t,s){bi.RequireString(e),bi.RequireFunction(t),i(this).removeEventListener(e,t,s)}dispatchEvent(e){i(this).dispatchEvent(e)}destroy(){const e=this.#private,t=e.GetRuntime();t.DestroyInstance(e),t.GetEventSheetManager().IsInEventEngine()||t.GetLayoutManager().IsEndingLayout()||t.GetEventSheetManager().IsFlushingBlocked()||t.FlushPendingInstances()}getOtherContainerInstances(){const e=this.#private.GetSiblings();return e?e.map(e=>e.GetInterfaceClass()):[]}*otherContainerInstances(){const e=this.#private;if(e.IsInContainer())for(const t of e.siblings())yield t.GetInterfaceClass()}get uid(){return this.#private.GetUID()}get templateName(){return this.#private.GetTemplateName()}set timeScale(e){bi.RequireFiniteNumber(e),this.#private.SetTimeScale(e)}get timeScale(){return this.#private.GetActiveTimeScale()}restoreTimeScale(){this.#private.RestoreTimeScale()}get dt(){const e=this.#private;return e.GetRuntime().GetDt(e)}hasTags(...e){bi.RequireArray(e);const t=new Set(e),s=this.#private.GetTagsSet();return t.isSubsetOf(s)}setAllTags(e){bi.RequireInstanceOf(e,Set),this.#private.SetTagsSet(e)}getAllTags(){return new Set(this.#private.GetTagsSet())}signal(e){bi.RequireString(e);const t=this.#private;t.GetRuntime().GetEventSheetManager().InstanceSignal(t,e)}waitForSignal(e){bi.RequireString(e);const t=this.#private;return t.GetRuntime().GetEventSheetManager().WaitForInstanceSignal(t,e)}}}{const vi=self.C3,Pi=self.C3X,Ri=vi._GetInternalAPIToken();self.ISDKInstanceBase=class extends self.IInstance{#private;#isTicking=!1;#tickFunc=null;#isTicking2=!1;#tickFunc2=null;#domComponentId;#wrapperComponentId;constructor(e){super(),this.#private=vi.AddonManager._GetInitObject2(Ri),this.#isTicking=!1,this.#tickFunc=null,this.#isTicking2=!1,this.#tickFunc2=null,this.#domComponentId=e?.domComponentId,this.#wrapperComponentId=e?.wrapperComponentId}_release(){this._setTicking(!1),this._setTicking2(!1),super._release()}_getInitProperties(){return vi.AddonManager._GetInitProperties()}_trigger(e){const t=this.#private;t.GetRuntime().Trigger(e,t)}_triggerAsync(e){const t=this.#private;return t.GetRuntime().TriggerAsync(e,t)}_addDOMMessageHandler(e,t){if(Pi.RequireString(e),Pi.RequireFunction(t),!this.#domComponentId)throw new Error(\"no DOM component id set\");const s=this.#private.GetRuntime();s.AddDOMComponentMessageHandler(this.#domComponentId,e,t)}_addDOMMessageHandlers(e){Pi.RequireArray(e);for(const[t,s]of e)this._addDOMMessageHandler(t,s)}_postToDOM(e,t){if(Pi.RequireString(e),!this.#domComponentId)throw new Error(\"no DOM component id set\");const s=this.#private.GetRuntime();s.PostComponentMessageToDOM(this.#domComponentId,e,t)}_postToDOMAsync(e,t){if(Pi.RequireString(e),!this.#domComponentId)throw new Error(\"no DOM component id set\");const s=this.#private.GetRuntime();return s.PostComponentMessageToDOMAsync(this.#domComponentId,e,t)}_postToDOMMaybeSync(e,t){const s=this.#private.GetRuntime();if(!s.IsInWorker())return window.c3_runtimeInterface._OnMessageFromRuntime({type:\"event\",component:this.#domComponentId,handler:e,data:t,responseId:null});this._postToDOM(e,t)}_setTicking(e){if(this.#isTicking!==(e=!!e)){this.#isTicking=e;const t=this.#private.GetRuntime();e?(this.#tickFunc||(this.#tickFunc=()=>this._tick()),t.Dispatcher().addEventListener(\"tick\",this.#tickFunc)):t.Dispatcher().removeEventListener(\"tick\",this.#tickFunc)}}_isTicking(){return this.#isTicking}_tick(){}_setTicking2(e){if(this.#isTicking2!==(e=!!e)){this.#isTicking2=e;const t=this.#private.GetRuntime();e?(this.#tickFunc2||(this.#tickFunc2=()=>this._tick2()),t.Dispatcher().addEventListener(\"tick2\",this.#tickFunc2)):t.Dispatcher().removeEventListener(\"tick2\",this.#tickFunc2)}}_isTicking2(){return this.#isTicking2}_tick2(){}_getDebuggerProperties(){return[]}_saveToJson(){return null}_loadFromJson(e){}_isWrapperExtensionAvailable(){if(!this.#wrapperComponentId)throw new Error(\"no wrapper component id set\");const e=this.#private.GetRuntime();return e.HasWrapperComponentId(this.#wrapperComponentId)}_addWrapperExtensionMessageHandler(e,t){if(Pi.RequireString(e),Pi.RequireFunction(t),!this.#wrapperComponentId)throw new Error(\"no wrapper component id set\");const s=this.#private.GetRuntime();s.AddWrapperExtensionMessageHandler(this.#wrapperComponentId,e,t)}_addWrapperMessageHandlers(e){Pi.RequireArray(e);for(const[t,s]of e)this._addWrapperExtensionMessageHandler(t,s)}_sendWrapperExtensionMessage(e,t){if(!this.#wrapperComponentId)throw new Error(\"no wrapper component id set\");this.runtime.sdk.sendWrapperExtensionMessage(this.#wrapperComponentId,e,t)}_sendWrapperExtensionMessageAsync(e,t){if(this.#wrapperComponentId)return this.runtime.sdk.sendWrapperExtensionMessageAsync(this.#wrapperComponentId,e,t);throw new Error(\"no wrapper component id set\")}}}{let e=function(e){return class r extends e{#privateInst;#privateWi;constructor(e){super(e);const t=Ai.AddonManager._GetInitObject2(Fi),s=t.GetWorldInfo(),i=(this.#privateInst=t,this.#privateWi=s,Ei.set(this,t),[]),r=s.GetInstanceEffectList();if(r){const a=s.GetObjectClass().GetEffectList().GetAllEffectTypes().length;for(let e=0;e<a;++e)i.push(new self.IEffectInstance(r,e))}const n={effects:{value:i,writable:!1}};Object.defineProperties(this,n)}get layout(){return this.#privateWi.GetLayout().GetILayout()}get layer(){return this.#privateWi.GetLayer().GetILayer()}get x(){return this.#privateWi.GetX()}set x(e){e=+e;const t=this.#privateWi;isNaN(e)||t.GetX()===e||(t.SetX(e),t.SetBboxChanged())}get y(){return this.#privateWi.GetY()}set y(e){e=+e;const t=this.#privateWi;isNaN(e)||t.GetY()===e||(t.SetY(e),t.SetBboxChanged())}setPosition(e,t){e=+e,t=+t;const s=this.#privateWi;isNaN(e)||isNaN(t)||s.GetX()===e&&s.GetY()===t||(s.SetXY(e,t),s.SetBboxChanged())}getPosition(){const e=this.#privateWi;return[e.GetX(),e.GetY()]}offsetPosition(e,t){if(e=+e,t=+t,!(isNaN(e)||isNaN(t)||0===e&&0===t)){const s=this.#privateWi;s.OffsetXY(e,t),s.SetBboxChanged()}}get zElevation(){return this.#privateWi.GetZElevation()}set zElevation(e){e=+e;const t=this.#privateInst,s=this.#privateWi;isNaN(e)||s.GetZElevation()===e||(s.SetZElevation(e),t.GetRuntime().UpdateRender())}get totalZElevation(){return this.#privateWi.GetTotalZElevation()}get width(){return this.#privateWi.GetWidth()}set width(e){e=+e;const t=this.#privateWi;isNaN(e)||t.GetWidth()===e||(t.SetWidth(e),t.SetBboxChanged())}get height(){return this.#privateWi.GetHeight()}set height(e){e=+e;const t=this.#privateWi;isNaN(e)||t.GetHeight()===e||(t.SetHeight(e),t.SetBboxChanged())}setSize(e,t){e=+e,t=+t;const s=this.#privateWi;isNaN(e)||isNaN(t)||s.GetWidth()===e&&s.GetHeight()===t||(s.SetSize(e,t),s.SetBboxChanged())}getSize(){const e=this.#privateWi;return[e.GetWidth(),e.GetHeight()]}get angle(){return this.#privateWi.GetAngle()}set angle(e){e=Ai.clampAngle(+e);const t=this.#privateWi;isNaN(e)||t.GetAngle()===e||(t.SetAngle(e),t.SetBboxChanged())}get angleDegrees(){return Ai.toDegrees(this.angle)}set angleDegrees(e){this.angle=Ai.toRadians(e)}getBoundingBox(){return this.#privateWi.GetBoundingBox().toDOMRect()}getBoundingQuad(){return this.#privateWi.GetBoundingQuad().toDOMQuad()}isOnScreen(){return this.#privateWi.IsInViewport2()}get isVisible(){return this.#privateWi.IsVisible()}set isVisible(e){e=!!e;const t=this.#privateInst,s=this.#privateWi;s.IsVisible()!==e&&(s.SetVisible(e),t.GetRuntime().UpdateRender())}get opacity(){return this.#privateWi.GetOpacity()}set opacity(e){e=Ai.clamp(+e,0,1);const t=this.#privateInst,s=this.#privateWi;isNaN(e)||s.GetOpacity()===e||(s.SetOpacity(e),t.GetRuntime().UpdateRender())}set colorRgb(e){if(Mi.RequireArray(e),e.length<3)throw new Error(\"expected 3 elements\");Li.setRgb(e[0],e[1],e[2]);const t=this.#privateInst,s=this.#privateWi;s.GetUnpremultipliedColor().equalsIgnoringAlpha(Li)||(s.SetUnpremultipliedColor(Li),t.GetRuntime().UpdateRender())}get colorRgb(){const e=this.#privateWi.GetUnpremultipliedColor();return[e.getR(),e.getG(),e.getB()]}set blendMode(e){Mi.RequireString(e);const t=Bi.get(e);if(\"number\"!=typeof t)throw new Error(\"invalid blend mode\");const s=this.#privateInst,i=this.#privateWi;i.SetBlendMode(t),s.GetRuntime().UpdateRender()}get blendMode(){return Oi.get(this.#privateWi.GetBlendMode())}moveToTop(){this.#privateWi.ZOrderMoveToTop()}moveToBottom(){this.#privateWi.ZOrderMoveToBottom()}moveToLayer(e){Mi.RequireInstanceOf(e,Di);const t=this.#privateInst,s=t.GetRuntime()._UnwrapScriptInterface(e);if(!s)throw new Error(\"invalid layer\");t.GetWorldInfo().ZOrderMoveToLayer(s)}moveAdjacentToInstance(e,t){Mi.RequireInstanceOf(e,r),this.#privateWi.ZOrderMoveAdjacentToInstance(Ei.get(e),t)}get zIndex(){return this.#privateWi.GetZIndex()}get isCollisionEnabled(){return this.#privateWi.IsCollisionEnabled()}set isCollisionEnabled(e){this.#privateWi.SetCollisionEnabled(!!e)}containsPoint(e,t){return Mi.RequireNumber(e),Mi.RequireNumber(t),this.#privateWi.ContainsPoint(+e,+t)}testOverlap(e){Mi.RequireInstanceOf(e,r);const t=this.#privateInst,s=Ei.get(e);return t.GetRuntime().GetCollisionEngine().TestOverlap(t,s)}testOverlapSolid(){const e=this.#privateInst,t=e.GetRuntime().GetCollisionEngine().TestOverlapSolid(e);return t?t.GetInterfaceClass():null}getParent(){const e=this.#privateInst.GetParent();return e?e.GetInterfaceClass():null}getTopParent(){const e=this.#privateInst.GetTopParent();return e?e.GetInterfaceClass():null}*parents(){for(const e of this.#privateInst.parents())yield e.GetInterfaceClass()}getChildCount(){return this.#privateInst.GetChildCount()}getChildAt(e){const t=this.#privateInst.GetChildAt(e);return t?t.GetInterfaceClass():null}*children(){for(const e of this.#privateInst.children())yield e.GetInterfaceClass()}*allChildren(){for(const e of this.#privateInst.allChildren())yield e.GetInterfaceClass()}addChild(e,t){Mi.RequireInstanceOf(e,r),Mi.RequireOptionalObject(t),t=t||{};const s=this.#privateInst,i=Ei.get(e);s.AddChild(i,t)}removeChild(e){Mi.RequireInstanceOf(e,r);const t=this.#privateInst,s=Ei.get(e);t.RemoveChild(s)}removeFromParent(){const e=this.#privateInst;if(e.HasParent()){const t=e.GetParent();t.RemoveChild(e)}}getHierarchyOpts(){const e=this.#privateWi;return{transformX:e.GetTransformWithParentX(),transformY:e.GetTransformWithParentY(),transformWidth:e.GetTransformWithParentWidth(),transformHeight:e.GetTransformWithParentHeight(),transformAngle:e.GetTransformWithParentAngle(),transformZElevation:e.GetTransformWithParentZElevation(),transformOpacity:e.GetTransformWithParentOpacity(),transformVisibility:e.GetTransformWithParentVisibility(),destroyWithParent:e.GetDestroyWithParent()}}createMesh(e,t){Mi.RequireFiniteNumber(e),Mi.RequireFiniteNumber(t),this.#privateWi.CreateMesh(e,t)}releaseMesh(){const e=this.#privateWi;e.ReleaseMesh(),e.SetBboxChanged()}setMeshPoint(e,t,s){Mi.RequireFiniteNumber(e),Mi.RequireFiniteNumber(t),Mi.RequireObject(s);const i=this.#privateWi;i.SetMeshPoint(e,t,s)&&i.SetBboxChanged()}getMeshPoint(e,t){let s=NaN,i=NaN,r=NaN,n=NaN,a=NaN,o=this.#privateWi;if(o.HasMesh()){const h=o.GetSourceMesh(),l=h.GetMeshPointAt(e,t);null!==l&&(s=l.GetX(),i=l.GetY(),r=l.GetZElevation(),n=l.GetU(),a=l.GetV())}return{x:s,y:i,zElevation:r,u:n,v:a}}getMeshSize(){const e=this.#privateWi;if(!e.HasMesh())return[0,0];const t=e.GetSourceMesh();return[t.GetHSize(),t.GetVSize()]}}};0;const Ai=self.C3,Mi=self.C3X,Di=self.ILayer,Ei=new WeakMap,Fi=Ai._GetInternalAPIToken(),Bi=new Map([[\"normal\",0],[\"additive\",1],[\"copy\",3],[\"destination-over\",4],[\"source-in\",5],[\"destination-in\",6],[\"source-out\",7],[\"destination-out\",8],[\"source-atop\",9],[\"destination-atop\",10]]),Oi=new Map([...Bi.entries()].map(e=>[e[1],e[0]])),Li=Ai.New(Ai.Color);self.IWorldInstance=e(self.IInstance),self.IWorldInstanceSDKBase=e(self.ISDKInstanceBase)}{const ki=self.C3X;self.IDOMInstance=class extends self.IWorldInstance{#private;constructor(){super(),this.#private=self.IInstance._GetInitInst()}getElement(){return this.#private.GetSdkInstance()._GetElementInDOMMode()}focus(){this.#private.GetSdkInstance().FocusElement()}blur(){this.#private.GetSdkInstance().BlurElement()}setCssStyle(e,t){ki.RequireString(e),this.#private.GetSdkInstance().SetElementCSSStyle(e,t)}}}{let i=function(e){let t=Vi.get(e);return t||(t=Ni.New(Ni.Event.Dispatcher),Vi.set(e,t)),t};i;const Ni=self.C3,Wi=self.C3X,Vi=new WeakMap,Ui=Ni._GetInternalAPIToken();self.IBehaviorInstance=class{#private;constructor(){const e=Ni.AddonManager._GetInitObject2(Ui),t={runtime:{value:(this.#private=e).GetRuntime().GetIRuntime(),writable:!1},behavior:{value:e.GetBehavior().GetIBehavior(),writable:!1},behaviorType:{value:e.GetBehaviorType().GetIBehaviorType(),writable:!1}};Object.defineProperties(this,t),e.GetRuntime()._MapScriptInterface(this,e)}static _GetInitInst(){return Ni.AddonManager._GetInitObject()}get instance(){return this.#private.GetObjectInstance().GetInterfaceClass()}_release(){const e=Vi.get(this);e&&(e.Release(),Vi.delete(this))}addEventListener(e,t,s){Wi.RequireString(e),Wi.RequireFunction(t),i(this).addEventListener(e,t,s)}removeEventListener(e,t,s){Wi.RequireString(e),Wi.RequireFunction(t),i(this).removeEventListener(e,t,s)}dispatchEvent(e){i(this).dispatchEvent(e)}}}{const ji=self.C3,Hi=ji._GetInternalAPIToken();self.IBehaviorType=class{constructor(){const e=ji.AddonManager._GetInitObject2(Hi),t={runtime:{value:e.GetRuntime().GetIRuntime(),writable:!1},behavior:{value:e.GetBehavior().GetIBehavior(),writable:!1},name:{value:e.GetName(),writable:!1}};Object.defineProperties(this,t)}}}{const Xi=self.C3,zi=Xi._GetInternalAPIToken();self.IBehavior=class{#private;constructor(){const e=Xi.AddonManager._GetInitObject2(zi),t={runtime:{value:(this.#private=e).GetRuntime().GetIRuntime(),writable:!1}};Object.defineProperties(this,t)}getAllInstances(){return this.#private.GetInstances().map(e=>e.GetInterfaceClass())}static getByConstructor(e){if(!e)return null;const t=Xi.AddonManager.GetBehaviorByConstructorFunction(e);return t?t.GetIBehavior():null}}}{const Yi=self.C3,qi=self.C3X,Ki=Yi.New(Yi.Color);self.IEffectInstance=class{#private;constructor(e,t){this.#private=e;const s={index:{value:t,writable:!1}};Object.defineProperties(this,s)}get name(){const e=this.#private.GetAllEffectTypes();return e[this.index].GetName()}get isActive(){return this.#private.IsEffectIndexActive(this.index)}set isActive(e){e=!!e;const t=this.#private;t.IsEffectIndexActive(this.index)!==e&&(t.SetEffectIndexActive(this.index,e),t.UpdateActiveEffects(),t.GetRuntime().UpdateRender())}setParameter(e,t){qi.RequireFiniteNumber(e),e=Math.floor(+e);const s=this.#private,i=s.GetEffectParameter(this.index,e);if(null===i)throw new RangeError(\"invalid index\");if(i instanceof Yi.Color){if(!Array.isArray(t)||t.length<3)throw new TypeError(\"expected array with 3 elements\");Ki.setRgb(t[0],t[1],t[2]),t=Ki}else if(\"number\"!=typeof t)throw new TypeError(\"expected number\");const r=s.SetEffectParameter(this.index,e,t);r&&s.IsEffectIndexActive(this.index)&&s.GetRuntime().UpdateRender()}getParameter(e){qi.RequireFiniteNumber(e),e=Math.floor(+e);const t=this.#private,s=t.GetEffectParameter(this.index,e);if(null===s)throw new RangeError(\"invalid index\");return s instanceof Yi.Color?[s.getR(),s.getG(),s.getB()]:s}}}self.IAnimation=class{#private;constructor(e){this.#private=e,Object.defineProperties(this,{name:{value:e.GetName(),writable:!1}})}get speed(){return this.#private.GetSpeed()}get isLooping(){return this.#private.IsLooping()}get repeatCount(){return this.#private.GetRepeatCount()}get repeatTo(){return this.#private.GetRepeatTo()}get isPingPong(){return this.#private.IsPingPong()}get frameCount(){return this.#private.GetFrameCount()}getFrames(){return this.#private.GetFrames().map(e=>e.GetIAnimationFrame())}*frames(){for(const e of this.#private.GetFrames())yield e.GetIAnimationFrame()}};self.IImageInfo=class{#private;constructor(e){this.#private=e}static _Unwrap(e){return e.#private}get width(){return this.#private.GetWidth()}get height(){return this.#private.GetHeight()}getSize(){const e=this.#private;return[e.GetWidth(),e.GetHeight()]}getTexture(e){return e.getTextureForImageInfo(this)}getTexRect(){return this.#private.GetTexRect().toDOMRect()}};{const Ji=self.C3X;self.IAnimationFrame=class extends self.IImageInfo{#private;constructor(e){super(e.GetImageInfo()),this.#private=e,Object.defineProperties(this,{duration:{value:e.GetDuration(),writable:!1},originX:{value:e.GetOriginX(),writable:!1},originY:{value:e.GetOriginY(),writable:!1}})}getOrigin(){const e=this.#private;return[e.GetOriginX(),e.GetOriginY()]}getImagePointCount(){return this.#private.GetImagePointCount()}getImagePointX(e){return this.getImagePoint(e)[0]}getImagePointY(e){return this.getImagePoint(e)[1]}getImagePoint(e){let t=this.#private,s=null;if(\"number\"==typeof e)s=t.GetImagePointByIndex(Math.floor(e));else{if(\"string\"!=typeof e)throw new TypeError(\"expected string or number\");s=t.GetImagePointByName(e)}return s?[s.GetX(),s.GetY()]:this.getOrigin()}getPolyPointCount(){const e=this.#private.GetCollisionPoly();return e?e.pointCount():0}getPolyPointX(e){return this.getPolyPoint(e)[0]}getPolyPointY(e){return this.getPolyPoint(e)[1]}getPolyPoint(e){Ji.RequireFiniteNumber(e),e=Math.floor(e);const t=this.#private.GetCollisionPoly();if(!t||e<0||e>=t.pointCount())return[0,0];const s=t.pointsArr(),i=s[2*e],r=s[2*e+1];return[i,r]}get tag(){return this.#private.GetTag()}}}{let t=function(e){const t=Qi.get(e);if(t.IsReleased())throw new Error(\"timeline/tween was released and is no longer valid\");return t};t;const Zi=self.C3X,Qi=new WeakMap;self.ITimelineStateBase=class{constructor(e){Qi.set(this,e),e.GetRuntime()._MapScriptInterface(this,e)}pause(){t(this).Stop()}resume(){t(this).Resume()}stop(){t(this).Reset()}hasTags(e){return t(this).HasTags(e)}set time(e){Zi.RequireFiniteNumber(e),t(this).SetTime(e)}get time(){return t(this).GetTime()}set totalTime(e){Zi.RequireFiniteNumber(e),t(this).SetTotalTime(e)}get totalTime(){return t(this).GetTotalTime()}set isLooping(e){t(this).SetLoop(!!e)}get isLooping(){return t(this).GetLoop()}set isPingPong(e){t(this).SetPingPong(!!e)}get isPingPong(){return t(this).GetPingPong()}set playbackRate(e){Zi.RequireFiniteNumber(e),t(this).SetPlaybackRate(e)}get playbackRate(){return t(this).GetPlaybackRate()}get progress(){const e=t(this);return e.GetTime()/e.GetTotalTime()}get tags(){return t(this).GetTags()}get finished(){return t(this).GetPlayPromise()}get isPlaying(){return t(this).IsPlaying()}get isPaused(){return t(this).IsPaused()}get isReleased(){return Qi.get(this).IsReleased()}}}{let s=new WeakMap;self.ITimelineState=class extends self.ITimelineStateBase{constructor(e){super(e),s.set(this,e);const t={name:{value:e.GetName(),writable:!1}};Object.defineProperties(this,t)}}}{let s=function(e){const t=r.get(e);if(t.IsReleased())throw new Error(\"tween was released and is no longer valid\");return t},i=(s,self.C3X),r=new WeakMap,n=new WeakMap,a=null;self.ITweenState=class extends self.ITimelineStateBase{constructor(e,t,s){super(e),a=a||s.easeToIndexFunc,r.set(this,e),t&&n.set(this,t)}stop(){const e=s(this),t=n.get(this);t.ReleaseTween(e)}setEase(e){i.RequireString(e);const t=self.Ease.GetEaseFromIndex(a(e));s(this).SetEase(t)}get instance(){const e=s(this).GetInstance();return e?e.GetInterfaceClass():null}get isDestroyOnComplete(){return s(this).GetDestroyInstanceOnComplete()}set isDestroyOnComplete(e){s(this).SetDestroyInstanceOnComplete(!!e)}get value(){const e=s(this);if(\"value\"!==e.GetId())throw new Error(\"not a value tween\");return e.GetPropertyTrack(\"value\").GetSourceAdapterValue()}}}self.ISDKPluginBase=class extends self.IPlugin{constructor(){super()}};{const $i=self.C3,er=self.C3X,tr=$i._GetInternalAPIToken();self.ISDKDOMPluginBase=class extends self.ISDKPluginBase{#private;#domComponentId;#nextElementId=0;#instMap=new Map;constructor(e){if(super(),this.#private=$i.AddonManager._GetInitObject2(tr),!e?.domComponentId)throw new Error(\"no DOM component ID specified\");this.#domComponentId=e.domComponentId,this._addElementMessageHandler(\"elem-focused\",e=>e._onElemFocused()),this._addElementMessageHandler(\"elem-blurred\",e=>{e&&e._onElemBlurred()})}_addElement(e){const t=this.#nextElementId++;return this.#instMap.set(t,e),t}_removeElement(e){this.#instMap.delete(e)}_addElementMessageHandler(e,s){const t=this.#private.GetRuntime();t.AddDOMComponentMessageHandler(this.#domComponentId,e,e=>{const t=this.#instMap.get(e.elementId);s(t,e)})}_addElementMessageHandlers(e){er.RequireArray(e);for(const[t,s]of e)this._addElementMessageHandlers(t,s)}}}{const sr=self.C3,ir=(new WeakMap,sr._GetInternalAPIToken());self.ISDKObjectTypeBase=class extends self.IObjectClass{#private;constructor(){super(),this.#private=sr.AddonManager._GetInitObject2(ir)}_onCreate(){}getImageInfo(){return this.#private.GetImageInfo().GetIImageInfo()}_loadTextures(e){}_releaseTextures(e){}_onDynamicTextureLoadComplete(){}_preloadTexturesWithInstances(e){}}}{const rr=self.C3,nr=(new WeakMap,rr._GetInternalAPIToken());self.ISDKWorldInstanceBase=class extends self.IWorldInstanceSDKBase{#private;#renderercontextlost_handler=null;#renderercontextrestored_handler=null;constructor(e){super(e),this.#private=rr.AddonManager._GetInitObject2(nr)}_release(){if(super._release(),this.#renderercontextlost_handler){const e=this.#private.GetRuntime().Dispatcher();e.removeEventListener(\"renderercontextlost\",this.#renderercontextlost_handler),e.removeEventListener(\"renderercontextrestored\",this.#renderercontextrestored_handler),this.#renderercontextlost_handler=null,this.#renderercontextrestored_handler=null}}_handleRendererContextLoss(){if(!this.#renderercontextlost_handler){this.#renderercontextlost_handler=()=>this._onRendererContextLost(),this.#renderercontextrestored_handler=()=>this._onRendererContextRestored();const e=this.#private.GetRuntime().Dispatcher();e.addEventListener(\"renderercontextlost\",this.#renderercontextlost_handler),e.addEventListener(\"renderercontextrestored\",this.#renderercontextrestored_handler)}}_onRendererContextLost(){}_onRendererContextRestored(){}_draw(e){}}}{const ar=self.C3,or=ar.New(ar.Rect),hr=new WeakMap,lr=ar._GetInternalAPIToken();self.ISDKDOMInstanceBase=class extends self.ISDKWorldInstanceBase{#elementId=-1;#isElementShowing=!0;#elemHasFocus=!1;#autoFontSize=!1;#autoFontSizeOffset=-.2;#lastRect=ar.New(ar.Rect,0,0,-1,-1);#lastWindowWidth=0;#lastWindowHeight=0;#lastHTMLIndex=-1;#lastHTMLZIndex=-1;#isPendingUpdateState=!1;constructor(e){if(!e?.domComponentId)throw new Error(\"no DOM component ID specified\");super(e);const t=ar.AddonManager._GetInitObject2(lr),s=(hr.set(this,t),this.#elementId=this.plugin._addElement(this),t.GetRuntime().GetCanvasManager());this.#lastWindowWidth=s.GetLastWidth(),this.#lastWindowHeight=s.GetLastHeight(),this._setTicking(!0)}_release(){super._release(),this.plugin._removeElement(this.#elementId),this._postToDOMElement(\"destroy\"),this.#elementId=-1,hr.delete(this)}_getElementInDOMMode(){const e=hr.get(this).GetRuntime();if(e.IsInWorker())throw new Error(\"not valid in worker mode\");return this._postToDOMElementMaybeSync(\"get-element\")}_postToDOMElement(e,t){(t=t||{}).elementId=this.#elementId,this._postToDOM(e,t)}_postToDOMElementMaybeSync(e,t){return(t=t||{}).elementId=this.#elementId,this._postToDOMMaybeSync(e,t)}_postToDOMElementAsync(e,t){return(t=t||{}).elementId=this.#elementId,this._postToDOMAsync(e,t)}_createElement(e){e=e||{};const t=hr.get(this).GetWorldInfo();e.elementId=this.#elementId,e.isVisible=t.IsVisible(),e.htmlIndex=t.GetLayer().GetHTMLIndex(),e.htmlZIndex=t.GetHTMLZIndex(),Object.assign(e,this._getElementState()),this.#isElementShowing=!!e.isVisible,this._postToDOMMaybeSync(\"create\",e),this._updatePosition(!0)}setElementVisible(e){this.#isElementShowing!==(e=!!e)&&(this.#isElementShowing=e,this._postToDOMElement(\"set-visible\",{isVisible:e}))}_tick(){this._updatePosition(!1)}_shouldPreserveElement(){const e=hr.get(this).GetRuntime(),t=e.GetCanvasManager().GetFullscreenMode();return\"Android\"===ar.Platform.OS&&(\"scale-inner\"===t||\"scale-outer\"===t||\"crop\"===t)}_updatePosition(c){const u=hr.get(this);if(!u.IsDestroyed()){let e=u.GetWorldInfo(),t=e.GetLayer(),s=e.GetBoundingBox(),[i,r]=t.LayerToCanvasCss(s.getLeft(),s.getTop()),[n,a]=t.LayerToCanvasCss(s.getRight(),s.getBottom()),o=u.GetRuntime().GetCanvasManager(),h=o.GetCssWidth(),l=o.GetCssHeight();if(e.IsVisible()&&t.IsVisible())if(!this._shouldPreserveElement()&&(n<=0||a<=0||h<=i||l<=r))this.setElementVisible(!1);else{or.set(i,r,n,a);const _=o.GetLastWidth(),d=o.GetLastHeight(),p=t.GetHTMLIndex(),f=e.GetHTMLZIndex();if(!c&&or.equals(this.#lastRect)&&this.#lastWindowWidth===_&&this.#lastWindowHeight===d&&this.#lastHTMLIndex===p&&this.#lastHTMLZIndex===f)this.setElementVisible(!0);else{this.#lastRect.copy(or),this.#lastWindowWidth=_,this.#lastWindowHeight=d,this.#lastHTMLIndex=p,this.#lastHTMLZIndex=f,this.setElementVisible(!0);let e=null;this.#autoFontSize&&(e=t.GetDisplayScale()+this.#autoFontSizeOffset),this._postToDOMElement(\"update-position\",{left:Math.round(this.#lastRect.getLeft()),top:Math.round(this.#lastRect.getTop()),width:Math.round(this.#lastRect.width()),height:Math.round(this.#lastRect.height()),htmlIndex:p,htmlZIndex:f,fontSize:e})}}else this.setElementVisible(!1)}}focusElement(){this._postToDOMElementMaybeSync(\"focus\",{focus:!0})}blurElement(){this._postToDOMElementMaybeSync(\"focus\",{focus:!1})}_onElemFocused(){this.#elemHasFocus=!0}_onElemBlurred(){this.#elemHasFocus=!1}isElementFocused(){return this.#elemHasFocus}setElementCSSStyle(e,t){this.postToDOMElement(\"set-css-style\",{prop:ar.CSSToCamelCase(e),val:t})}setElementAttribute(e,t){this.postToDOMElement(\"set-attribute\",{name:e,val:t})}removeElementAttribute(e){this.postToDOMElement(\"remove-attribute\",{name:e})}_updateElementState(){this.#isPendingUpdateState||(this.#isPendingUpdateState=!0,Promise.resolve().then(()=>{this.#isPendingUpdateState=!1,this._postToDOMElement(\"update-state\",this._getElementState())}))}_getElementState(){}_getElementId(){return this.#elementId}}}self.ISDKBehaviorBase=class extends self.IBehavior{constructor(){super()}};self.ISDKBehaviorTypeBase=class extends globalThis.IBehaviorType{constructor(){super()}_onCreate(){}};{const cr=self.C3,ur=new WeakMap,_r=cr._GetInternalAPIToken();self.ISDKBehaviorInstanceBase=class extends self.IBehaviorInstance{#isTicking=!1;#isTicking2=!1;#isPostTicking=!1;constructor(){super(),ur.set(this,cr.AddonManager._GetInitObject2(_r))}_release(){super._release(),this._setTicking(!1),this._setTicking2(!1),this._setPostTicking(!1),ur.delete(this)}_getInitProperties(){return cr.AddonManager._GetInitProperties()}_postCreate(){}_trigger(e){const t=ur.get(this);t.GetRuntime().Trigger(e,t.GetObjectInstance(),t.GetBehaviorType())}_triggerAsync(e){const t=ur.get(this);return t.GetRuntime().TriggerAsync(e,t.GetObjectInstance(),t.GetBehaviorType())}_setTicking(e){if(this.#isTicking!==(e=!!e)){this.#isTicking=e;const t=ur.get(this).GetRuntime();e?t._AddBehInstToTick(this):t._RemoveBehInstToTick(this)}}_isTicking(){return this.#isTicking}_tick(){}_setTicking2(e){if(this.#isTicking2!==(e=!!e)){this.#isTicking2=e;const t=ur.get(this).GetRuntime();e?t._AddBehInstToTick2(this):t._RemoveBehInstToTick2(this)}}_isTicking2(){return this.#isTicking2}_tick2(){}_setPostTicking(e){if(this.#isPostTicking!==(e=!!e)){this.#isPostTicking=e;const t=ur.get(this).GetRuntime();e?t._AddBehInstToPostTick(this):t._RemoveBehInstToPostTick(this)}}_isPostTicking(){return this.#isPostTicking}_postTick(){}_getDebuggerProperties(){return[]}_saveToJson(){return null}_loadFromJson(e){}}}{let i=self.C3X,r=null;self.ISDKUtils=class{constructor(e){r=e}addLoadPromise(e){r.AddLoadPromise(e)}sendWrapperExtensionMessage(e,t,s){i.RequireString(e),i.RequireString(t),i.RequireOptionalArray(s),r.SendWrapperExtensionMessage(e,t,s)}sendWrapperExtensionMessageAsync(e,t,s){return i.RequireString(e),i.RequireString(t),i.RequireOptionalArray(s),r.SendWrapperExtensionMessageAsync(e,t,s)}createLoopingConditionContext(e){return i.RequireOptionalString(e),new self.ILoopingConditionContext(r,e)}set isAutoSuspendEnabled(e){r._SetAutoSuspendEnabled(!!e)}get isAutoSuspendEnabled(){return r._IsAutoSuspendEnabled()}setSuspended(e){r.SetSuspended(!!e)}getObjectClassBySid(e){i.RequireNumber(e);const t=r.GetObjectClassBySID(e);return t?t.GetIObjectClass():null}}}self.ILoopingConditionContext=class{#runtime;#currentEvent;#solModifiers;#oldFrame;#newFrame;#loop;constructor(e,t){const s=(this.#runtime=e).GetEventSheetManager(),i=e.GetCurrentEvent(),r=(this.#currentEvent=i,this.#solModifiers=i.GetSolModifiers(),e.GetEventStack()),n=(this.#oldFrame=r.GetCurrentStackFrame(),this.#newFrame=r.Push(i),s.GetLoopStack()),a=n.Push();this.#loop=a,t&&a.SetName(t),e.SetDebuggingEnabled(!1)}retrigger(){const e=this.#runtime.GetEventSheetManager(),t=this.#solModifiers,s=this.#loop;e.PushCopySol(t),this.#currentEvent.Retrigger(this.#oldFrame,this.#newFrame),e.PopSol(t),s.SetIndex(s.GetIndex()+1)}get isStopped(){return this.#loop.IsStopped()}release(){const e=this.#runtime,t=e.GetEventStack(),s=e.GetEventSheetManager().GetLoopStack();e.SetDebuggingEnabled(!0),s.Pop(),t.Pop()}};{let d=self.C3,r=self.C3X,p=null,n=null;self.IRenderer=class{constructor(e,t){n=e,p=t}setAlphaBlendMode(){p.SetAlphaBlend()}setBlendMode(e){p.SetNamedBlendMode(e)}setColorFillMode(){p.SetColorFillMode()}setTextureFillMode(){p.SetTextureFillMode()}setSmoothLineFillMode(){p.SetSmoothLineFillMode()}setColor(e){p.SetColorRgba(e[0],e[1],e[2],e[3])}setColorRgba(e,t,s,i){p.SetColorRgba(e,t,s,i)}resetColor(){p.ResetColor()}setOpacity(e){p.SetOpacity(e)}setCurrentZ(e){p.SetCurrentZ(e)}getCurrentZ(){p.GetCurrentZ()}rect(e){p.Rect2(e.left,e.top,e.right,e.bottom)}rect2(e,t,s,i){p.Rect2(e,t,s,i)}quad(e){p.Quad(d.Quad.fromDOMQuad(e))}quad2(e,t,s,i,r,n,a,o){p.Quad2(e,t,s,i,r,n,a,o)}quad3(e,t){p.Quad3(d.Quad.fromDOMQuad(e),d.Rect.fromDOMRect(t))}quad4(e,t){p.Quad4(d.Quad.fromDOMQuad(e),d.Quad.fromDOMQuad(t))}quad3D(e,t,s,i,r,n,a,o,h,l,c,u,_){p.Quad3D(e,t,s,i,r,n,a,o,h,l,c,u,d.Rect.fromDOMRect(_))}quad3D2(e,t,s,i,r,n,a,o,h,l,c,u,_){p.Quad3D2(e,t,s,i,r,n,a,o,h,l,c,u,d.Quad.fromDOMQuad(_))}drawMesh(e,t,s){p.DrawMesh(e,t,s)}convexPoly(e){p.ConvexPoly(e)}line(e,t,s,i){p.Line(e,t,s,i)}texturedLine(e,t,s,i,r,n){p.TexturedLine(e,t,s,i,r,n)}lineRect(e,t,s,i){p.LineRect(e,t,s,i)}lineRect2(e){p.LineRect2(d.Rect.fromDOMRect(e))}lineQuad(e){p.LineQuad(d.Quad.fromDOMQuad(e))}pushLineWidth(e){p.PushLineWidth(e)}popLineWidth(){p.PopLineWidth()}pushLineCap(e){p.PushLineCap(e)}popLineCap(){p.PopLineCap()}setTexture(e){r.RequireOptionalInstanceOf(e,self.ITexture);const t=e?n._UnwrapScriptInterface(e):null;p.SetTexture(t)}loadTextureForImageInfo(e,t){const s=self.IImageInfo._Unwrap(e);if(s)return s.LoadStaticTexture(p,{wrapX:t?.wrapX??\"clamp-to-edge\",wrapY:t?.wrapY??\"clamp-to-edge\",sampling:t?.sampling??\"trilinear\",mipMap:t?.mipMap??!0});throw new Error(\"invalid IImageInfo\")}releaseTextureForImageInfo(e){const t=self.IImageInfo._Unwrap(e);if(!t)throw new Error(\"invalid IImageInfo\");t.ReleaseTexture()}getTextureForImageInfo(e){const t=self.IImageInfo._Unwrap(e);if(!t)throw new Error(\"invalid IImageInfo\");const s=t.GetTexture();return self.ITexture.GetInterface(n,s)}createDynamicTexture(e,t,s){r.RequireFiniteNumber(e),r.RequireFiniteNumber(t);const i=p.CreateDynamicTexture(e,t,{wrapX:s?.wrapX??\"clamp-to-edge\",wrapY:s?.wrapY??\"clamp-to-edge\",sampling:s?.sampling??\"trilinear\",mipMap:s?.mipMap??!0});return self.ITexture.GetInterface(n,i)}updateTexture(e,t,s){r.RequireInstanceOf(t,self.ITexture);const i=n._UnwrapScriptInterface(t);p.UpdateTexture(e,i,{premultiplyAlpha:s?.premultiplyAlpha??!0})}deleteTexture(e){r.RequireInstanceOf(e,self.ITexture);const t=n._UnwrapScriptInterface(e);p.DeleteTexture(t)}createRendererText(){const e=p.CreateRendererText();return new self.IRendererText(n,e)}setDeviceTransform(){n.GetCanvasManager().SetDeviceTransform(p)}setLayerTransform(e){r.RequireInstanceOf(e,globalThis.ILayer);const t=n._UnwrapScriptInterface(e);t._SetTransform(p)}}}{const dr=new WeakMap,pr=new WeakMap;self.ITexture=class{constructor(e,t){dr.set(this,{runtime:e,texture:t}),pr.set(t,this),e._MapScriptInterface(this,t),Object.defineProperties(this,{width:{value:t.GetWidth(),writable:!1},height:{value:t.GetHeight(),writable:!1}})}static GetInterface(e,t){if(!t)return null;const s=pr.get(t);return s||new self.ITexture(e,t)}}}{let i=function(e){return mr.get(e).rendererText};i;const fr=self.C3X,mr=new WeakMap;self.IRendererText=class{constructor(e,t){mr.set(this,{runtime:e,rendererText:t}),e._MapScriptInterface(this,t)}release(){i(this).Release()}set fontFace(e){fr.RequireString(e),i(this).SetFontName(e)}get fontFace(){return i(this).GetFontName()}set sizePt(e){fr.RequireFiniteNumber(e),i(this).SetFontSize(e)}get sizePt(){return i(this).GetFontSize()}set lineHeight(e){fr.RequireFiniteNumber(e),i(this).SetLineHeight(e)}get lineHeight(){return i(this).GetLineHeight()}set isBold(e){i(this).SetBold(e)}get isBold(){return i(this).IsBold()}set isItalic(e){i(this).SetItalic(e)}get isItalic(){return i(this).IsItalic()}setColor(e){fr.RequireArray(e),this.setColorRgb(e[0],e[1],e[2])}setColorRgb(e,t,s){i(this).SetColorRgb(e,t,s)}setCssColor(e){fr.RequireString(e),i(this).SetColor(e)}set horizontalAlign(e){i(this).SetHorizontalAlignment(e)}get horizontalAlign(){return i(this).GetHorizontalAlignment()}set verticalAlign(e){i(this).SetVerticalAlignment(e)}get verticalAlign(){return i(this).GetVerticalAlignment()}set wordWrapMode(e){i(this).SetWordWrapMode(e)}get wordWrapMode(){return i(this).GetWordWrapMode()}set textDirection(e){i(this).SetTextDirection(e)}get textDirection(){return i(this).GetTextDirection()}set text(e){fr.RequireString(e),i(this).SetText(e)}get text(){return i(this).GetText()}setSize(e,t,s){fr.RequireFiniteNumber(e),fr.RequireFiniteNumber(t),fr.RequireFiniteNumber(s),i(this).SetSize(e,t,s)}getTexture(){const{runtime:e,rendererText:t}=mr.get(this),s=t.GetTexture();return self.ITexture.GetInterface(e,s)}getTexRect(){return i(this).GetTexRect().toDOMRect()}setTextureUpdateCallback(e){fr.RequireFunction(e),i(this).ontextureupdate=e}releaseTexture(){i(this).ReleaseTexture()}get textWidth(){return i(this).GetTextWidth()}get textHeight(){return i(this).GetTextHeight()}}}{let i=function(e){if(!e)return\"\";const t=e.split(\".\");if(t.length<2)return\"\";const s=t.at(-1).toLowerCase();return Sr.get(s)||\"\"},n=function(i){return new Promise((e,t)=>{const s=document.createElement(\"script\");s.onload=e,s.onerror=t,s.async=!1,s.type=\"module\",s.src=i,document.head.appendChild(s)})};i,n;const m=self.C3,gr=new Set([\"local\",\"remote\"]),Sr=new Map([[\"mp4\",\"video/mp4\"],[\"webm\",\"video/webm\"],[\"m4a\",\"audio/mp4\"],[\"mp3\",\"audio/mpeg\"],[\"js\",\"application/javascript\"],[\"wasm\",\"application/wasm\"],[\"svg\",\"image/svg+xml\"],[\"html\",\"text/html\"]]);m.AssetManager=class extends m.DefendedBase{constructor(e,t){super();const s=t.exportType,i=(this._runtime=e,this._fileStructure=\"folders\",this._cordovaBlobUrlCache=new Map,this._isCordova=\"cordova\"===s,this._isiOSCordova=!!t.isiOSCordova,this._isFileProtocol=!!t.isFileProtocol,this._swClientId=t.swClientId,this._supportedAudioFormats=t.supportedAudioFormats||{},this._audioFiles=new Map,this._preloadSounds=!1,this._scriptSubfolder=t.scriptFolder,this._mediaSubfolder=\"\",this._fontsSubfolder=\"\",this._iconsSubfolder=\"\",this._fileMap=t.fileMap||new Map,this._fileMapBlobUrls=new Map,\"html5\"===s||\"scirra-arcade\"===s||\"instant-games\"===s);this._defaultLoadPolicy=i?\"remote\":\"local\",this._assetsByUrl=new Map,this._webFonts=[],this._loadPromises=[],this._hasFinishedInitialLoad=!1,this._totalAssetSizeToLoad=0,this._assetSizeLoaded=0,this._lastLoadProgress=0,this._hasHadErrorLoading=!1,this._loadingRateLimiter=m.New(m.RateLimiter,()=>this._FireLoadingProgressEvent(),50),this._localPromiseThrottle=m.New(m.PromiseThrottle,Math.max(m.hardwareConcurrency,8)),this._remotePromiseThrottle=m.New(m.PromiseThrottle,20),this._iAssetManager=new self.IAssetManager(this)}Release(){for(const e of this._assetsByUrl.values())e.Release();this._assetsByUrl.clear(),m.clearArray(this._loadPromises),this._runtime=null}GetRuntime(){return this._runtime}_SetFileStructure(e){this._fileStructure=e}GetFileStructure(){return this._fileStructure}GetScriptSubfolder(){return this._scriptSubfolder}_SetMediaSubfolder(e){this._mediaSubfolder=e}GetMediaSubfolder(){return this._mediaSubfolder}_SetFontsSubfolder(e){this._fontsSubfolder=e}GetFontsSubfolder(){return this._fontsSubfolder}_SetIconsSubfolder(e){this._iconsSubfolder=e}GetIconsSubfolder(){return this._iconsSubfolder}IsFileProtocol(){return this._isFileProtocol}FetchBlob(e,t){return t=t||this._defaultLoadPolicy,m.IsRelativeURL(e)?(\"flat\"===this._fileStructure&&(e=e.toLowerCase()),this._isCordova&&this._isFileProtocol?this.CordovaFetchLocalFileAsBlob(e):\"playable-ad-single-file\"===this._runtime.GetExportType()?self.c3_runtimeInterface._PlayableAdFetchBlob(e):(\"local\"===t?this._localPromiseThrottle:this._remotePromiseThrottle).Add(()=>m.FetchBlob(e))):m.FetchBlob(e)}FetchArrayBuffer(e){return m.IsRelativeURL(e)?(\"flat\"===this._fileStructure&&(e=e.toLowerCase()),this._isCordova&&this._isFileProtocol?this.CordovaFetchLocalFileAsArrayBuffer(e):\"playable-ad-single-file\"===this._runtime.GetExportType()?m.BlobToArrayBuffer(self.c3_runtimeInterface._PlayableAdFetchBlob(e)):(\"local\"===this._defaultLoadPolicy?this._localPromiseThrottle:this._remotePromiseThrottle).Add(()=>m.FetchArrayBuffer(e))):m.FetchArrayBuffer(e)}FetchText(e){return m.IsRelativeURL(e)?(\"flat\"===this._fileStructure&&(e=e.toLowerCase()),this._isCordova&&this._isFileProtocol?this.CordovaFetchLocalFileAsText(e):\"playable-ad-single-file\"===this._runtime.GetExportType()?m.BlobToString(self.c3_runtimeInterface._PlayableAdFetchBlob(e)):(\"local\"===this._defaultLoadPolicy?this._localPromiseThrottle:this._remotePromiseThrottle).Add(()=>m.FetchText(e))):m.FetchText(e)}async FetchJson(e){const t=await this.FetchText(e);return JSON.parse(t)}_CordovaFetchLocalFileAs(e,t){return\"flat\"===this._fileStructure&&(e=e.toLowerCase()),this._runtime.PostComponentMessageToDOMAsync(\"runtime\",\"cordova-fetch-local-file\",{filename:e,as:t})}CordovaFetchLocalFileAsText(e){return this._CordovaFetchLocalFileAs(e,\"text\")}async CordovaFetchLocalFileAsBlob(e){const t=await this._CordovaFetchLocalFileAs(e,\"buffer\"),s=i(e);return new Blob([t],{type:s})}async CordovaFetchLocalFileAsBlobURL(e){\"flat\"===this._fileStructure&&(e=e.toLowerCase());let t=this._cordovaBlobUrlCache.get(e);if(!t){const s=await this.CordovaFetchLocalFileAsBlob(e);t=URL.createObjectURL(s),this._cordovaBlobUrlCache.set(e,t)}return t}CordovaFetchLocalFileAsArrayBuffer(e){return this._CordovaFetchLocalFileAs(e,\"buffer\")}GetMediaFileUrl(e){\"flat\"===this._fileStructure&&(e=e.toLowerCase());let t=this._mediaSubfolder+e;return\"Gecko\"===m.Platform.BrowserEngine&&\"preview\"===this._runtime.GetExportType()?this._GetLocalBlobURLFromFileMap(t):t}GetProjectFileUrl(e){return m.IsAbsoluteURL(e)?Promise.resolve(e):this._isCordova&&this._isFileProtocol?this.CordovaFetchLocalFileAsBlobURL(e):\"playable-ad-single-file\"===this._runtime.GetExportType()?URL.createObjectURL(self.c3_runtimeInterface._PlayableAdFetchBlob(e)):(\"flat\"===this._fileStructure&&(e=e.toLowerCase()),Promise.resolve(e))}GetProjectFileIframeUrl(t){if(m.IsAbsoluteURL(t)||\"preview\"!==this._runtime.GetExportType()||!this._swClientId||!t)return t;try{const e=new URL(t,location.href);return e.searchParams.set(\"__c3_client_id\",this._swClientId),e.toString()}catch(e){return console.warn(\"Invalid iframe URL: \"+t),t}}LoadProjectFileUrl(e){return this.GetProjectFileUrl(e)}LoadImage(e){if(e.loadPolicy&&!gr.has(e.loadPolicy))throw new Error(\"invalid load policy\");let t=this._assetsByUrl.get(e.url);return t||(t=m.New(m.ImageAsset,this,{url:e.url,size:e.size||0,loadPolicy:e.loadPolicy||this._defaultLoadPolicy}),this._assetsByUrl.set(t.GetURL(),t),this._hasFinishedInitialLoad)||(this._totalAssetSizeToLoad+=t.GetSize(),this._loadPromises.push(t.Load().then(()=>this._AddLoadedSize(t.GetSize())))),t}_ReleaseAsset(e){this._assetsByUrl.delete(e.GetURL())}async WaitForAllToLoad(){try{await Promise.all(this._loadPromises),this._lastLoadProgress=1}catch(e){console.error(\"Error loading: \",e),this._hasHadErrorLoading=!0,this._FireLoadingProgressEvent()}}SetInitialLoadFinished(){this._hasFinishedInitialLoad=!0}HasHadErrorLoading(){return this._hasHadErrorLoading}_AddLoadedSize(e){this._assetSizeLoaded+=e,this._loadingRateLimiter.Call()}_FireLoadingProgressEvent(){const e=m.New(m.Event,\"loadingprogress\");this._lastLoadProgress=m.clamp(this._assetSizeLoaded/this._totalAssetSizeToLoad,0,1),e.progress=this._lastLoadProgress,this._runtime.Dispatcher().dispatchEvent(e)}GetLoadProgress(){return this._lastLoadProgress}_SetWebFonts(e){m.shallowAssignArray(this._webFonts,e),this._webFonts.length&&this._loadPromises.push(this._LoadWebFonts())}async _LoadWebFonts(){const e=[],t=[];for(const[s,i,r]of this._webFonts)this._totalAssetSizeToLoad+=r,e.push(this._LoadWebFont(s,i,t).then(()=>this._AddLoadedSize(r)));await Promise.all(e),this._runtime.IsInWorker()&&0<t.length&&await this._runtime.PostComponentMessageToDOMAsync(\"runtime\",\"load-webfonts\",{webfonts:t})}async _LoadWebFont(t,s,i){try{let e=await this.GetProjectFileUrl(s);\"Gecko\"===m.Platform.BrowserEngine&&(t=`'${t}'`),(\"Gecko\"===m.Platform.BrowserEngine&&\"preview\"===this._runtime.GetExportType()||\"playable-ad-single-file\"===this._runtime.GetExportType())&&(e=this._GetLocalBlobURLFromFileMap(e));const r=new FontFace(t,`url('${e}')`);(this._runtime.IsInWorker()?self:document).fonts.add(r),await r.load(),this._runtime.IsInWorker()&&i.push({name:t,url:e})}catch(e){console.warn(`[C3 runtime] Failed to load web font '${t}': `,e)}}IsAudioFormatSupported(e){return!!this._supportedAudioFormats[e]}_SetAudioFiles(e,t){this._preloadSounds=!!t;for(const[s,i,r]of e)this._audioFiles.set(s,{fileName:s,formats:i.map(e=>({type:e[0],fileExtension:e[1],fullName:s+e[1],fileSize:e[2]})),isMusic:r})}GetPreferredAudioFile(e){\"flat\"===this._fileStructure&&(e=e.toLowerCase());const t=this._audioFiles.get(e);if(!t)return null;let s=null;for(const i of t.formats)if(s||\"audio/webm; codecs=opus\"!==i.type||(s=i),this.IsAudioFormatSupported(i.type))return i;return s}GetProjectAudioFileUrl(e){const t=this.GetPreferredAudioFile(e);return t?{url:this.GetMediaFileUrl(t.fullName),type:t.type}:null}GetAudioToPreload(){if(this._preloadSounds){const e=[];for(const t of this._audioFiles.values())if(!t.isMusic){const s=this.GetPreferredAudioFile(t.fileName);s&&e.push({originalUrl:t.fileName,url:this.GetMediaFileUrl(s.fullName),type:s.type,fileSize:s.fileSize})}return e}return[]}_GetLocalBlobFromFileMap(e){return\"preview\"===this._runtime.GetExportType()&&(e=new URL(e,location.href).toString()),this._fileMap.get(e)||null}_GetLocalBlobURLFromFileMap(e){let t=this._fileMapBlobUrls.get(e);if(!t){const s=this._GetLocalBlobFromFileMap(e);if(!s)return e;t=URL.createObjectURL(s),this._fileMapBlobUrls.set(e,t)}return t}GetIAssetManager(){return this._iAssetManager}async LoadScripts(...e){const t=await Promise.all(e.map(e=>this.GetProjectFileUrl(e)));if(this._runtime.IsInWorker())if(1===e.length){const s=e[0];await import((m.IsRelativeURL(s)?\"./\":\"\")+s)}else{const i=e.map(e=>`import \"${m.IsRelativeURL(e)?\"./\":\"\"}${e}\";`).join(\"\\n\"),r=URL.createObjectURL(new Blob([i],{type:\"application/javascript\"}));await import(r)}else await Promise.all(t.map(e=>n(e)))}async CompileWebAssembly(e){if(WebAssembly.compileStreaming){const t=await this.GetProjectFileUrl(e);return WebAssembly.compileStreaming(fetch(t))}{const s=await m.FetchArrayBuffer(e);return WebAssembly.compile(s)}}async LoadStyleSheet(e){const t=await this.GetProjectFileUrl(e);return this._runtime.PostComponentMessageToDOMAsync(\"runtime\",\"add-stylesheet\",{url:t})}}}{const yr=self.C3;yr.Asset=class extends yr.DefendedBase{constructor(e,t){super(),this._assetManager=e,this._runtime=e.GetRuntime(),this._url=t.url||\"\",this._size=t.size,this._loadPolicy=t.loadPolicy,this._blob=t.blob||null,this._isLoaded=!!this._blob,this._loadPromise=null}Release(){this._loadPromise=null,this._assetManager=null,this._runtime=null,this._blob=null}GetURL(){return this._url}GetSize(){return this._size}Load(){return\"local\"===this._loadPolicy||this._blob?(this._isLoaded=!0,Promise.resolve()):(this._loadPromise||(this._loadPromise=this._assetManager.FetchBlob(this._url,this._loadPolicy).then(e=>(this._isLoaded=!0,this._loadPromise=null,this._blob=e)).catch(e=>{console.error(\"Error loading resource: \",e),this._loadPromise=null})),this._loadPromise)}IsLoaded(){return this._isLoaded}GetBlob(){return this._blob?Promise.resolve(this._blob):this._loadPromise||this._assetManager.FetchBlob(this._url,this._loadPolicy)}}}{const Gr=self.C3,ln=new Gr.PromiseThrottle,cn=new Set;Gr.ImageAsset=class extends Gr.Asset{constructor(e,t){super(e,t),this._texturePromise=null,this._webglTexture=null,this._refCount=0,this._imageWidth=-1,this._imageHeight=-1,cn.add(this)}Release(){if(0!==this._refCount)throw new Error(\"released image asset which still has texture references\");this._assetManager._ReleaseAsset(this),this._texturePromise=null,cn.delete(this),super.Release()}static OnRendererContextLost(){for(const e of cn)e._texturePromise=null,e._webglTexture=null,e._refCount=0}LoadStaticTexture(e,t){return t=t||{},this._refCount++,this._webglTexture?Promise.resolve(this._webglTexture):(this._texturePromise||(t.anisotropy=this._runtime.GetCanvasManager().GetTextureAnisotropy(),this._texturePromise=this._DoLoadStaticTexture(e,t)),this._texturePromise)}async _DoLoadStaticTexture(t,s){try{const i=await this.GetBlob();return 0===this._refCount?this._texturePromise=null:await ln.Add(async()=>{const e=await t.CreateStaticTextureAsync(i,s);return this._texturePromise=null,0===this._refCount?(t.DeleteTexture(e),null):(this._webglTexture=e,this._imageWidth=e.GetWidth(),this._imageHeight=e.GetHeight(),this._webglTexture)})}catch(e){throw console.error(\"Failed to load texture: \",e),e}}ReleaseTexture(){if(this._refCount<=0)throw new Error(\"texture released too many times\");if(this._refCount--,0===this._refCount&&this._webglTexture){const e=this._webglTexture.GetRenderer();e.DeleteTexture(this._webglTexture),this._webglTexture=null}}GetRefCount(){return this._refCount}GetTexture(){return this._webglTexture}GetWidth(){return this._imageWidth}GetHeight(){return this._imageHeight}async LoadToDrawable(){const e=await this.GetBlob();return Gr.Supports.ImageBitmap?createImageBitmap(e):Gr.BlobToImage(e)}}}{let e=function(e,t){return e.GetWorldInfo()._GetLastCachedZIndex()-t.GetWorldInfo()._GetLastCachedZIndex()};e;const un=self.C3;un.RenderCell=class extends un.DefendedBase{constructor(e,t,s){super(),this._grid=e,this._x=t,this._y=s,this._instances=[],this._isSorted=!0,this._pendingRemoval=new Set,this._isAnyPendingRemoval=!1}Release(){un.clearArray(this._instances),this._pendingRemoval.clear(),this._grid=null}Reset(){un.clearArray(this._instances),this._isSorted=!0,this._pendingRemoval.clear(),this._isAnyPendingRemoval=!1}SetChanged(){this._isSorted=!1}IsEmpty(){if(this._instances.length){if(this._instances.length>this._pendingRemoval.size)return!1;this._FlushPending()}return!0}Insert(e){this._pendingRemoval.has(e)?(this._pendingRemoval.delete(e),0===this._pendingRemoval.size&&(this._isAnyPendingRemoval=!1)):(this._instances.push(e),this._isSorted=1===this._instances.length)}Remove(e){this._pendingRemoval.add(e),this._isAnyPendingRemoval=!0,50<=this._pendingRemoval.size&&this._FlushPending()}_FlushPending(){this._isAnyPendingRemoval&&(this._instances.length===this._pendingRemoval.size?this.Reset():(un.arrayRemoveAllInSet(this._instances,this._pendingRemoval),this._pendingRemoval.clear(),this._isAnyPendingRemoval=!1))}_EnsureSorted(){this._isSorted||(this._instances.sort(e),this._isSorted=!0)}Dump(e){this._FlushPending(),this._EnsureSorted(),this._instances.length&&e.push(this._instances)}}}{const _n=self.C3;_n.RenderGrid=class extends _n.DefendedBase{constructor(e,t){super(),this._cellWidth=e,this._cellHeight=t,this._cells=_n.New(_n.PairMap)}Release(){this._cells.Release(),this._cells=null}GetCell(e,t,s){let i=this._cells.Get(e,t);return i||(s?(i=_n.New(_n.RenderCell,this,e,t),this._cells.Set(e,t,i),i):null)}XToCell(e){return Math.floor(e/this._cellWidth)}YToCell(e){return Math.floor(e/this._cellHeight)}Update(i,r,n){if(r)for(let s=r.getLeft(),e=r.getRight();s<=e;++s)for(let e=r.getTop(),t=r.getBottom();e<=t;++e)if(!n||!n.containsPoint(s,e)){const a=this.GetCell(s,e,!1);a&&(a.Remove(i),a.IsEmpty())&&this._cells.Delete(s,e)}if(n)for(let s=n.getLeft(),e=n.getRight();s<=e;++s)for(let e=n.getTop(),t=n.getBottom();e<=t;++e)r&&r.containsPoint(s,e)||this.GetCell(s,e,!0).Insert(i)}QueryRange(e,t){let s=this.XToCell(e.getLeft()),i=this.YToCell(e.getTop()),r=this.XToCell(e.getRight()),n=this.YToCell(e.getBottom());for(;s<=r;++s)for(let e=i;e<=n;++e){const a=this.GetCell(s,e,!1);a&&a.Dump(t)}}MarkRangeChanged(e){let t=e.getLeft(),s=e.getTop(),i=e.getRight(),r=e.getBottom();for(;t<=i;++t)for(let e=s;e<=r;++e){const n=this.GetCell(t,e,!1);n&&n.SetChanged()}}}}{let a=function(e,t){return e.GetWorldInfo()._GetLastCachedZIndex()-t.GetWorldInfo()._GetLastCachedZIndex()},e=function(e,t){return e.GetWorldInfo().GetZElevation()-t.GetWorldInfo().GetZElevation()};a,e;const y=self.C3,dn=new y.Rect,pn=new y.Quad,fn=[],mn=(new y.Rect,new y.Rect,self.glMatrix),br=mn.vec3,Ur=mn.vec4,Cr=mn.mat4,gn=Cr.create(),Sn=br.create(),yn=Ur.create(),Gn=br.create(),In=br.create(),Tn=br.create(),Cn=y.New(y.Vector2),bn=(y.New(y.Rect),[]),wn=[],xn=[],vn={name:\"\",sid:-1,isDynamic:!1,isVisible:!0,isInteractive:!0,isHTMLElementsLayer:!1,backgroundColor:[1,1,1,1],isTransparent:!0,parallax:[1,1],opacity:1,isForceOwnTexture:!1,renderAs3d:!1,useCameraDistanceDrawOrder:!1,useRenderCells:!1,scaleRate:1,blendMode:0,zElevation:0,initialInstancesData:[],effectListData:[],subLayersData:[]};y.Layer=class extends y.DefendedBase{constructor(e,t,s){super(),s=Object.assign({},vn,s),this._layout=e,this._runtime=e.GetRuntime(),this._parentLayer=t,this._name=s.name,this._index=-1,this._isHTMLElementsLayer=!!s.isHTMLElementsLayer,this._htmlIndex=-1,this._sid=s.sid,this._isDynamic=!!s.isDynamic,this._isVisible=!!s.isVisible,this._isInteractive=!!s.isInteractive,this._backgroundColor=y.New(y.Color),this._backgroundColor.setFromJSON(s.backgroundColor),this._isTransparent=!!s.isTransparent,this._parallaxX=s.parallax[0],this._parallaxY=s.parallax[1],this._color=y.New(y.Color,1,1,1,s.opacity),this._premultipliedColor=y.New(y.Color),this._isForceOwnTexture=!!s.isForceOwnTexture,this._renderAs3d=!!s.renderAs3d,this._useCameraDistanceDrawOrder=!!s.useCameraDistanceDrawOrder,this._useRenderCells=!!s.useRenderCells,this._scaleRate=s.scaleRate,this._blendMode=s.blendMode,this._curRenderTarget=null,this._scale=1,this._zElevation=s.zElevation,this._angle=0,this._scrollX=0,this._scrollY=0,this._hasOwnScrollPosition=!1,this._viewport=y.New(y.Rect),this._viewportZ0=y.New(y.Rect),this._viewport3D=y.New(y.Rect),this._isViewportChanged=!0,this._projectionMatrix=Cr.create(),this._isProjectionMatrixChanged=!0,this._modelViewMatrix=Cr.create(),this._isMVMatrixChanged=!0,this._viewFrustum=y.New(y.Gfx.ViewFrustum),this._isViewFrustumChanged=!0,this._startupInitialInstances=[],this._initialInstancesData=s.initialInstancesData,this._initialInstances=[],this._createdGlobalUids=[],this._initialUIDsToInstanceData=new Map,this._instances=[],this._zIndicesUpToDate=!1,this._htmlZIndicesUpToDate=!1,this._anyInstanceZElevated=!1;const r=this._runtime.GetCanvasManager();this._effectList=y.New(y.EffectList,this,s.effectListData),this._effectChain=y.New(y.Gfx.EffectChain,r.GetEffectChainManager(),{drawContent:(e,t)=>{const s=t.GetContentObject(),i=s.GetRenderTarget();e.SetColor(s.GetPremultipliedColor()),e.DrawRenderTarget(i),e.InvalidateRenderTarget(i),r.ReleaseAdditionalRenderTarget(i)},getShaderParameters:e=>this.GetEffectList()._GetEffectChainShaderParametersForIndex(e)}),this._needsRebuildEffectChainSteps=!0,this._wasDefaultColor=!0,this._renderGrid=null,this._lastRenderList=[],this._isRenderListUpToDate=!1,this._lastRenderCells=y.New(y.Rect,0,0,-1,-1),this._curRenderCells=y.New(y.Rect,0,0,-1,-1),this._iLayer=new self.ILayer(this),this._UpdatePremultipliedColor(),this.UsesRenderCells()&&(this._renderGrid=y.New(y.RenderGrid,this._runtime.GetOriginalViewportWidth(),this._runtime.GetOriginalViewportHeight())),this._subLayers=s.subLayersData.map(e=>y.Layer.CreateFromExportData(this._layout,this,e))}_InitInitialInstances(){for(const e of this._initialInstancesData){const t=this._runtime.GetObjectClassByIndex(e[1]);this._layout._AddInitialObjectClass(t),t.GetDefaultInstanceData()||(t.SetDefaultInstanceData(e),t._SetDefaultLayerIndex(this._index)),this._initialInstances.push(e),this._initialUIDsToInstanceData.set(e[2],e)}y.shallowAssignArray(this._startupInitialInstances,this._initialInstances),this._initialInstancesData=null}static CreateFromExportData(e,t,s){return y.New(y.Layer,e,t,{name:s[0],sid:s[2],isVisible:s[3],isInteractive:s[13],isHTMLElementsLayer:s[19],backgroundColor:s[4].map(e=>e/255),isTransparent:s[5],parallax:[s[6],s[7]],opacity:s[8],isForceOwnTexture:s[9],renderAs3d:s[17],useCameraDistanceDrawOrder:s[18],useRenderCells:s[10],scaleRate:s[11],blendMode:s[12],zElevation:s[16],initialInstancesData:s[14],effectListData:s[15],subLayersData:s[20]})}Release(){for(const e of this._subLayers)e.Release();y.clearArray(this._subLayers);for(const t of this._instances)this._runtime.DestroyInstance(t);y.clearArray(this._instances),this._effectList.Release(),this._effectList=null,this._effectChain.Release(),this._effectChain=null,this._iLayer=null,this._parentLayer=null,this._layout=null,this._runtime=null}GetInitialInstanceData(e){return this._initialUIDsToInstanceData.get(e)}CreateInitialInstances(r){let n=this._layout.IsFirstVisit(),a=0,o=this._initialInstances;for(let i=0,e=o.length;i<e;++i){let e=o[i],t=this._runtime.GetObjectClassByIndex(e[1]),s=!0;if(!t.HasPersistBehavior()||n){const h=this._runtime.CreateInstanceFromData(e,this,!0);r.push(h),t.IsGlobal()&&(s=!1,this._createdGlobalUids.push(h.GetUID()))}s&&(o[a]=o[i],++a)}y.truncateArray(o,a),this._runtime.FlushPendingInstances(),this.SetZIndicesChanged()}_AddInstance(e,t){if(!e.GetPlugin().IsWorldType())throw new Error(\"instance is not of world type\");const s=e.GetWorldInfo();if(s.GetLayer()!==this)throw new Error(\"instance added to wrong layer\");this._instances.push(e),0!==s.GetZElevation()&&(this._anyInstanceZElevated=!0),t&&this.UsesRenderCells()&&e.GetWorldInfo().SetBboxChanged(),this.SetZIndicesChanged(e)}_MaybeAddInstance(e){this._instances.includes(e)||(this._instances.push(e),0!==e.GetWorldInfo().GetZElevation()&&(this._anyInstanceZElevated=!0),this.SetZIndicesChanged(e))}_PrependInstance(e,t){const s=e.GetWorldInfo();if(s.GetLayer()!==this)throw new Error(\"instance added to wrong layer\");this._instances.unshift(e),0!==s.GetZElevation()&&(this._anyInstanceZElevated=!0),this.SetZIndicesChanged(e),t&&this.UsesRenderCells()&&e.GetWorldInfo().SetBboxChanged()}_RemoveInstance(e,t){const s=this._instances.indexOf(e);s<0||(t&&this.UsesRenderCells()&&e.GetWorldInfo()._RemoveFromRenderCells(),this._instances.splice(s,1),this.SetZIndicesChanged(e),this._MaybeResetAnyInstanceZElevatedFlag())}_SetAnyInstanceZElevated(){this._anyInstanceZElevated=!0}_MaybeResetAnyInstanceZElevatedFlag(){0===this._instances.length&&(this._anyInstanceZElevated=!1)}_SortInstancesByLastCachedZIndex(e){if(e){const t=new Set;for(const s of this._instances){const i=s.GetWorldInfo()._GetLastCachedZIndex();0<=i&&t.add(i)}let e=-1;for(const r of this._instances){const n=r.GetWorldInfo();if(!(0<=n._GetLastCachedZIndex())){for(++e;t.has(e);)++e;n._SetZIndex(e)}}}this._instances.sort(a)}_Start(){}_End(){for(const e of this._instances)e.GetObjectClass().IsGlobal()||this._runtime.DestroyInstance(e);this._runtime.FlushPendingInstances(),y.clearArray(this._instances),this._anyInstanceZElevated=!1,this.SetZIndicesChanged()}RecreateInitialObjects(t,e,s,i,r,n){const a=this._runtime.GetEventSheetManager(),o=this._runtime.GetAllObjectClasses(),h=t.IsFamily(),l=[];for(const c of this._initialInstances){const u=c[0],_=u[0],d=u[1];if(e.containsPoint(_,d)){const p=o[c[1]];if(p!==t){if(!h)continue;if(!t.FamilyHasMember(p))continue}let e=r;if(!e){const g=this._runtime.GetCurrentLayout();e=this.GetLayout()===g?this:(e=g.GetLayerByName(this.GetName()))||g.GetLayerByIndex(this.GetIndex())}const f=this._runtime.CreateInstanceFromData(c,e,!1,void 0,void 0,!1,n),m=(e.SortAndAddInstancesByZIndex(f),f.GetWorldInfo());m.OffsetXY(s,i),m.SetBboxChanged(),a.BlockFlushingInstances(!0),f._TriggerOnCreatedOnSelfAndRelated(),a.BlockFlushingInstances(!1),l.push(f)}}return l}GetInstanceCount(){return this._instances.length}GetLayout(){return this._layout}GetName(){return this._name}_SetIndex(e){this._index=e}GetIndex(){return this._index}_SetHTMLIndex(e){this._htmlIndex=e}GetHTMLIndex(){return this._htmlIndex}IsHTMLElementsLayer(){return this._isHTMLElementsLayer}SetIsHTMLElementsLayer(e){this._isHTMLElementsLayer!==(e=!!e)&&(this._isHTMLElementsLayer=e,this._layout._ReindexAndUpdateAllLayers(),this._runtime.UpdateRender())}_GetSiblingIndex(){let e=this.GetParentLayer();return(e?e.GetSubLayers():this.GetLayout()._GetRootLayers()).indexOf(this)}GetSID(){return this._sid}GetRuntime(){return this._runtime}IsDynamic(){return this._isDynamic}HasAnyDynamicParentLayer(){for(const e of this.parentLayers())if(e.IsDynamic())return!0;return!1}GetDevicePixelRatio(){return this._runtime.GetDevicePixelRatio()}GetEffectList(){return this._effectList}GetEffectChain(){return this._MaybeRebuildEffectChainSteps(),this._effectChain}_MaybeRebuildEffectChainSteps(){const e=this.HasDefaultColor();if(this._needsRebuildEffectChainSteps||e!==this._wasDefaultColor||this._effectChain.NeedsRebuild()){const t=this.GetEffectList().GetActiveEffectTypes();this._effectChain.BuildSteps(t.map(e=>e.GetShaderProgram()),{indexMap:t.map(e=>e.GetIndex()),forcePreDraw:!e,useFullSurface:!0}),this._needsRebuildEffectChainSteps=!1,this._wasDefaultColor=e}}UpdateActiveEffects(){this.GetEffectList().UpdateActiveEffects(),this._needsRebuildEffectChainSteps=!0}UsesRenderCells(){return this._useRenderCells&&!this._useCameraDistanceDrawOrder}GetRenderGrid(){return this._renderGrid}SetRenderListStale(){this._isRenderListUpToDate=!1}IsVisible(){for(const e of this.selfAndParentLayers())if(!e._IsVisibleFlagSet())return!1;return!0}_IsVisibleFlagSet(){return this._isVisible}SetVisible(e){this._isVisible!==(e=!!e)&&(this._isVisible=e,this._runtime.UpdateRender())}SetInteractive(e){this._isInteractive=!!e}IsInteractive(){return this._isInteractive}IsSelfAndParentsInteractive(){for(const e of this.selfAndParentLayers())if(!e.IsInteractive())return!1;return!0}SetOwnScrollPositionEnabled(e){if(this._hasOwnScrollPosition!==(e=!!e)){if(this._hasOwnScrollPosition=e){const t=this.GetLayout();this._scrollX=t.GetScrollX(),this._scrollY=t.GetScrollY()}this._SetMVMatrixChanged(),this._runtime.UpdateRender()}}IsOwnScrollPositionEnabled(){return this._hasOwnScrollPosition}SetScrollX(e){const t=this.GetLayout(),s=t.GetScrollLeftBound(),i=t.GetScrollRightBound();this._scrollX!==(e=(e=i<e?i:e)<s?s:e)&&(this._scrollX=e,this.IsOwnScrollPositionEnabled())&&(this._SetMVMatrixChanged(),this._runtime.UpdateRender())}SetScrollY(e){const t=this.GetLayout(),s=t.GetScrollTopBound(),i=t.GetScrollBottomBound();this._scrollY!==(e=(e=i<e?i:e)<s?s:e)&&(this._scrollY=e,this.IsOwnScrollPositionEnabled())&&(this._SetMVMatrixChanged(),this._runtime.UpdateRender())}GetScrollX(){return this.IsOwnScrollPositionEnabled()?this._scrollX:this.GetLayout().GetScrollX()}GetScrollY(){return this.IsOwnScrollPositionEnabled()?this._scrollY:this.GetLayout().GetScrollY()}GetViewport(){return this._MaybeUpdateViewport(),this._viewport}_GetViewportZ0(){return this._MaybeUpdateViewport(),this._viewportZ0}GetViewport3D(){return this._MaybeUpdateViewport(),this._viewport3D}_GetVanishingPoint(){const e=this.GetLayout();return[e.GetVanishingPointX(),e.GetVanishingPointY()]}GetDefaultCameraZ(e){return this._runtime.GetDefaultCameraZ(e)}GetViewportForZ(u,i){const r=this._GetViewportZ0();if(0===u)i.copy(r);else{let o=r.midX(),h=r.midY(),e=this.Get2DScaleFactorToZ(u),t=r.width()/e,s=r.height()/e,[l,c]=this._GetVanishingPoint();if(.5!==l||.5!==c){let e=this.Get2DCameraZ(),t=this._runtime,s=this.GetDefaultCameraZ()/e,i=(l-.5)*t.GetViewportWidth()/s,r=(c-.5)*t.GetViewportHeight()/s,n=this.GetAngle(),a=(0!==n&&(Cn.set(i,r),Cn.rotate(n),i=Cn.getX(),r=Cn.getY()),y.unlerp(e,0,u));o+=y.lerp(i,0,a),h+=y.lerp(r,0,a)}i.set(o-t/2,h-s/2,o+t/2,h+s/2)}}GetOpacity(){return this._color.getA()}SetOpacity(e){e=y.clamp(e,0,1),this._color.getA()!==e&&(this._color.setA(e),this._UpdatePremultipliedColor(),this._runtime.UpdateRender())}_UpdatePremultipliedColor(){this._premultipliedColor.copy(this._color),this._premultipliedColor.premultiply()}GetPremultipliedColor(){return this._premultipliedColor}HasDefaultColor(){return this._color.equalsRgba(1,1,1,1)}GetScaleRate(){return this._scaleRate}SetScaleRate(e){this._scaleRate!==e&&(this._scaleRate=e,this._SetMVMatrixChanged(),this._runtime.UpdateRender())}GetParallaxX(){return this._parallaxX}GetParallaxY(){return this._parallaxY}SetParallax(e,t){this._parallaxX===e&&this._parallaxY===t||(this._parallaxX=e,this._parallaxY=t,this._SetMVMatrixChanged(),this._runtime.UpdateRender())}SetParallaxX(e){this.SetParallax(e,this.GetParallaxY())}SetParallaxY(e){this.SetParallax(this.GetParallaxX(),e)}SetZElevation(e){this._zElevation!==e&&(this._zElevation=e,this._runtime.UpdateRender())}GetZElevation(){return this._zElevation}SetAngle(e){e=y.clampAngle(e),this._angle!==e&&(this._angle=e,this._SetMVMatrixChanged(),this._runtime.UpdateRender())}GetAngle(){return y.clampAngle(this._layout.GetAngle()+this._angle)}GetOwnAngle(){return this._angle}HasInstances(){return 0<this._instances.length}_GetInstances(){return this._instances}_GetInstancesInDrawOrder(){return this.RendersIn3DMode()&&this._useCameraDistanceDrawOrder?(y.shallowAssignArray(xn,this._GetInstances()),xn.sort((e,t)=>this._SortInstancesByCameraDistance(e,t)),xn):this._GetInstances()}_AppendAllInstancesIncludingSubLayersInDrawOrder(e){y.appendArray(e,this._GetInstancesInDrawOrder());for(const t of this._subLayers)t.IsVisible()&&0<t.GetOpacity()&&t._AppendAllInstancesIncludingSubLayersInDrawOrder(e)}_SortInstancesByCameraDistance(e,t){const s=this.GetLayout().Get3DCameraPosition(),i=s[0],r=s[1],n=s[2],a=e.GetWorldInfo(),o=t.GetWorldInfo(),h=a.GetX()-i,l=a.GetY()-r,c=a.GetZElevation()-n,u=o.GetX()-i,_=o.GetY()-r,d=o.GetZElevation()-n;return u*u+_*_+d*d-(h*h+l*l+c*c)}GetBackgroundColor(){return this._backgroundColor}IsTransparent(){return this._isTransparent}SetTransparent(e){this._isTransparent!==(e=!!e)&&(this._isTransparent=e,this._runtime.UpdateRender())}IsForceOwnTexture(){return this._isForceOwnTexture}SetForceOwnTexture(e){this._isForceOwnTexture!==(e=!!e)&&(this._isForceOwnTexture=e,this._runtime.UpdateRender())}RendersIn2DMode(){return!this.GetRuntime().Uses3DFeatures()||!this._renderAs3d}RendersIn3DMode(){return!this.RendersIn2DMode()}Has3DCamera(){return this.RendersIn3DMode()&&this.GetLayout().Is3DCameraEnabled()}SelfAndAllSubLayersHave3DCamera(){if(!this.Has3DCamera())return!1;for(const e of this._subLayers)if(!e.SelfAndAllSubLayersHave3DCamera())return!1;return!0}SetBlendMode(e){this._blendMode!==e&&(this._blendMode=e,this._runtime.UpdateRender())}GetBlendMode(){return this._blendMode}IsRootLayer(){return!this._parentLayer}GetParentLayer(){return this._parentLayer}_SetParentLayer(e){this._parentLayer=e}GetSubLayers(){return this._subLayers}HasAnySubLayers(){return 0<this._subLayers.length}_AddSubLayer(e,t=!0){t?this._subLayers.push(e):this._subLayers.unshift(e)}_InsertSubLayer(e,t,s){let i=this._subLayers.indexOf(t);if(-1===i)throw new Error(\"cannot find layer to insert by\");s&&++i,this._subLayers.splice(i,0,e)}_RemoveSubLayer(e){const t=this._subLayers.indexOf(e);if(-1===t)throw new Error(\"cannot find layer to remove\");this._subLayers.splice(t,1)}HasAnyVisibleSubLayer(){for(const e of this._subLayers)if(e.ShouldDraw())return!0;return!1}*selfAndAllSubLayers(){for(const e of this._subLayers)yield*e.selfAndAllSubLayers();yield this}*parentLayers(){let e=this.GetParentLayer();for(;e;)yield e,e=e.GetParentLayer()}*selfAndParentLayers(){yield this,yield*this.parentLayers()}HasParentLayer(e){for(const t of this.parentLayers())if(t===e)return!0;return!1}IsTransformCompatibleWith(e){return this===e||this._parallaxX===e._parallaxX&&this._parallaxY===e._parallaxY&&this._scale===e._scale&&this._scaleRate===e._scaleRate&&this._angle===e._angle&&this.GetScrollX()===e.GetScrollX()&&this.GetScrollY()===e.GetScrollY()}SaveTransform(){return{parallaxX:this.GetParallaxX(),parallaxY:this.GetParallaxY(),scale:this.GetOwnScale(),scaleRate:this.GetScaleRate(),angle:this.GetOwnAngle(),hasOwnScroll:this.IsOwnScrollPositionEnabled(),scrollX:this.GetScrollX(),scrollY:this.GetScrollY()}}RestoreTransform(e){this.SetParallax(e.parallaxX,e.parallaxY),this.SetOwnScale(e.scale),this.SetScaleRate(e.scaleRate),this.SetAngle(e.angle),this.SetOwnScrollPositionEnabled(e.hasOwnScroll),this.SetScrollX(e.scrollX),this.SetScrollY(e.scrollY),this._MaybeUpdateViewport()}_RemoveAllInstancesInSet(e){if(0!==e.size){const t=y.arrayRemoveAllInSet(this._instances,e);0<t&&(this._MaybeResetAnyInstanceZElevatedFlag(),this.SetZIndicesChanged())}}SetZIndicesChanged(e){this._zIndicesUpToDate=!1,this._isRenderListUpToDate=!1,e&&!e.GetObjectClass().GetPlugin().IsHTMLElementType()||(this._htmlZIndicesUpToDate=!1)}_UpdateZIndices(){if(!this._zIndicesUpToDate){if(this._instances.sort(e),this.UsesRenderCells())for(let e=0,t=this._instances.length;e<t;++e){const s=this._instances[e].GetWorldInfo();s._SetZIndex(e),this._renderGrid.MarkRangeChanged(s.GetRenderCellRange())}else for(let e=0,t=this._instances.length;e<t;++e)this._instances[e].GetWorldInfo()._SetZIndex(e);this._zIndicesUpToDate=!0}}_UpdateHTMLZIndices(){if(!this._htmlZIndicesUpToDate){let e=this._layout.GetRootLayersForHTMLLayer(this.GetHTMLIndex()),t=e.map(e=>[...e.selfAndAllSubLayers()]).flat(),s=0;for(const i of t){for(const r of i._GetInstances())r.GetObjectClass().GetPlugin().IsHTMLElementType()&&r.GetWorldInfo()._SetHTMLZIndex(s++);i._SetHTMLZIndicesUpToDate()}}}_SetHTMLZIndicesUpToDate(){this._htmlZIndicesUpToDate=!0}_GetHTMLLayerDOMState(){return{isVisible:this.IsVisible(),opacity:this.GetOpacity(),isInteractive:this.IsInteractive()}}MoveInstanceAdjacent(e,t,s){const i=e.GetWorldInfo(),r=t.GetWorldInfo();if(i.GetLayer()!==this||r.GetLayer()!==this)throw new Error(\"can't arrange Z order unless both objects on this layer\");let n=i.GetZIndex(),a=r.GetZIndex();return n!==a+(s?1:-1)&&(y.arrayRemove(this._instances,n),n<a&&a--,s&&a++,a===this._instances.length?this._instances.push(e):this._instances.splice(a,0,e),this.SetZIndicesChanged(e),!0)}_MergeSortedZArrays(e,t){let s=[],i=0,r=0,n=e.length,a=t.length;for(;i<n&&r<a;){const o=e[i],h=t[r];o.GetWorldInfo()._GetLastCachedZIndex()<h.GetWorldInfo()._GetLastCachedZIndex()?(s.push(o),++i):(s.push(h),++r)}for(;i<n;++i)s.push(e[i]);for(;r<a;++r)s.push(t[r]);return s}_MergeAllSortedZArrays_pass(t){const s=[],i=t.length;for(let e=0;e<i-1;e+=2){const r=t[e],n=t[e+1];s.push(this._MergeSortedZArrays(r,n))}return i%2==1&&s.push(t[i-1]),s}_MergeAllSortedZArrays(e){for(;1<e.length;)e=this._MergeAllSortedZArrays_pass(e);return e[0]}_GetRenderCellInstancesToDraw(){return this._UpdateZIndices(),y.clearArray(fn),this._renderGrid.QueryRange(this.GetViewport(),fn),fn.length?1===fn.length?fn[0]:this._MergeAllSortedZArrays(fn):[]}ShouldDraw(){return this.IsVisible()&&0<this.GetOpacity()&&this._DrawsAnyContentInSelfOrSubLayers()}_DrawsAnyContentInSelfOrSubLayers(){if(this.HasInstances()||!this.IsTransparent())return!0;for(const e of this._subLayers)if(e._DrawsAnyContentInSelfOrSubLayers())return!0;return!1}UsesOwnTexture(){return this.IsForceOwnTexture()||!this.HasDefaultColor()||0!==this.GetBlendMode()||this._effectList.HasAnyActiveEffect()}SelfOrAnySubLayerUsesOwnTexture(){if(this.UsesOwnTexture())return!0;for(const e of this._subLayers)if(e.SelfOrAnySubLayerUsesOwnTexture())return!0;return!1}GetRenderTarget(){return this._curRenderTarget}Get2DScaleFactorToZ(e){if(this._layout.IsOrthographicProjection())return 1;{const t=this.Get3DCameraZ();return t/(t-e)}}GetResolutionScaleFactorToZ(e){const t=this._runtime.GetRenderScale();if(this._layout.IsOrthographicProjection())return t;{const s=this.Get3DCameraZ(),i=this.GetDefaultCameraZ();return i/Math.abs(s-e)*t}}_SetMVMatrixChanged(){this._isMVMatrixChanged=!0,this._isViewFrustumChanged=!0,this._isViewportChanged=!0}_GetModelViewMatrix(e){return this._isMVMatrixChanged&&(this._CalculateModelViewMatrix(e,this._modelViewMatrix,0,0,null),this._isMVMatrixChanged=!1),this._modelViewMatrix}Get2DCameraZ(e){return this.GetDefaultCameraZ(e)/this.GetNormalScale()}Get3DCameraZ(){return this.Has3DCamera()?this.GetLayout().Get3DCameraPosition()[2]:this.Get2DCameraZ()}GetCameraPosition(){if(this.Has3DCamera()){const e=this.GetLayout().Get3DCameraPosition();return[e[0],e[1],e[2]]}return this._Get2DCameraPosition()}_Get2DCameraPosition(e=0,t=0,r=0){let n=this._runtime,s=this.GetLayout(),i=n.GetParallaxXOrigin(),a=n.GetParallaxYOrigin(),o=(this.GetScrollX()-i)*this._parallaxX+i,h=(this.GetScrollY()-a)*this._parallaxY+a,l=(n.IsPixelRoundingEnabled()&&(o=Math.round(o),h=Math.round(h)),o+e),c=h+t,u=s.IsOrthographicProjection()?this.GetDefaultCameraZ(r):this.Get2DCameraZ(r),[_,d]=this._GetVanishingPoint();if(.5!==_||.5!==d){let e=this.GetDefaultCameraZ(r)/u,t=(_-.5)*n.GetViewportWidth()/e,s=(d-.5)*n.GetViewportHeight()/e,i=this.GetAngle();0!==i&&(Cn.set(t,s),Cn.rotate(i),t=Cn.getX(),s=Cn.getY()),l+=t,c+=s}return[l,c,u]}_CalculateModelViewMatrix(e,t,s,i,r){const n=this._runtime,a=this.GetLayout();if(this.Has3DCamera()){br.copy(Gn,a.Get3DCameraPosition()),br.copy(In,a.Get3DCameraLookAt()),br.copy(Tn,a.Get3DCameraUpVector());const o=n.GetParallaxXOrigin(),h=n.GetParallaxYOrigin(),l=In[0]-Gn[0],c=In[1]-Gn[1],u=In[2]-Gn[2];Gn[0]=(Gn[0]-o)*this._parallaxX+o,Gn[1]=(Gn[1]-h)*this._parallaxY+h,Gn[2]*=Math.max(this._parallaxX,this._parallaxY),In[0]=Gn[0]+l,In[1]=Gn[1]+c,In[2]=Gn[2]+u}else{const[_,d,p]=this._Get2DCameraPosition(s,i,r),f=(br.set(Gn,_,d,p),br.set(In,_,d,p-100),this.GetAngle());0===f?br.set(Tn,0,1,0):br.set(Tn,Math.sin(f),Math.cos(f),0)}e.CalculateLookAtModelView(t,Gn,In,Tn,r||n.GetViewportHeight())}_SetProjectionMatrixChanged(){this._isProjectionMatrixChanged=!0,this._isViewFrustumChanged=!0,this._isViewportChanged=!0}_GetProjectionMatrix(e){return this._isProjectionMatrixChanged&&(this._CalculateProjectionMatrix(e),this._isProjectionMatrixChanged=!1),this._projectionMatrix}_CalculateProjectionMatrix(e){const t=this._runtime.GetCanvasManager(),[s,i]=this._GetVanishingPoint();if(this._layout.IsOrthographicProjection())e.CalculateOrthographicMatrix(this._projectionMatrix,t.GetDrawWidth(),t.GetDrawHeight());else if(.5===s&&.5===i)Cr.copy(this._projectionMatrix,t.GetDefaultProjectionMatrix());else{const r=t.GetDrawWidth(),n=t.GetDrawHeight();e.CalculatePerspectiveMatrix(this._projectionMatrix,r/n,s,i)}}_SetTransform(e,t=!0,s=0,i=0,r=0){t&&e.SetProjectionMatrix(this._GetProjectionMatrix(e));let n;n=0===s&&0===i&&0===r?this._GetModelViewMatrix(e):(this._CalculateModelViewMatrix(e,gn,s,i,r),gn),e.SetModelViewMatrix(n)}PrepareForDraw(e){this._SetTransform(e),e.SetBaseZ(this.GetZElevation())}_MaybeStartWebGLProfiling(e){let t=null;if(e.IsWebGL()&&this._runtime.IsGPUProfiling()){const s=this._runtime.GetCanvasManager().GetLayerTimingsBuffer(this);s&&(t=s.AddTimeElapsedQuery(),e.StartQuery(t))}return t}_MaybeStartWebGPUProfiling(e){if(e.IsWebGPU()&&this._runtime.IsGPUProfiling()){const t=2*(this.GetIndex()+1);e.StartMeasuringRenderPassTime(t,1+t)}}Draw(e,t,s){let i=this._runtime.GetCanvasManager(),r=this.UsesOwnTexture(),n=null,a=this._MaybeStartWebGLProfiling(e);if(this._MaybeStartWebGPUProfiling(e),r){const o={sampling:this._runtime.GetSampling(),isSampled:!0,canReadPixels:!!e.IsWebGPU()&&this._runtime.UsesAnyBackgroundBlending()};\"low\"===i.GetCurrentFullscreenScalingQuality()&&(o.width=i.GetDrawWidth(),o.height=i.GetDrawHeight()),n=this._runtime.GetAdditionalRenderTarget(o),this._curRenderTarget=n,e.SetRenderTarget(n),this.IsTransparent()&&e.ClearRgba(0,0,0,0)}else this._curRenderTarget=t,e.SetRenderTarget(t);if(this.IsTransparent()||e.Clear(this._backgroundColor),this._layout._DrawLayerList(e,this._curRenderTarget,this._subLayers,r&&this.IsTransparent()),this._MaybeStartWebGPUProfiling(e),this._SetTransform(e),e.SetBaseZ(this.GetZElevation()),e.SetDepthEnabled(this.RendersIn3DMode()),this.GetNormalScale()>Number.EPSILON){this._UpdateZIndices();const h=this.UsesRenderCells()&&0===this.GetZElevation()&&!this._anyInstanceZElevated;this.Has3DCamera()?this._DrawInstances_3DCamera(e):h?this._DrawInstances_RenderCells(e):this._DrawInstances(e,this._GetInstancesInDrawOrder())}e.SetBaseZ(0),e.SetCurrentZ(0),r&&(e.SetDepthEnabled(!1),this._DrawLayerOwnTextureToRenderTarget(e,n,t,s)),a&&e.EndQuery(a),this._curRenderTarget=null}_DrawInstances(s,i){let r=this.GetViewport(),n=this._curRenderTarget,a=this.GetLayout().IsOrthographicProjection(),o=this.GetLayout().HasVanishingPointOutsideViewport(),h=null;for(let e=0,t=i.length;e<t;++e){const l=i[e];if(l!==h){const c=(h=l).GetWorldInfo();c.IsVisible()&&c.IsInViewport(r,o,a)&&this._DrawInstanceMaybeWithEffects(l,c,s,n)}}}_DrawInstances_3DCamera(i){const r=this._curRenderTarget,n=this._GetViewFrustum(),a=bn,o=wn,h=this._GetInstancesInDrawOrder();for(let t=0,s=h.length;t<s;){const l=h[t],c=l.GetWorldInfo();if(c.IsVisible()&&c.IsInViewport3D(n)){(!l.RendersToOwnZPlane()||0<c.GetDepth())&&o.push(l);const u=l.GetWorldInfo().GetTotalZElevation();a.push(l);let e=t+1;for(;e<s;++e){const _=h[e],d=_.GetWorldInfo();if(d.IsVisible()&&d.IsInViewport3D(n)){if(d.GetTotalZElevation()!==u)break;(_.RendersToOwnZPlane()?(0<d.GetDepth()&&o.push(_),a):o).push(_)}}if(1!==a.length||a[0].MustMitigateZFighting()){this._DrawCoplanarInstances_3DCamera(i,a);for(let e=0,t=o.length;e<t;++e){const p=o[e],f=p.GetWorldInfo();f._SetDrawNonBackFacesOnly(!0),this._DrawInstanceMaybeWithEffects(p,f,i,r),f._SetDrawNonBackFacesOnly(!1)}}else{this._DrawInstanceMaybeWithEffects(l,c,i,r);for(let e=0,t=o.length;e<t;++e){const m=o[e];if(m!==l){const g=m.GetWorldInfo(),S=g.GetLayer();S._DrawInstanceMaybeWithEffects(m,g,i,r)}}}t=e,y.clearArray(a),y.clearArray(o)}else++t}}_DrawCoplanarInstances_3DCamera(s,i){const r=this._curRenderTarget;s.CoplanarStartStencilPass();for(let e=0,t=i.length;e<t;++e){const n=i[e],a=n.GetWorldInfo();a._SetDrawBackFaceOnly(!0),this._DrawInstance(n,a,s)}s.CoplanarStartColorPass();for(let e=0,t=i.length;e<t;++e){const o=i[e],h=o.GetWorldInfo();this._DrawInstanceMaybeWithEffects(o,h,s,r),h._SetDrawBackFaceOnly(!1)}s.CoplanarRestoreStandardRendering()}_DrawInstances_RenderCells(e){let t=this._renderGrid,s=this._curRenderCells,i=this._lastRenderCells,r=this.GetViewport(),n;s.set(t.XToCell(r.getLeft()),t.YToCell(r.getTop()),t.XToCell(r.getRight()),t.YToCell(r.getBottom())),this._isRenderListUpToDate&&s.equals(i)?n=this._lastRenderList:(n=this._GetRenderCellInstancesToDraw(),this._isRenderListUpToDate=!0,i.copy(s)),this._DrawInstances(e,n),n!==this._lastRenderList&&y.shallowAssignArray(this._lastRenderList,n)}_DrawInstanceMaybeWithEffects(e,t,s,i){t.HasAnyActiveEffect()?this._DrawInstanceWithEffectsAndRestore(e,t,s,i):this._DrawInstance(e,t,s)}_DrawInstance(e,t,s){const i=t.GetRendererStateGroup();s.GetCurrentStateGroup()!==i&&i.Apply(),e.Draw(s)}_DrawInstanceWithEffectsAndRestore(e,t,s,i){this._DrawInstanceWithEffects(e,t,s,i,null)&&this._SetTransform(s)}_DrawInstanceWithEffects(e,t,s,i,r){const n=t.GetInstanceEffectList().GetEffectChain();return n.Render(s,i,{contentObject:e,blendMode:t.GetBlendMode(),devicePixelRatio:this._runtime.GetEffectDevicePixelRatioParam(),time:e.GetInstanceGameTime(),layerScale:this._runtime.GetEffectLayerScaleParam()*this.GetNormalScale(),layerAngle:this.GetAngle(),layoutRect:t.GetBoundingBox(),drawSurfaceRect:n.CanSkipCalculatingDrawSurfaceRect()?null:this._InstanceBoxToDrawSurface(t),drawContentHook:r&&r.drawContentHook,compositOffX:r&&r.compositOffX,compositOffY:r&&r.compositOffY,updateOwnProjection:r&&r.updateOwnProjection}),s.SetBaseZ(this.GetZElevation()),n.DidChangeTransform()}_DrawLayerOwnTextureToRenderTarget(e,t,s,i){const r=this._effectList.GetActiveEffectTypes(),n=this._runtime;0===r.length?(e.SetRenderTarget(s),e.SetTextureFillMode(),i&&0===this._blendMode&&this.HasDefaultColor()?e.CopyRenderTarget(t):(e.SetBlendMode(this._blendMode),e.SetColor(this._premultipliedColor),e.DrawRenderTarget(t)),e.InvalidateRenderTarget(t),n.ReleaseAdditionalRenderTarget(t)):this.GetEffectChain().Render(e,s,{contentObject:this,blendMode:this.GetBlendMode(),devicePixelRatio:n.GetEffectDevicePixelRatioParam(),layerScale:n.GetEffectLayerScaleParam()*this.GetNormalScale(),layerAngle:this.GetAngle(),layoutRect:this.GetViewport(),drawSurfaceRect:null,invalidateRenderTargets:!0})}GetOwnScale(){return this._scale}SetOwnScale(e){this._scale!==e&&(this._scale=e,this._layout.BoundScrolling(),this._SetMVMatrixChanged(),this._runtime.UpdateRender())}GetRenderScale(){return this.GetNormalScale()*this._runtime.GetRenderScale()}GetDisplayScale(){return this.GetNormalScale()*this._runtime.GetDisplayScale()}GetNormalScale(){return(this._scale*this._layout.GetScale()-1)*this._scaleRate+1}_MaybeUpdateViewport(){if(this._isViewportChanged){this._isViewportChanged=!1;let e=this._runtime.GetParallaxXOrigin(),t=this._runtime.GetParallaxYOrigin(),s=(this.GetScrollX()-e)*this._parallaxX+e,i=(this.GetScrollY()-t)*this._parallaxY+t,r=this.GetNormalScale(),n=this._runtime.GetViewportWidth()/r,a=this._runtime.GetViewportHeight()/r,o=s-n/2,h=i-a/2;this._runtime.IsPixelRoundingEnabled()&&(o=Math.round(o),h=Math.round(h));const l=this._viewportZ0,c=(l.set(o,h,o+n,h+a),this.GetAngle()),u=(0!==c&&(dn.copy(l),dn.offset(-l.midX(),-l.midY()),pn.setFromRotatedRect(dn,c),pn.getBoundingBox(dn),dn.offset(l.midX(),l.midY()),l.copy(dn)),this._zElevation);this.GetViewportForZ(u,this._viewport),this.Has3DCamera()?this.CalculateViewport3D(u,this._viewport3D):this._viewport3D.copy(this._viewport)}}CalculateViewport3D(e,t){let s=this._runtime.GetCanvasManager(),i=s.GetCssWidth(),r=s.GetCssHeight(),[n,a]=this.CanvasCssToLayer(0,0,e),[o,h]=this.CanvasCssToLayer(i,0,e),[l,c]=this.CanvasCssToLayer(i,r,e),[u,_]=this.CanvasCssToLayer(0,r,e),d=Math.min(n,o,l,u),p=Math.min(a,h,c,_),f=Math.max(n,o,l,u),m=Math.max(a,h,c,_);isFinite(d)||(d=-1/0),isFinite(p)||(p=-1/0),isFinite(f)||(f=1/0),isFinite(m)||(m=1/0),t.set(d,p,f,m)}CanvasCssToLayer(e,t,s=0){return this._CanvasToLayer(e,t,s,this.GetDisplayScale())}DrawSurfaceToLayer(e,t,s=0){return this._CanvasToLayer(e,t,s,this.GetRenderScale()*this.GetDevicePixelRatio())}_CanvasToLayer(e,t,s,i){const r=this._runtime,n=r.GetRenderer(),a=this.GetNormalScale(),o=r.GetViewportWidth()/a,h=r.GetViewportHeight()/a,l=yn,c=(Ur.set(l,0,0,o,h),e/=i,t=l[3]-t/i,this._GetProjectionMatrix(n)),u=this._GetModelViewMatrix(n),_=Sn,d=y.Gfx.UnprojectScreenToWorldZ(e,t,s,u,c,l,_);return d?[_[0],_[1]]:[NaN,NaN]}CanvasCssToLayer_DefaultTransform(e,t){const s=this._scale,i=this._scaleRate,r=this._parallaxX,n=this._parallaxY,a=this._angle,o=(this._scale=1,this._scaleRate=1,this._parallaxX=1,this._parallaxY=1,this._angle=0,this._SetMVMatrixChanged(),this.CanvasCssToLayer(e,t));return this._scale=s,this._scaleRate=i,this._parallaxX=r,this._parallaxY=n,this._angle=a,this._SetMVMatrixChanged(),o}LayerToCanvasCss(e,t,s=0){return this._LayerToCanvas(e,t,s,this.GetDisplayScale())}LayerToDrawSurface(e,t,s=0){return this._LayerToCanvas(e,t,s,this.GetRenderScale()*this.GetDevicePixelRatio())}_LayerToCanvas(e,t,s,i){const r=this._runtime,n=r.GetRenderer(),a=this.GetNormalScale(),o=r.GetViewportWidth()/a,h=r.GetViewportHeight()/a,l=yn,c=(Ur.set(l,0,0,o,h),this._GetProjectionMatrix(n)),u=this._GetModelViewMatrix(n),_=Sn,d=y.Gfx.Project(e,t,s,u,c,l,_);return d?[_[0]*i,(l[3]-_[1])*i]:[NaN,NaN]}_GetLayerToDrawSurfaceScale(e,t){return e*=this.GetRenderScale()*this.GetDevicePixelRatio(),0!==t&&(e*=this.Get2DScaleFactorToZ(t)),e}_InstanceBoxToDrawSurface(e){const t=e.GetBoundingBox(),s=e.GetTotalZElevation(),i=e.GetDepth(),l=s+i,c=t.getLeft(),u=t.getTop(),_=t.getRight(),d=t.getBottom();if(this.Has3DCamera()){if(this._IsPointBehindNearPlane(c,u,s)||this._IsPointBehindNearPlane(_,u,s)||this._IsPointBehindNearPlane(_,d,s)||this._IsPointBehindNearPlane(c,d,s))return null;if(0<i&&(this._IsPointBehindNearPlane(c,u,l)||this._IsPointBehindNearPlane(_,u,l)||this._IsPointBehindNearPlane(_,d,l)||this._IsPointBehindNearPlane(c,d,l)))return null}else if(l>=this.Get2DCameraZ())return null;let[p,f]=this.LayerToDrawSurface(c,u,s),[m,g]=this.LayerToDrawSurface(_,d,s);if(0!==this.GetAngle()||0<i||this.Has3DCamera()){const[S,y]=this.LayerToDrawSurface(_,u,s),[G,I]=this.LayerToDrawSurface(c,d,s);if(0<i){let[e,t]=this.LayerToDrawSurface(c,u,l),[s,i]=this.LayerToDrawSurface(_,u,l),[r,n]=this.LayerToDrawSurface(_,d,l),[a,o]=this.LayerToDrawSurface(c,d,l),h=Math.min(p,m,S,G,e,s,r,a);m=Math.max(p,m,S,G,e,s,r,a),p=h,h=Math.min(f,g,y,I,t,i,n,o),g=Math.max(f,g,y,I,t,i,n,o),f=h}else{let e=Math.min(p,m,S,G);m=Math.max(p,m,S,G),p=e,e=Math.min(f,g,y,I),g=Math.max(f,g,y,I),f=e}}return dn.set(p,f,m,g),dn}_GetViewFrustum(){return this._isViewFrustumChanged&&(this._UpdateViewFrustum(),this._isViewFrustumChanged=!1),this._viewFrustum}_UpdateViewFrustum(){const e=this._runtime.GetRenderer(),t=this._GetProjectionMatrix(e),s=this._GetModelViewMatrix(e);this._viewFrustum.CalculatePlanes(s,t)}_IsPointBehindNearPlane(e,t,s){return this._GetViewFrustum().IsBehindNearPlane(e,t,s)}_SaveToJson(){const e={d:this.IsDynamic(),s:this.GetOwnScale(),a:this.GetOwnAngle(),v:this._IsVisibleFlagSet(),i:this.IsInteractive(),html:this.IsHTMLElementsLayer(),bc:this._backgroundColor.toJSON(),t:this.IsTransparent(),sx:this._scrollX,sy:this._scrollY,hosp:this._hasOwnScrollPosition,px:this.GetParallaxX(),py:this.GetParallaxY(),c:this._color.toJSON(),sr:this.GetScaleRate(),fx:this._effectList.SaveToJson(),cg:this._createdGlobalUids};return e}_LoadFromJson(e){this._isDynamic=!!e.d,this._scale=e.s,this._angle=e.a,this._isVisible=!!e.v,this._isInteractive=!e.hasOwnProperty(\"i\")||e.i,this._isHTMLElementsLayer=!!e.html,this._backgroundColor.setFromJSON(e.bc),this._isTransparent=!!e.t,e.hasOwnProperty(\"sx\")&&(this._scrollX=e.sx),e.hasOwnProperty(\"sy\")&&(this._scrollY=e.sy),e.hasOwnProperty(\"hosp\")&&(this._hasOwnScrollPosition=!!e.hosp),this._parallaxX=e.px,this._parallaxY=e.py,this._color.setFromJSON(e.c),this._UpdatePremultipliedColor(),this._scaleRate=e.sr,y.shallowAssignArray(this._createdGlobalUids,e.cg),y.shallowAssignArray(this._initialInstances,this._startupInitialInstances);let s=new Set(this._createdGlobalUids),i=0;for(let e=0,t=this._initialInstances.length;e<t;++e)s.has(this._initialInstances[e][2])||(this._initialInstances[i]=this._initialInstances[e],++i);y.truncateArray(this._initialInstances,i),this._effectList.LoadFromJson(e.fx),this._needsRebuildEffectChainSteps=!0}_LoadFromJsonAfterInstances(){this._SortInstancesByLastCachedZIndex(!1),this.SetZIndicesChanged(),this._SetMVMatrixChanged(),this._SetProjectionMatrixChanged()}GetILayer(){return this._iLayer}SortAndAddInstancesByZIndex(e,t=!1){if(this._instances.includes(e))t&&this._instances.sort((e,t)=>{const s=e.GetWorldInfo().GetSceneGraphZIndex(),i=t.GetWorldInfo().GetSceneGraphZIndex();return s-i});else if(e.HasChildren()){const s=[...e.allChildren()];s.push(e),s.sort((e,t)=>{const s=e.GetWorldInfo().GetSceneGraphZIndex(),i=t.GetWorldInfo().GetSceneGraphZIndex();return s-i});for(const i of s)if(i.IsInContainer())for(const r of i.siblings())if(!s.includes(r)){const n=[...r.allChildren()];n.push(r),n.sort((e,t)=>{const s=e.GetWorldInfo().GetSceneGraphZIndex(),i=t.GetWorldInfo().GetSceneGraphZIndex();return s-i}),n&&n.length&&s.splice(s.length,0,...n)}for(const a of s)a.GetPlugin().IsWorldType()&&this._AddInstance(a,!0)}else if(e.GetPlugin().IsWorldType()&&this._AddInstance(e,!0),e.IsInContainer())for(const o of e.siblings()){const h=[...o.allChildren()];if(h.push(o),h.sort((e,t)=>{const s=e.GetWorldInfo().GetSceneGraphZIndex(),i=t.GetWorldInfo().GetSceneGraphZIndex();return s-i}),h&&h.length)for(const l of h)l.GetPlugin().IsWorldType()&&this._AddInstance(l,!0)}}}}{let l=function(e,t,s,i){return e[0]===Math.fround(t)&&e[1]===Math.fround(s)&&e[2]===Math.fround(i)},I=function(e,t){v!==e&&(e.PrepareForDraw(t),v=e)},T=(l,I,self.C3),i=self.C3Debugger,r=(T.New(T.Rect),T.New(T.Rect),T.New(T.Rect)),C=T.New(T.Color),e=self.glMatrix,c=e.vec3,h=[],b=[],w=[],x=[],v=null;T.Layout=class extends T.DefendedBase{constructor(e,t,s){super(),this._layoutManager=e,this._runtime=e.GetRuntime(),this._name=s[0],this._originalWidth=s[1],this._originalHeight=s[2],this._width=s[1],this._height=s[2],this._isUnboundedScrolling=!!s[3],this._isOrthographicProjection=!!s[4],this._vanishingPointX=s[5],this._vanishingPointY=s[6],this._eventSheetName=s[7],this._eventSheet=null,this._sid=s[8],this._index=t,this._scrollX=0,this._scrollY=0,this._scale=1,this._angle=0,this._initialObjectClasses=new Set,this._textureLoadedTypes=new Set,this._textureLoadPendingPromises=new Set,this._createdInstances=[],this._createdPersistedInstances=[],this._createdPersistedInstancesToDataMap=new Map,this._createdPersistedIndexToInstanceMap=new Map,this._initialNonWorld=[],this._is3dCameraEnabled=!1,this._cam3dposition=c.create(),this._cam3dlook=c.create(),this._cam3dup=c.create(),this._rootLayers=[],this._allLayersFlat=[],this._layersByName=new Map,this._layersBySid=new Map,this._pendingSetHTMLLayerCount=-1;const r=this._runtime.GetCanvasManager();this._effectList=T.New(T.EffectList,this,s[11]),this._effectChain=T.New(T.Gfx.EffectChain,r.GetEffectChainManager(),{drawContent:(e,t)=>{const s=t.GetContentObject(),i=s.GetRenderTarget();e.ResetColor(),e.DrawRenderTarget(i),e.InvalidateRenderTarget(i),r.ReleaseAdditionalRenderTarget(i)},getShaderParameters:e=>this.GetEffectList()._GetEffectChainShaderParametersForIndex(e)}),this._needsRebuildEffectChainSteps=!0,this._wasFullScreenQualityLow=!1,this._curRenderTarget=null,this._persistData={},this._persistedIntances=new Map,this._isFirstVisit=!0,this._iLayout=new self.ILayout(this),this._userScriptDispatcher=T.New(T.Event.Dispatcher);for(const i of s[9])this._rootLayers.push(T.Layer.CreateFromExportData(this,null,i));this._ReindexLayers();for(const n of this.allLayers())n._InitInitialInstances();for(const a of s[10]){const o=this._runtime.GetObjectClassByIndex(a[1]);if(!o)throw new Error(\"missing nonworld object class\");o.GetDefaultInstanceData()||o.SetDefaultInstanceData(a),this._initialNonWorld.push(a),this._AddInitialObjectClass(o)}}Release(){for(const e of this._allLayersFlat)e.Release();T.clearArray(this._allLayersFlat),this._textureLoadPendingPromises.clear(),this._eventSheet=null,this._layoutManager=null,this._runtime=null}GetRuntime(){return this._runtime}GetName(){return this._name}GetSID(){return this._sid}GetIndex(){return this._index}GetEffectList(){return this._effectList}GetEffectChain(){return this._MaybeRebuildEffectChainSteps(),this._effectChain}_MaybeRebuildEffectChainSteps(){const e=\"low\"===this._runtime.GetCanvasManager().GetCurrentFullscreenScalingQuality();if(this._needsRebuildEffectChainSteps||this._wasFullScreenQualityLow!==e||this._effectChain.NeedsRebuild()){const t=this.GetEffectList().GetActiveEffectTypes();this._effectChain.BuildSteps(t.map(e=>e.GetShaderProgram()),{indexMap:t.map(e=>e.GetIndex()),forcePostDraw:e,useFullSurface:!0}),this._needsRebuildEffectChainSteps=!1,this._wasFullScreenQualityLow=e}}UpdateActiveEffects(){this.GetEffectList().UpdateActiveEffects(),this._needsRebuildEffectChainSteps=!0}GetMinLayerScale(){let s=this._allLayersFlat[0].GetNormalScale();for(let e=1,t=this._allLayersFlat.length;e<t;++e){const i=this._allLayersFlat[e];0===i.GetParallaxX()&&0===i.GetParallaxY()||(s=Math.min(s,i.GetNormalScale()))}return s}_GetScrollBoundMarginHorizontal(){return.5*this._runtime.GetViewportWidth()/this.GetMinLayerScale()}_GetScrollBoundMarginVertical(){return.5*this._runtime.GetViewportHeight()/this.GetMinLayerScale()}GetScrollLeftBound(){return this.IsUnboundedScrolling()?-1/0:this._GetScrollBoundMarginHorizontal()}GetScrollRightBound(){return this.IsUnboundedScrolling()?1/0:this.GetWidth()-this._GetScrollBoundMarginHorizontal()}GetScrollTopBound(){return this.IsUnboundedScrolling()?-1/0:this._GetScrollBoundMarginVertical()}GetScrollBottomBound(){return this.IsUnboundedScrolling()?1/0:this.GetHeight()-this._GetScrollBoundMarginVertical()}SetScrollX(e){const t=this.GetScrollLeftBound(),s=this.GetScrollRightBound();this._scrollX!==(e=(e=s<e?s:e)<t?t:e)&&(this._scrollX=e,this._SetAllLayersMVChanged(),this._runtime.UpdateRender())}GetScrollX(){return this._scrollX}SetScrollY(e){const t=this.GetScrollTopBound(),s=this.GetScrollBottomBound();this._scrollY!==(e=(e=s<e?s:e)<t?t:e)&&(this._scrollY=e,this._SetAllLayersMVChanged(),this._runtime.UpdateRender())}GetScrollY(){return this._scrollY}IsUnboundedScrolling(){return this._isUnboundedScrolling}BoundScrolling(){this.SetScrollX(this.GetScrollX()),this.SetScrollY(this.GetScrollY());for(const e of this._allLayersFlat)e.IsOwnScrollPositionEnabled()&&(e.SetScrollX(e.GetScrollX()),e.SetScrollY(e.GetScrollY()))}SetVanishingPointXY(e,t){this._vanishingPointX===e&&this._vanishingPointY===t||(this._vanishingPointX=e,this._vanishingPointY=t,this.IsPerspectiveProjection()&&(this._SetAllLayersProjectionChanged(),this._SetAllLayersMVChanged(),this._runtime.UpdateRender()))}GetVanishingPointX(){return this.IsOrthographicProjection()?.5:this._vanishingPointX}GetVanishingPointY(){return this.IsOrthographicProjection()?.5:this._vanishingPointY}HasVanishingPointOutsideViewport(){const e=this.GetVanishingPointX(),t=this.GetVanishingPointY();return e<0||1<e||t<0||1<t}SetPerspectiveProjection(){this._isOrthographicProjection&&(this._isOrthographicProjection=!1,this._SetAllLayersProjectionChanged(),this._SetAllLayersMVChanged(),this._runtime.UpdateRender())}SetOrthographicProjection(){this._isOrthographicProjection||(this._isOrthographicProjection=!0,this._SetAllLayersProjectionChanged(),this._SetAllLayersMVChanged(),this._runtime.UpdateRender())}IsOrthographicProjection(){return this._isOrthographicProjection}IsPerspectiveProjection(){return!this.IsOrthographicProjection()}Set3DCameraEnabled(e){this._is3dCameraEnabled!==(e=!!e)&&(this._is3dCameraEnabled=e,this._SetAllLayersMVChanged(),this._runtime.UpdateRender())}Is3DCameraEnabled(){return this._is3dCameraEnabled}Set3DCameraOrientation(e,t,s,i,r,n,a,o,h){l(this._cam3dposition,e,t,s)&&l(this._cam3dlook,i,r,n)&&l(this._cam3dup,a,o,h)||(c.set(this._cam3dposition,e,t,s),c.set(this._cam3dlook,i,r,n),c.set(this._cam3dup,a,o,h),this.Set3DCameraChanged())}Set3DCameraChanged(){this._SetAllLayersMVChanged(),this._runtime.UpdateRender()}Get3DCameraPosition(){return this._cam3dposition}Get3DCameraLookAt(){return this._cam3dlook}Get3DCameraUpVector(){return this._cam3dup}GetScale(){return this._scale}SetScale(e){this._scale!==e&&(this._scale=e,this._SetAllLayersMVChanged(),this.BoundScrolling(),this._runtime.UpdateRender())}SetAngle(e){e=T.clampAngle(e),this._angle!==e&&(this._angle=e,this._SetAllLayersMVChanged(),this._runtime.UpdateRender())}GetAngle(){return this._angle}GetWidth(){return this._width}SetWidth(e){!isFinite(e)||e<1||(this._width=e)}GetHeight(){return this._height}SetHeight(e){!isFinite(e)||e<1||(this._height=e)}GetEventSheet(){return this._eventSheet}_GetRootLayers(){return this._rootLayers}*allLayers(){for(const e of this._rootLayers)yield*e.selfAndAllSubLayers()}GetLayers(){return this._allLayersFlat}GetLayerCount(){return this._allLayersFlat.length}GetLayer(e){return\"number\"==typeof e?this.GetLayerByIndex(e):this.GetLayerByName(e.toString())}GetLayerByIndex(e){return e=T.clamp(Math.floor(e),0,this._allLayersFlat.length-1),this._allLayersFlat[e]}GetLayerByName(e){return this._layersByName.get(e.toLowerCase())||null}HasLayerByName(e){return!!this.GetLayerByName(e)}GetLayerBySID(e){return this._layersBySid.get(e)||null}_SetAllLayersProjectionChanged(){for(const e of this._allLayersFlat)e._SetProjectionMatrixChanged()}_SetAllLayersMVChanged(){for(const e of this._allLayersFlat)e._SetMVMatrixChanged()}AddLayer(e,t,s){if(this.HasLayerByName(e))throw new Error(`layer name '${e}' already in use`);if(!t&&s<2)throw new Error(\"invalid insert position\");const i=2<=s?t:t.GetParentLayer(),r=T.New(T.Layer,this,i,{name:e,sid:Math.floor(1e15*Math.random()),isDynamic:!0});this._InsertLayer(r,t,s),this.GetRuntime().UpdateRender(),this._ReindexAndUpdateAllLayers()}MoveLayer(e,t,s){if(!t&&s<2)throw new Error(\"invalid insert position\");e===t&&s<2||(this._RemoveLayer(e),this._InsertLayer(e,t,s),this.GetRuntime().UpdateRender(),this._ReindexAndUpdateAllLayers())}RemoveLayer(e){if(this._RemoveLayer(e)){const t=this._runtime.GetEventSheetManager();t.BlockFlushingInstances(!0),e.Release(),t.BlockFlushingInstances(!1),this.GetRuntime().UpdateRender(),this._ReindexAndUpdateAllLayers()}}RemoveAllDynamicLayers(){const e=new Set;for(const t of this.allLayers())t.IsDynamic()&&!t.HasAnyDynamicParentLayer()&&e.add(t);if(0!==e.size){const s=this._runtime.GetEventSheetManager();s.BlockFlushingInstances(!0);for(const i of e)this._RemoveLayer(i),i.Release();s.BlockFlushingInstances(!1),this.GetRuntime().UpdateRender(),this._ReindexAndUpdateAllLayers()}}_InsertLayer(t,s,i){if(2<=i)if(s){if(s===t||s.HasParentLayer(t))throw new Error(`cannot move layer '${t.GetName()}' to sub-layer of itself`);s._AddSubLayer(t,2===i),t._SetParentLayer(s)}else 2===i?this._rootLayers.push(t):this._rootLayers.unshift(t),t._SetParentLayer(null);else{const e=s.GetParentLayer();if(e){if(s.HasParentLayer(t))throw new Error(`cannot move layer '${t.GetName()}' to sub-layer of itself`);e._InsertSubLayer(t,s,0===i),t._SetParentLayer(e)}else{let e=this._rootLayers.indexOf(s);if(-1===e)throw new Error(\"cannot find layer to insert by\");0===i&&++e,this._rootLayers.splice(e,0,t),t._SetParentLayer(null)}}}_RemoveLayer(e){const t=e.GetParentLayer();if(t)return t._RemoveSubLayer(e),!0;if(1<this._rootLayers.length){const s=this._rootLayers.indexOf(e);if(-1===s)throw new Error(\"cannot find layer to remove\");return this._rootLayers.splice(s,1),!0}return!1}_ReindexLayers(){this._allLayersFlat=[...this.allLayers()],this._layersByName.clear(),this._layersBySid.clear();for(let e=0,t=this._allLayersFlat.length;e<t;++e){const s=this._allLayersFlat[e];s._SetIndex(e),this._layersByName.set(s.GetName().toLowerCase(),s),this._layersBySid.set(s.GetSID(),s)}}_ReindexHTMLLayers(){let e=0;for(const t of this._rootLayers){for(const s of t.selfAndAllSubLayers())s._SetHTMLIndex(e);t.IsHTMLElementsLayer()&&e++}}GetHTMLLayerCount(){return this._rootLayers.at(-1).GetHTMLIndex()+1}async _ReindexAndUpdateAllLayers(){this._ReindexLayers(),this._ReindexHTMLLayers(),this._pendingSetHTMLLayerCount=this.GetHTMLLayerCount()}_GetPendingSetHTMLLayerCount(){return this._pendingSetHTMLLayerCount}_ResetPendingHTMLLayerCount(){this._pendingSetHTMLLayerCount=-1}GetRootLayersForHTMLLayer(e){const t=[];for(const s of this._rootLayers){const i=s.GetHTMLIndex();if(i===e)t.push(s);else if(e<i)break}return t}SaveTransform(){return{scrollX:this.GetScrollX(),scrollY:this.GetScrollY(),scale:this.GetScale(),angle:this.GetAngle(),vpX:this.GetVanishingPointX(),vpY:this.GetVanishingPointY()}}RestoreTransform(e){this.SetScrollX(e.scrollX),this.SetScrollY(e.scrollY),this.SetScale(e.scale),this.SetAngle(e.angle),this.SetVanishingPointXY(e.vpX,e.vpY)}GetLayoutBackgroundColor(){let e=this._rootLayers.filter(e=>e.ShouldDraw())[0];for(;e;){if(!e.IsTransparent())return C.copyRgb(e.GetBackgroundColor()),C.setA(1),C;if(e.UsesOwnTexture())return C.setRgba(0,0,0,0),C;e=e.GetSubLayers().filter(e=>e.ShouldDraw())[0]}return C.setRgba(0,0,0,0),C}IsFirstVisit(){return this._isFirstVisit}_GetInitialObjectClasses(){return[...this._initialObjectClasses]}_AddInitialObjectClass(e){if(e.IsInContainer())for(const t of e.GetContainer().GetObjectTypes())this._initialObjectClasses.add(t);else this._initialObjectClasses.add(e)}_GetTextureLoadedObjectTypes(){return[...this._textureLoadedTypes]}_Load(e,t){if(e===this||!t)return Promise.resolve();e&&(T.CopySet(this._textureLoadedTypes,e._textureLoadedTypes),e._textureLoadedTypes.clear());const s=[];for(const i of this._initialObjectClasses)this._textureLoadedTypes.has(i)||(s.push(i.LoadTextures(t)),this._textureLoadedTypes.add(i));return Promise.all(s)}async MaybeLoadTexturesFor(e){if(e.IsFamily())throw new Error(\"cannot load textures for family\");const t=this._runtime.GetRenderer();if(t&&!t.IsContextLost()&&!this._textureLoadedTypes.has(e)){this._textureLoadedTypes.add(e);const s=e.LoadTextures(t);this._AddPendingTextureLoadPromise(s),await s,e.OnDynamicTextureLoadComplete(),this._runtime.UpdateRender()}}_AddPendingTextureLoadPromise(e){this._textureLoadPendingPromises.add(e),e.then(()=>this._textureLoadPendingPromises.delete(e)).catch(()=>this._textureLoadPendingPromises.delete(e))}WaitForPendingTextureLoadsToComplete(){return Promise.all([...this._textureLoadPendingPromises])}MaybeUnloadTexturesFor(e){if(e.IsFamily()||0<e.GetInstanceCount())throw new Error(\"cannot unload textures\");const t=this._runtime.GetRenderer();t&&this._textureLoadedTypes.has(e)&&(this._textureLoadedTypes.delete(e),e.ReleaseTextures(t))}_Unload(e,t){if(e!==this&&t)for(const s of this._textureLoadedTypes)s.IsGlobal()||e._initialObjectClasses.has(s)||(s.ReleaseTextures(),this._textureLoadedTypes.delete(s))}_OnRendererContextLost(){this._textureLoadedTypes.clear()}async _StartRunning(e){const t=this._runtime,s=this._layoutManager,i=t.GetEventSheetManager(),r=(this._eventSheetName&&(this._eventSheet=i.GetEventSheetByName(this._eventSheetName),this._eventSheet._UpdateDeepIncludes()),s._SetMainRunningLayout(this),this._width=this._originalWidth,this._height=this._originalHeight,this._scrollX=t.GetOriginalViewportWidth()/2,this._scrollY=t.GetOriginalViewportHeight()/2,this.BoundScrolling(),this._SetAllLayersProjectionChanged(),this._SetAllLayersMVChanged(),this._ReindexHTMLLayers(),await this._runtime.GetCanvasManager().SetHTMLLayerCount(this.GetHTMLLayerCount(),!0),this._MoveGlobalObjectsToThisLayout(e),this._runtime.SetUsingCreatePromises(!0),this._CreateInitialInstances(),this._isFirstVisit||this._CreatePersistedInstances(),this._CreateAndLinkContainerInstances(this._createdInstances),this._CreateAndLinkContainerInstances(this._createdPersistedInstances),this._CreateInitialNonWorldInstances(),s.ClearPendingChangeLayout(),t.FlushPendingInstances(),this._runtime.SetUsingCreatePromises(!1),this._runtime.GetCreatePromises());if(await Promise.all(r),T.clearArray(r),!t.IsLoadingState()){for(const n of this._createdInstances)n.SetupInitialSceneGraphConnections();for(const a of this._createdPersistedInstances)a.SetupPersistedSceneGraphConnections(this._createdPersistedInstancesToDataMap,this._createdPersistedIndexToInstanceMap);for(const[o,h]of Object.entries(this._persistData)){const l=this._runtime.GetObjectClassBySID(parseInt(o,10));l&&!l.IsFamily()&&l.HasPersistBehavior()&&T.clearArray(h)}for(const c of this._createdInstances)c._TriggerOnCreated();for(const u of this._createdPersistedInstances)u._TriggerOnCreated()}T.clearArray(this._createdInstances),T.clearArray(this._createdPersistedInstances),this._createdPersistedInstancesToDataMap.clear(),this._createdPersistedIndexToInstanceMap.clear(),await Promise.all([...this._initialObjectClasses].map(e=>e.PreloadTexturesWithInstances(this._runtime.GetRenderer()))),e&&(t.Dispatcher().dispatchEvent(new T.Event(\"beforefirstlayoutstart\")),await t.DispatchUserScriptEventAsyncWait(new T.Event(\"beforeprojectstart\"))),await this.DispatchRuntimeUserScriptEventAsyncWait(new T.Event(\"beforeanylayoutstart\")),t.Dispatcher().dispatchEvent(new T.Event(\"beforelayoutstart\")),await this.DispatchUserScriptEventAsyncWait(new T.Event(\"beforelayoutstart\")),t.IsLoadingState()||await t.TriggerAsync(T.Plugins.System.Cnds.OnLayoutStart,null,null),t.Dispatcher().dispatchEvent(new T.Event(\"afterlayoutstart\")),await this.DispatchUserScriptEventAsyncWait(new T.Event(\"afterlayoutstart\")),await this.DispatchRuntimeUserScriptEventAsyncWait(new T.Event(\"afteranylayoutstart\")),e&&(t.Dispatcher().dispatchEvent(new T.Event(\"afterfirstlayoutstart\")),await t.DispatchUserScriptEventAsyncWait(new T.Event(\"afterprojectstart\"))),i._RunQueuedTriggers(s),await this.WaitForPendingTextureLoadsToComplete(),this._isFirstVisit=!1}_MoveGlobalObjectsToThisLayout(e){for(const t of this._runtime.GetAllObjectClasses())if(!t.IsFamily()&&t.IsWorldType())for(const s of t.GetInstances()){const i=s.GetWorldInfo(),r=i.GetLayer(),n=T.clamp(r.GetIndex(),0,this._allLayersFlat.length-1),a=this._allLayersFlat[n];i._SetLayer(a,!0),a._MaybeAddInstance(s)}if(!e)for(const o of this._allLayersFlat)o._SortInstancesByLastCachedZIndex(!1)}_CreateInitialInstances(){for(const e of this._allLayersFlat)e.CreateInitialInstances(this._createdInstances),e._Start()}_CreatePersistedInstances(){let t=!1;for(const[e,s]of Object.entries(this._persistData)){const i=this._runtime.GetObjectClassBySID(parseInt(e,10));if(i&&!i.IsFamily()&&i.HasPersistBehavior())for(const r of s){let e=null;if(!i.IsWorldType()||(e=r.hasOwnProperty(\"instJson\")?this.GetLayerBySID(r.instJson.w.l):this.GetLayerBySID(r.w.l))){const n=this._runtime.CreateInstanceFromData(i,e,!1,0,0,!0);r.hasOwnProperty(\"instJson\")?n.LoadFromJson(r.instJson):n.LoadFromJson(r),t=!0,this._createdPersistedInstances.push(n),r.hasOwnProperty(\"instJson\")&&(this._createdPersistedInstancesToDataMap.set(n,r),this._createdPersistedIndexToInstanceMap.set(r.index,n))}}}for(const a of this._allLayersFlat)a._SortInstancesByLastCachedZIndex(!0),a.SetZIndicesChanged();t&&(this._runtime.FlushPendingInstances(),this._runtime._RefreshUidMap())}_CreateAndLinkContainerInstances(t){for(const s of t)if(s.IsInContainer()){const i=s.GetWorldInfo(),e=s.GetIID();for(const r of s.GetObjectClass().GetContainer().objectTypes())if(r!==s.GetObjectClass()){const n=r.GetInstances();if(n.length>e)s._AddSibling(n[e]);else{let e;e=i?this._runtime.CreateInstanceFromData(r,i.GetLayer(),!0,i.GetX(),i.GetY(),!0):this._runtime.CreateInstanceFromData(r,null,!0,0,0,!0),this._runtime.FlushPendingInstances(),r._UpdateIIDs(),s._AddSibling(e),t.push(e)}}}}_CreateInitialNonWorldInstances(){for(const e of this._initialNonWorld){const t=this._runtime.GetObjectClassByIndex(e[1]);t.IsInContainer()||this._runtime.CreateInstanceFromData(e,null,!0)}}_CreateGlobalNonWorlds(){let s=[],i=this._initialNonWorld,r=0;for(let e=0,t=i.length;e<t;++e){const n=i[e],a=this._runtime.GetObjectClassByIndex(n[1]);a.IsGlobal()?a.IsInContainer()&&a.GetContainer().HasAnyWorldType()||s.push(this._runtime.CreateInstanceFromData(n,null,!0)):(i[r]=n,++r)}T.truncateArray(i,r),this._runtime.FlushPendingInstances(),this._CreateAndLinkContainerInstances(s)}RecreateInitialObjects(e,t,s,i,r,n,a){if(s)return s.RecreateInitialObjects(e,t,r,n,i,a);{const o=[];for(const h of this._allLayersFlat)o.push(h.RecreateInitialObjects(e,t,r,n,i,a));return o.flat()}}async _StopRunning(){const e=this._layoutManager;this._runtime.IsLoadingState()||(await this.DispatchRuntimeUserScriptEventAsyncWait(new T.Event(\"beforeanylayoutend\")),await this.DispatchUserScriptEventAsyncWait(new T.Event(\"beforelayoutend\")),await this._runtime.TriggerAsync(T.Plugins.System.Cnds.OnLayoutEnd,null,null),await this.DispatchUserScriptEventAsyncWait(new T.Event(\"afterlayoutend\")),await this.DispatchRuntimeUserScriptEventAsyncWait(new T.Event(\"afteranylayoutend\"))),e.SetIsEndingLayout(!0),this._runtime.GetEventSheetManager().ClearAllScheduledWaits(),this._isFirstVisit||this._SavePersistData();for(const t of this._allLayersFlat)t._End();for(const s of this._runtime.GetAllObjectClasses())if(!(s.IsGlobal()||s.IsWorldType()||s.GetPlugin().IsSingleGlobal()||s.IsFamily())){for(const i of s.GetInstances())this._runtime.DestroyInstance(i);this._runtime.FlushPendingInstances()}e.SetIsEndingLayout(!1),e.GetMainRunningLayout()===this&&e._SetMainRunningLayout(null)}_SaveInstanceToPersist(e,t){const s=e.GetObjectClass().GetSID().toString(),i=(this._persistData.hasOwnProperty(s)||(this._persistData[s]=[]),this._persistData[s]),r={index:t,instJson:e.SaveToJson(),sceneGraphJson:{children:[]}};i.push(r),this._persistedIntances.set(e,r)}_SaveSceneGraphInfoToPersist(e){const t=this._persistedIntances.get(e);for(const s of e.GetChildren()){const i=this._persistedIntances.get(s);i&&t.sceneGraphJson.children.push({index:i.index,flags:T.SceneGraphInfo._GetFlagsNumber(s.GetWorldInfo())})}}_SavePersistData(){this._persistedIntances.clear();let e=0;for(const t of this._allLayersFlat){t._UpdateZIndices();for(const s of t._GetInstances()){const i=s.GetObjectClass();!i.IsGlobal()&&i.HasPersistBehavior()&&(this._SaveInstanceToPersist(s,e),e++)}}for(const r of this._allLayersFlat)for(const n of r._GetInstances()){const a=n.GetObjectClass();!a.IsGlobal()&&a.HasPersistBehavior()&&this._SaveSceneGraphInfoToPersist(n)}this._persistedIntances.clear()}ResetPersistData(){this._persistData={},this._isFirstVisit=!0}GetRenderTarget(){return this._curRenderTarget}UsesOwnTexture(){const e=this._runtime,t=e.GetRenderer().IsWebGL();return\"low\"===e.GetCanvasManager().GetCurrentFullscreenScalingQuality()||t&&e.UsesAnyBackgroundBlending()||this._effectList.HasAnyActiveEffect()||t&&e.Uses3DFeatures()}_MaybeStartDrawToOwnTexture(e){const t=this._runtime.GetCanvasManager();if(this.UsesOwnTexture()){e.SetRenderTarget(null),e.ClearRgba(0,0,0,0);const s={sampling:this._runtime.GetSampling(),isSampled:e.IsWebGPU()||this._runtime.UsesAnyBackgroundBlending()||this._effectList.HasAnyActiveEffect(),canReadPixels:!!e.IsWebGPU()&&this._runtime.UsesAnyBackgroundBlending()};\"low\"===t.GetCurrentFullscreenScalingQuality()&&(s.width=t.GetDrawWidth(),s.height=t.GetDrawHeight()),this._curRenderTarget=this._runtime.GetAdditionalRenderTarget(s)}else this._curRenderTarget=null}_MaybeCopyOwnTextureToBackbuffer(e){this._runtime._NeedsHTMLLayerCompositing(e)&&(e.SetDepthEnabled(!1),e.SetRenderTarget(null),e.SetTextureFillMode(),e.CopyRenderTarget(this._curRenderTarget))}_MaybeEndDrawToOwnTexture(e){this.UsesOwnTexture()&&(e.SetDepthEnabled(!1),this._DrawLayoutOwnTextureToRenderTarget(e,this._curRenderTarget))}DrawMain(e){e.SetRenderTarget(this._curRenderTarget),e.Clear(this.GetLayoutBackgroundColor()),this._runtime.Uses3DFeatures()&&e.ClearDepth();const t=this.GetRootLayersForHTMLLayer(0);this._DrawLayerList(e,this._curRenderTarget,t,!0),e.IsWebGPU()&&e.StartMeasuringRenderPassTime(0,1),this._MaybeEndDrawToOwnTexture(e),this._curRenderTarget=null}DrawForHTMLLayerIndex(e,t){let s=null;this._runtime._NeedsHTMLLayerCompositing(e)&&(s=this._curRenderTarget),e.SetRenderTarget(s),e.ClearRgba(0,0,0,0),this._runtime.Uses3DFeatures()&&e.ClearDepth();const i=this.GetRootLayersForHTMLLayer(t);this._DrawLayerList(e,s,i,!0),this._MaybeCopyOwnTextureToBackbuffer(e),e.EndBatch(),this._runtime.GetCanvasManager().BlitMainCanvasToHTMLLayerCanvas(t)}_DrawLayerList(e,i,t,r){const n=t.filter(e=>e.ShouldDraw());for(let t=0,s=n.length;t<s;){const a=n[t];if(a.SelfAndAllSubLayersHave3DCamera()&&!a.SelfOrAnySubLayerUsesOwnTexture()){h.push(a);for(let e=t+1;e<s;++e){const o=n[e];if(!o.SelfAndAllSubLayersHave3DCamera()||o.SelfOrAnySubLayerUsesOwnTexture())break;h.push(n[e])}if(2<=h.length||1===h.length&&h[0].HasAnyVisibleSubLayer()){this._Draw3DLayers(e,i,h),t+=h.length,T.clearArray(h);continue}T.clearArray(h)}a.Draw(e,i,r&&0===t),++t}}_DrawLayoutOwnTextureToRenderTarget(e,t){const s=this._effectList.GetActiveEffectTypes(),i=this._runtime;0===s.length?(e.SetRenderTarget(null),e.SetTextureFillMode(),e.CopyRenderTarget(t),e.InvalidateRenderTarget(t),i.ReleaseAdditionalRenderTarget(t)):(r.set(0,0,i.GetViewportWidth(),i.GetViewportHeight()),this.GetEffectChain().Render(e,null,{contentObject:this,blendMode:3,devicePixelRatio:this._runtime.GetEffectDevicePixelRatioParam(),layerScale:this._runtime.GetEffectLayerScaleParam()*this.GetScale(),layerAngle:this.GetAngle(),layoutRect:r,drawSurfaceRect:null,invalidateRenderTargets:!0}))}_Draw3DLayers(i,r,e){e[0].IsTransparent()||(C.copyRgb(e[0].GetBackgroundColor()),C.setA(1),i.Clear(C)),this._runtime.GetCanvasManager(),i.SetDepthEnabled(!0);const n=b,a=w,o=x;for(const h of e)h._UpdateZIndices(),h._AppendAllInstancesIncludingSubLayersInDrawOrder(n);const t=e[0],s=t._MaybeStartWebGLProfiling(i);t._MaybeStartWebGPUProfiling(i);for(let t=0,s=n.length;t<s;){const l=n[t],c=l.GetWorldInfo(),u=c.GetLayer();if(c.IsVisible()&&c.IsInViewport3D(u._GetViewFrustum())){(!l.RendersToOwnZPlane()||0<c.GetDepth())&&o.push(l);const _=l.GetWorldInfo().GetTotalZElevation();a.push(l);let e=t+1;for(;e<s;++e){const d=n[e],p=d.GetWorldInfo();if(p.IsVisible()&&p.IsInViewport3D(p.GetLayer()._GetViewFrustum())){if(p.GetTotalZElevation()!==_)break;(d.RendersToOwnZPlane()?(0<p.GetDepth()&&o.push(d),a):o).push(d)}}if(1!==a.length||a[0].MustMitigateZFighting()){this._Draw3DLayersCoplanarInstances(i,r,a);for(let e=0,t=o.length;e<t;++e){const f=o[e],m=f.GetWorldInfo(),g=m.GetLayer();m._SetDrawNonBackFacesOnly(!0),I(g,i),g._DrawInstanceMaybeWithEffects(f,m,i,r),m._SetDrawNonBackFacesOnly(!1)}}else{I(u,i),u._DrawInstanceMaybeWithEffects(l,c,i,r);for(let e=0,t=o.length;e<t;++e){const S=o[e];if(S!==l){const y=S.GetWorldInfo(),G=y.GetLayer();I(G,i),G._DrawInstanceMaybeWithEffects(S,y,i,r)}}}t=e,T.clearArray(a),T.clearArray(o)}else++t}s&&i.EndQuery(s),T.clearArray(n),v=null}_Draw3DLayersCoplanarInstances(s,i,r){s.CoplanarStartStencilPass();for(let e=0,t=r.length;e<t;++e){const n=r[e],a=n.GetWorldInfo(),o=a.GetLayer();a._SetDrawBackFaceOnly(!0),I(o,s),o._DrawInstance(n,a,s)}s.CoplanarStartColorPass();for(let e=0,t=r.length;e<t;++e){const h=r[e],l=h.GetWorldInfo(),c=l.GetLayer();I(c,s),c._DrawInstanceMaybeWithEffects(h,l,s,i),l._SetDrawBackFaceOnly(!1)}s.CoplanarRestoreStandardRendering()}_SaveToJson(){const e={sx:this.GetScrollX(),sy:this.GetScrollY(),s:this.GetScale(),a:this.GetAngle(),w:this.GetWidth(),h:this.GetHeight(),ortho:this.IsOrthographicProjection(),vpX:this.GetVanishingPointX(),vpY:this.GetVanishingPointY(),fv:this._isFirstVisit,persist:this._persistData,fx:this._effectList.SaveToJson(),layers:{},dynamicLayers:[]};for(const t of this._allLayersFlat)if(t.IsDynamic()){const s=t.GetParentLayer();e.dynamicLayers.push({sid:t.GetSID(),name:t.GetName(),parentSid:s?s.GetSID():null,siblingIndex:t._GetSiblingIndex(),data:t._SaveToJson()})}else e.layers[t.GetSID().toString()]=t._SaveToJson();return e}_LoadFromJson(e){this._scrollX=e.sx,this._scrollY=e.sy,this._scale=e.s,this._angle=e.a,this._width=e.w,this._height=e.h,this._isOrthographicProjection=!!e.ortho,e.hasOwnProperty(\"vpX\")&&(this._vanishingPointX=e.vpX),e.hasOwnProperty(\"vpY\")&&(this._vanishingPointY=e.vpY),this._isFirstVisit=!!e.fv,this._persistData=e.persist,this._effectList.LoadFromJson(e.fx),this._needsRebuildEffectChainSteps=!0;for(const[t,s]of Object.entries(e.layers)){const i=parseInt(t,10),r=this.GetLayerBySID(i);r&&r._LoadFromJson(s)}if(e.hasOwnProperty(\"dynamicLayers\")){this.RemoveAllDynamicLayers(),this._runtime.FlushPendingInstances();const n=new Map,a=e.dynamicLayers;for(let e=a.length-1;0<=e;--e){const o=a[e],h=o.sid,l=o.name,c=o.parentSid,u=o.siblingIndex,_=o.data;if(this._ReindexLayers(),!this.HasLayerByName(l)&&!this.GetLayerBySID(h)){let e,t;if(null===c)e=null,t=this._rootLayers;else{if(!(e=this.GetLayerBySID(c)))continue;t=e.GetSubLayers()}const d=T.New(T.Layer,this,e,{name:l,sid:h,isDynamic:!0});t.push(d);let s=n.get(t);s||(s=[],n.set(t,s)),s.push({layer:d,siblingIndex:u}),d._LoadFromJson(_)}}for(const[p,f]of n){f.sort((e,t)=>e.siblingIndex-t.siblingIndex);for(const m of f){let e=m.layer,t=m.siblingIndex,s=p.indexOf(e);p.splice(s,1),p.splice(t,0,e)}}}this._ReindexAndUpdateAllLayers(),this._SetAllLayersProjectionChanged(),this._SetAllLayersMVChanged()}GetILayout(){return this._iLayout}UserScriptDispatcher(){return this._userScriptDispatcher}DispatchUserScriptEvent(e){e.layout=this.GetILayout();const t=this._runtime,s=t.IsDebug()&&!t.GetEventSheetManager().IsInEventEngine();s&&i.StartMeasuringScriptTime(),this._userScriptDispatcher.dispatchEvent(e),s&&i.AddScriptTime()}DispatchUserScriptEventAsyncWait(e){return e.layout=this.GetILayout(),this._userScriptDispatcher.dispatchEventAndWaitAsync(e)}DispatchRuntimeUserScriptEventAsyncWait(e){return e.layout=this.GetILayout(),this._runtime.DispatchUserScriptEventAsyncWait(e)}_LogLayerTree(){this._LogLayerList(this._rootLayers)}_LogLayerList(e,t=0){const s=e.slice(0);s.reverse();for(const i of s)console.log(\"\\t\".repeat(t)+\"- \"+i.GetName()),this._LogLayerList(i.GetSubLayers(),t+1)}}}{const Pn=self.C3;Pn.LayoutManager=class extends Pn.DefendedBase{#runtime;#allLayouts=[];#layoutsByName=new Map;#layoutsBySid=new Map;#mainRunningLayout=null;#runningSubLayouts=[];#firstLayout=null;#isEndingLayout=0;#pendingChangeLayout=null;constructor(e){super(),this.#runtime=e}Release(){this.#runtime=null,this.#mainRunningLayout=null,this.#firstLayout=null,this.#pendingChangeLayout=null,Pn.clearArray(this.#allLayouts),this.#layoutsByName.clear(),this.#layoutsBySid.clear(),Pn.clearArray(this.#runningSubLayouts)}Create(e){const t=Pn.New(Pn.Layout,this,this.#allLayouts.length,e);this.#allLayouts.push(t),this.#layoutsByName.set(t.GetName().toLowerCase(),t),this.#layoutsBySid.set(t.GetSID(),t)}GetRuntime(){return this.#runtime}SetFirstLayout(e){this.#firstLayout=e}GetFirstLayout(){if(this.#firstLayout)return this.#firstLayout;if(this.#allLayouts.length)return this.#allLayouts[0];throw new Error(\"no first layout\")}GetLayoutByName(e){return this.#layoutsByName.get(e.toLowerCase())||null}GetLayoutBySID(e){return this.#layoutsBySid.get(e)||null}GetLayoutByIndex(e){return e=Pn.clamp(Math.floor(e),0,this.#allLayouts.length-1),this.#allLayouts[e]}GetLayout(e){return\"number\"==typeof e?this.GetLayoutByIndex(e):this.GetLayoutByName(e.toString())}GetAllLayouts(){return this.#allLayouts}_SetMainRunningLayout(e){this.#mainRunningLayout=e}GetMainRunningLayout(){return this.#mainRunningLayout}_AddRunningSubLayout(e){if(this.#runningSubLayouts.includes(e))throw new Error(\"layout already running\");this.#runningSubLayouts.push(e)}_RemoveRunningSubLayout(e){const t=this.#runningSubLayouts.indexOf(e);if(-1===t)throw new Error(\"layout not running\");this.#runningSubLayouts.splice(t,1)}*runningLayouts(){this.#mainRunningLayout&&(yield this.#mainRunningLayout),this.#runningSubLayouts.length&&(yield*this.#runningSubLayouts)}IsLayoutRunning(e){return this.#mainRunningLayout===e||this.#runningSubLayouts.includes(e)}SetIsEndingLayout(e){if(e)this.#isEndingLayout++;else{if(this.#isEndingLayout<=0)throw new Error(\"already unset\");this.#isEndingLayout--}}IsEndingLayout(){return 0<this.#isEndingLayout}ChangeMainLayout(e){this.#pendingChangeLayout=e}ClearPendingChangeLayout(){this.#pendingChangeLayout=null}IsPendingChangeMainLayout(){return!!this.#pendingChangeLayout}GetPendingChangeMainLayout(){return this.#pendingChangeLayout}SetAllLayerProjectionChanged(){const e=this.GetMainRunningLayout();e&&e._SetAllLayersProjectionChanged()}SetAllLayerMVChanged(){const e=this.GetMainRunningLayout();e&&e._SetAllLayersMVChanged()}}}{const G=self.C3,Rn=new RegExp(\"<(.+?)>\",\"g\");G.TimelineManager=class extends G.DefendedBase{constructor(e){super(),this._runtime=e,this._timelineDataManager=G.New(G.TimelineDataManager),this._pluginInstance=null,this._timelines=[],this._timelinesByName=new Map,this._objectClassToTimelineMap=new Map,this._timelinesCreatedByTemplate=new Map,this._scheduledTimelines=[],this._playingTimelines=[],this._markedForRemovalTimelines=[],this._hasRuntimeListeners=!1,this._changingLayout=!1,this._isTickingTimelines=!1,this._tickFunc=()=>this._OnTick(),this._tick2Func=()=>this._OnTick2(),this._beforeLayoutChange=()=>this._OnBeforeChangeLayout(),this._layoutChange=()=>this._OnAfterChangeLayout(),this._instanceDestroy=e=>this._OnInstanceDestroy(e.instance),this._beforeLoad=e=>this._OnBeforeLoad(),this._afterLoad=e=>this._OnAfterLoad(),this._afterLayoutStart=e=>this._OnAfterLayoutStart(),this._destroyedWhileLoadingState=[],this._renderChange=0}Release(){this.RemoveRuntimeListeners(),this._tickFunc=null,this._tick2Func=null,this._beforeLayoutChange=null,this._layoutChange=null,this._instanceDestroy=null,this._afterLoad=null;for(const e of this._timelines)e.Stop(),e.Release();G.clearArray(this._timelines),this._timelines=null,this._timelineDataManager.Release(),this._timelineDataManager=null,G.clearArray(this._scheduledTimelines),this._scheduledTimelines=null,G.clearArray(this._playingTimelines),this._playingTimelines=null,G.clearArray(this._markedForRemovalTimelines),this._markedForRemovalTimelines=null,this._timelinesByName.clear(),this._timelinesByName=null,this._objectClassToTimelineMap.clear(),this._objectClassToTimelineMap=null,this._timelinesCreatedByTemplate.clear(),this._timelinesCreatedByTemplate=null,G.clearArray(this._destroyedWhileLoadingState),this._destroyedWhileLoadingState=null,this._runtime=null}AddRuntimeListeners(){const e=this._runtime.Dispatcher();e.addEventListener(\"pretick\",this._tickFunc),e.addEventListener(\"tick2\",this._tick2Func),e.addEventListener(\"beforelayoutchange\",this._beforeLayoutChange),e.addEventListener(\"layoutchange\",this._layoutChange),e.addEventListener(\"instancedestroy\",this._instanceDestroy),e.addEventListener(\"beforeload\",this._beforeLoad),e.addEventListener(\"afterload\",this._afterLoad),e.addEventListener(\"afterlayoutstart\",this._afterLayoutStart)}RemoveRuntimeListeners(){const e=this._runtime.Dispatcher();e.removeEventListener(\"pretick\",this._tickFunc),e.removeEventListener(\"tick2\",this._tick2Func),e.removeEventListener(\"beforelayoutchange\",this._beforeLayoutChange),e.removeEventListener(\"layoutchange\",this._layoutChange),e.removeEventListener(\"instancedestroy\",this._instanceDestroy),e.removeEventListener(\"beforeload\",this._beforeLoad),e.removeEventListener(\"afterload\",this._afterLoad),e.removeEventListener(\"afterlayoutstart\",this._afterLayoutStart)}Create(e){this._timelineDataManager.Add(e);const t=G.TimelineState.CreateInitial(e,this);this.Add(t),this.SetTimelineObjectClassesToMap(t),this._timelinesCreatedByTemplate.set(t.GetName(),0)}CreateFromTemplate(e){const t=this.GetTimelineDataManager(),s=e.GetTemplateName(),i=t.Get(s),r=G.TimelineState.CreateFromTemplate(s+\":\"+this._timelinesCreatedByTemplate.get(s),i,this);return this._IncreaseTemplateTimelinesCount(s),this.Add(r),r}_IncreaseTemplateTimelinesCount(e){this._timelinesCreatedByTemplate.set(e,this._timelinesCreatedByTemplate.get(e)+1)}_SetCreatedTemplateTimelinesCount(){for(const e of this._timelines)if(!e.IsTemplate()){const t=e.GetTemplateName();this._IncreaseTemplateTimelinesCount(t)}}_ClearCreatedTemplateTimelinesCount(){for(const e of this._timelinesCreatedByTemplate.keys())this._timelinesCreatedByTemplate.set(e,0)}Add(e){this._timelines.push(e),this._timelinesByName.set(e.GetName().toLowerCase(),e)}Remove(e){e.Removed(),e.IsTemplate()||(G.arrayFindRemove(this._timelines,e),G.arrayFindRemove(this._scheduledTimelines,e),G.arrayFindRemove(this._playingTimelines,e),G.arrayFindRemove(this._markedForRemovalTimelines,e),this._timelinesByName.delete(e.GetName().toLowerCase()),this.RemoveTimelineFromObjectClassMap(e),e.IsReleased())||e.Release()}Trigger(e){this._runtime.Trigger(e,this._pluginInstance,null)}GetRuntime(){return this._runtime}GetTimelineDataManager(){return this._timelineDataManager}SetPluginInstance(e){this._pluginInstance=e}GetPluginInstance(){return this._pluginInstance}*GetTimelines(){for(const e of this._timelines)yield e}*GetPlayingTimelines(){for(const e of this._playingTimelines)yield e}SetTimelineObjectClassToMap(e,t){this._objectClassToTimelineMap.has(e)||this._objectClassToTimelineMap.set(e,new Set),this._objectClassToTimelineMap.get(e).add(t)}SetTimelineObjectClassesToMap(e){for(const t of e.GetObjectClasses())this.SetTimelineObjectClassToMap(t,e)}RemoveTimelineFromObjectClassMap(e){for(const[t,s]of this._objectClassToTimelineMap.entries())s.has(e)&&(s.delete(e),0===s.size)&&this._objectClassToTimelineMap.delete(t)}GetTimelinesForObjectClass(e){if(this._objectClassToTimelineMap.has(e))return this._objectClassToTimelineMap.get(e)}GetTimelineOfTemplateForInstances(e,t){if(t)for(const s of this._timelines){const i=t.every(e=>s.HasTrackInstance(e.instance,e.trackId));if(i&&s.GetName().includes(e.GetName()))return s}}GetTimelineByName(e){return this._timelinesByName.get(e.toLowerCase())||null}GetScheduledOrPlayingTimelineByName(e){for(const t of this._scheduledTimelines)if(t.GetName()===e)return t;for(const s of this._playingTimelines)if(s.GetName()===e)return s;return null}*GetTimelinesByName(s){if(Rn.test(s)){Rn.lastIndex=0;let e,t=new Set;do{if(e=Rn.exec(s)){const i=e[1].split(\",\");for(const r of i)t.add(r)}}while(e);for(const n of t.values()){const a=this.GetTimelineByName(n);a&&(yield a)}t.clear()}else{const e=this.GetTimelineByName(s);e&&(yield e)}}*GetTimelinesByTags(e){for(const t of this._timelines)t.HasTags(e)&&(yield t)}AddScheduledTimeline(e){this._scheduledTimelines.includes(e)||this._scheduledTimelines.push(e),this._MaybeEnableRuntimeListeners()}RemovePlayingTimeline(e){G.arrayFindRemove(this._playingTimelines,e),this._MaybeDisableRuntimeListeners()}ScheduleTimeline(e){this._playingTimelines.includes(e)?(e.SetPlaying(!0),e.SetScheduled(!1),e.SetMarkedForRemoval(!1)):(e.SetPlaying(!1),e.SetScheduled(!0),e.SetMarkedForRemoval(!1),this._scheduledTimelines.includes(e)||this._scheduledTimelines.push(e)),this._MaybeEnableRuntimeListeners()}DeScheduleTimeline(e){e.SetPlaying(!1),e.SetScheduled(!1),e.ResolvePlayPromise(),G.arrayFindRemove(this._scheduledTimelines,e),this._MaybeDisableRuntimeListeners()}CompleteTimeline(e){e.SetPlaying(!1),e.SetScheduled(!1),this._playingTimelines.includes(e)&&(e.SetMarkedForRemoval(!0),this._markedForRemovalTimelines.push(e),G.arrayFindRemove(this._playingTimelines,e)),this._scheduledTimelines.includes(e)&&e.SetMarkedForRemoval(!0)}CompleteTimelineBeforeChangeOfLayout(e){e.SetPlaying(!1),e.SetScheduled(!1),e.SetMarkedForRemoval(!1),e.SetPlaybackRate(1),G.arrayFindRemove(this._playingTimelines,e)}CompleteTimelineAndResolve(e){this.CompleteTimeline(e),e.ResolvePlayPromise()}_OnTick(){if(!this.GetRuntime().IsLoadingState()&&this._hasRuntimeListeners&&!this._changingLayout){for(this._isTickingTimelines=!0;this._scheduledTimelines.length;){const e=this._scheduledTimelines.pop();(e.IsMarkedForRemoval()?(e.SetInitialStateForce(),this._markedForRemovalTimelines):(e.SetInitialState(),this._playingTimelines)).push(e),0!==e.GetRenderChange()&&(this._renderChange=1)}const t=this._runtime._GetDtFast(),s=this._runtime.GetDt1(),i=this._runtime.GetTimeScale();for(let e=this._playingTimelines.length-1;0<=e;e--){const r=this._playingTimelines[e];r&&r.Tick(t,i,s)}this._isTickingTimelines=!1,0!==this._renderChange&&this.GetRuntime().UpdateRender()}}_OnTick2(){if(!this.GetRuntime().IsLoadingState()&&this._hasRuntimeListeners&&!this._changingLayout){let s;for(let e=0,t=this._markedForRemovalTimelines.length;e<t;e++){const i=this._markedForRemovalTimelines[e];s=s||new Set,i.Removed(),this._MaybeExecuteTimelineFinishTriggers(i),s.add(i)}if(s){G.arrayRemoveAllInSet(this._markedForRemovalTimelines,s);for(let e=this._renderChange=0,t=this._playingTimelines.length;e<t;e++)if(0!==this._playingTimelines[e].GetRenderChange()){this._renderChange=1;break}}this._MaybeDisableRuntimeListeners()}}_MaybeExecuteTimelineFinishTriggers(e){e.IsReleased()||e.HasValidTracks()&&e.IsComplete()&&e.InitialStateSet()&&e.FinishTriggers()}_MaybeEnableRuntimeListeners(){this._hasRuntimeListeners||(this._hasRuntimeListeners=!0)}_MaybeDisableRuntimeListeners(){this._markedForRemovalTimelines.length||this._playingTimelines.length||this._scheduledTimelines.length||this._isTickingTimelines||(this._hasRuntimeListeners=!1)}_OnBeforeChangeLayout(){for(this._changingLayout=!0;this._scheduledTimelines.length;)this.DeScheduleTimeline(this._scheduledTimelines.pop());const e=new Set;for(const t of this._playingTimelines){const s=t._OnBeforeChangeLayout();s&&(t.Removed(),e.add(t))}G.arrayRemoveAllInSet(this._playingTimelines,e),e.clear();for(const i of this._markedForRemovalTimelines){const r=i._OnBeforeChangeLayout();r&&(i.Removed(),e.add(i))}G.arrayRemoveAllInSet(this._markedForRemovalTimelines,e),this._MaybeDisableRuntimeListeners();for(const n of this._timelines)n.CleanCaches()}_OnAfterChangeLayout(){this._changingLayout=!1}_OnInstanceDestroy(e){const t=e.GetObjectClass(),s=this.GetTimelinesForObjectClass(t);if(s)if(this._runtime.IsLoadingState())this._destroyedWhileLoadingState.push(e);else for(const i of s)i.IsTemplate()||(i.IsReleased()?this.Remove(i):i.HasValidTracks()||(this._MaybeExecuteTimelineFinishTriggers(i),this.Remove(i)))}_OnBeforeLoad(){for(const e of this._scheduledTimelines.map(e=>e))this._MaybeExecuteTimelineFinishTriggers(e),this.Remove(e);for(const t of this._playingTimelines.map(e=>e))this._MaybeExecuteTimelineFinishTriggers(t),this.Remove(t)}_OnAfterLoad(){for(const e of this._destroyedWhileLoadingState)this._OnInstanceDestroy(e);G.clearArray(this._destroyedWhileLoadingState);for(const t of this._timelines)t._OnAfterLoad()}_OnAfterLayoutStart(){const e=this._runtime.GetLayoutManager(),t=e.GetMainRunningLayout();if(t)for(const s of this._timelines){const i=s.GetStartOnLayout();i&&t.GetName()===i&&this.ScheduleTimeline(s)}}_SaveToJson(){return{timelinesJson:this._SaveTimelinesToJson(),scheduledTimelinesJson:this._SaveScheduledTimelinesToJson(),playingTimelinesJson:this._SavePlayingTimelinesToJson(),markedForRemovalTimelinesJson:this._SaveMarkedForRemovalTimelinesToJson(),hasRuntimeListeners:this._hasRuntimeListeners,changingLayout:this._changingLayout,isTickingTimelines:this._isTickingTimelines}}_LoadFromJson(e){e&&(this._ClearCreatedTemplateTimelinesCount(),this._LoadTimelinesFromJson(e.timelinesJson),this._LoadScheduledTimelinesFromJson(e.scheduledTimelinesJson),this._LoadPlayingTimelinesFromJson(e.playingTimelinesJson),this._LoadMarkedForRemovalTimelinesFromJson(e.markedForRemovalTimelinesJson),this._hasRuntimeListeners=!e.hasRuntimeListeners,this._changingLayout=!!e.changingLayout,this._isTickingTimelines=!!e.isTickingTimelines,this._SetCreatedTemplateTimelinesCount(),this._MaybeEnableRuntimeListeners(),this._MaybeDisableRuntimeListeners())}_SaveTimelinesToJson(){return this._timelines.map(e=>e._SaveToJson())}_LoadTimelinesFromJson(e){for(const t of e){let e=this.GetTimelineByName(t.name);if(e)e._LoadFromJson(t);else{const s=this._GetTemplateNameFromJson(t);if(!s)continue;const i=this.GetTimelineByName(s);(e=this.CreateFromTemplate(i))._LoadFromJson(t)}e.HasTracks()||this.Remove(e)}}_GetTemplateNameFromJson(e){const t=e.name,s=t.split(\":\");return s&&2===s.length?s[0]:null}_SaveScheduledTimelinesToJson(){return this._SaveTimelines(this._scheduledTimelines)}_LoadScheduledTimelinesFromJson(e){this._LoadTimelines(e,this._scheduledTimelines)}_SavePlayingTimelinesToJson(){return this._SaveTimelines(this._playingTimelines)}_LoadPlayingTimelinesFromJson(e){this._LoadTimelines(e,this._playingTimelines)}_SaveMarkedForRemovalTimelinesToJson(){return this._SaveTimelines(this._markedForRemovalTimelines)}_LoadMarkedForRemovalTimelinesFromJson(e){this._LoadTimelines(e,this._markedForRemovalTimelines)}_IsTimelineInJson(e,t){if(t)for(const s of t)if(s===e.GetName())return!0;return!1}_SaveTimelines(e){return e.map(e=>e.GetName())}_LoadTimelines(e,t){const s=new Set;for(const i of t)this._IsTimelineInJson(i,e)||s.add(i);if(G.arrayRemoveAllInSet(t,s),e)for(const r of e){const n=this.GetTimelineByName(r);if(n){const a=t.find((t=>e=>e.GetName()===t)(r));a||t.push(n)}}}}}{const An=self.C3,Mn=[0,0],Dn=[0,0],En=[0,0],Fn=[0,0,0,0,0],Bn=new Array(4),On=[{x:0,y:0,t:0,distance:0},{x:0,y:0,t:0,distance:0},{x:0,y:0,t:0,distance:0}],Ln={x:0,y:0,t:0,distance:0};An.TimelineInfo=class{constructor(e,t){this._initialized=!1,this._timeline=e,this._segments=[];let s=null;if(s=t?this._timeline.GetTrackById(t):An.first(this._timeline.GetTracks())){const i=s.GetPropertyTrack(\"offsetX\"),r=s.GetPropertyTrack(\"offsetY\");if(i&&r){this._xTrack=i,this._yTrack=r;const n=i.GetPropertyKeyframeDataItemArrayIncludingDisabled(),a=r.GetPropertyKeyframeDataItemArrayIncludingDisabled();for(let e=1,t=Math.min(n.length,a.length);e<t;++e){const o=n[e],h=(o.GetNext(),o.GetPrevious()),l=a[e],c=(l.GetNext(),l.GetPrevious());h&&\"cubic-bezier\"===h.GetPathMode()&&c&&\"cubic-bezier\"===c.GetPathMode()?this._segments.push(An.New(An.TimelineCubicBezierSegmentInfo,h,c,o,l,this._segments.length)):(h&&\"line\"===h.GetPathMode()&&c&&c.GetPathMode(),this._segments.push(An.New(An.TimelineLineSegmentInfo,o,l,this._segments.length)))}this._initialized=!0}}}Release(){for(const e of this._segments)e.Release();An.clearArray(this._segments),this._segments=null,this._timeline=null,this._xTrack=null,this._yTrack=null}WasInitialized(){return this._initialized}segments(){return this._segments}SetOrigin(e){const t=\"relative\"===this._xTrack.GetResultMode()?e.GetX():0,s=\"relative\"===this._yTrack.GetResultMode()?e.GetY():0;for(const i of this._segments)i.SetOrigin(t,s)}Project(t,s,e){let i=NaN,r=this._segments.length;for(let e=0;e<r;e++){const n=this._segments[e];if(\"cubic-bezier\"===n.GetType()){const a=n.Project(t,s);(isNaN(i)||a[3]<i)&&(i=a[3],En[0]=a[2],En[1]=n.GetIndex())}}return En}ProjectWithOptions(t,s,e){const i=e.tRange;An.IsFiniteNumber(i[0])||(i[0]=0),An.IsFiniteNumber(i[1])||(i[1]=1);let r=NaN,n=this._segments.length;for(let e=0;e<n;e++){const a=this._segments[e];if(\"cubic-bezier\"===a.GetType()){const o=a.ProjectWithRange(t,s,i);(isNaN(r)||o[3]<r)&&(r=o[3],En[0]=o[2],En[1]=a.GetIndex())}}return En}Tangent(e,t){return this._segments[t].Tangent(e)}TangentAngle(e,t){return this._segments[t].TangentAngle(e)}},An.TimelineCubicBezierSegmentInfo=class{constructor(e,t,s,i,r){this._index=r;const n=e.GetAddOn(\"cubic-bezier\"),a=s.GetAddOn(\"cubic-bezier\"),o=t.GetAddOn(\"cubic-bezier\"),h=i.GetAddOn(\"cubic-bezier\");this._aX=e.GetValueWithResultMode(),this._aY=t.GetValueWithResultMode(),this._bX=e.GetValueWithResultMode()+n.GetStartAnchor(),this._bY=t.GetValueWithResultMode()+o.GetStartAnchor(),this._cX=s.GetValueWithResultMode()+a.GetEndAnchor(),this._cY=i.GetValueWithResultMode()+h.GetEndAnchor(),this._dX=s.GetValueWithResultMode(),this._dY=i.GetValueWithResultMode(),this._aXO=0,this._aYO=0,this._bXO=0,this._bYO=0,this._cXO=0,this._cYO=0,this._dXO=0,this._dYO=0,this._d0x=0,this._d0y=0,this._d1x=0,this._d1y=0,this._d2x=0,this._d2y=0,this._x1Factor=0,this._x2Factor=0,this._x3Factor=0,this._y1Factor=0,this._y2Factor=0,this._y3Factor=0,this._lutIndex=NaN,this._initialized=!1,this._len=100,this._arcLengths=new Array(this._len+1),this._arcLengths[0]=0,this._length=0,this._lut=[],this._lutObjects=[];for(let e=0;e<100;e++)this._lutObjects.push({x:0,y:0,t:0,distance:0});this._CalculateLength()}Release(){An.clearArray(this._arcLengths),this._arcLengths=null,An.clearArray(this._lut),this._lut=null,An.clearArray(this._lutObjects),this._lutObjects=null}GetType(){return\"cubic-bezier\"}GetIndex(){return this._index}GetStepCount(){return Math.floor(this._length/25)}GetStepIncrement(){return 1/this.GetStepCount()}SetOrigin(e,t){this._originX=e,this._originY=t,this._arcLengths=new Array(this._len+1),this._arcLengths[0]=0,this._CalculateLength(),this._aXO=this._aX+this._originX,this._aYO=this._aY+this._originY,this._bXO=this._bX+this._originX,this._bYO=this._bY+this._originY,this._cXO=this._cX+this._originX,this._cYO=this._cY+this._originY,this._dXO=this._dX+this._originX,this._dYO=this._dY+this._originY,this._d0x=3*(this._bXO-this._aXO),this._d0y=3*(this._bYO-this._aYO),this._d1x=3*(this._cXO-this._bXO),this._d1y=3*(this._cYO-this._bYO),this._d2x=3*(this._dXO-this._cXO),this._d2y=3*(this._dYO-this._cYO),this._x1Factor=3*(this._bXO-this._aXO),this._x2Factor=3*(this._aXO+this._cXO-2*this._bXO),this._x3Factor=this._dXO-this._aXO+3*(this._bXO-this._cXO),this._y1Factor=3*(this._bYO-this._aYO),this._y2Factor=3*(this._aYO+this._cYO-2*this._bYO),this._y3Factor=this._dYO-this._aYO+3*(this._bYO-this._cYO)}Map(e){if(!this._initialized)return NaN;const t=this._Map(e);return Dn[0]=this._X(t),Dn[1]=this._Y(t),Dn}Project(e,t){const s=this._GenerateLUT(100),i=this._FindClosestFromLUT(e,t,s),r=this._RefineProjection(e,t,s,i);return Fn[0]=r.x,Fn[1]=r.y,Fn[2]=r.t,Fn[3]=r.distance,Fn}ProjectWithRange(e,t,s){const i=this._GenerateLUT(100),r=this._FindClosestFromLUTWithRange(e,t,i,s),n=this._RefineProjection(e,t,i,r);return Fn[0]=n.x,Fn[1]=n.y,Fn[2]=n.t,Fn[3]=n.distance,Fn}Tangent(e){const t=1-e,s=t*t,i=2*t*e,r=e*e,n=s*this._d0x+i*this._d1x+r*this._d2x,a=s*this._d0y+i*this._d1y+r*this._d2y,o=Math.hypot(n,a);return Mn[0]=n/o,Mn[1]=a/o,Mn}TangentAngle(e){const t=1-e,s=t*t,i=2*t*e,r=e*e,n=s*this._d0x+i*this._d1x+r*this._d2x,a=s*this._d0y+i*this._d1y+r*this._d2y;return Math.atan2(a,n)}_Map(r){if(this._initialized){let e=r*this._arcLengths[this._len],t=0,s=this._len,i=0;for(;t<s;)i=t+((s-t)/2|0),this._arcLengths[i]<e?t=i+1:s=i;this._arcLengths[i]>e&&i--;const n=this._arcLengths[i];return n===e?i/this._len:(i+(e-n)/(this._arcLengths[i+1]-n))/this._len}}_X(e){return this._initialized?self.Ease.GetRuntimeEase(\"cubicbezier\")(e,this._aX+this._originX,this._bX+this._originX,this._cX+this._originX,this._dX+this._originX):NaN}_Y(e){return this._initialized?self.Ease.GetRuntimeEase(\"cubicbezier\")(e,this._aY+this._originY,this._bY+this._originY,this._cY+this._originY,this._dY+this._originY):NaN}_GenerateLUT(t){if(!(this._lut.length>=(t=t||100))){this._lut=new Array(t),t++;for(let e=0;e<t-1;e++){const s=e/(t-1),i=s**2,r=s**3,n=this._x1Factor*s,a=this._x2Factor*i,o=this._x3Factor*r,h=this._y1Factor*s,l=this._y2Factor*i,c=this._y3Factor*r,u=this._aXO+n+a+o,_=this._aYO+h+l+c;this._lutObjects[e].x=u,this._lutObjects[e].y=_,this._lutObjects[e].t=s,this._lutObjects[e].distance=0,this._lut[e]=this._lutObjects[e]}}return this._lut}_FindClosestFromLUT(t,s,i,e=0,r=Number.MAX_SAFE_INTEGER){let n=0;if(isNaN(this._lutIndex))for(let e=0;e<100;e++){const a=i[e],o=a.x-t,h=a.y-s;a.distance=o*o+h*h,a.distance<r&&(r=a.distance,n=e)}else{for(let e=this._lutIndex;e<this._lutIndex+5&&!(e>=i.length);e++){const l=i[e],c=l.x-t,u=l.y-s;l.distance=c*c+u*u,l.distance<r&&(r=l.distance,n=e)}for(let e=this._lutIndex;e>this._lutIndex-5&&!(e<0);e--){const _=i[e],d=_.x-t,p=_.y-s;_.distance=d*d+p*p,_.distance<r&&(r=_.distance,n=e)}}return this._lutIndex=n}_FindClosestFromLUTWithRange(t,s,i,r,n=Number.MAX_SAFE_INTEGER){let a=0;if(isNaN(this._lutIndex))for(let e=0;e<100;e++){const o=i[e],h=o.x-t,l=o.y-s;o.distance=h*h+l*l,o.t>=r[0]&&o.t<=r[1]&&o.distance<n&&(n=o.distance,a=e)}else{for(let e=this._lutIndex;e<this._lutIndex+5&&!(e>=i.length);e++){const c=i[e],u=c.x-t,_=c.y-s;c.distance=u*u+_*_,c.t>=r[0]&&c.t<=r[1]&&c.distance<n&&(n=c.distance,a=e)}for(let e=this._lutIndex;e>this._lutIndex-5&&!(e<0);e--){const d=i[e],p=d.x-t,f=d.y-s;d.distance=p*p+f*f,d.t>=r[0]&&d.t<=r[1]&&d.distance<n&&(n=d.distance,a=e)}}return this._lutIndex=a}_RefineProjection(a,o,h,l){let c=h[l],e=1,u=Number.MAX_SAFE_INTEGER;e:do{let e=h.length,t=0===l?0:l-1,s=l===e-1?e-1:l+1,i=h[t].t,r=h[s].t,n=(r-i)/4;if(n<.001)break;Bn[0]=h[t];for(let e=1;e<=2;e++){const _=i+e*n,d=_**2,p=_**3,f=this._x1Factor*_,m=this._x2Factor*d,g=this._x3Factor*p,S=this._y1Factor*_,y=this._y2Factor*d,G=this._y3Factor*p,I=this._aXO+f+m+g,T=this._aYO+S+y+G,C=I-a,b=T-o,w=C*C+b*b;if(w<u){u=w,l=e,Ln.x=I,Ln.y=T,Ln.t=_,Ln.distance=w,c=Ln;break e}const x=On[e-1];x.x=I,x.y=T,x.t=_,x.distance=w,Bn[e]=x}Bn[3]=h[s],h=Bn}while(e++<20);return c}_CalculateLength(){this._initialized=!0;let t=this._X(0),s=this._Y(0),i=0;for(let e=1;e<=this._len;e++){const r=this._X(.01*e),n=this._Y(.01*e),a=t-r,o=s-n;i+=Math.hypot(a,o),this._arcLengths[e]=i,t=r,s=n}this._length=i}},An.TimelineLineSegmentInfo=class{constructor(e,t,s){this._index=s,this._targetX=e.GetValueWithResultMode(),this._targetY=t.GetValueWithResultMode(),this._originX=0,this._originY=0}Release(){}GetType(){return\"line\"}GetIndex(){return this._index}SetOrigin(e,t){this._originX=e,this._originY=t}GetX(){return this._targetX+this._originX}GetY(){return this._targetY+this._originY}}}{const I=self.C3;I.TimelineState=class extends I.DefendedBase{constructor(e,t,s){super(),this._runtime=s.GetRuntime(),this._timelineManager=s,this._timelineDataItem=t,this._name=e,this._tracks=[],this._tracksLength=0,this._beforeAndAfterTracks=null,this._beforeAndAfterTracksLength=0,this.CreateTrackStates(),this._playPromise=null,this._playResolve=null,this._playheadTime=0,this._overshoot=0,this._playbackRate=1,this._pingPongState=0,this._currentRepeatCount=1,this._isPlaying=!1,this._isScheduled=!1,this._initialStateSet=!1,this._complete=!0,this._released=!1,this._markedForRemoval=!1,this._completedTick=-1,this._implicitPause=!1,this._isTemplate=!1,this._finishedTriggers=!1,this._firstTick=!1,this._lastDelta=NaN,this._tags=[\"\"],this._stringTags=\"\",this._tagsChanged=!1,this._renderChange=0,this._hasNestedContent=0,this._iTimelineState=null}static CreateInitial(e,t){const s=t.GetTimelineDataManager(),i=s.GetNameId(),r=s.Get(e[i]),n=I.New(I.TimelineState,e[i],r,t);return n.SetIsTemplate(!0),n}static CreateFromTemplate(e,t,s){return I.New(I.TimelineState,e,t,s)}Release(){if(!this.IsReleased()){const e=this._runtime.Dispatcher();this._timelineManager.DeScheduleTimeline(this),this._timelineManager.CompleteTimelineAndResolve(this);for(const t of this._tracks)t.Release();I.clearArray(this._tracks),this._tracks=null,this._runtime=null,this._timelineManager=null,this._timelineDataItem=null,this._released=!0,this._playPromise=null,this._playResolve=null,this.FireReleaseEvent(e)}}FireReleaseEvent(e){const t=I.New(I.Event,\"timelinestatereleased\");t.timelineState=this,e.dispatchEvent(t)}GetType(){return 0}CreateTrackStates(){for(const e of this._timelineDataItem.GetTrackData().trackDataItems())this._tracksLength=this._tracks.push(I.TrackState.Create(this,e))}GetTimelineManager(){return this._timelineManager}GetRuntime(){return this._runtime}GetTracks(){return this._tracks}GetSimilarPropertyTracks(i,r,n,a){if(this._hasNestedContent){let s;for(let t=0;t<this._tracks.length;t++){let e=this._tracks[t];if(i===e.GetInstance()){const o=e.GetPropertyTrack(n);o&&r.constructor===o.GetSourceAdapter().constructor&&o.GetResultMode()===a.GetResultMode()&&(s=s||[]).push(o)}}return s}}HasTracks(){return!!this._tracks.length}GetTrackById(e){for(const t of this._tracks)if(I.equalsNoCase(t.GetId(),e))return t;return null}GetTrackByName(e){for(const t of this._tracks)if(!t.IsInstanceTrack()&&I.equalsNoCase(t.GetName(),e))return t;return null}SetName(e){this._name=e}GetName(){return this._name}GetTimelineDataItem(){return this._timelineDataItem}GetTemplateName(){return this._timelineDataItem.GetName()}GetTotalTime(){return this._timelineDataItem.GetTotalTime()}SetTotalTime(e){this._timelineDataItem.SetTotalTime(e)}GetStep(){return this._timelineDataItem.GetStep()}SetStep(e){this._timelineDataItem.SetStep(e)}GetInterpolationMode(){return this._timelineDataItem.GetInterpolationMode()}SetInterpolationMode(e){this._timelineDataItem.SetInterpolationMode(e)}GetResultMode(){return this._timelineDataItem.GetResultMode()}SetResultMode(e){this._timelineDataItem.GetResultMode(e)}SetEase(e){for(const t of this.GetTracks())t.SetEase(e)}GetLoop(){return this._timelineDataItem.GetLoop()}SetLoop(e){return this._timelineDataItem.SetLoop(e)}GetPingPong(){return this._timelineDataItem.GetPingPong()}SetPingPong(e){return this._timelineDataItem.SetPingPong(e)}GetRepeatCount(){return this._timelineDataItem.GetRepeatCount()}SetRepeatCount(e){return this._timelineDataItem.SetRepeatCount(e)}SetPlaybackRate(e){return this._playbackRate=e}GetPlaybackRate(){return this._playbackRate}GetStartOnLayout(){return this._timelineDataItem.GetStartOnLayout()}GetTransformWithSceneGraph(){return this._timelineDataItem.GetTransformWithSceneGraph()}GetUseSystemTimescale(){return this._timelineDataItem.GetUseSystemTimescale()}GetPingPongState(){return this._pingPongState}IsForwardPlayBack(){return!this.IsPlaying()||0<this._playbackRate}GetPlayPromise(){return this._playPromise||(this._playPromise=new Promise(e=>{this._playResolve=e})),this._playPromise}ResolvePlayPromise(){this._playPromise&&(this._playResolve(),this._playPromise=null,this._playResolve=null)}SetTags(e){this._tags=I.TimelineState._GetTagArray(e),this._tagsChanged=!0}GetTags(){return this._tags}GetStringTags(){return this._tagsChanged&&(this._stringTags=this._tags.join(\" \")),this._tagsChanged=!1,this._stringTags}HasTags(e){if(!this._tags)return!1;if(!this._tags.length)return!1;const t=I.TimelineState._GetTagArray(e);return!!t&&!!t.length&&t.every(I.TimelineState._HasTag,this)}OnStarted(){I.Plugins.Timeline&&this.constructor===I.TimelineState&&(I.Plugins.Timeline.Cnds.PushTriggerTimeline(this),this._timelineManager.Trigger(I.Plugins.Timeline.Cnds.OnTimelineStarted),this._timelineManager.Trigger(I.Plugins.Timeline.Cnds.OnTimelineStartedByName),this._timelineManager.Trigger(I.Plugins.Timeline.Cnds.OnTimelineStartedByTags),this._timelineManager.Trigger(I.Plugins.Timeline.Cnds.OnAnyTimelineStarted),I.Plugins.Timeline.Cnds.PopTriggerTimeline())}OnCompleted(){this._completedTick=this._runtime.GetTickCount()}FinishTriggers(){this._finishedTriggers||(this._finishedTriggers=!0,I.Plugins.Timeline&&this.constructor===I.TimelineState&&(I.Plugins.Timeline.Cnds.PushTriggerTimeline(this),this._timelineManager.Trigger(I.Plugins.Timeline.Cnds.OnTimelineFinished),this._timelineManager.Trigger(I.Plugins.Timeline.Cnds.OnTimelineFinishedByName),this._timelineManager.Trigger(I.Plugins.Timeline.Cnds.OnTimelineFinishedByTags),this._timelineManager.Trigger(I.Plugins.Timeline.Cnds.OnAnyTimelineFinished),I.Plugins.Timeline.Cnds.PopTriggerTimeline()))}SetPlaying(e){this._isPlaying=e}IsCompletedTick(){return this._completedTick===this._runtime.GetTickCount()}IsPlaying(e=!1){return!!this.IsCompletedTick()||!(!this.IsScheduled()||e)||this._isPlaying}_IsPlaying(){return this.IsPlaying(!0)}IsPaused(){return this._IsPaused()}_IsPaused(){return!(this.IsReleased()||this.IsScheduled()||this._IsPlaying()||this.IsComplete())}SetScheduled(e){this._isScheduled=e}IsScheduled(){return this._isScheduled}SetComplete(e){this._complete=e;const t=this.GetTime();(t<=0||t>=this.GetTotalTime())&&(this._complete=!0)}IsComplete(){return this._complete}IsReleased(){return this._released}SetMarkedForRemoval(e){this._markedForRemoval=e}IsMarkedForRemoval(){return this._markedForRemoval}SetImplicitPause(e){this._implicitPause=e}IsImplicitPause(){return this._implicitPause}SetIsTemplate(e){this._isTemplate=!!e}IsTemplate(){return this._isTemplate}InitialStateSet(){return this._initialStateSet}GetTime(){return this._playheadTime}SetTime(e){const t=this.GetTime();this._SetTime(e),this.SetComplete(!1),this.IsComplete()||this.SetImplicitPause(!0),!this._IsPlaying()&&!this.IsScheduled()&&this._initialStateSet||(this._IsPlaying()||this.IsScheduled()||this._initialStateSet?this._IsPlaying()?this.Stop():this.IsScheduled()&&(this._timelineManager.DeScheduleTimeline(this),this.SetInitialStateFromSetTime()):this.SetInitialStateFromSetTime()),this._SetUpdateStateBefore(),this._Interpolate(this.GetTime(),!1,!0,!0,t),this._SetUpdateStateAfter(),this._renderChange&&this.GetRuntime().UpdateRender(),this._OnSetTime()}_SetTime(e){(e=I.IsFiniteNumber(e)?e:this.GetTotalTime())<0?this._playheadTime=0:e>=this.GetTotalTime()?this._playheadTime=this.GetTotalTime():this._playheadTime=e}_SetTimeAndReset(e){(e=I.IsFiniteNumber(e)?e:this.GetTotalTime())<0?this._playheadTime=0:e>=this.GetTotalTime()?this._playheadTime=this.GetTotalTime():this._playheadTime=e;for(const t of this._tracks)t.SetResetState()}_OnSetTime(){I.Plugins.Timeline&&this.constructor===I.TimelineState&&(I.Plugins.Timeline.Cnds.PushTriggerTimeline(this),this._timelineManager.Trigger(I.Plugins.Timeline.Cnds.OnTimeSet),this._timelineManager.Trigger(I.Plugins.Timeline.Cnds.OnTimeSetByName),this._timelineManager.Trigger(I.Plugins.Timeline.Cnds.OnTimeSetByTags),I.Plugins.Timeline.Cnds.PopTriggerTimeline())}_CanResume(){if(!this.GetLoop())if(this.GetPingPong()&&1===this._pingPongState){if(this.IsForwardPlayBack()){if(this.GetTime()>=this.GetTotalTime())return!1}else if(this.GetTime()<=0)return!1}else if(!this.GetLoop()&&!this.GetPingPong())if(this.IsForwardPlayBack()){if(this.GetTime()>=this.GetTotalTime())return!1}else if(this.GetTime()<=0)return!1;return!0}Resume(){this.IsReleased()||this._CanResume()&&this.Play(!0)}Play(e=!1){return!this.IsReleased()&&!this.IsScheduled()&&(this._IsPlaying()&&this.IsCompletedTick()?this._SchedulePlayingTimeline():!this._IsPlaying()&&!!(this.IsComplete()||e||this.IsImplicitPause())&&this._ScheduleStoppedTimeline())}_SchedulePlayingTimeline(){return this.SetImplicitPause(!1),this._timelineManager.RemovePlayingTimeline(this),this._timelineManager.ScheduleTimeline(this),this.GetPlayPromise(),!0}_ScheduleStoppedTimeline(){return this.SetImplicitPause(!1),this._timelineManager.ScheduleTimeline(this),this.GetPlayPromise(),!0}Stop(e=!1){this.IsReleased()||(this.SetComplete(e),this._timelineManager.CompleteTimeline(this),this.IsComplete()&&this.ResolvePlayPromise())}Reset(e=!0,t=!1){if(!this.IsReleased()){if(!this._IsPlaying()&&this.IsScheduled())return this._timelineManager.DeScheduleTimeline(this);if(!this.IsComplete()){this.Stop(!0),this.IsForwardPlayBack()?this._SetTime(0):this._SetTime(this.GetTotalTime());const s=this.GetTime();this._SetUpdateStateBefore(),t?this._InterpolateBeforeChangeLayout(s):this._Interpolate(s,!1,!1,!0),e&&this._OnSetTime(),this._SetUpdateStateAfter(),this._renderChange&&e&&this.GetRuntime().UpdateRender()}}}ResetBeforeChangeLayout(){this.Reset(!1,!0)}_InterpolateBeforeChangeLayout(e){this._Interpolate(e,!1,!1,!0,NaN,!1,!0)}_OnBeforeChangeLayout(){if(!this.IsReleased()){if(!this.GetRuntime().IsLoadingState()&&this.HasValidGlobalTracks())return!1;this._timelineManager.CompleteTimelineBeforeChangeOfLayout(this),this.GetRuntime().IsLoadingState()||this.ResetBeforeChangeLayout()}return!0}SetInitialStateFromSetTime(){this.SetInitialState(!0)}SetInitialStateForce(){this.SetInitialState(!1,!0),this.SetPlaying(!1),this.SetScheduled(!1)}SetInitialState(e=!1,t=!1){if(!this.IsMarkedForRemoval()||t){if(e){this._finishedTriggers=!1,this._initialStateSet=!0,this._firstTick=!0,this._SetUpdateStateBefore();for(const s of this._tracks)s.SetInitialState()}else if(this.SetPlaying(!0),this.SetScheduled(!1),this.OnStarted(),this.IsComplete()){this._completedTick=-1,0!==this._pingPongState&&(this._playbackRate=Math.abs(this._playbackRate)),this._pingPongState=0,this._currentRepeatCount=1,this._complete=!1,this._finishedTriggers=!1,this._initialStateSet=!0,this._firstTick=!0,this.IsForwardPlayBack()?this._SetTime(0):this._SetTime(this.GetTotalTime()),this._SetUpdateStateBefore();for(const i of this._tracks)i.SetInitialState()}else{this._firstTick=!0,this._finishedTriggers=!1,this._SetUpdateStateBefore();for(const r of this._tracks)r.SetResumeState()}this._SetUpdateStateAfter()}}GetRenderChange(){return this._renderChange}_SetUpdateStateBefore(){this._hasNestedContent=0;for(const e of this._tracks)e.IsNested()&&(this._hasNestedContent=1)}_SetUpdateStateAfter(){this._renderChange=0;for(const e of this._tracks)e._SetUpdateState(),0===this._renderChange&&1===e.GetRenderChange()&&(this._renderChange=1),this._beforeAndAfterTracks||1!==e.GetNeedsBeforeAndAfter()||(this._beforeAndAfterTracks||(this._beforeAndAfterTracks=[]),this._beforeAndAfterTracksLength=this._beforeAndAfterTracks.push(e))}Tick(e,t,s){if(this.GetUseSystemTimescale()){if(0===e&&0===this._lastDelta)return;this._lastDelta=e,e=s}else{if(0===s&&0===this._lastDelta)return;e=this._lastDelta=s,t=1}const i=this._playheadTime+this._overshoot,r=e*t*this._playbackRate,n=i+r,a=this._timelineDataItem._totalTime;n<0?(this._playheadTime=0,this._overshoot=-n):a<=n?(this._playheadTime=a,this._overshoot=this._playheadTime-n):(this._playheadTime=n,this._overshoot=0);let o=!1,h=!1,l=this.GetLoop(),c=this.GetPingPong();l||c?l&&!c?0<this._playbackRate?this._playheadTime>=a&&(this._SetTimeAndReset(0),h=!0):this._playheadTime<=0&&(this._SetTimeAndReset(a),h=!0):!l&&c?0<this._playbackRate?this._playheadTime>=a&&(this._SetTime(a),this.SetPlaybackRate(-1*this.GetPlaybackRate()),h=!0,1===this._pingPongState?this._currentRepeatCount<this.GetRepeatCount()?(this._currentRepeatCount++,this._pingPongState=0):o=!0:0===this._pingPongState&&(this._pingPongState=1)):this._playheadTime<=0&&(this._SetTime(0),this.SetPlaybackRate(-1*this.GetPlaybackRate()),h=!0,1===this._pingPongState?this._currentRepeatCount<this.GetRepeatCount()?(this._currentRepeatCount++,this._pingPongState=0):o=!0:0===this._pingPongState&&(this._pingPongState=1)):l&&c&&(0<this._playbackRate?this._playheadTime>=a&&(this._SetTime(a),this.SetPlaybackRate(-1*this.GetPlaybackRate()),h=!0,this._pingPongState++,I.wrap(this._pingPongState,0,2)):this._playheadTime<=0&&(this._SetTime(0),this.SetPlaybackRate(-1*this.GetPlaybackRate()),h=!0,this._pingPongState++,I.wrap(this._pingPongState,0,2))):0<this._playbackRate?this._playheadTime>=a&&(this._currentRepeatCount<this.GetRepeatCount()?(this._currentRepeatCount++,this._SetTimeAndReset(0),h=!0):(this._SetTime(a),o=!0)):this._playheadTime<=0&&(this._currentRepeatCount<this.GetRepeatCount()?(this._currentRepeatCount++,this._SetTimeAndReset(a),h=!0):(this._SetTime(0),o=!0));let u,_=this._tracksLength;if(o){for(u=0;u<_;u++)this._tracks[u].SetEndState();this.Stop(!0),this.OnCompleted()}else{const d=this._beforeAndAfterTracksLength;for(u=0;u<d;u++)this._beforeAndAfterTracks[u].BeforeInterpolate();if(1===this._hasNestedContent)for(u=0;u<_;u++){const p=this._tracks[u],f=p.GetStartOffset(),m=this._playheadTime-f,g=i-f;m<0&&0<g?(this._playheadTime=f<0?0:a<=f?a:f,p.Interpolate(f,!0,!1,h,this._firstTick,!1)):p.Interpolate(this._playheadTime,!0,!1,h,this._firstTick,!1)}else for(u=0;u<_;u++)this._tracks[u].Interpolate(this._playheadTime,!0,!1,h,this._firstTick,!1);for(u=0;u<d;u++)this._beforeAndAfterTracks[u].AfterInterpolate();this._firstTick&&(this._firstTick=!1)}}_Interpolate(t,s=!1,i=!1,r=!1,n=NaN,e=!1,a=!1){for(const o of this._tracks)o.BeforeInterpolate();for(const h of this._tracks){let e=t;if(\"number\"==typeof n&&!isNaN(n)){const l=this.GetTime(),c=l-h.GetStartOffset(),u=n-h.GetStartOffset();c<0&&0<u&&(e=h.GetStartOffset(),this._SetTime(e))}h.Interpolate(e,s,i,r,this._firstTick,a)}for(const _ of this._tracks)_.AfterInterpolate();this._firstTick&&e&&(this._firstTick=!1)}AddTrack(){const e=this._timelineDataItem.GetTrackData().AddEmptyTrackDataItem(),t=I.TrackState.Create(this,e);return this._tracksLength=this._tracks.push(t),t}Removed(){if(!this.IsReleased())for(const e of this._tracks)e.TimelineRemoved()}CleanCaches(){for(const e of this._tracks)e.CleanCaches()}ClearTrackInstances(){for(const e of this._tracks)e.ClearInstance()}SetTrackInstance(e,t,s){if(t){if(\"number\"==typeof s&&0<=s){const i=this._tracks[s];return i?(i.SetInstance(t),void this._timelineManager.SetTimelineObjectClassToMap(t.GetObjectClass(),this)):void 0}for(const r of this._tracks)if(r.IsInstanceTrack())if(e){if(r.GetId()===e){r.SetInstance(t),this._timelineManager.SetTimelineObjectClassToMap(t.GetObjectClass(),this);break}}else if(!r.HasInstance()){r.SetInstance(t),this._timelineManager.SetTimelineObjectClassToMap(t.GetObjectClass(),this);break}}}HasTrackInstance(e,t){for(const s of this._tracks)if(s.IsInstanceTrack())if(t){if(t===s.GetId()&&e===s.GetInstance())return!0}else if(e===s.GetInstance())return!0;return!1}HasValidTracks(){return this._tracks.some(e=>!e.IsInstanceTrack()||e.CanInstanceBeValid())}HasValidGlobalTracks(){return this._tracks.some(e=>{if(e.IsInstanceTrack()){if(!e.CanInstanceBeValid())return!1;const t=e.GetObjectClass();return!!t&&t.IsGlobal()}return!1})}GetPropertyTrack(e){for(const t of this.GetTracks())for(const s of t.GetPropertyTracks())if(s.GetPropertyName()===e)return s}GetTrackFromInstance(e){for(const t of this._tracks)if(e===t.GetInstance())return t;return null}GetKeyframeWithTags(e){let t=e?e.split(\" \"):[],s=new Set(t.map(e=>e.toLowerCase().trim()));t=[...s.values()];for(const i of this.GetTracks())for(const r of i.GetKeyframeDataItems()){const n=t.every(e=>r.HasTag(e));if(n)return r}}GetObjectClasses(){const e=[];for(const t of this.GetTracks())e.push(t.GetObjectClass());return e.filter(e=>e)}_OnAfterLoad(){for(const e of this.GetTracks())e._OnAfterLoad()}_SaveToJson(){return{tracksJson:this._SaveTracksToJson(),name:this._name,playheadTime:this.GetTime(),playbackRate:this._playbackRate,pingPongState:this._pingPongState,currentRepeatCount:this._currentRepeatCount,isPlaying:this._isPlaying,isScheduled:this._isScheduled,initialStateSet:this._initialStateSet,finishedTriggers:this._finishedTriggers,complete:this._complete,released:this._released,markedForRemoval:this._markedForRemoval,completedTick:this._completedTick,implicitPause:this._implicitPause,isTemplate:this._isTemplate,tags:this._tags.join(\" \"),stringTags:this._stringTags,tagsChanged:this._tagsChanged,firstTick:this._firstTick}}_LoadFromJson(e){e&&(this._LoadTracksFromJson(e.tracksJson),this._name=e.name,this._playheadTime=e.playheadTime,this._playbackRate=e.playbackRate,this._pingPongState=e.pingPongState,this._currentRepeatCount=e.currentRepeatCount,this._isPlaying=!!e.isPlaying,this._isScheduled=!!e.isScheduled,this._initialStateSet=!!e.initialStateSet,this._finishedTriggers=!!e.hasOwnProperty(\"finishedTriggers\")&&!!e.finishedTriggers,this._complete=!!e.complete,this._released=!!e.released,this._markedForRemoval=!!e.markedForRemoval,this._completedTick=e.completedTick,this._implicitPause=!!e.implicitPause,this._isTemplate=!!e.isTemplate,this._tags=e.tags.split(\" \"),this._stringTags=e.stringTags,this._tagsChanged=!!e.tagsChanged,this._firstTick=!!e.firstTick)}_SaveTracksToJson(){return this._tracks.map(e=>e._SaveToJson())}_LoadTracksFromJson(e){this.ClearTrackInstances(),e.forEach((e,t)=>{const s=this._tracks[t];s._LoadFromJson(e)}),this._tracks.filter(e=>e.CanInstanceBeValid())}static _HasTag(e){const t=this.GetTags();return\"\"===e?1===t.length&&\"\"===t[0]:t.map(e=>e.toLowerCase()).includes(e.toLowerCase())}static _GetTagArray(e){if(I.IsArray(e))return e.slice(0);if(I.IsString(e))return e.split(\" \");throw new Error(\"invalid tags\")}GetITimelineState(){return this._iTimelineState||(this._iTimelineState=I.New(self.ITimelineState,this)),this._iTimelineState}}}{const kn=self.C3;kn.TrackState=class extends kn.DefendedBase{constructor(e,t){super(),this._timeline=e,this._trackDataItem=t,this._trackData=t.GetTrackData(),this._instanceUid=NaN,this._objectClassIndex=NaN,this._instance=null,this._worldInfo=null,this._cleared=!1,this._isNested=0<t.GetStartOffset(),this._initialStateOfNestedSet=!1,this._endStateOfNestedSet=!1,this._instanceUidToLoad=NaN,this._lastKeyframeDataItem=null,this._keyframeDataItems=this._trackDataItem.GetKeyframeData().GetKeyframeDataItemArray(),this._propertyTracks=[],this.CreatePropertyTrackStates(),this._worldInfoChange=0,this._renderChange=0,this._needsBeforeAndAfter=0}static Create(e,t){return kn.New(kn.TrackState,e,t)}Release(){this._keyframeDataItems=null;for(const e of this._propertyTracks)e.Release();kn.clearArray(this._propertyTracks),this._propertyTracks=null,this._timeline=null,this._instance=null,this._worldInfo=null,this._trackDataItem=null,this._lastKeyframeDataItem=null}CreatePropertyTrackStates(){for(const e of this._trackDataItem.GetPropertyTrackData().propertyTrackDataItems())this._propertyTracks.push(kn.PropertyTrackState.Create(this,e))}TimelineRemoved(){for(const e of this._propertyTracks)e.TimelineRemoved()}CleanCaches(){for(const e of this._propertyTracks)e.CleanCaches();this._instance=null,this._worldInfo=null}GetTimeline(){return this._timeline}GetRuntime(){return this._timeline.GetRuntime()}GetKeyframeDataItems(){return this._keyframeDataItems||(this._keyframeDataItems=this._trackDataItem.GetKeyframeData().GetKeyframeDataItemArray()),this._keyframeDataItems}GetPropertyTracks(){return this._propertyTracks}GetPropertyTrack(t){for(let e=0;e<this._propertyTracks.length;e++){const s=this._propertyTracks[e];if(s.GetPropertyName()===t)return s}}MaybeGetInstance(){this._instance||this.GetInstance()}IsInstanceValid(){return!!this._instance&&!this._instance.IsDestroyed()}CanInstanceBeValid(){if(!this.IsInstanceTrack())return!1;const e=this.GetInstanceUID(),t=this.GetRuntime().GetInstanceByUID(e);return!!t&&!t.IsDestroyed()}GetObjectClass(){if(this.IsInstanceTrack()){const e=this.GetObjectClassIndex();if(-1!==e)return this.GetRuntime().GetObjectClassByIndex(e)}}GetTrackIndexInTimeline(){return this._timeline.GetTracks().indexOf(this)}ClearInstance(){this._instance=null,this._instanceUid=NaN,this._worldInfo=null,this._objectClassIndex=NaN,this._cleared=!0}HasInstance(){return!!this._instance}GetInstance(){if(!this._cleared){if(!this._instance||!this.IsInstanceValid()){const e=this.GetInstanceUID();this._instance=this.GetRuntime().GetInstanceByUID(e)}return this._instance}}SetInstance(e){if(this._cleared=!1,this._instance!==e){this.CleanCaches(),this._instance=e,this._objectClassIndex=e.GetObjectClass().GetIndex(),this._instanceUid=e.GetUID(),this._worldInfo=e.GetWorldInfo();for(const t of this.propertyTrackItems()){const s=t.propertyTrack,i=t.sourceAdapter,r=s.GetSourceAdapterId();switch(r){case\"instance-variable\":{i.GetEditorIndex();const n=e.GetObjectClass(),a=n.GetInstanceVariableIndexByName(t.name),o=n.GetInstanceVariableName(a),h=n.GetInstanceVariableType(a);o===t.name&&h===t.type&&i.UpdateInstanceVariableIndex(a);break}case\"behavior\":{const l=t.behaviorType,c=this.GetObjectClass(),u=e.GetObjectClass(),_=i.GetBehaviorType(u);if(l&&_){const d=l.GetName();c.GetBehaviorIndexByName(d),u.GetBehaviorIndexByName(d),i.GetEditorIndex(),i.UpdateBehaviorTypeSid(_.GetSID())}break}}}}}*propertyTrackItems(){for(const e of this._propertyTracks){const t=e.GetSourceAdapter(),s=this.GetObjectClass(),i={propertyTrack:e,sourceAdapter:t};switch(e.GetSourceAdapterId()){case\"world-instance\":i.property=e.GetPropertyName();break;case\"instance-variable\":{const r=t.GetEditorIndex();i.name=s.GetInstanceVariableName(r),i.type=s.GetInstanceVariableType(r);break}case\"effect\":{const n=s.GetEffectList(),a=t.GetEffectType(n);i.effectType=a;break}case\"behavior\":{const o=t.GetBehaviorType(s);i.behaviorType=o;break}case\"plugin\":i.plugin=s.GetPlugin()}yield i}}GetWorldInfo(){if(!this._worldInfo||!this.IsInstanceValid()){const e=this.GetInstance();e&&(this._worldInfo=e.GetWorldInfo())}return this._worldInfo}GetTrackDataItem(){return this._trackDataItem}GetInstanceUID(){return isNaN(this._instanceUid)?this._trackDataItem.GetInstanceUID():this._instanceUid}SetInstanceUID(e){this._trackDataItem.SetInstanceUID(e)}GetInterpolationMode(){return this._trackDataItem.GetInterpolationMode()}SetInterpolationMode(e){this._trackDataItem.SetInterpolationMode(e)}GetResultMode(){return this._trackDataItem.GetResultMode()}GetId(){return this._trackDataItem.GetId()}GetStartOffset(){return this._trackDataItem.GetStartOffset()}GetLocalTotalTime(){return this._trackDataItem.GetLocalTotalTime()}SetLocalTotalTime(e){this._trackDataItem.SetLocalTotalTime(e)}SetResultMode(e){this._trackDataItem.SetResultMode(e)}SetEase(e){for(const t of this.GetKeyframeDataItems())t.SetEase(e);for(const s of this.GetPropertyTracks())s.SetEase(e)}GetEnable(){return this._trackDataItem.GetEnable()}SetEnable(e){this._trackDataItem.SetEnable(e)}GetObjectClassIndex(){return isNaN(this._objectClassIndex)?this._trackDataItem.GetObjectClassIndex():this._objectClassIndex}SetObjectClassIndex(e){this._trackDataItem.SetObjectClassIndex(e)}SetOriginalWidth(e){this._trackDataItem.SetOriginalWidth(e)}GetOriginalWidth(){const e=this.GetInstance();if(e){const t=e.GetSdkInstance();if(t.IsOriginalSizeKnown())return e.GetSdkInstance().GetOriginalWidth()}return this._trackDataItem.GetOriginalWidth()}SetOriginalHeight(e){this._trackDataItem.SetOriginalHeight(e)}GetOriginalHeight(){const e=this.GetInstance();if(e){const t=e.GetSdkInstance();if(t.IsOriginalSizeKnown())return e.GetSdkInstance().GetOriginalHeight()}return this._trackDataItem.GetOriginalHeight()}GetType(){return this._trackDataItem.GetType()}GetName(){return this._trackDataItem.GetName()}IsInstanceTrack(){return 0===this.GetType()}IsValueTrack(){return 1===this.GetType()}IsAudioTrack(){return 2===this.GetType()}GetWorldInfoChange(){return this._worldInfoChange}GetRenderChange(){return this._renderChange}GetNeedsBeforeAndAfter(){return this._needsBeforeAndAfter}IsNested(){return this._isNested}SetResetState(){for(const e of this._propertyTracks)e.SetResetState()}SetInitialState(){if(this.MaybeGetInstance(),this.IsInstanceValid()||!this.IsInstanceTrack()){const e=this.GetTimeline(),t=e.IsForwardPlayBack(),s=t?0:this.GetLocalTotalTime();for(const r of this._propertyTracks)r.SetInitialState(s),0===this._worldInfoChange&&1===r.GetWorldInfoChange()&&(this._worldInfoChange=1),0===this._renderChange&&1===r.GetRenderChange()&&(this._renderChange=1);this._needsBeforeAndAfter=0;const i=this._propertyTracks.some(e=>e.GetNeedsBeforeAndAfter());i&&(this._needsBeforeAndAfter=1),this._lastKeyframeDataItem=this._GetLastKeyFrameBeforeTime(s),this._initialStateOfNestedSet=!1,this._endStateOfNestedSet=!1,this.Interpolate(s),this.OnKeyframeReached(this._GetLastKeyFrameBeforeTime(s))}}SetResumeState(){if(this.MaybeGetInstance(),this.IsInstanceValid()||!this.IsInstanceTrack()){this._timeline.IsForwardPlayBack();const e=this._timeline.GetTime()-this.GetStartOffset();this._lastKeyframeDataItem=this._GetLastKeyFrameBeforeTime(e);for(const t of this._propertyTracks)t.SetResumeState(e)}}SetEndState(){if(!this.GetTimeline().IsComplete()&&(this.MaybeGetInstance(),this.IsInstanceValid()||!this.IsInstanceTrack())&&!this._isNested){const e=this._timeline.GetTime(),t=this.GetStartOffset()+this.GetLocalTotalTime();t<=e?this.Interpolate(this.GetLocalTotalTime(),!0,!1,!0,!1,!1,!0):e<=0&&this.Interpolate(0,!0,!1,!0,!1,!1,!0)}}_SetUpdateState(){for(let e=0,t=this._propertyTracks.length;e<t;e++){const s=this._propertyTracks[e];s._SetUpdateState(),0===this._worldInfoChange&&1===s.GetWorldInfoChange()&&(this._worldInfoChange=1),0===this._renderChange&&1===s.GetRenderChange()&&(this._renderChange=1)}}BeforeInterpolate(){const t=this._propertyTracks.length;for(let e=0;e<t;e++)this._propertyTracks[e].BeforeInterpolate()}Interpolate(s,e=!1,i=!1,r=!1,t=!1,n=!1,a=!1){this._instance||this.GetInstance();const o=this._instance&&!this._instance.IsDestroyed(),h=0===this._trackDataItem._type;if((o||!h)&&!(n&&h&&this.GetObjectClass().IsGlobal()||(s-=this.GetStartOffset())<0)){this.MaybeSetInitialStateOfNestedTrack(s,e),this.MaybeTriggerKeyframeReachedConditions(s,e,t);for(let e=0,t=this._propertyTracks.length;e<t;e++)this._propertyTracks[e].Interpolate(s,i,r,a);this.MaybeSetEndStateOfNestedTrack(s,e),0!==this._worldInfoChange&&(this._worldInfo||(this._worldInfo=this._instance.GetWorldInfo()),this._worldInfo)&&this._worldInfo.SetBboxChanged()}}AfterInterpolate(){const t=this._propertyTracks.length;for(let e=0;e<t;e++)this._propertyTracks[e].AfterInterpolate()}MaybeSetInitialStateOfNestedTrack(e,t){if(t&&this._isNested&&!this._initialStateOfNestedSet){const s=this.GetTimeline();if(s.IsForwardPlayBack()){if(e<0)return}else if(e>this.GetLocalTotalTime())return;for(const i of this._propertyTracks)i.SetInitialState();this._initialStateOfNestedSet=!0}}MaybeSetEndStateOfNestedTrack(e,t){if(t&&this._isNested&&!this._endStateOfNestedSet){const s=this.GetTimeline();if(s.IsForwardPlayBack()){if(e>=this.GetLocalTotalTime()){for(const i of this._propertyTracks)i.Interpolate(this.GetLocalTotalTime(),!1,!0);this._endStateOfNestedSet=!0}}else if(e<=0){for(const r of this._propertyTracks)r.Interpolate(0,!1,!0);this._endStateOfNestedSet=!0}}}MaybeTriggerKeyframeReachedConditions(e,t,s){if(!s&&t&&kn.Plugins.Timeline){const i=this.GetTimeline(),r=this._lastKeyframeDataItem.GetNext(),n=this._lastKeyframeDataItem.GetTime(),a=r?r.GetTime():i.GetTotalTime();if(e<=n||a<=e)if(this._lastKeyframeDataItem=this._trackData.GetFirstKeyFrameDataItemLowerOrEqualThan(e,this._trackDataItem),i.IsForwardPlayBack())r&&this.OnKeyframeReached(this._lastKeyframeDataItem);else{const o=this._lastKeyframeDataItem.GetNext();o&&this.OnKeyframeReached(o)}}}_GetLastKeyFrameBeforeTime(e){const t=this._trackData.GetKeyFrameDataItemAtTime(e,this._trackDataItem);return t||this._trackData.GetFirstKeyFrameDataItemLowerOrEqualThan(e,this._trackDataItem)}OnKeyframeReached(e){if(kn.Plugins.Timeline){const t=this.GetTimeline(),s=t.GetTimelineManager();kn.Plugins.Timeline.Cnds.PushTriggerTimeline(t),kn.Plugins.Timeline.Cnds.PushTriggerKeyframe(e),s.Trigger(kn.Plugins.Timeline.Cnds.OnAnyKeyframeReached),s.Trigger(kn.Plugins.Timeline.Cnds.OnKeyframeReached),kn.Plugins.Timeline.Cnds.PopTriggerTimeline(t),kn.Plugins.Timeline.Cnds.PopTriggerKeyframe(e)}}AddKeyframe(){const e=this._trackDataItem.GetKeyframeData(),t=e.AddEmptyKeyframeDataItem();return t}AddPropertyTrack(){const e=this._trackDataItem.GetPropertyTrackData(),t=e.AddEmptyPropertyTrackDataItem(),s=kn.PropertyTrackState.Create(this,t);return this._propertyTracks.push(s),s}DeleteKeyframes(e){const t=this._trackDataItem.GetKeyframeData();t.DeleteKeyframeDataItems(e)}DeletePropertyKeyframes(e){for(const t of this._propertyTracks)t.DeletePropertyKeyframes(e)}SaveState(){for(const e of this._propertyTracks)e.SaveState()}CompareInitialStateWithCurrent(){if(this.MaybeGetInstance(),this.IsInstanceValid()||!this.IsInstanceTrack())for(const e of this._propertyTracks)e.CompareInitialStateWithCurrent()}CompareSaveStateWithCurrent(){if(this.MaybeGetInstance(),this.IsInstanceValid()||!this.IsInstanceTrack()){let e=!1;for(const t of this._propertyTracks){const s=t.CompareSaveStateWithCurrent();!e&&s&&(e=!0)}if(e){const i=this.AddKeyframe();i.SetTime(this.GetTimeline().GetTime()),i.SetEase(\"noease\"),i.SetEnable(!0),i.SetTags(\"\")}}}_OnAfterLoad(){isNaN(this._instanceUidToLoad)||this._LoadInstanceFromJson(this._instanceUidToLoad),this._instanceUidToLoad=NaN}_SaveToJson(){const e=this.GetInstance(),t=e?e.GetUID():this.GetInstanceUID();return{propertyTracksJson:this._SavePropertyTracksToJson(),lastKeyframeDataItemJson:this._SaveLastKeyframeDataItemToJson(),initialStateOfNestedSet:this._initialStateOfNestedSet,endStateOfNestedSet:this._endStateOfNestedSet,instanceUid:t,cleared:this._cleared}}_LoadFromJson(e){if(e){this._LoadPropertyTracksFromJson(e.propertyTracksJson),this._LoadLastKeyframeDataItemFromJson(e.lastKeyframeDataItemJson),this._instanceUidToLoad=e.instanceUid,this._initialStateOfNestedSet=!1,e.hasOwnProperty.initialStateOfNestedSet&&(this._initialStateOfNestedSet=e.initialStateOfNestedSet),this._endStateOfNestedSet=!1,e.hasOwnProperty.endStateOfNestedSet&&(this._endStateOfNestedSet=e.endStateOfNestedSet),this._cleared=!!e.hasOwnProperty(\"cleared\")&&e.cleared;for(const t of this._propertyTracks)0===this._worldInfoChange&&1===t.GetWorldInfoChange()&&(this._worldInfoChange=1),0===this._renderChange&&1===t.GetRenderChange()&&(this._renderChange=1);this._needsBeforeAndAfter=0,this._propertyTracks.some(e=>e.GetNeedsBeforeAndAfter())&&(this._needsBeforeAndAfter=1)}}_SaveLastKeyframeDataItemToJson(){const e=this._trackDataItem.GetKeyframeData();return e.GetKeyframeDataItemIndex(this._lastKeyframeDataItem)}_SavePropertyTracksToJson(){return this._propertyTracks.map(e=>e._SaveToJson())}_LoadPropertyTracksFromJson(e){e.forEach((e,t)=>{const s=this._propertyTracks[t];s._LoadFromJson(e)})}_LoadInstanceFromJson(e){if(kn.IsFiniteNumber(e)){const t=this.GetRuntime().GetInstanceByUID(e);if(t){const s=this.GetTimeline();s.SetTrackInstance(this._trackDataItem.GetId(),t,this.GetTrackIndexInTimeline())}}}_LoadLastKeyframeDataItemFromJson(e){const t=this._trackDataItem.GetKeyframeData();this._lastKeyframeDataItem=t.GetKeyframeDataItemFromIndex(e)}}}{const Nn=self.C3;Nn.PropertyTrackState=class extends Nn.DefendedBase{constructor(e,t){super(),this._track=e,this._propertyTrackDataItem=t,this._propertyTrackData=t.GetPropertyTrackData(),this._worldInfoChange=0,this._renderChange=0,this._needsBeforeAndAfter=0,this._sourceAdapter=this.GetSourceAdapter(),this._propertyKeyframeDataItems=this._propertyTrackDataItem.GetPropertyKeyframeData().GetPropertyKeyframeDataItemArray(),this._lastPropertyKeyframeDataItem=null,this._absoluteValueObject=null}static Create(e,t){return Nn.New(Nn.PropertyTrackState,e,t)}Release(){this._track=null,this._sourceAdapter&&(this._sourceAdapter.Release(),this._sourceAdapter=null),this._propertyKeyframeDataItems=null,this._propertyTrackDataItem=null,this._propertyTrackData=null}GetWorldInfoChange(){return this._worldInfoChange}GetRenderChange(){return this._renderChange}GetNeedsBeforeAndAfter(){return this._needsBeforeAndAfter}HasAbsoluteValueObject(){return!!this._absoluteValueObject}SetAbsoluteValueObject(e){this._absoluteValueObject=e}GetAbsoluteValueObject(){return this._absoluteValueObject}GetTrack(){return this._track}GetPropertyTrackDataItem(){return this._propertyTrackDataItem}GetPropertyTrackData(){return this._propertyTrackData}GetTimeline(){return this._track.GetTimeline()}GetRuntime(){return this._track.GetRuntime()}GetInstance(){return this._track.GetInstance()}GetSourceAdapter(){if(!this._sourceAdapter){let e=this._propertyTrackDataItem.GetSourceAdapterId(),t;switch(e){case\"behavior\":t=new Nn.PropertyTrackState.BehaviorSourceAdapter(this);break;case\"effect\":t=new Nn.PropertyTrackState.EffectSourceAdapter(this),this._renderChange=1;break;case\"instance-variable\":t=new Nn.PropertyTrackState.InstanceVariableSourceAdapter(this);break;case\"plugin\":t=new Nn.PropertyTrackState.PluginSourceAdapter(this),this._renderChange=1;break;case\"world-instance\":t=new Nn.PropertyTrackState.PropertySourceAdapter(this),this._renderChange=1,this._worldInfoChange=1;break;case\"value\":t=new Nn.PropertyTrackState.ValueSourceAdapter(this);break;case\"audio\":t=new Nn.PropertyTrackState.AudioSourceAdapter(this)}this._sourceAdapter=t}return this._sourceAdapter}GetSourceAdapterId(){return this._propertyTrackDataItem.GetSourceAdapterId()}SetSourceAdapterId(e){this._propertyTrackDataItem.SetSourceAdapterId(e)}GetSourceAdapterArgs(){return this._propertyTrackDataItem.GetSourceAdapterArguments()}SetSourceAdapterArgs(e){this._propertyTrackDataItem.SetSourceAdapterArguments(e)}GetSourceAdapterValue(){return this.GetSourceAdapter().GetValue()}GetPropertyName(){return this._propertyTrackDataItem.GetProperty()}SetPropertyName(e){this._propertyTrackDataItem.SetProperty(e)}GetPropertyType(){return this._propertyTrackDataItem.GetType()}SetPropertyType(e){this._propertyTrackDataItem.SetType(e)}GetPropertyKeyframeType(){return this.GetPropertyTrackData().GetFirstPropertyKeyframeDataItem(this._propertyTrackDataItem).GetType()}GetMin(){return this._propertyTrackDataItem.GetMin()}SetMin(e){this._propertyTrackDataItem.SetMin(e)}GetMax(){return this._propertyTrackDataItem.GetMax()}SetMax(e){this._propertyTrackDataItem.SetMax(e)}GetEnable(){return this._propertyTrackDataItem.GetEnable()}SetEnable(e){this._propertyTrackDataItem.SetEnable(e)}GetInterpolationMode(){return this._propertyTrackDataItem.GetInterpolationMode()}SetInterpolationMode(e){this._propertyTrackDataItem.SetInterpolationMode(e)}GetResultMode(){return this._propertyTrackDataItem.GetResultMode()}SetResultMode(e){this._propertyTrackDataItem.SetResultMode(e)}SetEase(e){for(const t of this.GetPropertyKeyframeDataItems())t.SetEase(e)}CanHavePropertyKeyframes(){return this._propertyTrackDataItem.CanHavePropertyKeyframes()}GetPropertyKeyframeDataItems(){return this._propertyKeyframeDataItems||(this._propertyKeyframeDataItems=this._propertyTrackDataItem.GetPropertyKeyframeData().GetPropertyKeyframeDataItemArray()),this._propertyKeyframeDataItems}GetPropertyKeyframeDataItemArrayIncludingDisabled(){return this._propertyTrackDataItem.GetPropertyKeyframeData().GetPropertyKeyframeDataItemArrayIncludingDisabled()}GetPropertyKeyFrameDataItemAtTime(e){return this._propertyTrackData.GetPropertyKeyFrameDataItemAtTime(e,this._propertyTrackDataItem)}GetFirstPropertyKeyFrameDataItemLowerOrEqualThan(e){return this._propertyTrackData.GetFirstPropertyKeyFrameDataItemLowerOrEqualThan(e,this._propertyTrackDataItem)}GetPropertyKeyframeDataItemPairForTime(e){let t=this._propertyTrackData.GetPropertyKeyFrameDataItemAtTime(e,this._propertyTrackDataItem),s;return s=t?this._propertyTrackData.GetFirstPropertyKeyFrameDataItemHigherThan(e,this._propertyTrackDataItem):(t=this._propertyTrackData.GetFirstPropertyKeyFrameDataItemLowerOrEqualThan(e,this._propertyTrackDataItem),this._propertyTrackData.GetFirstPropertyKeyFrameDataItemHigherOrEqualThan(e,this._propertyTrackDataItem)),{start:t,end:s}}*GetPropertyKeyframeValues(){for(const e of this.GetPropertyKeyframeDataItems())yield e.GetValueWithResultMode()}*GetPropertyKeyframeTimes(){for(const e of this.GetPropertyKeyframeDataItems())yield e.GetTime()}TimelineRemoved(){this.GetSourceAdapter().TimelineRemoved()}CleanCaches(){this.GetSourceAdapter().CleanCaches()}GetCurrentState(){return this.GetSourceAdapter().GetCurrentState()}SetResetState(){this.GetSourceAdapter().SetResetState()}SetInitialState(e){this.GetSourceAdapter().SetInitialState(),this._lastPropertyKeyframeDataItem=this._GetLastPropertyKeyFrameBeforeTime(e),this._SetUpdateState()}SetResumeState(e){this.GetSourceAdapter().SetResumeState(),this._lastPropertyKeyframeDataItem=this._GetLastPropertyKeyFrameBeforeTime(e)}_SetUpdateState(){const e=this.GetTrack();if(this._needsBeforeAndAfter=0,e.IsInstanceTrack()){const t=this.GetTimeline(),s=e.GetInstance(),i=this.GetSourceAdapter(),r=this.GetPropertyName(),n=i.MayNeedBeforeAndAfterInterpolate();if(n){const a=t.GetSimilarPropertyTracks(s,i,r,this);a&&a.length&&(this._needsBeforeAndAfter=1)}else this._needsBeforeAndAfter=0}}_GetLastPropertyKeyFrameBeforeTime(e){const t=this.GetTimeline(),s=this._propertyTrackData.GetPropertyKeyFrameDataItemAtTime(e,this._propertyTrackDataItem);return s||(t.IsForwardPlayBack()?this._propertyTrackData.GetFirstPropertyKeyFrameDataItemLowerOrEqualThan(e,this._propertyTrackDataItem):this._propertyTrackData.GetFirstPropertyKeyFrameDataItemHigherOrEqualThan(e,this._propertyTrackDataItem))}BeforeInterpolate(){this._sourceAdapter.BeforeInterpolate()}Interpolate(e,t=!1,s=!1,i=!1){let r,n,a=!1;if(t)r=this._propertyTrackData.GetFirstPropertyKeyFrameDataItemLowerOrEqualThan(e,this._propertyTrackDataItem);else{if(this._lastPropertyKeyframeDataItem){const o=this.GetTimeline(),h=this._lastPropertyKeyframeDataItem.GetNext(),l=this._lastPropertyKeyframeDataItem.GetTime(),c=h?h.GetTime():o.GetTotalTime();(e<=l||c<=e)&&(this._lastPropertyKeyframeDataItem=this._propertyTrackData.GetFirstPropertyKeyFrameDataItemLowerOrEqualThan(e,this._propertyTrackDataItem),a=!0)}else this._lastPropertyKeyframeDataItem=this._propertyTrackData.GetFirstPropertyKeyFrameDataItemLowerOrEqualThan(e,this._propertyTrackDataItem),a=!0;r=this._lastPropertyKeyframeDataItem}r&&(n=r.GetNext()),this._sourceAdapter.Interpolate(e,r,n,t,s,i,a)}GetInterpolatedValue(e){if(this._lastPropertyKeyframeDataItem){const i=this.GetTimeline(),r=this._lastPropertyKeyframeDataItem.GetNext(),n=this._lastPropertyKeyframeDataItem.GetTime(),a=r?r.GetTime():i.GetTotalTime();(e<=n||a<=e)&&(this._lastPropertyKeyframeDataItem=this._propertyTrackData.GetFirstPropertyKeyFrameDataItemLowerOrEqualThan(e,this._propertyTrackDataItem))}else this._lastPropertyKeyframeDataItem=this._propertyTrackData.GetFirstPropertyKeyFrameDataItemLowerOrEqualThan(e,this._propertyTrackDataItem);const t=this._lastPropertyKeyframeDataItem,s=t.GetNext();return this._sourceAdapter.GetInterpolatedValue(e,t,s)}GetInterpolatedValueFast(e,t,s){return this._sourceAdapter.GetInterpolatedValue(e,t,s)}AfterInterpolate(){this._sourceAdapter.AfterInterpolate()}static GetStartPropertyKeyframeForTime(e,t){const s=t.GetPropertyTrackDataItem(),i=t._propertyTrackData;return i.GetFirstPropertyKeyFrameDataItemLowerOrEqualThan(e,s)}static GetEndPropertyKeyframeForTime(e,t){const s=t.GetPropertyTrackDataItem(),i=t._propertyTrackData;return i.GetFirstPropertyKeyFrameDataItemHigherOrEqualThan(e,s)}AddPropertyKeyframe(){const e=this._propertyTrackDataItem.GetPropertyKeyframeData(),t=e.AddEmptyPropertyKeyframeDataItem();return this._lastPropertyKeyframeDataItem=null,t}DeletePropertyKeyframes(e){this._lastPropertyKeyframeDataItem=null;const t=this._propertyTrackDataItem.GetPropertyKeyframeData();t.DeletePropertyKeyframeDataItems(e)}SaveState(){this.GetSourceAdapter().SaveState()}CompareInitialStateWithCurrent(){const e=this.GetSourceAdapter().CompareInitialStateWithCurrent();if(e){const t=this._propertyTrackData.GetFirstPropertyKeyframeDataItem(this._propertyTrackDataItem),s=this.GetSourceAdapter().GetCurrentState();t.SetAbsoluteValue(s)}}CompareSaveStateWithCurrent(){const e=this.GetSourceAdapter().CompareSaveStateWithCurrent();return e&&this.AddPropertyKeyframeAtCurrentTime(),this.GetSourceAdapter().ClearSaveState(),e}AddPropertyKeyframeAtCurrentTime(){const e=this.GetTimeline().GetTime(),t=this.GetSourceAdapter(),s=Nn.PropertyTrackState.GetStartPropertyKeyframeForTime(e,this),i=this.AddPropertyKeyframe();i.SetType(s.GetType()),i.SetTime(e),i.SetEase(s.GetEase()),i.SetEnable(!0),i.SetValue(t.GetValueAtTime()),i.SetAbsoluteValue(t.GetCurrentState())}_SaveToJson(){return{sourceAdapterJson:this.GetSourceAdapter()._SaveToJson()}}_LoadFromJson(e){e&&this.GetSourceAdapter()._LoadFromJson(e.sourceAdapterJson)}}}{const Wn=self.C3,Vn=Wn.PropertyTrackState;Vn.PropertySourceAdapter=class{constructor(e){this._propertyTrack=e,this._propertyAdapter=null,this.GetPropertyAdapter()}Release(){this._propertyAdapter&&(this._propertyAdapter.Release(),this._propertyAdapter=null),this._propertyTrack=null}MayNeedBeforeAndAfterInterpolate(){return this._propertyAdapter.MayNeedBeforeAndAfterInterpolate()}GetPropertyTrack(){return this._propertyTrack}TimelineRemoved(){this._propertyAdapter&&this._propertyAdapter.TimelineRemoved()}CleanCaches(){this._propertyAdapter&&this._propertyAdapter.CleanCaches()}GetPropertyAdapter(){return this._propertyAdapter||(this._propertyAdapter=this._CreatePropertyAdapter()),this._propertyAdapter}GetEditorIndex(){}GetIndex(){return this.GetEditorIndex()}GetTarget(){}SetResetState(){this.GetPropertyAdapter().SetResetState()}SetInitialState(){this.GetPropertyAdapter().SetInitialState()}SetResumeState(){this.GetPropertyAdapter().SetResumeState()}BeforeInterpolate(){this._propertyAdapter.BeforeChangeProperty()}Interpolate(e,t,s,i,r,n,a){let o=this._propertyTrack.GetPropertyKeyframeType(),h;switch(o){case\"numeric\":h=Vn.NumericTypeAdapter.Interpolate(e,t,s,this._propertyTrack);break;case\"angle\":h=Vn.AngleTypeAdapter.Interpolate(e,t,s,this._propertyTrack);break;case\"boolean\":h=Vn.BooleanTypeAdapter.Interpolate(e,t,s,this._propertyTrack);break;case\"color\":h=Vn.ColorTypeAdapter.Interpolate(e,t,s,this._propertyTrack);break;case\"text\":h=Vn.TextTypeAdapter.Interpolate(e,t,s,this._propertyTrack)}this._propertyAdapter.ChangeProperty(e,h,t,s,i,r,n,a)}GetInterpolatedValue(e,t,s){switch(this._propertyTrack.GetPropertyKeyframeType()){case\"numeric\":return Vn.NumericTypeAdapter.Interpolate(e,t,s,this._propertyTrack);case\"angle\":return Vn.AngleTypeAdapter.Interpolate(e,t,s,this._propertyTrack);case\"boolean\":return Vn.BooleanTypeAdapter.Interpolate(e,t,s,this._propertyTrack);case\"color\":return Vn.ColorTypeAdapter.Interpolate(e,t,s,this._propertyTrack);case\"text\":return Vn.TextTypeAdapter.Interpolate(e,t,s,this._propertyTrack)}}AfterInterpolate(){this._propertyAdapter.AfterChangeProperty()}SaveState(){this.GetPropertyAdapter().SetSaveState()}ClearSaveState(){this.GetPropertyAdapter().ClearSaveState()}GetCurrentState(){return this.GetPropertyAdapter().GetCurrentState()}CompareInitialStateWithCurrent(){return this.GetPropertyAdapter().CompareInitialStateWithCurrent()}CompareSaveStateWithCurrent(){return this.GetPropertyAdapter().CompareSaveStateWithCurrent()}GetValueAtTime(){const e=this._propertyTrack,t=e.GetTrack(),s=t.GetTimeline().GetTime(),i=Vn.GetStartPropertyKeyframeForTime(s,e),r=i.GetNext(),n=e.GetPropertyKeyframeType();switch(n){case\"numeric\":return Vn.NumericTypeAdapter.Interpolate(s,i,r,e);case\"angle\":return Vn.AngleTypeAdapter.Interpolate(s,i,r,e);case\"boolean\":return Vn.BooleanTypeAdapter.Interpolate(s,i,r,e);case\"color\":return Vn.ColorTypeAdapter.Interpolate(s,i,r,e);case\"text\":return Vn.TextTypeAdapter.Interpolate(s,i,r,e)}}_CreatePropertyAdapter(){const e=this._propertyTrack,t=e.CanHavePropertyKeyframes()?e.GetPropertyKeyframeType():\"\";switch(t){case\"combo\":case\"boolean\":case\"text\":case\"string\":return new Vn.PropertyInterpolationAdapter.NoInterpolationAdapter(this);case\"numeric\":case\"number\":case\"angle\":return new(\"combo\"===this._propertyTrack.GetPropertyType()?Vn.PropertyInterpolationAdapter.NoInterpolationAdapter:Vn.PropertyInterpolationAdapter.NumericInterpolationAdapter)(this);case\"color\":case\"offsetColor\":return new Vn.PropertyInterpolationAdapter.ColorInterpolationAdapter(this);default:return new Vn.PropertyInterpolationAdapter.NumericInterpolationAdapter(this)}}_SaveToJson(){return{propertyAdapterJson:this.GetPropertyAdapter()._SaveToJson()}}_LoadFromJson(e){e&&this.GetPropertyAdapter()._LoadFromJson(e.propertyAdapterJson)}}}{const Un=self.C3;class jn extends Un.PropertyTrackState.PropertySourceAdapter{constructor(e){super(e),this._updatedIndex=NaN}GetEditorIndex(){return this._propertyTrack.GetPropertyTrackDataItem().GetSourceAdapterArguments()[0]}GetIndex(){return this._updatedIndex||super.GetIndex()}GetTarget(){return this._propertyTrack.GetTrack().GetInstance()}UpdateInstanceVariableIndex(e){const t=this._propertyTrack.GetPropertyTrackDataItem().GetSourceAdapterArguments()[0];t!==e&&(this._updatedIndex=e)}Interpolate(e,t,s,i,r,n,a){this.GetPropertyAdapter().CanChange(t.GetValue())&&super.Interpolate(e,t,s,i,r,n,a)}GetInterpolatedValue(e,t,s){if(this.GetPropertyAdapter().CanChange(t.GetValue()))return super.GetInterpolatedValue(e,t,s)}_SaveToJson(){return Object.assign(super._SaveToJson(),{index:this._updatedIndex})}_LoadFromJson(e){e&&(super._LoadFromJson(e),this._updatedIndex=e.index)}}Un.PropertyTrackState.InstanceVariableSourceAdapter=jn}{const Hn=self.C3;class Xn extends Hn.PropertyTrackState.PropertySourceAdapter{constructor(e){super(e),this._sid=NaN}GetEditorIndex(){const e=this._propertyTrack.GetPropertyTrackDataItem();return e.GetSourceAdapterArguments()[1]}GetTarget(){const e=this._propertyTrack.GetPropertyTrackDataItem(),t=this._propertyTrack.GetTrack(),s=this._sid||e.GetSourceAdapterArguments()[0],i=t.GetInstance(),r=i.GetBehaviorIndexBySID(s),n=i.GetBehaviorInstances()[r];return n.GetSdkInstance()}GetBehaviorType(e){const t=this._propertyTrack.GetPropertyTrackDataItem(),s=t.GetSourceAdapterArguments()[2];return e.GetBehaviorTypeByName(s)}UpdateBehaviorTypeSid(e){const t=this._propertyTrack.GetPropertyTrackDataItem();t.GetSourceAdapterArguments()[0]!==e&&(this._sid=e)}Interpolate(e,t,s,i,r,n,a){const o=this._propertyTrack.GetTrack(),h=o.GetInstance();this.GetBehaviorType(h.GetObjectClass())&&super.Interpolate(e,t,s,i,r,n,a)}GetInterpolatedValue(e,t,s){const i=this._propertyTrack.GetTrack(),r=i.GetInstance();if(this.GetBehaviorType(r.GetObjectClass()))return super.GetInterpolatedValue(e,t,s)}_SaveToJson(){return Object.assign(super._SaveToJson(),{sid:this._sid})}_LoadFromJson(e){e&&(super._LoadFromJson(e),this._sid=e.sid)}}Hn.PropertyTrackState.BehaviorSourceAdapter=Xn}{const zn=self.C3;class Yn extends zn.PropertyTrackState.PropertySourceAdapter{constructor(e){super(e)}GetEditorIndex(){return this._propertyTrack.GetPropertyTrackDataItem().GetSourceAdapterArguments()[1]}GetTarget(){const e=this._propertyTrack,t=e.GetTrack(),s=t.GetWorldInfo(),i=s.GetInstanceEffectList(),r=i.GetEffectList(),n=this.GetEffectType(r),a=n.GetIndex();return i.IsEffectIndexActive(a)?i.GetEffectParametersForIndex(a):null}GetEffectType(e){const t=this._propertyTrack,s=t.GetPropertyTrackDataItem().GetSourceAdapterArguments()[0];return e.GetEffectTypeByName(s)}Interpolate(e,t,s,i,r,n,a){this._IsEffectActive()&&super.Interpolate(e,t,s,i,r,n,a)}GetInterpolatedValue(e,t,s){if(this._IsEffectActive())return super.GetInterpolatedValue(e,t,s)}_IsEffectActive(){const e=this._propertyTrack,t=e.GetTrack(),s=t.GetWorldInfo(),i=s.GetInstanceEffectList(),r=i.GetEffectList(),n=this.GetEffectType(r);if(n){const a=n.GetIndex();return i.IsEffectIndexActive(a)}}}zn.PropertyTrackState.EffectSourceAdapter=Yn}{const qn=self.C3;class Kn extends qn.PropertyTrackState.PropertySourceAdapter{constructor(e){super(e)}GetEditorIndex(){return this._propertyTrack.GetPropertyTrackDataItem().GetSourceAdapterArguments()[0]}GetTarget(){return this._propertyTrack.GetTrack().GetInstance().GetSdkInstance()}Interpolate(e,t,s,i,r,n,a){const o=this._propertyTrack.GetTrack(),h=o.GetObjectClass().GetPlugin(),l=o.GetInstance().GetObjectClass().GetPlugin();h===l&&super.Interpolate(e,t,s,i,r,n,a)}GetInterpolatedValue(e,t,s){const i=this._propertyTrack.GetTrack(),r=i.GetObjectClass().GetPlugin(),n=i.GetInstance().GetObjectClass().GetPlugin();if(r===n)return super.GetInterpolatedValue(e,t,s)}GetOptionalCallbacks(){const e=this._propertyTrack.GetTrack(),t=e.GetObjectClass().GetPlugin();if(qn.Plugins.Sprite&&t instanceof qn.Plugins.Sprite&&(\"initial-frame\"===this._propertyTrack.GetPropertyName()||\"initial-animation\"===this._propertyTrack.GetPropertyName()))switch(this._propertyTrack.GetResultMode()){case\"relative\":case\"absolute\":return null}}}qn.PropertyTrackState.PluginSourceAdapter=Kn}{const Jn=self.C3;class Zn extends Jn.PropertyTrackState.PropertySourceAdapter{constructor(e){super(e),this._value=0,this._init=!1}MayNeedBeforeAndAfterInterpolate(){return!1}SetInitialState(){let e=this._propertyTrack.GetPropertyTrackData(),t=this._propertyTrack.GetPropertyTrackDataItem();t=e.GetFirstPropertyKeyframeDataItem(t),this._value=t.GetValueWithResultMode()}SetResumeState(){}GetValue(){return this._init||this._propertyTrack.Interpolate(0),this._value}Interpolate(e,t,s,i,r,n,a){this._value=Jn.PropertyTrackState.NumericTypeAdapter.Interpolate(e,t,s,this._propertyTrack),this._init=!0}SaveState(){}ClearSaveState(){}GetCurrentState(){return this._value}CompareInitialStateWithCurrent(){return!1}CompareSaveStateWithCurrent(){return!1}_SaveToJson(){return{value:this._value,init:this._init}}_LoadFromJson(e){e&&(this._value=e.value,this._init=!e.hasOwnProperty(\"init\")||e.init)}}Jn.PropertyTrackState.ValueSourceAdapter=Zn}{const Qn=self.C3;class $n extends Qn.PropertyTrackState.PropertySourceAdapter{constructor(e){super(e),this._audioPlaybackStarted=!1,this._sdkInstance=null,this._actions=null,this._expressions=null,this._timeline=this._propertyTrack.GetTimeline(),this._track=this._propertyTrack.GetTrack(),this._sourceAdapterArgs=this._propertyTrack.GetSourceAdapterArgs(),this._fileArgs=this._sourceAdapterArgs[0],this._startOffsetTime=this._sourceAdapterArgs[1],this._sourceAdapterArgs[3]?this._audioTag=this._sourceAdapterArgs[3]:this._audioTag=Math.random().toString(36).slice(2),this._pauseTime=NaN,this._pauseVolume=NaN,this._volume=NaN,this._audioSource=null,this._Initialize()}Release(){super.Release(),this._sdkInstance=null,this._actions=null,this._expressions=null,this._timeline=null,this._track=null,this._sourceAdapterArgs=null,this._fileArgs=null,this._audioSource=null}_Initialize(){if(self.C3.Plugins.Audio){const e=this._propertyTrack.GetRuntime(),t=e.GetSingleGlobalObjectClassByCtor(self.C3.Plugins.Audio);t&&(this._sdkInstance=t.GetSingleGlobalInstance().GetSdkInstance()),this._actions=self.C3.Plugins.Audio.Acts,this._expressions=self.C3.Plugins.Audio.Exps}}_MaybeSetAudioSource(){if(!this._audioSource){const e=this._propertyTrack.GetTrack(),t=e.GetPropertyTrack(\"audioSource\");t&&(this._audioSource=t.GetSourceAdapter())}}_GetPauseVolume(){const e=this._propertyTrack.GetTrack(),t=e.GetPropertyTrack(\"volume\");return(t?t.GetSourceAdapter():this)._pauseVolume}TimelineRemoved(){super.TimelineRemoved(),this._audioPlaybackStarted=!1,this._sdkInstance&&(this._expressions&&(this._pauseTime=this._expressions.PlaybackTime.call(this._sdkInstance,this._audioTag),this._pauseVolume=this._expressions.Volume.call(this._sdkInstance,this._audioTag)),this._actions)&&this._actions.Stop.call(this._sdkInstance,this._audioTag)}GetAudioTag(){return this._audioTag}GetVolume(){return this._volume}SetVolume(e){this._volume=e}SetInitialState(){super.SetInitialState(),this._pauseTime=NaN,this._audioPlaybackStarted=!1}SetResumeState(){super.SetResumeState();const e=this._propertyTrack.GetTimeline(),t=e.GetTime();switch(this._pauseTime=t-this._startOffsetTime,this._propertyTrack.GetPropertyName()){case\"audioSource\":break;case\"volume\":this._pauseVolume=this._propertyTrack.GetInterpolatedValue(t)}this._audioPlaybackStarted=!1}Interpolate(e,t,s,i,r,n,a){if(this._sdkInstance)switch(this._propertyTrack.GetPropertyName()){case\"audioSource\":{if(!this._timeline.IsForwardPlayBack())return;if(i)return void(this._actions&&this._actions.Stop.call(this._sdkInstance,this._audioTag));if(e<this._startOffsetTime)return void(this._audioPlaybackStarted=!1);const o=this._expressions.PlaybackRate.call(this._sdkInstance,this._audioTag),h=this._timeline.GetPlaybackRate();if(h!==o&&this._actions.SetPlaybackRate.call(this._sdkInstance,this._audioTag,h),this._audioPlaybackStarted)return;if(!this._propertyTrack.GetTimeline().IsPlaying())return;if(this._audioPlaybackStarted=!0,isNaN(this._pauseTime)){const l=self.performance.now(),c=e-this._startOffsetTime,u=this._sdkInstance.GetAudioContextState();if(\"suspended\"===u)return void(this._audioPlaybackStarted=!1);const _=self.performance.now(),d=(_-l)/1e3,p=c+d;if(this._actions){let e=this.GetVolume();isNaN(e)?(this.SetVolume(0),e=0):this.SetVolume(e),this._actions.PlayFromTimeline.call(this._sdkInstance,this._fileArgs,e,this._audioTag,p)}}else{const f=this._pauseTime,m=(this._pauseTime=NaN,this._GetPauseVolume()),g=(this._pauseVolume=NaN,this._sdkInstance.GetAudioContextState());if(\"suspended\"===g)return void(this._audioPlaybackStarted=!1);this._actions&&(this.SetVolume(m),this._actions.PlayFromTimeline.call(this._sdkInstance,this._fileArgs,m,this._audioTag,f))}break}case\"volume\":this._MaybeSetAudioSource(),super.Interpolate(e,t,s,i,r,n,a)}}GetInterpolatedValue(e,t,s){if(this._sdkInstance)switch(this._propertyTrack.GetPropertyName()){case\"audioSource\":return;case\"volume\":return this._MaybeSetAudioSource(),super.GetInterpolatedValue(e,t,s)}}Getter(e,t){return this._audioSource?this._audioSource.GetVolume():0}Setter(e,t,s,i){this._audioSource&&this._audioSource.SetVolume(this.Getter()+t),this._actions&&this._audioSource&&this._actions.SetVolume.call(this._sdkInstance,this._audioSource.GetAudioTag(),this._audioSource.GetVolume())}AbsoluteSetter(e,t,s){this._audioSource&&this._audioSource.SetVolume(t),this._actions&&this._audioSource&&this._actions.SetVolume.call(this._sdkInstance,this._audioSource.GetAudioTag(),this._audioSource.GetVolume())}DoesRounding(){return!0}_SaveToJson(){return{audioPlaybackStarted:this._audioPlaybackStarted,audioTag:this._audioTag,pauseTime:this._pauseTime,pauseVolume:this._pauseVolume,volume:this._volume}}_LoadFromJson(e){e&&(this._audioPlaybackStarted=e.audioPlaybackStarted,this._audioTag=e.audioTag,this._pauseTime=e.pauseTime,this._pauseVolume=e.pauseVolume,this._volume=e.volume,this._Initialize())}}Qn.PropertyTrackState.AudioSourceAdapter=$n}{const ea=self.C3;ea.PropertyTrackState.PropertyInterpolationAdapter=class{constructor(e){this._sourceAdapter=e,this._propertyTrack=e.GetPropertyTrack(),this._worldInfo=this._propertyTrack.GetTrack().GetWorldInfo(),this._property=this._propertyTrack.GetPropertyName(),this._firstAbsoluteUpdate=!1,this._saveState=null,this._target=null}Release(){this._sourceAdapter=null,this._propertyTrack=null,this._worldInfo=null,this._saveState=null,this._target=null}MayNeedBeforeAndAfterInterpolate(){return!1}TimelineRemoved(){}CleanCaches(){this._worldInfo=null,this._saveState=null,this._target=null}GetSourceAdapter(){return this._sourceAdapter}GetPropertyTrack(){return this._propertyTrack}GetWorldInfo(){return this._worldInfo||(this._worldInfo=this._propertyTrack.GetTrack().GetWorldInfo()),this._worldInfo}SetFirstAbsoluteUpdate(e){this._firstAbsoluteUpdate=!!e}GetFirstAbsoluteUpdate(){return this._firstAbsoluteUpdate}SetResetState(){}SetInitialState(){}SetResumeState(){}SetSaveState(){this._saveState=this.GetCurrentState()}ClearSaveState(){this._saveState=null}GetCurrentState(){}CompareInitialStateWithCurrent(){}CompareSaveStateWithCurrent(){}CanChange(e){const t=typeof this._Getter(),s=typeof e;return t==s}BeforeChangeProperty(){}ChangeProperty(e,t,s,i,r,n,a,o){}AfterChangeProperty(){}_FirstKeyframeGetter(){const e=this._PickTimelinePlaybackMode(()=>{const e=this._propertyTrack.GetPropertyTrackDataItem(),t=this._propertyTrack.GetPropertyTrackData();return t.GetFirstPropertyKeyframeDataItem(e)},()=>{const e=this._propertyTrack.GetPropertyTrackDataItem(),t=this._propertyTrack.GetPropertyTrackData();return t.GetLastPropertyKeyframeDataItem(e)});return e.GetAbsoluteValue()}_CurrentKeyframeGetter(){const e=this._propertyTrack.GetTimeline(),i=e.GetTime()-this._propertyTrack.GetTrack().GetStartOffset(),t=this._PickTimelinePlaybackMode(()=>{const e=this._propertyTrack.GetPropertyTrackDataItem(),t=this._propertyTrack.GetPropertyTrackData();return t.GetFirstPropertyKeyFrameDataItemLowerOrEqualThan(i,e)},()=>{const e=this._propertyTrack.GetPropertyTrackDataItem(),t=this._propertyTrack.GetPropertyTrackData(),s=t.GetFirstPropertyKeyFrameDataItemHigherOrEqualThan(i,e);return s||t.GetLastPropertyKeyframeDataItem(e)});return t.GetAbsoluteValue()}_PickTimelinePlaybackMode(e,t){const s=this._propertyTrack.GetTimeline();return(s.IsForwardPlayBack()?e:t)()}_PickResultMode(e,t){const s=this._propertyTrack.GetResultMode();return(\"relative\"===s?e:t)()}_PickFirstAbsoluteUpdate(e,t){return(this.GetFirstAbsoluteUpdate()?(this.SetFirstAbsoluteUpdate(!1),e):t)()}_GetAbsoluteInitialValue(e){}_GetIndex(){return this._sourceAdapter.GetIndex()}_GetTarget(){return this._target||(this._target=this._sourceAdapter.GetTarget()),this._target}_PickSource(e,t,s,i,r,n){const a=this._propertyTrack.GetSourceAdapterId();switch(a){case\"behavior\":return e();case\"effect\":return t();case\"instance-variable\":return s();case\"plugin\":return i();case\"world-instance\":return r();case\"audio\":return n()}}_SaveToJson(){return{firstAbsoluteUpdate:this._firstAbsoluteUpdate,saveState:this._saveState}}_LoadFromJson(e){e&&(this._firstAbsoluteUpdate=e.firstAbsoluteUpdate,this._saveState=e.saveState)}_GetPropertyKeyframeStubs(e,t=!1){const s=[];for(const i of e){const r=i.GetTrack().GetStartOffset();for(const n of i.GetPropertyKeyframeDataItems())(t&&0===n.GetTime()||!t)&&s.push({time:r+n.GetTime(),value:n.GetAbsoluteValue()})}return s.sort((e,t)=>e.time-t.time)}_GetLastPropertyKeyframeStub(e,t,s){return this._GetPropertyKeyframeStubLowerThanPlayhead(t,s)}_GetPropertyKeyframeStubLowerThanPlayhead(t,s){for(let e=s.length-1;0<=e;e--){const i=s[e].time;if(i<=t)return s[e]}return null}}}{const ta=self.C3,sa=new Map,ia=[0,0,0];class ra extends ta.PropertyTrackState.PropertyInterpolationAdapter{constructor(e){super(e)}SetResetState(){}SetInitialState(){}SetResumeState(){}GetCurrentState(){const e=this._propertyTrack.GetSourceAdapterId(),t=this._GetTarget(),s=this._GetIndex();switch(e){case\"behavior\":return this._ToColorArray(t.GetPropertyValueByIndex(s));case\"effect\":return this._ToColorArray(t[s]);case\"plugin\":return this._ToColorArray(t.GetPropertyValueByIndex(s));case\"world-instance\":return this._ToColorArray(this._Getter())}}CompareInitialStateWithCurrent(){const e=this._FirstKeyframeGetter();return!this._CompareColors(e,this._Getter())}CompareSaveStateWithCurrent(){return!ta.IsNullOrUndefined(this._saveState)&&!this._CompareColors(this._saveState,this._Getter())}_CompareColors(e,t){return e=this._GetColorFromArray(e),t=this._GetColorFromArray(t),e.equalsIgnoringAlpha(t)}_FirstKeyframeGetter(){const e=super._FirstKeyframeGetter();return this._GetColorFromArray(e)}_CurrentKeyframeGetter(){const e=super._CurrentKeyframeGetter();return this._GetColorFromArray(e)}_GetAbsoluteInitialValue(e){}_ToColorArray(e){return(ta.IsInstanceOf(e,ta.Color)?e.toArray():e).slice(0,3)}_GetColorFromArray(e){return ta.IsInstanceOf(e,ta.Color)?e:new ta.Color(e[0],e[1],e[2],1)}CanChange(e){return!0}MayNeedBeforeAndAfterInterpolate(){return!0}BeforeChangeProperty(){const e=this._propertyTrack.GetTimeline(),t=this._propertyTrack.GetInstance(),s=this._propertyTrack.GetSourceAdapter(),i=e.GetSimilarPropertyTracks(t,s,this._property,this._propertyTrack);if(i&&1<i.length){sa.has(t)||sa.set(t,new Map);const r=sa.get(t),n=this._propertyTrack.GetSourceAdapterId(),a=(r.has(n)||r.set(n,new Map),r.get(n));a.has(this._property)||a.set(this._property,{used:!1,color:new ta.Color(0,0,0,1)})}}_GetTmpColor(e,t,s){const i=sa.get(e).get(t).get(s);return i.used=!0,i.color}ChangeProperty(e,t,s,i,r,n,a,o){const h=this._propertyTrack.GetTimeline(),l=this._propertyTrack.GetTrack(),c=this._propertyTrack.GetInstance(),u=this._propertyTrack.GetSourceAdapter(),_=this._propertyTrack.GetSourceAdapterId(),d=this._property,p=h.GetSimilarPropertyTracks(c,u,d,this._propertyTrack);if(p&&1<p.length){const f=this._GetPropertyKeyframeStubs(p,!0),m=this._GetLastPropertyKeyframeStub(h,h.GetTime(),f);if(m){const g=l.GetStartOffset(),S=m.time-g;if(0==S)this._GetTmpColor(c,_,this._property).addRgb(t[0],t[1],t[2]);else if(!(S<0)){const y=t[0],G=t[1],I=t[2],T=this._propertyTrack.Interpolate(S,!1,!0),C=ta.Color.DiffChannel(y,T[0]),b=ta.Color.DiffChannel(G,T[1]),w=ta.Color.DiffChannel(I,T[2]);this._GetTmpColor(c,_,this._property).addRgb(C,b,w)}}}else this._Setter(t[0],t[1],t[2])}AfterChangeProperty(){const e=this._propertyTrack.GetInstance();if(sa.has(e)){const t=sa.get(e),s=this._propertyTrack.GetSourceAdapterId();if(t.has(s)){const i=t.get(s);if(i.has(this._property)){const r=i.get(this._property),n=r.used,a=r.color;n&&this._Setter(a.getR(),a.getG(),a.getB()),0===i.size&&t.delete(s),0===t.size&&sa.delete(e)}}}}_Getter(){const e=this._propertyTrack.GetSourceAdapterId(),t=this._GetTarget(),s=this._GetIndex();switch(e){case\"behavior\":return this._GetColorFromArray(t.GetPropertyValueByIndex(s));case\"effect\":return t[s].clone();case\"plugin\":return this._GetColorFromArray(t.GetPropertyValueByIndex(s));case\"world-instance\":return this.GetWorldInfo().GetUnpremultipliedColor().clone()}}_Setter(e,t,s){const i=this._propertyTrack.GetSourceAdapterId(),r=this._GetTarget(),n=this._GetIndex();switch(i){case\"behavior\":ia[0]=e,ia[1]=t,ia[2]=s,r.SetPropertyValueByIndex(n,ia);break;case\"effect\":r[n].setRgb(e,t,s);break;case\"plugin\":ia[0]=e,ia[1]=t,ia[2]=s,r.SetPropertyValueByIndex(n,ia);break;case\"world-instance\":this.GetWorldInfo().SetUnpremultipliedColorRGB(e,t,s)}}_SaveToJson(){}_LoadFromJson(e){}}ta.PropertyTrackState.PropertyInterpolationAdapter.ColorInterpolationAdapter=ra}{const na=self.C3,aa=na.PropertyTrackState;class oa extends na.PropertyTrackState.PropertyInterpolationAdapter{constructor(e){super(e)}SetResetState(){}SetInitialState(){}SetResumeState(){}GetCurrentState(){return this._Getter()}CompareInitialStateWithCurrent(){const e=this._FirstKeyframeGetter();return e!==this.GetCurrentState()}CompareSaveStateWithCurrent(){return!na.IsNullOrUndefined(this._saveState)&&this._saveState!==this.GetCurrentState()}MayNeedBeforeAndAfterInterpolate(){return!1}ChangeProperty(e,t,s,i,r,n,a,o){const h=this._propertyTrack,l=h.GetTrack(),c=h.GetSourceAdapterId(),u=h.GetTimeline(),_=l.GetInstance(),d=h.GetSourceAdapter(),p=this._property,f=u.GetSimilarPropertyTracks(_,d,p,h);if(f&&1<f.length){const g=this._GetPropertyKeyframeStubs(f),S=e+l.GetStartOffset(),y=this._GetLastPropertyKeyframeStub(u,S,g);y&&(t=y.value)}const m=h.GetPropertyKeyframeType();switch(m){case\"numeric\":if(aa.NumericTypeAdapter.WillChange(this._GetIndex(),this._GetTarget(),t,c))break;return;case\"angle\":if(aa.AngleTypeAdapter.WillChange(this._GetIndex(),this._GetTarget(),t,c))break;return;case\"boolean\":if(aa.BooleanTypeAdapter.WillChange(this._GetIndex(),this._GetTarget(),t,c))break;return;case\"color\":if(aa.ColorTypeAdapter.WillChange(this._GetIndex(),this._GetTarget(),t,c))break;return;case\"text\":if(!aa.TextTypeAdapter.WillChange(this._GetIndex(),this._GetTarget(),t,c))return}this._Setter(t)}_Getter(){const e=this._propertyTrack.GetSourceAdapterId(),t=this._GetTarget(),s=this._GetIndex();switch(e){case\"behavior\":return t.GetPropertyValueByIndex(s);case\"effect\":return t[s];case\"instance-variable\":return t.GetInstanceVariableValue(s);case\"plugin\":return t.GetPropertyValueByIndex(s)}}_Setter(e){const t=this._propertyTrack.GetSourceAdapterId(),s=this._GetTarget(),i=this._GetIndex();switch(t){case\"behavior\":s.SetPropertyValueByIndex(i,e);break;case\"effect\":s[i]=e;break;case\"instance-variable\":s.SetInstanceVariableValue(i,e);break;case\"plugin\":s.SetPropertyValueByIndex(i,e)}}}na.PropertyTrackState.PropertyInterpolationAdapter.NoInterpolationAdapter=oa}{const ha=self.C3,la=(ha.PropertyTrackState.PropertyInterpolationAdapter,new Map),ca=(e,t,s,i,r,n=!1,a=null,o=null)=>{la.set(e,{setter:t,absolute_setter:s,getter:i,round:r,fRound:n,init:a,reset:o})};ca(\"offsetX\",(e,t,s,i)=>{\"relative\"===i._propertyTrack.GetResultMode()?e.OffsetX(t,s.GetTimeline().GetTransformWithSceneGraph()):e.OffsetX(t)},(e,t)=>e.SetX(t),e=>e.GetX(),!0),ca(\"offsetY\",(e,t,s,i)=>{\"relative\"===i._propertyTrack.GetResultMode()?e.OffsetY(t,s.GetTimeline().GetTransformWithSceneGraph()):e.OffsetY(t)},(e,t)=>e.SetY(t),e=>e.GetY(),!0),ca(\"offsetWidth\",(t,e,o,s,i)=>{if(0!==e){const r=\"relative\"===s._propertyTrack.GetResultMode(),l=1===s._typeAdapter.GetType();if((r||l)&&t.HasParent()&&t.GetTransformWithParentWidth()){if(isNaN(s._absoluteToFactor)){let i=[],e=t.GetParent();for(;e;)i.push(e),e=e.GetParent();i.reverse();let h=(e,t)=>t.GetTimeline().GetTrackFromInstance(e.GetInstance()),r=(e,t)=>{const s=h(e,t);if(s)return s.GetOriginalWidth();const i=e.GetInstance().GetSdkInstance();return i.IsOriginalSizeKnown()?i.GetOriginalWidth():e._GetSceneGraphInfo()._GetStartWidth()},n=(e,t,s,i=0)=>{const r=h(e,t);if(!r)return i;const n=r.GetPropertyTrack(s);if(!n)return i;const a=n.GetPropertyTrackDataItem().GetPropertyKeyframeData();if(!a)return i;const o=a.GetLastPropertyKeyframeDataItem();return o?o.GetValue():i},a;if(l){let e=i[i.length-1];a=e.GetWidth()}else{let t=i[0],e=t._GetSceneGraphInfo()._GetStartWidth(),s=t._GetSceneGraphInfo().GetStartScaleX();a=e*s,a=(a+=n(t,o,\"offsetWidth\"))+r(t,o)*n(t,o,\"offsetScaleX\");for(let e=1;e<i.length;e++){const c=(t=i[e])._GetSceneGraphInfo().GetStartScaleX();a=(a=(a*=c)+n(t,o,\"offsetWidth\"))+r(t,o)*n(t,o,\"offsetScaleX\")}}s._absoluteToFactor=0===a?Number.EPSILON:a}i||t.OffsetWidth(e/s._absoluteToFactor,!0)}else t.OffsetWidth(e)}},(e,t)=>e.SetWidth(t),e=>e.GetWidth(),!0),ca(\"offsetHeight\",(t,e,o,s,i)=>{if(0!==e){const r=\"relative\"===s._propertyTrack.GetResultMode(),h=1===s._typeAdapter.GetType();if((r||h)&&t.HasParent()&&t.GetTransformWithParentHeight()){if(isNaN(s._absoluteToFactor)){let i=[],e=t.GetParent();for(;e;)i.push(e),e=e.GetParent();i.reverse();let r=(e,t)=>{i=e;const s=t.GetTimeline().GetTrackFromInstance(i.GetInstance());var i;if(s)return s.GetOriginalHeight();const r=e.GetInstance().GetSdkInstance();return r.IsOriginalSizeKnown()?r.GetOriginalHeight():e._GetSceneGraphInfo()._GetStartHeight()},n=(e,t,s,i=0)=>{const r=t.GetTimeline().GetTrackFromInstance(e.GetInstance());if(!r)return i;const n=r.GetPropertyTrack(s);if(!n)return i;const a=n.GetPropertyTrackDataItem().GetPropertyKeyframeData();if(!a)return i;const o=a.GetLastPropertyKeyframeDataItem();return o?o.GetValue():i},a;if(h){let e=i[i.length-1];a=e.GetHeight()}else{let t=i[0],e=t._GetSceneGraphInfo()._GetStartHeight(),s=t._GetSceneGraphInfo().GetStartScaleY();a=e*s,a=(a+=n(t,o,\"offsetHeight\"))+r(t,o)*n(t,o,\"offsetScaleY\");for(let e=1;e<i.length;e++){const l=(t=i[e])._GetSceneGraphInfo().GetStartScaleY();a=(a=(a*=l)+n(t,o))+r(t,o)*n(t,o,\"offsetScaleY\")}}s._absoluteToFactor=0===a?Number.EPSILON:a}i||t.OffsetHeight(e/s._absoluteToFactor,!0)}else t.OffsetHeight(e)}},(e,t)=>e.SetHeight(t),e=>e.GetHeight(),!0),ca(\"offsetAngle\",(e,t,s,i,r)=>{e.OffsetAngle(t)},(e,t)=>e.SetAngle(t),e=>e.GetAngle(),!1,!0),ca(\"offsetOpacity\",(e,t,s,i,r)=>{const n=i._opacityFactor||1,a=(t/=n,e.GetOpacity()),o=a+t;if(0===i._clampAccumulator)1<o?i._clampAccumulator+=o-1:o<0&&(i._clampAccumulator+=o),e.OffsetOpacity(t);else{const h=e.GetOpacity()+t;0<t&&0<i._clampAccumulator?1<h&&(i._clampAccumulator+=h-1):0<t&&i._clampAccumulator<0?(i._clampAccumulator+=t,0<i._clampAccumulator&&(e.OffsetOpacity(i._clampAccumulator),i._clampAccumulator=0)):t<0&&0<i._clampAccumulator?(i._clampAccumulator+=t,i._clampAccumulator<0&&(e.OffsetOpacity(i._clampAccumulator),i._clampAccumulator=0)):t<0&&i._clampAccumulator<0&&h<0&&(i._clampAccumulator+=h)}},(e,t)=>{e.SetOpacity(t)},e=>e.GetOpacity(),!1,!0,(n,r,a)=>{switch(n._clampAccumulator=0,n._propertyTrack.GetResultMode()){case\"relative\":{n._propertyTrack.GetPropertyTrackData();let e=n._propertyTrack.GetPropertyTrackDataItem(),t=e.GetPropertyKeyframeData(),s=t.GetPropertyKeyframeDataItemArray(),i=n.GetWorldInfo().GetOpacity(),r=i;for(const o of s){const h=o.GetTime(),l=n._propertyTrack.GetInterpolatedValue(h);r=i+l,r=ha.clamp(r,0,1)}n._totalForewardOpacityDelta=i-r,n._totalForewardOpacityDelta=Math.round(100*(n._totalForewardOpacityDelta+Number.EPSILON))/100,r=i;for(let e=s.length-1;0<=e;e--){const c=s[e].GetTime(),u=n._propertyTrack.GetInterpolatedValue(c);r-=u,r=ha.clamp(r,0,1)}n._totalBackwardOpacityDelta=r,n._totalBackwardOpacityDelta=Math.round(100*(n._totalBackwardOpacityDelta+Number.EPSILON))/100;break}}const e=\"relative\"===n._propertyTrack.GetResultMode(),t=1===n._typeAdapter.GetType();if((e||t)&&r.HasParent()&&r.GetTransformWithParentOpacity()){let t=[],e=r.GetParent();for(;e;)t.push(e),e=e.GetParent();t.reverse();let s=(e,t,s)=>{const i=t.GetTimeline().GetTrackFromInstance(e.GetInstance());if(!i)return 0;const r=i.GetPropertyTrack(s);if(!r)return 0;const n=r.GetPropertyTrackDataItem().GetPropertyKeyframeData();if(!n)return 0;const a=n.GetLastPropertyKeyframeDataItem();return a?a.GetValue():0},i=t[0]._GetSceneGraphInfo().GetStartOpacity();i+=s(t[0],a,\"offsetOpacity\");for(let e=1;e<t.length;e++)i+=s(t[e],a,\"offsetOpacity\");n._opacityFactor=0===i?1:i}},s=>{switch(s._propertyTrack.GetResultMode()){case\"relative\":{s._clampAccumulator=0;let e=s.GetWorldInfo(),t=e.GetOpacity();t=Math.round(100*(t+Number.EPSILON))/100,s._propertyTrack.GetTimeline().IsForwardPlayBack()?(e.SetOpacity(t+s._totalForewardOpacityDelta),s._lastValue=0):(e.SetOpacity(t-s._totalBackwardOpacityDelta),s._lastValue=s.GetSourceAdapter().GetValueAtTime());break}}}),ca(\"offsetOriginX\",(e,t)=>e.OffsetOriginX(t),(e,t)=>e.SetOriginX(t),e=>e.GetOriginX(),!1),ca(\"offsetOriginY\",(e,t)=>e.OffsetOriginY(t),(e,t)=>e.SetOriginY(t),e=>e.GetOriginY(),!1),ca(\"offsetZElevation\",(e,t)=>e.OffsetZElevation(t),(e,t)=>e.SetZElevation(t),e=>e.GetZElevation(),!0),ca(\"offsetScaleX\",(e,t,s,i)=>{if(0!==t){const r=e.GetWidth()<0?-1:1;if(\"relative\"===i._propertyTrack.GetResultMode()&&e.HasParent()&&e.GetTransformWithParentWidth()){const n=s.GetOriginalWidth()*r*t;isNaN(i._absoluteToFactor)&&la.get(\"offsetWidth\").setter(e,1,s,i,!0),e.OffsetWidth(n/i._absoluteToFactor,!0)}else e.OffsetWidth(s.GetOriginalWidth()*r*t)}},(e,t,s)=>{e.SetWidth(s.GetOriginalWidth()*t)},(i,r)=>{const n=i.GetWidth()<0?-1:1;if(i.GetTransformWithParentWidth()){let e=i.GetParent(),t=r.GetTimeline().GetTrackFromInstance(e.GetInstance()),s=NaN;if(t)s=e.GetWidth()/t.GetOriginalWidth();else{const a=e.GetInstance().GetSdkInstance();s=a.IsOriginalSizeKnown()?e.GetWidth()/a.GetOriginalWidth():1}return i.GetWidth()*n/(r.GetOriginalWidth()*s)}return i.GetWidth()*n/r.GetOriginalWidth()},!1),ca(\"offsetScaleY\",(e,t,s,i)=>{if(0!==t){const r=e.GetHeight()<0?-1:1;if(\"relative\"===i._propertyTrack.GetResultMode()&&e.HasParent()&&e.GetTransformWithParentHeight()){const n=s.GetOriginalHeight()*r*t;isNaN(i._absoluteToFactor)&&la.get(\"offsetHeight\").setter(e,1,s,i,!0),e.OffsetHeight(n/i._absoluteToFactor,!0)}else e.OffsetHeight(s.GetOriginalHeight()*r*t)}},(e,t,s)=>{e.SetHeight(s.GetOriginalHeight()*t)},(i,r)=>{const n=i.GetHeight()<0?-1:1;if(i.GetTransformWithParentHeight()){let e=i.GetParent(),t=r.GetTimeline().GetTrackFromInstance(e.GetInstance()),s=NaN;if(t)s=e.GetHeight()/t.GetOriginalHeight();else{const a=e.GetInstance().GetSdkInstance();s=a.IsOriginalSizeKnown()?e.GetHeight()/a.GetOriginalHeight():1}return i.GetHeight()*n/(r.GetOriginalHeight()*s)}return i.GetHeight()*n/r.GetOriginalHeight()},!1);class ua extends ha.PropertyTrackState.PropertyInterpolationAdapter{constructor(e){super(e),this._lastValue=0,this._clampAccumulator=0,this._totalForewardOpacityDelta=0,this._totalBackwardOpacityDelta=0,this._opacityFactor=NaN,this._absoluteToFactor=NaN,this._angleReflectMirrorOrFlip=void 0,this._angleReflectMirrorAndFlip=void 0,this._instance_getter=null,this._instance_setter=null,this._instance_absolute_setter=null,this._reset_action=null,this._init_action=null,this._source_adapter_getter=null,this._source_adapter_setter=null,this._source_adapter_absolute_setter=null,this._round=!1,this._fRound=!1,ha.IsInstanceOf(this._propertyTrack.GetTimeline(),ha.TweenState)?this._typeAdapter=new ha.PropertyTrackState.PropertyInterpolationAdapter.NumericInterpolationAdapterForTween(this):this._typeAdapter=new ha.PropertyTrackState.PropertyInterpolationAdapter.NumericInterpolationAdapterForTimeline(this);const t=this._propertyTrack.GetPropertyName();switch(this._propertyTrack.GetSourceAdapterId()){case\"world-instance\":{const s=la.get(t);this._instance_getter=s.getter,this._instance_setter=s.setter,this._instance_absolute_setter=s.absolute_setter,this._round=s.round,this._fRound=s.fRound,this._init_action=s.init,this._reset_action=s.reset;break}case\"audio\":this._source_adapter_getter=e.Getter,this._source_adapter_setter=e.Setter,this._source_adapter_absolute_setter=e.AbsoluteSetter,this._round=!!e.DoesRounding(),this._fRound=!1}}Release(){this._typeAdapter=null,this._instance_getter=null,this._instance_setter=null,this._instance_absolute_setter=null,this._reset_action=null,this._init_action=null,this._source_adapter_getter=null,this._source_adapter_setter=null,this._source_adapter_absolute_setter=null,super.Release()}MayNeedBeforeAndAfterInterpolate(){return this._typeAdapter.MayNeedBeforeAndAfterInterpolate()}GetLastValue(){return this._lastValue}SetLastValue(e){this._lastValue=e}SetResetState(){this._reset_action&&this._reset_action(this)}SetInitialState(){const e=this._typeAdapter.SetInitialState();if(\"number\"==typeof e&&(this._lastValue=e),this._init_action){const t=this.GetWorldInfo(),s=this._propertyTrack.GetTrack();this._init_action(this,t,s)}}SetResumeState(){const e=this._typeAdapter.SetResumeState();\"number\"==typeof e&&(this._lastValue=e)}GetCurrentState(){return this._Getter()}CompareInitialStateWithCurrent(){const e=this._FirstKeyframeGetter();return e!==this.GetCurrentState()}CompareSaveStateWithCurrent(){return!ha.IsNullOrUndefined(this._saveState)&&this._saveState!==this.GetCurrentState()}BeforeChangeProperty(){this._typeAdapter.BeforeChangeProperty()}ChangeProperty(e,t,s,i,r,n,a,o){return this._typeAdapter.ChangeProperty(e,t,s,i,r,n,a,o)}AfterChangeProperty(){this._typeAdapter.AfterChangeProperty()}_Getter(){const e=this._GetTarget(),t=this._GetIndex(),s=this.GetWorldInfo(),i=this._propertyTrack.GetTrack(),r=this._propertyTrack.GetSourceAdapterId();switch(r){case\"behavior\":return e.GetPropertyValueByIndex(t);case\"effect\":return e[t];case\"instance-variable\":return e.GetInstanceVariableValue(t);case\"plugin\":return e.GetPropertyValueByIndex(t);case\"world-instance\":return this._instance_getter(s,i);case\"audio\":return this._source_adapter_getter.call(this.GetSourceAdapter(),s,i)}}_Setter(e,t,s){const i=this._GetTarget(),r=this._GetIndex(),n=this.GetWorldInfo(),a=this._propertyTrack.GetTrack(),o=this._propertyTrack.GetSourceAdapterId();switch(o){case\"behavior\":i.OffsetPropertyValueByIndex(r,e);break;case\"effect\":i[r]+=e;break;case\"instance-variable\":i.SetInstanceVariableOffset(r,e);break;case\"plugin\":i.OffsetPropertyValueByIndex(r,e,this.GetSourceAdapter().GetOptionalCallbacks());break;case\"world-instance\":this._instance_setter(n,e,a,this);break;case\"audio\":this._source_adapter_setter.call(this.GetSourceAdapter(),n,e,a,this)}}_SetterAbsolute(e,t,s){let i=this._propertyTrack.GetInterpolationMode();if(\"discrete\"!==(i=\"default\"===i?\"continuous\":i)||t){if(\"discrete\"===i&&s){const l=this._propertyTrack.GetTimeline(),c=l.GetTime(),u=this._propertyTrack.GetPropertyKeyFrameDataItemAtTime(c);if(!u)return}const r=this._GetTarget(),n=this._GetIndex(),a=this.GetWorldInfo(),o=this._propertyTrack.GetTrack(),h=this._propertyTrack.GetSourceAdapterId();switch(h){case\"behavior\":r.SetPropertyValueByIndex(n,e);break;case\"effect\":r[n]=e;break;case\"instance-variable\":r.SetInstanceVariableValue(n,e);break;case\"plugin\":r.SetPropertyValueByIndex(n,e,this.GetSourceAdapter().GetOptionalCallbacks());break;case\"world-instance\":this._instance_absolute_setter(a,e,o);break;case\"audio\":this._source_adapter_absolute_setter.call(this.GetSourceAdapter(),a,e,o)}}}_MaybeEnsureValue(e,t,s,i,r,n,a,o){this._typeAdapter._MaybeEnsureValue(e,t,s,i,r,n,a,o)}_AddDelta(e,t,s,i,r){let n=(e=\"angle\"===this._propertyTrack.GetPropertyType()?ha.toDegrees(e):e).toString(),a=n.split(\".\")[1]||\"\",o=a.length,h=this._Getter(),l;switch(l=0===o?this._round?Math.round(h):this._fRound?\"angle\"===this._propertyTrack.GetPropertyType()?ha.toRadians(Math.round(ha.toDegrees(h))):Number(ha.toFixed(h,2)):h:this._round?Number(ha.toFixed(h,o)):(this._fRound,h),this._Setter(l-h,t,s),this._propertyTrack.GetPropertyName()){case\"offsetWidth\":case\"offsetScaleX\":{const c=this.GetWorldInfo(),u=c.GetWidth(),_=Number(ha.toFixed(u,2));c.OffsetWidth(_-u);break}case\"offsetHeight\":case\"offsetScaleY\":{const d=this.GetWorldInfo(),p=d.GetHeight(),f=Number(ha.toFixed(p,2));d.OffsetHeight(f-p);break}}}_SaveToJson(){return Object.assign(super._SaveToJson(),{v:this._lastValue,a:this._clampAccumulator,fod:this._totalForewardOpacityDelta,bod:this._totalBackwardOpacityDelta,of:this._opacityFactor,sf:this._absoluteToFactor,armorf:this._angleReflectMirrorOrFlip,armandf:this._angleReflectMirrorAndFlip})}_LoadFromJson(e){e&&(super._LoadFromJson(e),this._lastValue=e.v,this._clampAccumulator=e.a,this._totalForewardOpacityDelta=ha.IsFiniteNumber(e.fod)?e.fod:0,this._totalBackwardOpacityDelta=ha.IsFiniteNumber(e.bod)?e.bod:0,this._opacityFactor=ha.IsFiniteNumber(e.of)?e.of:NaN,this._absoluteToFactor=ha.IsFiniteNumber(e.sf)?e.sf:NaN,this._angleReflectMirrorOrFlip=ha.IsFiniteNumber(e.armorf)?e.armorf:void 0,this._angleReflectMirrorAndFlip=ha.IsFiniteNumber(e.armandf)?e.armandf:void 0)}}ha.PropertyTrackState.PropertyInterpolationAdapter.NumericInterpolationAdapter=ua}{const _a=self.C3;class da{constructor(e){this._used=!1,this._value=0,this._propertyKeyframeReached=!1,this._endState=!1,this._propertyTracks=e;for(let e=0,t=this._propertyTracks.length;e<t;e++)this._propertyTracks[e].SetAbsoluteValueObject(this)}GetPropertyTracks(){return this._propertyTracks}SetUsed(){this._used=!0}GetUsed(){return this._used}SetValue(e){this._value=e}GetValue(){return this._value}SetPropertyKeyframeReached(e){this._propertyKeyframeReached=e}GetPropertyKeyframeReached(){return this._propertyKeyframeReached}SetEndState(e){this._endState=e}GetEndState(){return this._endState}Reset(){this._used=!1,this._value=0,this._propertyKeyframeReached=!1,this._endState=!1}}class pa{constructor(e){this._numericInterpolationAdapter=e}Release(){this._numericInterpolationAdapter=null}GetType(){return 0}SetInitialState(){const e=this._numericInterpolationAdapter;return this._numericInterpolationAdapter.GetPropertyTrack(),e._PickResultMode(()=>e._PickTimelinePlaybackMode(()=>0,()=>e.GetSourceAdapter().GetValueAtTime()),()=>{})}SetResumeState(){}MayNeedBeforeAndAfterInterpolate(){this._numericInterpolationAdapter;const e=this._numericInterpolationAdapter.GetPropertyTrack();switch(e.GetResultMode()){case\"relative\":return!1;case\"absolute\":return!0}}BeforeChangeProperty(){this._numericInterpolationAdapter;const e=this._numericInterpolationAdapter.GetPropertyTrack(),t=e.GetPropertyName();switch(e.GetResultMode()){case\"relative\":break;case\"absolute\":if(e.HasAbsoluteValueObject()){const s=e.GetAbsoluteValueObject();s.Reset()}else{const i=e.GetTimeline(),r=e.GetInstance(),n=e.GetSourceAdapter(),a=i.GetSimilarPropertyTracks(r,n,t,e);a&&1<a.length&&new da(a)}}}ChangeProperty(e,t,s,i,r,n,a,o){const h=this._numericInterpolationAdapter,l=this._numericInterpolationAdapter.GetPropertyTrack();switch(l.GetResultMode()){case\"relative\":{const c=h.GetLastValue();h._Setter(t-c,s,i),n&&this._MaybeEnsureValue(e,s,i,r,c,t),h.SetLastValue(t);break}case\"absolute\":{const u=l.GetTimeline(),_=l.GetTrack();if(l.GetInstance(),l.GetSourceAdapter(),l.HasAbsoluteValueObject()){const d=l.GetAbsoluteValueObject(),p=d.GetPropertyTracks(),f=h._GetPropertyKeyframeStubs(p,!0),m=h._GetLastPropertyKeyframeStub(u,u.GetTime(),f);if(m){const g=_.GetStartOffset(),S=m.time-g;if(0==S)d.SetEndState(a),d.SetPropertyKeyframeReached(o),d.SetUsed(),d.SetValue(d.GetValue()+t);else{if(S<0)return;const y=l.GetInterpolatedValue(S);d.SetEndState(a),d.SetPropertyKeyframeReached(o),d.SetUsed(),d.SetValue(d.GetValue()+(t-y))}}}else h._SetterAbsolute(t,o,a);break}}}AfterChangeProperty(){const e=this._numericInterpolationAdapter,t=this._numericInterpolationAdapter.GetPropertyTrack();switch(t.GetResultMode()){case\"relative\":break;case\"absolute\":if(t.HasAbsoluteValueObject()){const s=t.GetAbsoluteValueObject();s.GetUsed()&&e._SetterAbsolute(s.GetValue(),s.GetPropertyKeyframeReached(),s.GetEndState())}}}_MaybeEnsureValue(e,t,s,i,r,n){const a=this._numericInterpolationAdapter;i||(t&&e===t.GetTime()?a._AddDelta(t.GetValueWithResultMode(),t,s):s&&e===s.GetTime()?a._AddDelta(s.GetValueWithResultMode(),t,s):n-r==0&&a._AddDelta(t.GetValueWithResultMode(),t,s))}}_a.PropertyTrackState.PropertyInterpolationAdapter.NumericInterpolationAdapterForTimeline=pa}{const fa=self.C3;class ma{constructor(e){this._numericInterpolationAdapter=e}Release(){this._numericInterpolationAdapter=null}GetType(){return 1}SetInitialState(){const e=this._numericInterpolationAdapter;return e.SetFirstAbsoluteUpdate(!0),this._GetAbsoluteInitialValue(e._FirstKeyframeGetter())}SetResumeState(){const e=this._numericInterpolationAdapter;if(e._FirstKeyframeGetter()!==e._CurrentKeyframeGetter())return e.SetFirstAbsoluteUpdate(!0),this._GetAbsoluteInitialValue(e._CurrentKeyframeGetter())}MayNeedBeforeAndAfterInterpolate(){return!1}BeforeChangeProperty(){}ChangeProperty(e,t,s,i,r,n,a,o){const h=this._numericInterpolationAdapter,l=h.GetLastValue();switch(h.GetPropertyTrack().GetResultMode()){case\"relative\":h._Setter(t-l,s,i),n&&this._MaybeEnsureValue(e,s,i,r,l,t,!1,a);break;case\"absolute\":h.GetFirstAbsoluteUpdate()?(h.SetFirstAbsoluteUpdate(!1),h._Setter(l,s,i)):0===e&&0===h.GetPropertyTrack().GetTimeline().GetTotalTime()?h._SetterAbsolute(t,!0,!1):(h._Setter(t-l,s,i),n&&this._MaybeEnsureValue(e,s,i,r,l,t,this._ForceEndValue(),a))}h.SetLastValue(t)}AfterChangeProperty(){}_GetAbsoluteInitialValue(e){const t=this._numericInterpolationAdapter;return e-t.GetCurrentState()}_ForceEndValue(){let e=this._numericInterpolationAdapter,t=e.GetWorldInfo().GetInstance(),s=e.GetPropertyTrack().GetRuntime(),i=s.GetTimelineManager(),r=0;for(const n of i.GetPlayingTimelines())0===n.GetType()?n.HasTrackInstance(t)&&r++:1===n.GetType()&&n.GetInstance()===t&&r++;return r<=1}_MaybeEnsureValue(e,t,s,i,r,n,a,o){const h=this._numericInterpolationAdapter;i?t&&e===t.GetTime()?h._AddDelta(t.GetValueWithResultMode(),t,s,a,o):s&&e===s.GetTime()?h._AddDelta(s.GetValueWithResultMode(),t,s,a,o):s||h._AddDelta(t.GetValueWithResultMode(),t,s,a,o):t&&e===t.GetTime()?h._AddDelta(t.GetValueWithResultMode(),t,s,a,o):s&&e===s.GetTime()?h._AddDelta(s.GetValueWithResultMode(),t,s,a,o):n-r==0&&h._AddDelta(t.GetValueWithResultMode(),t,s,a,o)}}fa.PropertyTrackState.PropertyInterpolationAdapter.NumericInterpolationAdapterForTween=ma}{const ga=self.C3,Sa=self.Ease;ga.PropertyTrackState.NumericTypeAdapter=class{constructor(){}static WillChange(e,t,s,i){let r;switch(i){case\"behavior\":r=t.GetPropertyValueByIndex(e);break;case\"effect\":r=t[e];break;case\"instance-variable\":r=t.GetInstanceVariableValue(e);break;case\"plugin\":r=t.GetPropertyValueByIndex(e)}return r!==s}static Interpolate(n,a,o,h){if(!o){let e=h.GetPropertyTrackDataItem(),t=h.GetPropertyTrackData();return(e=t.GetLastPropertyKeyframeDataItem(e)).GetValueWithResultMode()}let l=h.GetInterpolationMode();if(\"default\"===l&&(l=\"continuous\"),\"discrete\"===(l=\"combo\"===h.GetPropertyType()?\"discrete\":l))return a.GetValueWithResultMode();if(\"continuous\"===l||\"step\"===l){const c=h.GetTimeline().GetStep();if(\"step\"===l&&0!==c){const m=1/c;n=Math.floor(n*m)/m}const u=a.GetValueWithResultMode(),_=o.GetValueWithResultMode(),d=a.GetAddOn(\"cubic-bezier\"),p=o.GetAddOn(\"cubic-bezier\"),f=d&&d.GetStartEnable()&&p&&p.GetEndEnable();if(!f&&u===_)return u;let e=a.GetTime(),t=o.GetTime(),s=(\"step\"===l&&0!==c&&(n=ga.clamp(n,e,t)),ga.normalize(n,e,t)),i=a.GetEase(),r;if(f){const g=t-e;r=Sa.GetRuntimeEase(i)(g*s,0,1,g),r=Sa.GetRuntimeEase(\"cubicbezier\")(r,u,u+d.GetStartAnchor(),_+p.GetEndAnchor(),_)}else r=Sa.GetRuntimeEase(i)((t-e)*s,u,_-u,t-e);return\"integer\"===h.GetPropertyType()?Math.floor(r):r}}}}{const ya=self.C3;ya.PropertyTrackState.AngleTypeAdapter=class{constructor(){}static WillChange(e,t,s,i){let r;switch(i){case\"behavior\":r=t.GetPropertyValueByIndex(e);break;case\"effect\":r=t[e];break;case\"instance-variable\":r=t.GetInstanceVariableValue(e);break;case\"plugin\":r=t.GetPropertyValueByIndex(e)}return r!==s}static Interpolate(e,t,s,i){if(!s){let e=i.GetPropertyTrackDataItem(),t=i.GetPropertyTrackData();return(e=t.GetLastPropertyKeyframeDataItem(e)).GetValueWithResultMode()}let r=i.GetInterpolationMode();if(\"default\"===r&&(r=\"continuous\"),\"discrete\"===(r=\"combo\"===i.GetPropertyType()?\"discrete\":r))return t.GetValueWithResultMode();if(\"continuous\"===r||\"step\"===r){const n=i.GetTimeline().GetStep();if(\"step\"===r&&0!==n){const u=1/n;e=Math.floor(e*u)/u}const a=t.GetTime(),o=s.GetTime(),h=t.GetValueWithResultMode(),l=s.GetValueWithResultMode(),c=(\"step\"===r&&0!==n&&(e=ya.clamp(e,a,o)),t.GetAddOn(\"angle\"));if(!c){if(h===l)return h;const _=ya.normalize(e,a,o),d=self.Ease.GetRuntimeEase(t.GetEase());return ya.angleLerp(h,l,d(_,0,1,1))}{const p=c.GetRevolutions();if(h===l&&0===p)return h;const f=ya.normalize(e,a,o),m=self.Ease.GetRuntimeEase(t.GetEase()),g=m(f,0,1,1);switch(c.GetDirection()){case\"closest\":return ya.angleLerp(h,l,g,p);case\"clockwise\":return ya.angleLerpClockwise(h,l,g,p);case\"anti-clockwise\":return ya.angleLerpAntiClockwise(h,l,g,p)}}}}}}{const Ga=self.C3;Ga.PropertyTrackState.BooleanTypeAdapter=class{constructor(){}static WillChange(e,t,s,i){let r;switch(i){case\"behavior\":r=t.GetPropertyValueByIndex(e);break;case\"effect\":r=t[e];break;case\"instance-variable\":r=t.GetInstanceVariableValue(e);break;case\"plugin\":r=t.GetPropertyValueByIndex(e)}return!!r!=!!s}static Interpolate(e,t,s,i){if(s)return t.GetValueWithResultMode()?1:0;{let e=i.GetPropertyTrackDataItem(),t=i.GetPropertyTrackData();return(e=t.GetLastPropertyKeyframeDataItem(e)).GetValueWithResultMode()?1:0}}}}{const Ia=self.C3,Ta=[0,0,0],Ca=[0,0,0],ba=[0,0,0];Ia.PropertyTrackState.ColorTypeAdapter=class{constructor(){}static WillChange(e,t,s,i){let r;switch(i){case\"behavior\":r=t.GetPropertyValueByIndex(e);break;case\"effect\":r=t[e];break;case\"instance-variable\":r=t.GetInstanceVariableValue(e);break;case\"plugin\":r=t.GetPropertyValueByIndex(e)}return Array.isArray(s)?(Ta[0]=s[0],Ta[1]=s[1],Ta[2]=s[2]):(ba.parseCommaSeparatedRgb(s),Ta[0]=Math.floor(255*ba.getR()),Ta[1]=Math.floor(255*ba.getG()),Ta[2]=Math.floor(255*ba.getB())),Array.isArray(r)?(Ca[0]=r[0],Ca[1]=r[1],Ca[2]=r[2]):(ba.parseCommaSeparatedRgb(r),Ca[0]=Math.floor(255*ba.getR()),Ca[1]=Math.floor(255*ba.getG()),Ca[2]=Math.floor(255*ba.getB())),Ta[0]!==Ca[0]||Ta[1]!==Ca[1]||Ta[2]!==Ca[2]}static Interpolate(e,t,s,i){if(!s){let e=i.GetPropertyTrackDataItem(),t=i.GetPropertyTrackData(),s=(e=t.GetLastPropertyKeyframeDataItem(e)).GetValueWithResultMode();return Ta[0]=s[0],Ta[1]=s[1],Ta[2]=s[2],Ta}let r=i.GetInterpolationMode();if(\"discrete\"===(r=\"default\"===r?\"continuous\":r)){const n=t.GetValueWithResultMode();return Ta[0]=n[0],Ta[1]=n[1],Ta[2]=n[2],Ta}if(\"continuous\"===r||\"step\"===r){const a=i.GetTimeline().GetStep();if(\"step\"===r&&0!==a){const T=1/a;e=Math.floor(e*T)/T}const o=t.GetTime(),h=s.GetTime(),l=t.GetValueWithResultMode(),c=s.GetValueWithResultMode(),u=(\"step\"===r&&0!==a&&(e=Ia.clamp(e,o,h)),Ia.normalize(e,o,h)),_=t.GetEase(),d=l[0],p=l[1],f=l[2],m=c[0],g=c[1],S=c[2],y=self.Ease.GetRuntimeEase(_),G=h-o,I=G*u;return Ta[0]=d===m?d:y(I,d,m-d,G),Ta[1]=p===g?p:y(I,p,g-p,G),Ta[2]=f===S?f:y(I,f,S-f,G),Ta}}}}{const wa=self.C3;wa.PropertyTrackState.TextTypeAdapter=class{constructor(){}static WillChange(e,t,s,i){let r;switch(i){case\"behavior\":r=t.GetPropertyValueByIndex(e);break;case\"effect\":r=t[e];break;case\"instance-variable\":r=t.GetInstanceVariableValue(e);break;case\"plugin\":r=t.GetPropertyValueByIndex(e)}return r!==s}static Interpolate(e,t,s,i){if(s)return t.GetValueWithResultMode();{let e=i.GetPropertyTrackDataItem(),t=i.GetPropertyTrackData();return(e=t.GetLastPropertyKeyframeDataItem(e)).GetValueWithResultMode()}}}}{const xa=self.C3;xa.TimelineDataManager=class{constructor(){this._timelineDataItems=new Map}Release(){for(const e of this._timelineDataItems.values())e.Release();this._timelineDataItems.clear(),this._timelineDataItems=null}Add(e){const t=new xa.TimelineDataItem(e),s=t.GetName();this._timelineDataItems.set(s,t)}Get(e){return this._timelineDataItems.get(e)}GetNameId(){return 0}static _CreateDataItems(e,t,s,i){if(t)for(const r of t)xa.TimelineDataManager._CreateDataItem(\"create\",r,e,s,i)}static _CreateDataItemsIncludingDisabled(e,t,s,i){if(t)for(const r of t)xa.TimelineDataManager._CreateDataItem(\"create-including-disabled\",r,e,s,i)}static _LoadDataItemsFromJson(s,e,t,i){s.length?e.forEach((e,t)=>{s[t]._LoadFromJson(e)}):e.forEach(e=>{xa.TimelineDataManager._CreateDataItem(\"load\",e,s,t,i)})}static _CreateDataItem(e,t,s,i,r){let n;if(\"function\"==typeof i)switch(e){case\"load\":n=new i(null,r);break;case\"create\":case\"create-including-disabled\":n=new i(t,r)}else if(\"object\"==typeof i){const a=i.prop,o=t[a],h=i.map.get(o);switch(e){case\"load\":n=new h(null,r);break;case\"create\":case\"create-including-disabled\":n=new h(t,r)}}switch(e){case\"load\":n._LoadFromJson(t),s.push(n);break;case\"create\":if(\"function\"==typeof n.GetEnable&&!n.GetEnable())return n.Release();s.push(n);break;case\"create-including-disabled\":s.push(n)}}}}{const va=self.C3;va.TimelineDataItem=class{constructor(e){this._name=\"\",this._totalTime=NaN,this._step=0,this._interpolationMode=\"default\",this._resultMode=\"default\",this._loop=!1,this._pingPong=!1,this._repeatCount=1,this._trackData=null,this._startOnLayout=\"\",this._transformWithSceneGraph=!1,this._useSystemTimescale=!0,e&&(this._name=e[0],this._totalTime=e[1],this._step=e[2],this._interpolationMode=e[3],this._resultMode=e[4],this._loop=!!e[6],this._pingPong=!!e[7],this._repeatCount=e[8],this._startOnLayout=e[9],this._transformWithSceneGraph=!!e[10],this._useSystemTimescale=!!e[11],this._trackData=new va.TrackData(e[5],this))}Release(){this._trackData.Release(),this._trackData=null}GetTrackData(){return this._trackData||(this._trackData=new va.TrackData(null,this)),this._trackData}GetName(){return this._name}SetName(e){this._name=e}GetTotalTime(){return this._totalTime}SetTotalTime(e){this._totalTime=e}GetStep(){return this._step}SetStep(e){this._step=e}GetInterpolationMode(){return this._interpolationMode}SetInterpolationMode(e){this._interpolationMode=e}GetResultMode(){return this._resultMode}SetResultMode(e){this._resultMode=e}GetLoop(){return this._loop}SetLoop(e){this._loop=e}GetPingPong(){return this._pingPong}SetPingPong(e){this._pingPong=e}GetRepeatCount(){return this._repeatCount}SetRepeatCount(e){this._repeatCount=e}GetStartOnLayout(){return this._startOnLayout}GetTransformWithSceneGraph(){return this._transformWithSceneGraph}GetUseSystemTimescale(){return this._useSystemTimescale}_SaveToJson(){return{trackDataJson:this._trackData._SaveToJson(),name:this._name,totalTime:this._totalTime,step:this._step,interpolationMode:this._interpolationMode,resultMode:this._resultMode,loop:this._loop,pingPong:this._pingPong,repeatCount:this._repeatCount,startOnLayout:this._startOnLayout,transformWithSceneGraph:!!this._transformWithSceneGraph,useSystemTimescale:this._useSystemTimescale}}_LoadFromJson(e){e&&(this.GetTrackData()._LoadFromJson(e.trackDataJson),this._name=e.name,this._totalTime=e.totalTime,this._step=e.step,this._interpolationMode=e.interpolationMode,this._resultMode=e.resultMode,this._loop=e.loop,this._pingPong=e.pingPong,this._repeatCount=e.repeatCount,this._startOnLayout=e.startOnLayout,this._transformWithSceneGraph=!!e.transformWithSceneGraph,this._useSystemTimescale=!!e.useSystemTimescale)}}}{const Pa=self.C3;class Ra{constructor(e,t){this._trackData=t,this._instanceData=null,this._additionalInstanceData=null,this._instanceUid=NaN,this._objectClassIndex=NaN,this._interpolationMode=\"default\",this._resultMode=\"default\",this._enabled=!1,this._keyframeData=null,this._propertyTrackData=null,this._id=\"\",this._nestedData=null,this._startOffset=0,this._localTotalTime=this._trackData.GetTimelineDataItem().GetTotalTime(),this._type=0,this._name=\"\",e&&(e[0]&&(this._instanceData=e[0],this._instanceUid=e[0][2],this._objectClassIndex=e[0][1]),this._interpolationMode=e[1],this._resultMode=e[2],this._enabled=!!e[3],e[6]&&(this._id=e[6]),e[7]&&(this._nestedData=e[7],this._startOffset=e[7][0],this._localTotalTime=e[7][1]),e[8]&&(this._additionalInstanceData=e[8]),e[8]&&(this._additionalInstanceData=e[8]),e[9]&&(this._type=e[9]),e[10]&&(this._name=e[10]),this._keyframeData=new Pa.KeyframeData(e[4],this),this._propertyTrackData=new Pa.PropertyTrackData(e[5],this))}Release(){this._instanceData=null,this._trackData=null,this._keyframeData&&(this._keyframeData.Release(),this._keyframeData=null),this._propertyTrackData&&(this._propertyTrackData.Release(),this._propertyTrackData=null),this._nestedData=null}GetTrackData(){return this._trackData}GetKeyframeData(){return this._keyframeData||(this._keyframeData=new Pa.KeyframeData(null,this)),this._keyframeData}GetPropertyTrackData(){return this._propertyTrackData||(this._propertyTrackData=new Pa.PropertyTrackData(null,this)),this._propertyTrackData}GetInstanceData(){return this._instanceData}GetObjectClassIndex(){return this._objectClassIndex}SetObjectClassIndex(e){this._objectClassIndex=e}GetInstanceUID(){return this._instanceUid}SetInstanceUID(e){this._instanceUid=e}GetInterpolationMode(){return this._interpolationMode}SetInterpolationMode(e){this._interpolationMode=e}GetResultMode(){return this._resultMode}SetResultMode(e){this._resultMode=e}GetEnable(){return this._enabled}SetEnable(e){this._enabled=!!e}GetId(){return this._id}GetStartOffset(){return this._startOffset}GetLocalTotalTime(){return this._localTotalTime}SetLocalTotalTime(e){this._localTotalTime=e}GetOriginalWidth(){return this._additionalInstanceData[0]}SetOriginalWidth(e){this._additionalInstanceData||(this._additionalInstanceData=[]),this._additionalInstanceData[0]=e}GetOriginalHeight(){return this._additionalInstanceData||(this._additionalInstanceData=[]),this._additionalInstanceData[1]}SetOriginalHeight(e){this._additionalInstanceData||(this._additionalInstanceData=[]),this._additionalInstanceData[1]=e}GetType(){return this._type}GetName(){return this._name}_SaveToJson(){return{keyframeDataJson:this._keyframeData._SaveToJson(),propertyTrackDataJson:this._propertyTrackData._SaveToJson(),instanceData:this._instanceData,additionalInstanceData:this._additionalInstanceData,instanceUid:this._instanceUid,objectClassIndex:this._objectClassIndex,interpolationMode:this._interpolationMode,resultMode:this._resultMode,enabled:this._enabled,id:this._id,nestedData:this._nestedData,type:this._type,name:this._name}}_LoadFromJson(e){e&&(this._instanceData=e.instanceData,this._instanceUid=e.instanceUid,this._objectClassIndex=e.objectClassIndex,this._interpolationMode=e.interpolationMode,this._resultMode=e.resultMode,this._enabled=e.enabled,this._id=e.id,this._type=e.type||0,this._name=e.name||\"\",this._localTotalTime=this._trackData.GetTimelineDataItem().GetTotalTime(),e.nestedData&&(this._nestedData=e.nestedData,this._startOffset=this._nestedData[0],this._localTotalTime=this._nestedData[1]),e.additionalInstanceData&&(this._additionalInstanceData=e.additionalInstanceData),this.GetKeyframeData()._LoadFromJson(e.keyframeDataJson),this.GetPropertyTrackData()._LoadFromJson(e.propertyTrackDataJson))}}Pa.TrackData=class{constructor(e,t){this._timelineDataItem=t,this._trackDataItems=[],Pa.TimelineDataManager._CreateDataItems(this._trackDataItems,e,Ra,this)}Release(){this._timelineDataItem=null;for(const e of this._trackDataItems)e.Release();Pa.clearArray(this._trackDataItems),this._trackDataItems=null}GetTimelineDataItem(){return this._timelineDataItem}AddEmptyTrackDataItem(){const e=new Ra(null,this);return this._trackDataItems.push(e),e}GetFirstKeyframeDataItem(e){return e.GetKeyframeData().GetKeyframeDataItemArray()[0]}GetLastKeyframeDataItem(e){const t=e.GetKeyframeData().GetKeyframeDataItemArray();return t.at(-1)}GetKeyFrameDataItemAtTime(t,e){const s=e.GetKeyframeData().GetKeyframeDataItemArray(),i=s.length;for(let e=0;e<i;e++){const r=s[e];if(r.GetTime()===t)return r}}GetFirstKeyFrameDataItemHigherThan(t,e){const s=e.GetKeyframeData().GetKeyframeDataItemArray(),i=s.length;for(let e=0;e<i;e++){const r=s[e];if(r.GetTime()>t)return r}}GetFirstKeyFrameDataItemHigherOrEqualThan(t,e){const s=e.GetKeyframeData().GetKeyframeDataItemArray(),i=s.length;for(let e=0;e<i;e++){const r=s[e];if(r.GetTime()>=t)return r}}GetFirstKeyFrameDataItemLowerOrEqualThan(t,e){const s=e.GetKeyframeData().GetKeyframeDataItemArray();for(let e=s.length-1;0<=e;e--){const i=s[e];if(i.GetTime()<=t)return i}}*trackDataItems(){for(const e of this._trackDataItems)yield e}_SaveToJson(){return{trackDataItemsJson:this._trackDataItems.map(e=>e._SaveToJson())}}_LoadFromJson(e){e&&Pa.TimelineDataManager._LoadDataItemsFromJson(this._trackDataItems,e.trackDataItemsJson,Ra,this)}}}{const Aa=self.C3;class Ma{constructor(e,t){this._propertyTrackData=t,this._sourceAdapterId=\"\",this._sourceAdapterArguments=null,this._property=null,this._type=null,this._min=NaN,this._max=NaN,this._interpolationMode=\"default\",this._resultMode=\"default\",this._enabled=!1,this._propertyKeyframeData=null,this._canHavePropertyKeyframes=!0,e&&(this._sourceAdapterId=e[0][0],this._sourceAdapterArguments=e[0].slice(1),this._property=e[1],this._type=e[2],this._min=e[3],this._max=e[4],this._interpolationMode=e[5],this._resultMode=e[6],this._enabled=!!e[7],this._propertyKeyframeData=new Aa.PropertyKeyframeData(e[8],this),this._canHavePropertyKeyframes=e[9])}Release(){this._propertyKeyframeData.Release(),this._propertyKeyframeData=null,this._propertyTrackData=null,this._sourceAdapterArguments=null}GetPropertyTrackData(){return this._propertyTrackData}GetPropertyKeyframeData(){return this._propertyKeyframeData||(this._propertyKeyframeData=new Aa.PropertyKeyframeData(null,this)),this._propertyKeyframeData}GetSourceAdapterId(){return this._sourceAdapterId}SetSourceAdapterId(e){this._sourceAdapterId=e}GetSourceAdapterArguments(){return this._sourceAdapterArguments}SetSourceAdapterArguments(e){this._sourceAdapterArguments=e}GetProperty(){return this._property}SetProperty(e){this._property=e}GetType(){return this._type}SetType(e){this._type=e}GetMin(){return this._min}SetMin(e){this._min=e}GetMax(){return this._max}SetMax(e){this._max=e}GetInterpolationMode(){return this._interpolationMode}SetInterpolationMode(e){this._interpolationMode=e}GetResultMode(){return this._resultMode}SetResultMode(e){this._resultMode=e}GetEnable(){return this._enabled}SetEnable(e){this._enabled=!!e}CanHavePropertyKeyframes(){return!!this._canHavePropertyKeyframes}_SaveToJson(){return{propertyKeyframeDataJson:this._propertyKeyframeData._SaveToJson(),sourceAdapterId:this._sourceAdapterId,sourceAdapterArguments:this._sourceAdapterArguments,property:this._property,type:this._type,min:this._min,max:this._max,interpolationMode:this._interpolationMode,resultMode:this._resultMode,enabled:this._enabled,canHavePropertyKeyframes:this._canHavePropertyKeyframes}}_LoadFromJson(e){e&&(this._sourceAdapterId=e.sourceAdapterId,this._sourceAdapterArguments=e.sourceAdapterArguments,this._property=e.property,this._type=e.type,this._min=e.min,this._max=e.max,this._interpolationMode=e.interpolationMode,this._resultMode=e.resultMode,this._enabled=e.enabled,this._canHavePropertyKeyframes=e.canHavePropertyKeyframes,this.GetPropertyKeyframeData()._LoadFromJson(e.propertyKeyframeDataJson))}}Aa.PropertyTrackData=class{constructor(e,t){this._trackDataItem=t,this._propertyTrackDataItems=[],Aa.TimelineDataManager._CreateDataItems(this._propertyTrackDataItems,e,Ma,this)}Release(){this._trackDataItem=null;for(const e of this._propertyTrackDataItems)e.Release();Aa.clearArray(this._propertyTrackDataItems),this._propertyTrackDataItems=null}GetTrackDataItem(){return this._trackDataItem}AddEmptyPropertyTrackDataItem(){const e=new Ma(null,this);return this._propertyTrackDataItems.push(e),e}GetFirstPropertyKeyframeDataItem(e){const t=e.GetPropertyKeyframeData();return t.GetPropertyKeyframeDataItemArray()[0]}GetLastPropertyKeyframeDataItem(e){const t=e.GetPropertyKeyframeData(),s=t.GetPropertyKeyframeDataItemArray();return s.at(-1)}GetPropertyKeyFrameDataItemAtTime(t,e){const s=e.GetPropertyKeyframeData(),i=s.GetPropertyKeyframeDataItemArray(),r=i.length;for(let e=0;e<r;e++){const n=i[e];if(n.GetTime()===t)return n}}GetFirstPropertyKeyFrameDataItemHigherThan(t,e){const s=e.GetPropertyKeyframeData(),i=s.GetPropertyKeyframeDataItemArray(),r=i.length;for(let e=0;e<r;e++){const n=i[e];if(n.GetTime()>t)return n}}GetFirstPropertyKeyFrameDataItemHigherOrEqualThan(t,e){const s=e.GetPropertyKeyframeData(),i=s.GetPropertyKeyframeDataItemArray(),r=i.length;for(let e=0;e<r;e++){const n=i[e];if(n.GetTime()>=t)return n}}GetFirstPropertyKeyFrameDataItemLowerOrEqualThan(t,e){const s=e.GetPropertyKeyframeData(),i=s.GetPropertyKeyframeDataItemArray();for(let e=i.length-1;0<=e;e--){const r=i[e];if(r.GetTime()<=t)return r}}*propertyTrackDataItems(){for(const e of this._propertyTrackDataItems)yield e}_SaveToJson(){return{propertyTrackDataItemsJson:this._propertyTrackDataItems.map(e=>e._SaveToJson())}}_LoadFromJson(e){e&&Aa.TimelineDataManager._LoadDataItemsFromJson(this._propertyTrackDataItems,e.propertyTrackDataItemsJson,Ma,this)}}}{const Da=self.C3;class Ea{constructor(e,t){if(this._keyframeData=t,this._time=-1,this._ease=\"noease\",this._enable=!1,this._tags=null,this._lowerTags=null,e){this._time=e[0],this._ease=e[1],this._enable=!!e[2];const s=e[3];this._tags=s?s.split(\" \"):[],this._lowerTags=new Set(this._tags.map(e=>e.toLowerCase())),this._next=null}}Release(){this._keyframeData=null,Da.clearArray(this._tags),this._tags=null,this._lowerTags.clear(),this._lowerTags=null,this._next=null}GetKeyframeData(){return this._keyframeData}GetNext(){return this._next}SetNext(e){this._next=e}GetTime(){return this._time}SetTime(e){this._time=e,this._keyframeData._LinkKeyframeDataItems()}GetEase(){return this._ease}SetEase(e){this._ease=e}GetEnable(){return this._enable}SetEnable(e){this._enable=!!e}GetTags(){return this._tags}SetTags(e){this._tags=e?e.split(\" \"):[],this._lowerTags=new Set(this._tags.map(e=>e.toLowerCase()))}GetLowerTags(){return this._lowerTags}HasTag(e){return this._lowerTags.has(e.toLowerCase())}_SaveToJson(){return{time:this._time,ease:this._ease,enable:this._enable,tags:this._tags}}_LoadFromJson(e){e&&(this._time=e.time,this._ease=e.ease,this._enable=e.enable,this._tags=e.tags,this._lowerTags=new Set(this._tags.map(e=>e.toLowerCase())))}}Da.KeyframeData=class{constructor(e,t){this._trackDataItem=t,this._keyframeDataItems=[],Da.TimelineDataManager._CreateDataItems(this._keyframeDataItems,e,Ea,this),this._LinkKeyframeDataItems()}Release(){this._trackDataItem=null;for(const e of this._keyframeDataItems)e.Release();Da.clearArray(this._keyframeDataItems),this._keyframeDataItems=null}_LinkKeyframeDataItems(){this._keyframeDataItems.sort((e,t)=>e.GetTime()-t.GetTime());for(let e=0;e<this._keyframeDataItems.length;e++){const t=this._keyframeDataItems[e];t.SetNext(this._keyframeDataItems[e+1])}}GetTrackDataItem(){return this._trackDataItem}GetKeyframeDataItemCount(){return this._keyframeDataItems.length}GetKeyframeDataItemArray(){return this._keyframeDataItems}AddEmptyKeyframeDataItem(){const e=new Ea(null,this);return this._keyframeDataItems.push(e),this._LinkKeyframeDataItems(),e}DeleteKeyframeDataItems(e){for(const t of this._keyframeDataItems)if(e(t)){const s=this._keyframeDataItems.indexOf(t);-1!==s&&(t.Release(),this._keyframeDataItems.splice(s,1))}this.SortKeyframeDataItems(),this._LinkKeyframeDataItems()}SortKeyframeDataItems(){this._keyframeDataItems.sort((e,t)=>e.GetTime()-t.GetTime())}GetKeyframeDataItemIndex(e){return this._keyframeDataItems.indexOf(e)}GetKeyframeDataItemFromIndex(e){return this._keyframeDataItems[e]}*keyframeDataItems(){for(const e of this._keyframeDataItems)yield e}*keyframeDataItemsReverse(){for(let e=this._keyframeDataItems.length-1;0<=e;e--)yield this._keyframeDataItems[e]}_SaveToJson(){return{keyframeDataItemsJson:this._keyframeDataItems.map(e=>e._SaveToJson())}}_LoadFromJson(e){e&&(Da.TimelineDataManager._LoadDataItemsFromJson(this._keyframeDataItems,e.keyframeDataItemsJson,Ea,this),this._LinkKeyframeDataItems())}}}{const Fa=self.C3;class Ba{constructor(e,t){this._propertyKeyframeData=t,this._value=null,this._aValue=null,this._type=\"\",this._time=NaN,this._ease=\"noease\",this._enable=!1,this._addonData=null,this._addonInstance=void 0,this._pathMode=\"line\",e&&(this._value=e[0][0],this._aValue=e[0][1],this._type=e[0][2],this._time=e[1],this._ease=e[2],this._enable=!!e[3],this._pathMode=e[5],this._addonData=null,e[4]&&(this._addonData=new Fa.AddonData(e[4],this)),this._next=null,this._prev=null)}Release(){this._propertyKeyframeData=null,this._addonData&&(this._addonData.Release(),this._addonData=null),this._next=null,this._prev=null}GetAddonData(){return this._addonData}SetNext(e){this._next=e}GetNext(){return this._next}SetPrevious(e){this._prev=e}GetPrevious(){return this._prev}GetValue(){return this._value}SetValue(e){\"color\"===this._type&&Fa.IsFiniteNumber(e)?(this._value[0]=Fa.GetRValue(e),this._value[1]=Fa.GetGValue(e),this._value[2]=Fa.GetBValue(e)):this._value=e}GetAbsoluteValue(){return this._aValue}SetAbsoluteValue(e){\"color\"===this._type&&Fa.IsFiniteNumber(e)?(this._aValue[0]=Fa.GetRValue(e),this._aValue[1]=Fa.GetGValue(e),this._aValue[2]=Fa.GetBValue(e)):this._aValue=e}GetValueWithResultMode(){const e=this._propertyKeyframeData.GetPropertyTrackDataItem().GetResultMode();return\"relative\"===e?this.GetValue():\"absolute\"===e?this.GetAbsoluteValue():void 0}GetType(){return this._type}SetType(e){this._type=e}GetTime(){return this._time}SetTime(e){this._time=e,this._propertyKeyframeData._LinkPropertyKeyframeDataItems()}GetEase(){return this._ease}SetEase(e){this._ease=e}GetEnable(){return this._enable}SetEnable(e){this._enable=!!e}GetPathMode(){return this._pathMode}GetAddOn(t){if(this._addonData){if(!this._addonInstance&&null!==this._addonInstance){const s=this._addonData.GetAddDataItemArray();if(s){const i=s.length;for(let e=0;e<i;e++){const r=s[e];if(r.GetId()===t)return this._addonInstance=r,this._addonInstance}}this._addonInstance=null}return this._addonInstance}}_SaveToJson(){const e=this._addonData;return{addonDataJson:e&&e._SaveToJson(),value:this._value,aValue:this._aValue,type:this._type,time:this._time,ease:this._ease,enable:this._enable}}_LoadFromJson(e){e&&(e.addonDataJson&&this._addonData._SetFromJson(e.addonDataJson),this._value=e.value,this._aValue=e.aValue,this._type=e.type,this._time=e.time,this._ease=e.ease,this._enable=e.enable)}}Fa.PropertyKeyframeData=class{constructor(e,t){this._propertyTrackDataItem=t,this._propertyKeyframeDataItems=[],this._propertyKeyframeDataItemsIncludingDisabled=[],Fa.TimelineDataManager._CreateDataItems(this._propertyKeyframeDataItems,e,Ba,this),Fa.TimelineDataManager._CreateDataItemsIncludingDisabled(this._propertyKeyframeDataItemsIncludingDisabled,e,Ba,this),this._LinkPropertyKeyframeDataItems()}Release(){this._propertyTrackDataItem=null;for(const e of this._propertyKeyframeDataItems)e.Release();Fa.clearArray(this._propertyKeyframeDataItems),this._propertyKeyframeDataItems=null;for(const t of this._propertyKeyframeDataItemsIncludingDisabled)t.Release();Fa.clearArray(this._propertyKeyframeDataItemsIncludingDisabled),this._propertyKeyframeDataItemsIncludingDisabled=null}_LinkPropertyKeyframeDataItems(){let t=this._propertyKeyframeDataItems;t.sort((e,t)=>e.GetTime()-t.GetTime());for(let e=0;e<t.length;e++){const s=t[e];e+1<t.length&&s.SetNext(t[e+1]),0<=e-1&&s.SetPrevious(t[e-1])}(t=this._propertyKeyframeDataItemsIncludingDisabled).sort((e,t)=>e.GetTime()-t.GetTime());for(let e=0;e<t.length;e++){const i=t[e];e+1<t.length&&i.SetNext(t[e+1]),0<=e-1&&i.SetPrevious(t[e-1])}}AddEmptyPropertyKeyframeDataItem(){const e=new Ba(null,this);return this._propertyKeyframeDataItems.push(e),this._LinkPropertyKeyframeDataItems(),e}DeletePropertyKeyframeDataItems(e){for(const t of this._propertyKeyframeDataItems)if(e(t)){const s=this._propertyKeyframeDataItems.indexOf(t);-1!==s&&(t.Release(),this._propertyKeyframeDataItems.splice(s,1))}this.SortPropertyKeyFrameDataItems(),this._LinkPropertyKeyframeDataItems()}SortPropertyKeyFrameDataItems(){this._propertyKeyframeDataItems.sort((e,t)=>e.GetTime()-t.GetTime())}GetPropertyTrackDataItem(){return this._propertyTrackDataItem}GetPropertyKeyframeDataItemCount(){return this._propertyKeyframeDataItems.length}GetLastPropertyKeyframeDataItem(){return this._propertyKeyframeDataItems[this._propertyKeyframeDataItems.length-1]}GetPropertyKeyframeDataItemArray(){return this._propertyKeyframeDataItems}GetPropertyKeyframeDataItemArrayIncludingDisabled(){return this._propertyKeyframeDataItemsIncludingDisabled}*propertyKeyframeDataItems(){for(const e of this._propertyKeyframeDataItems)yield e}*propertyKeyframeDataItemsReverse(){for(let e=this._propertyKeyframeDataItems.length-1;0<=e;e--)yield this._propertyKeyframeDataItems[e]}_SaveToJson(){const e=this._propertyKeyframeDataItems,t=this._propertyKeyframeDataItemsIncludingDisabled;return{propertyKeyframeDataItemsJson:e.map(e=>e._SaveToJson()),propertyKeyframeDataItemsIncludingDisabledJson:t.map(e=>e._SaveToJson())}}_LoadFromJson(e){e&&(Fa.TimelineDataManager._LoadDataItemsFromJson(this._propertyKeyframeDataItems,e.propertyKeyframeDataItemsJson,Ba,this),Fa.TimelineDataManager._LoadDataItemsFromJson(this._propertyKeyframeDataItemsIncludingDisabled,e.propertyKeyframeDataItemsIncludingDisabledJson,Ba,this),this._LinkPropertyKeyframeDataItems())}}}{const Oa=self.C3;class La{constructor(e,t){this._addonData=t,this._id=e[0],this._data=e[1]}Release(){this._addonData=null,this._data=null}GetAddonData(){return this._addonData}GetId(){return this._id}_SaveToJson(){return{id:this._id,data:this._data}}_LoadFromJson(e){e&&(this._id=e.id,this._data=e.data)}}class ka extends La{constructor(e,t){super(e,t),this._startAnchor=this._data[0],this._startEnable=!!this._data[1],this._endAnchor=this._data[2],this._endEnable=!!this._data[3]}Release(){super.Release()}GetStartAnchor(){return this._startAnchor}GetStartEnable(){return this._startEnable}GetEndAnchor(){return this._endAnchor}GetEndEnable(){return this._endEnable}_SaveToJson(){return Object.assign(super._SaveToJson(),{startAnchor:this._startAnchor,startEnable:!!this._startEnable,endAnchor:this._endAnchor,endEnable:!!this._endEnable})}_LoadFromJson(e){e&&(super._LoadFromJson(e),this._startAnchor=e.startAnchor,this._startEnable=!!e.startEnable,this._endAnchor=e.endAnchor,this._endEnable=!!e.endEnable)}}class Na extends La{constructor(e,t){super(e,t),this._direction=this._data[0],this._revolutions=this._data[1]}Release(){super.Release()}GetDirection(){return this._direction}GetRevolutions(){return this._revolutions}_SaveToJson(){return Object.assign(super._SaveToJson(),{direction:this._direction,revolutions:this._revolutions})}_LoadFromJson(e){e&&(super._LoadFromJson(e),this._direction=e.direction,this._revolutions=e.revolutions)}}Oa.AddonData=class{constructor(e,t){this._propertyKeyframeDataItem=t,this._addonDataItems=[],Oa.TimelineDataManager._CreateDataItems(this._addonDataItems,e,{prop:0,map:new Map([[\"cubic-bezier\",ka],[\"angle\",Na]])},this)}Release(){this._propertyKeyframeDataItem=null;for(const e of this._addonDataItems)e.Release();Oa.clearArray(this._addonDataItems),this._addonDataItems=null}GetPropertyKeyframeDataItem(){return this._propertyKeyframeDataItem}GetAddDataItemArray(){return this._addonDataItems}*addonDataItems(){for(const e of this._addonDataItems)yield e}_SaveToJson(){return{addonDataItemsJson:this._addonDataItems.map(e=>e._SaveToJson())}}_LoadFromJson(e){e&&Oa.TimelineDataManager._LoadDataItemsFromJson(this._addonDataItems,e.addonDataItemsJson,{prop:\"id\",map:new Map([[\"cubic-bezier\",ka],[\"angle\",Na]])},this)}}}{let f=self.C3,s=0;f.TweenState=class extends f.TimelineState{constructor(e,t){super(\"tween-\"+s++,e,t),this._id=\"\",this._destroyInstanceOnComplete=!1,this._initialValueMode=\"start-value\",this._instance=null,this._on_completed_callbacks=null,this._on_started_callbacks=null,this._track=null,this._iTweenState=null}FireReleaseEvent(e){const t=f.New(f.Event,\"tweenstatereleased\");t.tweenState=this,e.dispatchEvent(t)}GetType(){return 1}CreateTrackStates(){for(const e of this._timelineDataItem.GetTrackData().trackDataItems())this._tracks.push(f.TweenTrackState.Create(this,e));this._track=this._tracks[0]}AddTrack(){const e=this._timelineDataItem.GetTrackData().AddEmptyTrackDataItem(),t=f.TweenTrackState.Create(this,e);return this._tracks.push(t),this._CacheTrack(),t}_CacheTrack(){this._track=this._tracks[0]}GetPropertyTrack(e){return this._track.GetPropertyTracks()[0]}SetPropertyType(e){this._propertyType=e}GetInstance(){const e=this.GetTracks();if(e&&e.length){const t=e[0];if(this._track=t){const s=t.GetInstance();return t.IsInstanceValid()?s:void 0}}}AddStartedCallback(e){this._on_started_callbacks||(this._on_started_callbacks=[]),this._on_started_callbacks.push(e)}AddCompletedCallback(e){this._on_completed_callbacks||(this._on_completed_callbacks=[]),this._on_completed_callbacks.push(e)}RemoveStartedCallback(e){if(this._on_started_callbacks){const t=this._on_started_callbacks.indexOf(e);-1!==t&&this._on_started_callbacks.splice(t,1)}}RemoveCompletedCallback(e){if(this._on_completed_callbacks){const t=this._on_completed_callbacks.indexOf(e);-1!==t&&this._on_completed_callbacks.splice(t,1)}}SetStartValue(e,t){for(const s of this._tracks)for(const i of s._propertyTracks)if(i.GetPropertyName()===t){const r=i.GetPropertyTrackData(),n=i.GetPropertyTrackDataItem(),a=r.GetFirstPropertyKeyframeDataItem(n);a.SetValue(e),a.SetAbsoluteValue(e)}}_GetPropertyTrackState(e){for(const t of this._tracks)for(const s of t._propertyTracks)if(s.GetPropertyName()===e)return s}BeforeSetEndValues(e){for(const t of e){const s=this._GetPropertyTrackState(t);this.SetStartValue(s.GetCurrentState(),t)}if(this.IsForwardPlayBack()){const i=this.GetTotalTime()-this.GetTime();this.SetTotalTime(i);for(const r of this._tracks)r.SetLocalTotalTime(i);this._SetTime(0)}else{const n=this.GetTime();this.SetTotalTime(n);for(const a of this._tracks)a.SetLocalTotalTime(n);this._SetTime(n)}this.SetInitialStateFromSetTime()}SetEndValue(e,t){const s=this._GetPropertyTrackState(t),i=s.GetPropertyTrackData(),r=s.GetPropertyTrackDataItem(),n=i.GetLastPropertyKeyframeDataItem(r);n.SetTime(this.GetTotalTime()),n.SetValue(e),n.SetAbsoluteValue(e)}SetId(e){this._id=e}GetId(){return this._id}SetInitialValueMode(e){this._initialValueMode=e}GetInitialValueMode(){return this._initialValueMode}SetDestroyInstanceOnComplete(e){this._destroyInstanceOnComplete=e}GetDestroyInstanceOnComplete(){return this._destroyInstanceOnComplete}OnStarted(){if(this._on_started_callbacks)for(const e of this._on_started_callbacks)e(this);if(!this.IsComplete())for(const t of this._tracks)t.CompareSaveStateWithCurrent()}OnCompleted(){this._completedTick=this._runtime.GetTickCount()}FinishTriggers(){if(!this._finishedTriggers&&(this._finishedTriggers=!0,this._on_completed_callbacks))for(const e of this._on_completed_callbacks)e(this)}SetTime(e){this._DeleteIntermediateKeyframes(),super.SetTime(e)}_SetTimeAndReset(e){(e=f.IsFiniteNumber(e)?e:this.GetTotalTime())<0?this._playheadTime=0:e>=this.GetTotalTime()?this._playheadTime=this.GetTotalTime():this._playheadTime=e,this._track.SetResetState()}SetInitialState(e){if(!this.InitialStateSet()&&\"current-state\"===this.GetInitialValueMode())for(const t of this._tracks)t.CompareInitialStateWithCurrent();super.SetInitialState(e)}Stop(e=!1){if(super.Stop(e),!this.IsComplete())for(const t of this._tracks)t.SaveState()}Reset(e=!0,t=!1){this._DeleteIntermediateKeyframes(),super.Reset(e,t)}_DeleteIntermediateKeyframes(){for(const e of this._tracks){const t=e=>{const t=e.GetTime(),s=this.GetTotalTime();return 0!==t&&t!==s};e.DeleteKeyframes(t),e.DeletePropertyKeyframes(t)}}_OnBeforeChangeLayout(){if(!this.IsReleased()){const e=this.GetInstance();if(e&&e.GetObjectClass().IsGlobal())return!1;this._timelineManager.CompleteTimelineBeforeChangeOfLayout(this),this.ResetBeforeChangeLayout()}return!0}Tick(r,e,t){if(this._instance||(this._instance=this.GetInstance()),!this._instance||this._instance.IsDestroyed())this.Stop(!0),this.OnCompleted();else{const s=this._instance.GetTimeScale();if(0!==(r=-1!==s?t*s:r)||0!==this._lastDelta){this._lastDelta=r;const n=this._playheadTime+this._overshoot,a=r*this._playbackRate,o=n+a,h=this._timelineDataItem._totalTime;o<0?(this._playheadTime=0,this._overshoot=-o):h<=o?(this._playheadTime=h,this._overshoot=this._playheadTime-o):(this._playheadTime=o,this._overshoot=0);let e=!1,t=!1,s=this.GetLoop(),i=this.GetPingPong();s||i?s&&!i?0<this._playbackRate?this._playheadTime>=h&&(this._SetTimeAndReset(0),this._TweenTrigger(f.Behaviors.Tween.Cnds.OnAnyTweenLoop),this._TweenTrigger(f.Behaviors.Tween.Cnds.OnTweensLoop),t=!0):this._playheadTime<=0&&(this._SetTimeAndReset(h),this._TweenTrigger(f.Behaviors.Tween.Cnds.OnAnyTweenLoop),this._TweenTrigger(f.Behaviors.Tween.Cnds.OnTweensLoop),t=!0):!s&&i?0<this._playbackRate?this._playheadTime>=h&&(this._SetTime(h),this.SetPlaybackRate(-1*this.GetPlaybackRate()),t=!0,1===this._pingPongState?this._currentRepeatCount<this.GetRepeatCount()?(this._currentRepeatCount++,this._TweenTrigger(f.Behaviors.Tween.Cnds.OnAnyTweenLoop),this._TweenTrigger(f.Behaviors.Tween.Cnds.OnTweensLoop),this._TweenTrigger(f.Behaviors.Tween.Cnds.OnAnyTweenPingPong),this._TweenTrigger(f.Behaviors.Tween.Cnds.OnTweensPingPong),this._pingPongState=0):(this._TweenTrigger(f.Behaviors.Tween.Cnds.OnAnyTweenPingPong),this._TweenTrigger(f.Behaviors.Tween.Cnds.OnTweensPingPong),e=!0):0===this._pingPongState&&(this._TweenTrigger(f.Behaviors.Tween.Cnds.OnAnyTweenPingPong),this._TweenTrigger(f.Behaviors.Tween.Cnds.OnTweensPingPong),this._pingPongState=1)):this._playheadTime<=0&&(this._SetTime(0),this.SetPlaybackRate(-1*this.GetPlaybackRate()),t=!0,1===this._pingPongState?this._currentRepeatCount<this.GetRepeatCount()?(this._currentRepeatCount++,this._TweenTrigger(f.Behaviors.Tween.Cnds.OnAnyTweenLoop),this._TweenTrigger(f.Behaviors.Tween.Cnds.OnTweensLoop),this._TweenTrigger(f.Behaviors.Tween.Cnds.OnAnyTweenPingPong),this._TweenTrigger(f.Behaviors.Tween.Cnds.OnTweensPingPong),this._pingPongState=0):(e=!0,this._TweenTrigger(f.Behaviors.Tween.Cnds.OnAnyTweenPingPong),this._TweenTrigger(f.Behaviors.Tween.Cnds.OnTweensPingPong)):0===this._pingPongState&&(this._TweenTrigger(f.Behaviors.Tween.Cnds.OnAnyTweenPingPong),this._TweenTrigger(f.Behaviors.Tween.Cnds.OnTweensPingPong),this._pingPongState=1)):s&&i&&(0<this._playbackRate?this._playheadTime>=h&&(this._SetTime(h),this.SetPlaybackRate(-1*this.GetPlaybackRate()),t=!0,0===this._pingPongState&&(this._TweenTrigger(f.Behaviors.Tween.Cnds.OnAnyTweenPingPong),this._TweenTrigger(f.Behaviors.Tween.Cnds.OnTweensPingPong)),1===this._pingPongState&&(this._TweenTrigger(f.Behaviors.Tween.Cnds.OnAnyTweenLoop),this._TweenTrigger(f.Behaviors.Tween.Cnds.OnTweensLoop),this._TweenTrigger(f.Behaviors.Tween.Cnds.OnAnyTweenPingPong),this._TweenTrigger(f.Behaviors.Tween.Cnds.OnTweensPingPong)),this._pingPongState++,this._pingPongState=f.wrap(this._pingPongState,0,2)):this._playheadTime<=0&&(this._SetTime(0),this.SetPlaybackRate(-1*this.GetPlaybackRate()),t=!0,0===this._pingPongState&&(this._TweenTrigger(f.Behaviors.Tween.Cnds.OnAnyTweenPingPong),this._TweenTrigger(f.Behaviors.Tween.Cnds.OnTweensPingPong)),1===this._pingPongState&&(this._TweenTrigger(f.Behaviors.Tween.Cnds.OnAnyTweenLoop),this._TweenTrigger(f.Behaviors.Tween.Cnds.OnTweensLoop),this._TweenTrigger(f.Behaviors.Tween.Cnds.OnAnyTweenPingPong),this._TweenTrigger(f.Behaviors.Tween.Cnds.OnTweensPingPong)),this._pingPongState++,this._pingPongState=f.wrap(this._pingPongState,0,2))):0<this._playbackRate?this._playheadTime>=h&&(this._currentRepeatCount<this.GetRepeatCount()?(this._currentRepeatCount++,this._SetTimeAndReset(0),this._TweenTrigger(f.Behaviors.Tween.Cnds.OnAnyTweenLoop),this._TweenTrigger(f.Behaviors.Tween.Cnds.OnTweensLoop),t=!0):(this._SetTime(h),e=!0)):this._playheadTime<=0&&(this._currentRepeatCount<this.GetRepeatCount()?(this._currentRepeatCount++,this._SetTimeAndReset(h),this._TweenTrigger(f.Behaviors.Tween.Cnds.OnAnyTweenLoop),this._TweenTrigger(f.Behaviors.Tween.Cnds.OnTweensLoop),t=!0):(this._SetTime(0),e=!0)),e?(this._track.SetEndState(),this.Stop(!0),this.OnCompleted()):(this._track.Interpolate(this._playheadTime,!0,!1,t,this._firstTick,!1),this._firstTick&&(this._firstTick=!1))}}}_TweenTrigger(e){const t=this.GetInstance(),s=t.GetBehaviorSdkInstanceFromCtor(f.Behaviors.Tween);s.PushTriggerTween(this),this._runtime.Trigger(e,t,s.GetBehaviorType()),s.PopTriggerTween()}_SaveToJson(){const e=super._SaveToJson(),t=this.GetTimelineDataItem();return Object.assign(e,{tweenDataItemJson:t._SaveToJson(),id:this._id,destroyInstanceOnComplete:this._destroyInstanceOnComplete,initialValueMode:this._initialValueMode})}_LoadFromJson(e){if(e){const t=this.GetTimelineDataItem();t._LoadFromJson(e.tweenDataItemJson),super._LoadFromJson(e),this._id=e.id,this._destroyInstanceOnComplete=e.destroyInstanceOnComplete,this._initialValueMode=e.initialValueMode,this._CacheTrack()}}static IsPlaying(e){return e.IsPlaying()}static IsPaused(e){return e.IsPaused()}static IsPing(e){return!!e.GetPingPong()&&0===e.GetPingPongState()}static IsPong(e){return!!e.GetPingPong()&&1===e.GetPingPongState()}static Build(e){const t=e.runtime.GetTimelineManager(),s=new f.TimelineDataItem;if(e.json){s._LoadFromJson(e.json.tweenDataItemJson);const i=new f.TweenState(s,t);return i._LoadFromJson(e.json),i}{const r=new f.TweenState(s,t),n=(f.IsArray(e.propertyTracksConfig)||(e.propertyTracksConfig=[e.propertyTracksConfig]),r.SetId(e.id),r.SetTags(e.tags),r.SetInitialValueMode(e.initialValueMode),r.SetDestroyInstanceOnComplete(e.releaseOnComplete),r.SetLoop(e.loop),r.SetPingPong(e.pingPong),r.SetTotalTime(e.time),r.SetStep(0),r.SetInterpolationMode(\"default\"),r.SetResultMode(e.propertyTracksConfig[0].resultMode),r.SetRepeatCount(e.repeatCount),r.AddTrack()),a=(n.SetInstanceUID(e.instance.GetUID()),n.SetInterpolationMode(\"default\"),n.SetResultMode(e.propertyTracksConfig[0].resultMode),n.SetEnable(!0),n.SetObjectClassIndex(e.instance.GetObjectClass().GetIndex()),e.instance.GetSdkInstance()),o=a.IsOriginalSizeKnown()?a.GetOriginalWidth():e.instance.GetWorldInfo().GetWidth(),h=a.IsOriginalSizeKnown()?a.GetOriginalHeight():e.instance.GetWorldInfo().GetHeight(),l=(n.SetOriginalWidth(o),n.SetOriginalHeight(h),n.AddKeyframe()),c=(l.SetTime(0),l.SetEase(\"noease\"),l.SetEnable(!0),l.SetTags(\"\"),n.AddKeyframe());c.SetTime(e.time),c.SetEase(\"noease\"),c.SetEnable(!0),c.SetTags(\"\");for(const u of e.propertyTracksConfig){const _=n.AddPropertyTrack(),d=(_.SetSourceAdapterId(u.sourceId),_.SetSourceAdapterArgs(u.sourceArgs),_.SetPropertyName(u.property),_.SetPropertyType(u.type),_.SetMin(NaN),_.SetMax(NaN),_.SetInterpolationMode(\"default\"),_.SetResultMode(u.resultMode),_.SetEnable(!0),_.AddPropertyKeyframe()),p=(d.SetType(u.valueType),d.SetTime(0),d.SetEase(u.ease),d.SetEnable(!0),d.SetValue(u.startValue),d.SetAbsoluteValue(u.startValue),_.AddPropertyKeyframe());p.SetType(u.valueType),p.SetTime(e.time),p.SetEase(u.ease),p.SetEnable(!0),p.SetValue(u.endValue),p.SetAbsoluteValue(u.endValue),_.GetSourceAdapter()}return r}}static SetInstanceUID(e,t){if(!isNaN(t))for(const s of e.GetTracks())s.SetInstanceUID(t)}GetITweenState(e,t){return this._iTweenState||(this._iTweenState=f.New(self.ITweenState,this,e,t)),this._iTweenState}}}{const Wa=self.C3;Wa.TweenTrackState=class extends Wa.TrackState{constructor(e,t){super(e,t),this._firstPropertyTrack=null,this._secondPropertyTrack=null}static Create(e,t){return Wa.New(Wa.TweenTrackState,e,t)}_CachePropertyTracks(){1===this._propertyTracks.length?this._firstPropertyTrack=this._propertyTracks[0]:(this._firstPropertyTrack=this._propertyTracks[0],this._secondPropertyTrack=this._propertyTracks[1])}CreatePropertyTrackStates(){for(const e of this._trackDataItem.GetPropertyTrackData().propertyTrackDataItems())this._propertyTracks.push(Wa.TweenPropertyTrackState.Create(this,e));this._CachePropertyTracks()}AddPropertyTrack(){const e=this._trackDataItem.GetPropertyTrackData(),t=e.AddEmptyPropertyTrackDataItem(),s=Wa.TweenPropertyTrackState.Create(this,t);return this._propertyTracks.push(s),this._CachePropertyTracks(),s}SetInitialState(){if(this.MaybeGetInstance(),this.IsInstanceValid()||!this.IsInstanceTrack()){const e=this.GetTimeline(),t=e.IsForwardPlayBack(),s=t?0:this.GetLocalTotalTime();for(const r of this._propertyTracks)r.SetInitialState(s),0===this._worldInfoChange&&1===r.GetWorldInfoChange()&&(this._worldInfoChange=1),0===this._renderChange&&1===r.GetRenderChange()&&(this._renderChange=1);this._needsBeforeAndAfter=0;const i=this._propertyTracks.some(e=>e.GetNeedsBeforeAndAfter());i&&(this._needsBeforeAndAfter=1),this._lastKeyframeDataItem=this._GetLastKeyFrameBeforeTime(s),this._initialStateOfNestedSet=!1,this._endStateOfNestedSet=!1,this.Interpolate(s)}}BeforeInterpolate(){}Interpolate(e,t=0,s=!1,i=!1,r,n=!1,a=!1){if(this._instance||this.GetInstance(),this._instance){const o=!this._instance.IsDestroyed();return o&&(!n||!this.GetObjectClass().IsGlobal())&&((this._secondPropertyTrack?(this._firstPropertyTrack.Interpolate(e,s,i,a),this._secondPropertyTrack):this._firstPropertyTrack).Interpolate(e,s,i,a),void(0!==this._firstPropertyTrack.GetWorldInfoChange()&&(this._worldInfo||(this._worldInfo=this._instance.GetWorldInfo()),this._worldInfo)&&this._worldInfo.SetBboxChanged()))}}AfterInterpolate(){}_LoadFromJson(e){super._LoadFromJson(e),this._CachePropertyTracks()}}}{const Va=self.C3;Va.TweenPropertyTrackState=class extends Va.PropertyTrackState{constructor(e,t){super(e,t),this._basic=!1}static Create(e,t){return Va.New(Va.TweenPropertyTrackState,e,t)}Interpolate(e,t=!1,s=!1,i=!1){let r,n;if(this._basic)r=this._propertyKeyframeDataItems[0],n=this._propertyKeyframeDataItems[1];else{if(t)r=this._propertyTrackData.GetFirstPropertyKeyFrameDataItemLowerOrEqualThan(e,this._propertyTrackDataItem);else{if(this._lastPropertyKeyframeDataItem){const a=this.GetTimeline(),o=this._lastPropertyKeyframeDataItem.GetNext(),h=this._lastPropertyKeyframeDataItem.GetTime(),l=o?o.GetTime():a.GetTotalTime();(e<=h||l<=e)&&(this._lastPropertyKeyframeDataItem=this._propertyTrackData.GetFirstPropertyKeyFrameDataItemLowerOrEqualThan(e,this._propertyTrackDataItem))}else this._lastPropertyKeyframeDataItem=this._propertyTrackData.GetFirstPropertyKeyFrameDataItemLowerOrEqualThan(e,this._propertyTrackDataItem);r=this._lastPropertyKeyframeDataItem}n=r.GetNext()}this._sourceAdapter.Interpolate(e,r,n,t,s,i)}AddPropertyKeyframe(){const e=this._propertyTrackDataItem.GetPropertyKeyframeData(),t=e.AddEmptyPropertyKeyframeDataItem();return this._lastPropertyKeyframeDataItem=null,this._basic=this.GetPropertyKeyframeDataItems().length<=2,t}DeletePropertyKeyframes(e){this._lastPropertyKeyframeDataItem=null;const t=this._propertyTrackDataItem.GetPropertyKeyframeData();t.DeletePropertyKeyframeDataItems(e),this._basic=this.GetPropertyKeyframeDataItems().length<=2}_SaveToJson(){return{sourceAdapterJson:this.GetSourceAdapter()._SaveToJson(),basic:this._basic}}_LoadFromJson(e){e&&(this.GetSourceAdapter()._LoadFromJson(e.sourceAdapterJson),this._basic=e.basic)}}}{const Ua=self.C3,ja=self.Ease;Ua.Transition=class extends Ua.DefendedBase{constructor(e,t=!0){super(),this._name=e[0],this._linear=e[2],this._transitionKeyframes=[];for(const s of e[1]){const i=Ua.TransitionKeyframe.Create(this,s);this._transitionKeyframes.push(i)}for(let e=0;e<this._transitionKeyframes.length;e++){const r=this._transitionKeyframes[e],n=this._transitionKeyframes[e+1],a=this._transitionKeyframes[e-1];r.SetNext(n),r.SetPrevious(a)}this._precalculatedSamples=new Map,this._transitionKeyframeCache=new Map,this._PreCalcSamples(),t&&ja.AddCustomEase(this._name,(e,t,s,i)=>this.Interpolate(e,t,s,i),null,{transition:this})}static Create(e){return Ua.New(Ua.Transition,e)}Release(){for(const e of this._transitionKeyframes)e.Release();Ua.clearArray(this._transitionKeyframes),this._transitionKeyframes=null,this._precalculatedSamples.clear(),this._precalculatedSamples=null,this._transitionKeyframeCache.clear(),this._transitionKeyframeCache=null}MakeLinear(e){this._linear=!!e}GetTransitionKeyFrameAt(e){const t=this._transitionKeyframeCache.get(e);if(t)return t;for(const s of this._transitionKeyframes)if(s.GetValueX()===e)return this._transitionKeyframeCache.set(e,s),s}GetFirstTransitionKeyFrameLowerOrEqualThan(t){for(let e=this._transitionKeyframes.length-1;0<=e;e--){const s=this._transitionKeyframes[e],i=s.GetValueX();if(i<=t){let e=s;if(i<t)return e;if(i===t){for(;e;){const r=e.GetPrevious();if(!r)break;if(r.GetValueX()!==e.GetValueX())break;e=r}return e}}}}Interpolate(e,t,s,i){let r=e/i;if(this._linear){const S=this.GetTransitionKeyFrameAt(0),y=this.GetTransitionKeyFrameAt(1),G=t+(t+s)*S.GetValueY(),I=(t+s)*y.GetValueY(),T=I-G;return 0===i?G+T:ja.NoEase(e,G,T,i)}0===i&&(r=1);let n=this.GetFirstTransitionKeyFrameLowerOrEqualThan(r),a=n.GetNext();if(!a){const C=n.GetPrevious(),b=n;n=C,a=b}const o=a.GetValueX()-n.GetValueX(),h=Ua.mapToRange(r,n.GetValueX(),a.GetValueX(),0,o);if(n.IsSegmentLinear()||0==o){const w=t+(t+s)*n.GetValueY(),x=(t+s)*a.GetValueY(),v=x-w;return 0==o?1===h?w+v:w:ja.NoEase(h,w,v,o)}let l=n.GetValueX(),c=n.GetValueY(),u=n.GetValueX()+n.GetStartAnchorX(),_=n.GetValueY()+n.GetStartAnchorY(),d=a.GetValueX()+a.GetEndAnchorX(),p=a.GetValueY()+a.GetEndAnchorY(),f=a.GetValueX(),m=a.GetValueY(),g=ja.GetRuntimeEase(\"spline\")(h,l,c,u,_,d,p,f,m,this._precalculatedSamples.get(n));return(1-(g+=n.GetValueY()))*t+g*(t+s)}_PreCalcSamples(){this._precalculatedSamples.clear();for(let e=0;e<this._transitionKeyframes.length-1;e++){const t=this._transitionKeyframes[e];if(t.GetStartEnable()){const s=t,i=this._transitionKeyframes[e+1];if(i.GetEndEnable()){const r=s.GetValueX(),n=s.GetValueX()+s.GetStartAnchorX(),a=i.GetValueX()+i.GetEndAnchorX(),o=i.GetValueX();this._precalculatedSamples.set(s,ja.GetBezierSamples(r,n,a,o))}}}}}}{const Ha=self.C3;Ha.TransitionKeyframe=class extends Ha.DefendedBase{constructor(e,t){super(),this._transition=e,this._valueX=t[0],this._valueY=t[1],this._startAnchorX=t[2],this._startAnchorY=t[3],this._endAnchorX=t[4],this._endAnchorY=t[5],this._startEnable=t[6],this._endEnable=t[7],this._segmentMode=t[8],this._next=null,this._prev=null}Release(){this._transition=null}static Create(e,t){return Ha.New(Ha.TransitionKeyframe,e,t)}SetNext(e){this._next=e}GetNext(){return this._next}SetPrevious(e){this._prev=e}GetPrevious(){return this._prev}GetValueX(){return this._valueX}GetValueY(){return this._valueY}GetStartAnchorX(){return this._startAnchorX}GetStartAnchorY(){return this._startAnchorY}GetEndAnchorX(){return this._endAnchorX}GetEndAnchorY(){return this._endAnchorY}GetStartEnable(){return this._startEnable}GetEndEnable(){return this._endEnable}IsSegmentLinear(){return\"linear\"===this._segmentMode}IsSegmentCubic(){return\"cubic\"===this._segmentMode}}}{const Xa=self.C3;Xa.TransitionManager=class extends Xa.DefendedBase{constructor(e){super(),this._runtime=e,this._transitions=[]}Release(){for(const e of this._transitions)e.Release();Xa.clearArray(this._transitions),this._transitions=null}Create(e){this._transitions.push(Xa.Transition.Create(e))}}}{const za=self.C3;za.TemplateManager=class extends za.DefendedBase{constructor(e){super(),this._runtime=e,this._templateDataMap=null,this._instanceToTemplateNameMap=null,this._instanceDestroy=e=>this._OnInstanceDestroy(e.instance)}Release(){if(this.RemoveRuntimeListeners(),this._templateDataMap){for(const e of this._templateDataMap.values())e.clear();this._templateDataMap.clear()}this._templateDataMap=null,this._runtime=null}Create(e){if(this._templateDataMap||(this._templateDataMap=new Map),e){const t=e[0][16],s=t[0],i=e[1],r=(this._templateDataMap.has(i)||this._templateDataMap.set(i,new Map),this._templateDataMap.get(i));r.set(s,e)}}AddRuntimeListeners(){const e=this._runtime.Dispatcher();e&&e.addEventListener(\"instancedestroy\",this._instanceDestroy)}RemoveRuntimeListeners(){const e=this._runtime.Dispatcher();e&&e.removeEventListener(\"instancedestroy\",this._instanceDestroy)}HasTemplates(){return!!this._templateDataMap&&0!==this._templateDataMap.size}GetTemplateData(e,t){let s;if(s=e instanceof za.ObjectClass?e.GetIndex():e,this._templateDataMap.has(s)){const i=this._templateDataMap.get(s).get(t);return i?JSON.parse(JSON.stringify(i)):void 0}}MapInstanceToTemplateName(e,t){this._instanceToTemplateNameMap||(this._instanceToTemplateNameMap=new WeakMap),this._instanceToTemplateNameMap.has(e)||this._instanceToTemplateNameMap.set(e,t)}GetInstanceTemplateName(e){if(!this._instanceToTemplateNameMap)return\"\";const t=this._instanceToTemplateNameMap.get(e);return t||\"\"}_OnInstanceDestroy(e){this._instanceToTemplateNameMap&&this._instanceToTemplateNameMap.has(e)&&this._instanceToTemplateNameMap.delete(e)}}}{const Ya=self.C3;Ya.FlowchartManager=class{constructor(e){this._runtime=e,this._flowchartDataManager=new Ya.FlowchartDataManager}Release(){this._flowchartDataManager.Release(),this._flowchartDataManager=null,this._runtime=null}GetRuntime(){return this._runtime}Create(e){this._flowchartDataManager.Add(e)}GetFlowchartDataItemByName(e){return this._flowchartDataManager.Get(e)}HasFlowcharts(){return this._flowchartDataManager.HasFlowcharts()}}}{const T=self.C3;T.FlowchartState=class{constructor(e,t,s,i,r,n,a){this._runtime=r.GetRuntime(),this._flowchartManager=r,this._flowchartName=e,this._startNodeTag=s,this._flowchartDataItem=i,this._tag=t,this._pluginInstance=n,this._pluginUID=a??n.GetInstance().GetUID(),this._SetStartFlowchartNode(),this._currentFlowchartNodeId=this._startFlowchartNode?.GetFlowchartId()??-1,this._previousFlowchartNodeIds=[],this._previousFlowchartState=null,this._previousFlowchartStateStartNodeId=NaN,this._referenceFlowchartStates=null,this._currentReferenceFlowchartState=null,this._rootFlowchartState=null,this._previousFlowchartStateTag=\"\",this._referenceFlowchartStatesJson=null,this._currentReferenceFlowchartStateTag=\"\",this._rootFlowchartStateTag=\"\",this._triggerCount=0,this._markForRelease=!1,this._released=!1}Release(){this._released||(T.clearArray(this._previousFlowchartNodeIds),this._previousFlowchartNodeIds=null,this._runtime=null,this._flowchartManager=null,this._flowchartDataItem=null,this._pluginInstance=null,this._previousFlowchartState=null,this._previousFlowchartStateStartNodeId=NaN,this._referenceFlowchartStates&&this._referenceFlowchartStates.clear(),this._referenceFlowchartStates=null,this._currentReferenceFlowchartState=null,this._rootFlowchartState=null,this._previousFlowchartStateTag=\"\",this._referenceFlowchartStatesJson=null,this._currentReferenceFlowchartStateTag=\"\",this._rootFlowchartStateTag=\"\",this._released=!0)}WasReleased(){return this._released}GetFlowchartManager(){return this._flowchartManager}GetRuntime(){return this._runtime}GetName(){return this._flowchartName}GetFlowchartDataItem(){return this._flowchartDataItem}GetTag(){return this._tag}GetPluginInstance(){return this._pluginInstance||(this._pluginInstance=this._runtime.GetInstanceByUID(this._pluginUID).GetSdkInstance()),this._pluginInstance}GetCurrentNode(){return this.GetFlowchartElementById(this._currentFlowchartNodeId)}GetCurrentNodeTag(){const e=this.GetCurrentNode();return e?e.GetTag():\"\"}GetCurrentNodeTags(){const e=this.GetCurrentNode();return e?e.GetTags():[]}CurrentNodeHasTags(e){const t=this.GetCurrentNodeTags();if(!t)return!1;if(!t.length)return!1;const s=T.FlowchartState._GetTagArray(e);return!(!s||!s.length)&&s.every(T.FlowchartState._HasTag,t)}CurrentNodeCompareTags(e,t){const s=this.GetCurrentNodeTags();if(!s)return!1;if(!s.length)return!1;const i=T.FlowchartState._GetTagArray(e);return!(!i||!i.length)&&i.every(e=>T.FlowchartState._CompareTag.call(s,e,t))}static _HasTag(e){return\"\"===e?1===this.length&&\"\"===this[0]:this.map(e=>e.trim().toLowerCase()).includes(e.trim().toLowerCase())}static _GetTagArray(e){return e.trim().split(\" \")}static _CompareTag(t,s){return\"\"===t?1===this.length&&\"\"===this[0]:this.some(e=>T.compare(e.trim(),s,t.trim()))}GetCurrentNodeParent(e){const t=this.GetCurrentNode();if(t){if(T.IsFiniteNumber(e)){const s=t.GetParentFlowchartIds(),i=s?s[e]:void 0;if(T.IsFiniteNumber(i))return this.GetFlowchartElementById(i)}if(\"string\"==typeof e)for(const r of t.GetParentFlowchartIds()){const n=this.GetFlowchartElementById(r);if(n.HasTags(e))return this.GetFlowchartElementById(n.GetFlowchartId())}}}GetCurrentNodeParentTag(e){const t=this.GetCurrentNodeParent(e);return t?t.GetTag():\"\"}GetCurrentNodeParentTags(e){const t=this.GetCurrentNodeParent(e);return t?t.GetTags():\"\"}GetCurrentNodeParentIndex(e){const t=this.GetCurrentNode();if(!t)return-1;const s=t.GetParentFlowchartIds();if(!s)return-1;const i=this.GetCurrentNodeParent(e);return i?s.indexOf(i.GetFlowchartId()):-1}GetCurrentNodeParentCount(){const e=this.GetCurrentNode();if(!e)return 0;const t=e.GetParentFlowchartIds();return t?t.length:0}GetFlowchartElementById(e){return this._flowchartDataItem.GetFlowchartElementById(e)}Reset(){const e=this._GetRootFlowchartState();e._Reset(!0)}_Reset(e){if(this._GetReferenceFlowchartStates()){for(const[t,s]of this._GetReferenceFlowchartStates().entries())s._Reset(!1);this._GetReferenceFlowchartStates().clear()}if(this._referenceFlowchartStates=null,this._previousFlowchartState=null,this._previousFlowchartStateStartNode=null,this._currentReferenceFlowchartState=null,this._previousFlowchartStateTag=\"\",this._referenceFlowchartStatesJson=null,this._currentReferenceFlowchartStateTag=\"\",this._rootFlowchartStateTag=\"\",this._previousFlowchartNodeIds=[],e){this._flowchartManager.SetCurrentFlowchartState(this);const i=this._startFlowchartNode.GetFlowchartId();i!==this._currentFlowchartNodeId&&this._GotoFlowchartNode(i)}else this._currentFlowchartNodeId=this._startFlowchartNode.GetFlowchartId()}GetCurrentNodeOutputCount(){const e=this._flowchartDataItem.GetFlowchartElementById(this._currentFlowchartNodeId);return e?e.GetFlowchartNodeOutputData().GetFlowchartNodeOutputDataItemCount():0}GetCurrentNodeOutputNameAt(e){const t=this._GetFlowchartNodeOutputAt(e);return t?t.GetName():\"\"}GetCurrentNodeOutputValueAt(e){let t;return T.IsFiniteNumber(e)&&(t=this._GetFlowchartNodeOutputAt(e)),\"string\"==typeof e&&(t=this._GetFlowchartNodeOutputByName(e)),\"number\"!=typeof e&&\"string\"!=typeof e&&console.warn(\"[Flowcharts] unexpected argument type in GetCurrentNodeOutputValueAt expression\"),t?t.GetValue():\"\"}GotoNextFlowchartNode(e){let t;if(T.IsFiniteNumber(e)&&(t=this._GetFlowchartNodeOutputAt(e)),t=\"string\"==typeof e?this._GetFlowchartNodeOutputByName(e):t){const s=t.GetConnectedFlowchartNodeFlowchartId();T.IsFiniteNumber(s)&&(this._previousFlowchartNodeIds.push(this._currentFlowchartNodeId),this._GotoFlowchartNode(s))}}GotoAnyFlowchartNode(e){const t=this._flowchartDataItem.GetFlowchartNodeByTags(e);if(t){const s=this._flowchartDataItem.GetFlowchartElementById(t.GetFlowchartId());s&&(this._previousFlowchartNodeIds.push(this._currentFlowchartNodeId),this._GotoFlowchartNode(s.GetFlowchartId()))}}GotoPreviousFlowchartNode(){const e=this._previousFlowchartNodeIds.pop();T.IsFiniteNumber(e)?this._GotoFlowchartNode(e):this._GetPreviousFlowchartState()&&(this._flowchartManager.SetCurrentFlowchartState(this._GetPreviousFlowchartState(),!0,!1,!1),this._GetPreviousFlowchartState()._GotoFlowchartNode(this._GetPreviousFlowchartStateStartNodeId()),this._GetRootFlowchartState()._SetCurrentReferenceFlowchart(this._GetPreviousFlowchartState()))}GotoParentFlowchartNode(e){const t=this.GetCurrentNode();if(t){t.GetFlowchartId();const s=this.GetCurrentNodeParent(e);s&&(this._previousFlowchartNodeIds.push(this._currentFlowchartNodeId),this._GotoFlowchartNode(s.GetFlowchartId()))}}HasOutput(t){if(T.IsFiniteNumber(t)){const e=this._flowchartDataItem.GetFlowchartElementById(this._currentFlowchartNodeId),s=e.GetFlowchartNodeOutputData().GetFlowchartNodeOutputDataItems();return!!s[t]}if(\"string\"==typeof t){const i=this._flowchartDataItem.GetFlowchartElementById(this._currentFlowchartNodeId),r=i.GetFlowchartNodeOutputData().GetFlowchartNodeOutputDataItems();for(let e=0;e<r.length;e++)if(r[e].GetName()===t)return!0}return!1}MarkForRelease(){this._markForRelease=!0}IsInTriggerState(){return 0<this._triggerCount}PushIsTriggerState(){this._triggerCount++}PopIsTriggerState(){this._triggerCount--,0===this._triggerCount&&this._markForRelease&&this._flowchartManager.RemoveFlowchartState(this)}_GotoFlowchartNode(e){const s=this._currentFlowchartNodeId,t=this.GetPluginInstance().GetInstance();if(this.PushIsTriggerState(),this._flowchartManager.PushFlowchartState(this),this._runtime.Trigger(T.Plugins.Flowchart.Cnds.OnBeforeAnyNodeChange,t),this._runtime.Trigger(T.Plugins.Flowchart.Cnds.OnBeforeTaggedNodeChange,t),this._runtime.Trigger(T.Plugins.Flowchart.Cnds.OnBeforeAnyNodeChangeInFlowchart,t),this._runtime.Trigger(T.Plugins.Flowchart.Cnds.OnBeforeTaggedNodeChangeInFlowchart,t),this._currentFlowchartNodeId=e,this._runtime.Trigger(T.Plugins.Flowchart.Cnds.OnAnyNodeChange,t),this._runtime.Trigger(T.Plugins.Flowchart.Cnds.OnTaggedNodeChange,t),this._runtime.Trigger(T.Plugins.Flowchart.Cnds.OnAnyNodeChangeInFlowchart,t),this._runtime.Trigger(T.Plugins.Flowchart.Cnds.OnTaggedNodeChangeInFlowchart,t),this._flowchartManager.PopFlowchartState(),this.PopIsTriggerState(),!this.WasReleased()){const i=this.GetFlowchartElementById(this._currentFlowchartNodeId);if(\"reference\"===i.GetType()){const r=i.GetReferenceFlowchartName();if(this._HasReferenceFlowchartState(i)){this._previousFlowchartNodeIds.pop();const n=this._GetReferenceFlowchartState(i),a=(this._flowchartManager.SetCurrentFlowchartState(n,!0,!0,!1),n._SetPreviousFlowchart(this,s),this._GetRootFlowchartState());a._SetCurrentReferenceFlowchart(n)}else{const o=i.GetReferenceFlowchartStartNodeTag();if(r){this._previousFlowchartNodeIds.pop();let t=i.GetReferenceFlowchartTag();if(t){let e=this._flowchartManager.GetFlowchartState(t);for(;e;)t=T.IncrementNumberAtEndOf(t),e=this._flowchartManager.GetFlowchartState(t)}else{t=r+\"-ref\";let e=this._flowchartManager.GetFlowchartState(t);for(;e;)t=T.IncrementNumberAtEndOf(t),e=this._flowchartManager.GetFlowchartState(t)}const h=this._flowchartManager.AddFlowchartState(r,o,t,this._pluginInstance,!0),l=(h._SetPreviousFlowchart(this,s),this._SetReferenceFlowchartState(i,h),this._GetRootFlowchartState());h._SetRootFlowchartState(l),l._SetCurrentReferenceFlowchart(h)}}}}}_GetFlowchartNodeOutputAt(e){const t=this._flowchartDataItem.GetFlowchartElementById(this._currentFlowchartNodeId);if(!t)return null;const s=t.GetFlowchartNodeOutputData().GetFlowchartNodeOutputDataItems();if(!s)return null;const i=s[e];return i||null}_GetFlowchartNodeOutputByName(e){const t=this._flowchartDataItem.GetFlowchartElementById(this._currentFlowchartNodeId);if(!t)return null;const s=t.GetFlowchartNodeOutputData().GetFlowchartNodeOutputDataItemByName(e);return s||null}_SetStartFlowchartNode(t){if(\"number\"==typeof t){let e=this.GetFlowchartElementById(t);e=e||this._flowchartDataItem.GetFlowchartStartNode(),this._startFlowchartNode=e}else{let e=this._flowchartDataItem.GetFlowchartNodeByTags(this._startNodeTag);e=e||this._flowchartDataItem.GetFlowchartStartNode(),this._startFlowchartNode=e}}_SaveToJson(){return this._markForRelease?null:{flowchartName:this._flowchartName,flowchartTag:this._tag,startNodeTag:this._startNodeTag,currentNodeId:this._currentFlowchartNodeId,previousNodeIds:this._previousFlowchartNodeIds,pluginUID:this._pluginInstance.GetInstance().GetUID(),reference:{previousFlowchartTag:this._GetPreviousFlowchartState()?this._GetPreviousFlowchartState().GetTag():\"\",previousStartNodeId:T.IsFiniteNumber(this._GetPreviousFlowchartStateStartNodeId())?this._GetPreviousFlowchartStateStartNodeId():NaN,referencesJson:this._GetFlowchartReferencesJson(),currentReferenceFlowchartTag:this.GetCurrentReferenceFlowchart()?this.GetCurrentReferenceFlowchart().GetTag():\"\",rootFlowchartTag:this._GetRootFlowchartState()?this._GetRootFlowchartState().GetTag():\"\"}}}_GetFlowchartReferencesJson(){if(!this._HasReferenceFlowchartStates())return null;const e=[];for(const[t,s]of this._GetReferenceFlowchartStates().entries())e.push({flowchartElementId:t.GetFlowchartId(),flowchartStateTag:s.GetTag()});return e.length?e:null}_LoadFromJson(e){if(e){if(this._flowchartName=e.flowchartName,this._tag=e.flowchartTag,this._startNodeTag=e.startNodeTag,this._currentFlowchartNodeId=e.currentNodeId,this._previousFlowchartNodeIds=e.previousNodeIds,this._pluginUID=e.pluginUID,e.hasOwnProperty(\"reference\")){const t=e.reference;this._previousFlowchartStateTag=t.previousFlowchartTag,this._previousFlowchartStateStartNodeId=t.previousStartNodeId,this._referenceFlowchartStatesJson=t.referencesJson,this._currentReferenceFlowchartStateTag=t.currentReferenceFlowchartTag,this._rootFlowchartStateTag=t.rootFlowchartTag}this._SetStartFlowchartNode()}}_GetPreviousFlowchartState(){return\"string\"==typeof this._previousFlowchartStateTag&&this._previousFlowchartStateTag&&(this._previousFlowchartState=this._flowchartManager.GetFlowchartState(this._previousFlowchartStateTag),this._previousFlowchartStateTag=\"\"),this._previousFlowchartState}_GetPreviousFlowchartStateStartNodeId(){return this._previousFlowchartStateStartNodeId}_SetPreviousFlowchart(e,t){this._previousFlowchartState=e,this._previousFlowchartStateStartNodeId=t}GetCurrentReferenceFlowchart(){return\"string\"==typeof this._currentReferenceFlowchartStateTag&&this._currentReferenceFlowchartStateTag&&(this._currentReferenceFlowchartState=this._flowchartManager.GetFlowchartState(this._currentReferenceFlowchartStateTag),this._currentReferenceFlowchartStateTag=\"\"),this._currentReferenceFlowchartState}_SetCurrentReferenceFlowchart(e){this._currentReferenceFlowchartState=e,this._currentReferenceFlowchartState===this&&(this._currentReferenceFlowchartState=null)}_GetRootFlowchartState(){return\"string\"==typeof this._rootFlowchartStateTag&&this._rootFlowchartStateTag&&(this._rootFlowchartState=this._flowchartManager.GetFlowchartState(this._rootFlowchartStateTag),this._rootFlowchartStateTag=\"\"),this._rootFlowchartState||this}_SetRootFlowchartState(e){this._rootFlowchartState=e}_HasReferenceFlowchartStates(){return this._RebuildReferenceFlowchartStates(),!!this._referenceFlowchartStates}_HasReferenceFlowchartState(e){return this._RebuildReferenceFlowchartStates(),this._referenceFlowchartStates&&this._referenceFlowchartStates.has(e)}_RebuildReferenceFlowchartStates(){if(this._referenceFlowchartStatesJson){this._referenceFlowchartStates&&this._referenceFlowchartStates.clear(),this._referenceFlowchartStates||(this._referenceFlowchartStates=new Map);for(const e of this._referenceFlowchartStatesJson){const t=this._flowchartManager.GetFlowchartState(e.flowchartStateTag),s=t.GetFlowchartElementById(e.flowchartElementId);this._referenceFlowchartStates.set(s,t)}this._referenceFlowchartStatesJson=null}}_GetReferenceFlowchartStates(){return this._RebuildReferenceFlowchartStates(),this._referenceFlowchartStates}_GetReferenceFlowchartState(e){return this._RebuildReferenceFlowchartStates(),this._referenceFlowchartStates.get(e)}_SetReferenceFlowchartState(e,t){this._referenceFlowchartStates||(this._referenceFlowchartStates=new Map),this._referenceFlowchartStates.set(e,t)}}}{const qa=self.C3;qa.FlowchartStateManager=class{constructor(e){this._runtime=e,this._flowchartStates=new Map,this._currentFlowchartState=null,this._flowchartStateStack=[],this._on_after_load=()=>this._OnAfterLoad(),this._loadJson=null}Release(){qa.clearArray(this._flowchartStateStack),this._flowchartStateStack=null,this._flowchartStates.clear(),this._flowchartStates=null,this._currentFlowchartState=null,this._runtime=null,this._loadJson=null}GetRuntime(){return this._runtime}AddFlowchartState(e,t,s,i,r,n){const a=this._runtime.GetFlowchartManager().GetFlowchartDataItemByName(e);if(a){if(!this._flowchartStates.has(s)){const o=new qa.FlowchartState(e,s,t,a,this,i,n);return this._flowchartStates.set(s,o),r&&this.SetCurrentFlowchartState(o,!0),o}{const h=this._flowchartStates.get(s);h&&this.RemoveFlowchartState(h)}}else console.warn(`[Flowcharts] no flowchart found with name '${e}'`)}RemoveFlowchartState(e){if(e.MarkForRelease(),!e.IsInTriggerState()){const t=e.GetTag();this._flowchartStates.delete(t),e.Release(),this._currentFlowchartState===e&&(this._currentFlowchartState=null)}}ResetFlowchartState(e){e.Reset()}GetFlowchartState(e){return this._flowchartStates.get(e)}PushFlowchartState(e){this._flowchartStateStack.push(e)}PopFlowchartState(){this._flowchartStateStack.pop()}SetCurrentFlowchartState(e,t=!1,s=!1,i=!0){if(i){const r=e.GetCurrentReferenceFlowchart();e=r||e}e!==this._currentFlowchartState&&(this._TriggerBeforeFlowchartChange(),this._TriggerAfterFlowchartChange(e,t,s))}GetCurrentFlowchartState(e){return\"string\"==typeof e?this.GetFlowchartState(e):this._flowchartStateStack.length?this._flowchartStateStack[this._flowchartStateStack.length-1]:this._currentFlowchartState}_TriggerBeforeFlowchartChange(){if(this._currentFlowchartState&&!this._currentFlowchartState.WasReleased()){const e=this._currentFlowchartState.GetPluginInstance().GetInstance();this._currentFlowchartState.PushIsTriggerState(),this.PushFlowchartState(this._currentFlowchartState),this._runtime.Trigger(qa.Plugins.Flowchart.Cnds.OnBeforeFlowchartChange,e),this.PopFlowchartState(),this._currentFlowchartState.PopIsTriggerState()}}_TriggerAfterFlowchartChange(e,t=!1,s=!1){if(this._currentFlowchartState=e,this._currentFlowchartState&&!this._currentFlowchartState.WasReleased()){const i=this._currentFlowchartState.GetPluginInstance().GetInstance();this._currentFlowchartState.PushIsTriggerState(),this.PushFlowchartState(this._currentFlowchartState),this._runtime.Trigger(qa.Plugins.Flowchart.Cnds.OnFlowchartChange,i),!0!==s&&\"number\"!=typeof s||this._currentFlowchartState._SetStartFlowchartNode(s),t&&(this._runtime.Trigger(qa.Plugins.Flowchart.Cnds.OnAnyNodeChange,i),this._runtime.Trigger(qa.Plugins.Flowchart.Cnds.OnTaggedNodeChange,i)),this.PopFlowchartState(),this._currentFlowchartState.PopIsTriggerState()}}_SaveToJson(){return{flowchartJsonObjects:[...this._flowchartStates.values()].map(e=>e._SaveToJson()),currentFlowchartTag:this._currentFlowchartState?this._currentFlowchartState.GetTag():null}}_LoadFromJson(e){if(e){this._loadJson=e;const t=new Map;for(const s of this._loadJson.flowchartJsonObjects){const i=s.flowchartTag;if(this._flowchartStates.has(i)){const r=this._flowchartStates.get(i);r._LoadFromJson(s),t.set(i,r)}else{const n=this.AddFlowchartState(s.flowchartName,s.startNodeTag,s.flowchartTag,null,!1,s.pluginUID);n._LoadFromJson(s),t.set(s.flowchartTag,n)}}for(const[a,o]of this._flowchartStates.entries())t.has(a)||o.Release();this._flowchartStates.clear(),this._flowchartStates=t,this._runtime.IsLoadingState()?this._runtime.Dispatcher().addEventListener(\"afterload\",this._on_after_load):this._OnAfterLoad()}}_OnAfterLoad(){this._runtime.Dispatcher().removeEventListener(\"afterload\",this._on_after_load);const e=this._flowchartStates.get(this._loadJson.currentFlowchartTag);e&&this.SetCurrentFlowchartState(e,!0),this._loadJson=null}}}{const Ka=self.C3;Ka.FlowchartDataManager=class{constructor(){this._flowchartDataItems=new Map}Release(){for(const e of this._flowchartDataItems.values())e.Release();this._flowchartDataItems.clear(),this._flowchartDataItems=null}Add(e){const t=new Ka.FlowchartDataItem(e),s=t.GetName();this._flowchartDataItems.set(s,t)}Get(e){return this._flowchartDataItems.get(e)}HasFlowcharts(){return!!this._flowchartDataItems.size}static CreateDataItems(e,t,s,i){if(t)for(const r of t){const n=new s(r,i);e.push(n)}}}}{const Ja=self.C3;Ja.FlowchartDataItem=class{constructor(e){this._name=e[0],this._flowchartNodeData=new Ja.FlowchartNodeData(e[1],this)}Release(){this._flowchartNodeData.Release(),this._flowchartNodeData=null}GetFlowchartNodeData(){return this._flowchartNodeData}GetFlowchartElementById(e){return this._flowchartNodeData.GetFlowchartElementById(e)}GetFlowchartNodeByTags(e){return this._flowchartNodeData.GetFlowchartNodeByTags(e)}GetFlowchartStartNode(){return this._flowchartNodeData.GetFlowchartStartNode()}GetName(){return this._name}}}{const Za=self.C3;class Qa{constructor(e,t){this._flowchartNodeData=t,this._type=e[7],this._flowchartId=e[0],this._tag=e[1],this._tag?this._tags=this._tag.trim().split(\" \").map(e=>e.trim()):this._tags=[],this._parentFlowchartIds=e[2],this._parentOutputFlowchartIds=null,this._childrenFlowchartIds=null,\"dictionary\"===this._type&&(this._parentOutputFlowchartIds=e[3],this._childrenFlowchartIds=e[4]),this._isStart=e[6],this._referenceFlowchartName=null,this._referenceFlowchartStartNodeTag=null,this._referenceFlowchartTag=null,\"reference\"===this._type&&(this._referenceFlowchartName=e[8],this._referenceFlowchartStartNodeTag=e[9],this._referenceFlowchartTag=e[10]),this._flowchartNodeOutputData=new Za.FlowchartNodeOutputData(e[5],this)}Release(){this._flowchartNodeData=null}GetFlowchartNodeData(){return this._flowchartNodeData}GetFlowchartNodeOutputData(){return this._flowchartNodeOutputData}GetFlowchartId(){return this._flowchartId}GetTag(){return this._tag}GetTags(){return this._tags}HasTags(e){if(!this._tags)return!1;if(!this._tags.length)return!1;const t=Za.FlowchartState._GetTagArray(e);return!(!t||!t.length)&&t.every(Za.FlowchartState._HasTag,this._tags)}GetIsStart(){return this._isStart}GetParentFlowchartIds(){return this._parentFlowchartIds}GetParentOutputFlowchartIds(){return this._parentOutputFlowchartIds}GetChildrenFlowchartIds(){return this._childrenFlowchartIds}GetType(){return this._type}GetReferenceFlowchartName(){return this._referenceFlowchartName}GetReferenceFlowchartStartNodeTag(){return this._referenceFlowchartStartNodeTag}GetReferenceFlowchartTag(){return this._referenceFlowchartTag}}Za.FlowchartNodeData=class{constructor(e,t){this._flowchartDataItem=t,this._flowchartNodeItems=[],this._flowchartNodeItemsIdMap=new Map,this._flowchartNodeItemsTagMap=new Map,this._flowchartNodeStartItem=null,Za.FlowchartDataManager.CreateDataItems(this._flowchartNodeItems,e,Qa,this);for(const s of this._flowchartNodeItems){const i=s.GetFlowchartId(),r=s.GetTag(),n=s.GetTags(),a=s.GetIsStart();if(this._flowchartNodeItemsIdMap.set(i,s),r)for(const h of n)this._flowchartNodeItemsTagMap.has(h)||this._flowchartNodeItemsTagMap.set(h,new Set),this._flowchartNodeItemsTagMap.get(h).add(s);a&&(this._flowchartNodeStartItem=s);const o=s.GetFlowchartNodeOutputData();for(const l of o.flowchartNodeOutputDataItems()){const c=l.GetFlowchartId();this._flowchartNodeItemsIdMap.set(c,l)}}}Release(){this._flowchartDataItem=null;for(const e of this._flowchartNodeItems)e.Release();Za.clearArray(this._flowchartNodeItems),this._flowchartNodeItems=null}GetFlowchartDataItem(){return this._flowchartDataItem}GetFlowchartElementById(e){return this._flowchartNodeItemsIdMap.get(e)}GetFlowchartNodeByTags(e){if(!e||!e.length)return null;const s=[];for(const i of e.trim().split(\" \")){let e=this._flowchartNodeItemsTagMap.get(i.trim())??new Set;if(0===e.size)return null;s.push(e)}const t=s.reduce((e,t)=>t.size<e.size?t:e);return[...t].filter(t=>s.every(e=>e.has(t)))[0]}GetFlowchartStartNode(){return this._flowchartNodeStartItem}*flowchartNodeDataItems(){for(const e of this._flowchartNodeItems)yield e}}}{const $a=self.C3;class eo{constructor(e,t){this._flowchartNodeOutputData=t,this._flowchartId=e[0],this._name=e[1],this._value=e[2],this._connectedFlowchartNodeFlowchartId=e[3]}Release(){this._flowchartNodeOutputData=null}GetFlowchartNodeOutputData(){return this._flowchartNodeOutputData}GetFlowchartId(){return this._flowchartId}GetName(){return this._name}GetValue(){return this._value}GetConnectedFlowchartNodeFlowchartId(){return this._connectedFlowchartNodeFlowchartId}}$a.FlowchartNodeOutputData=class{constructor(e,t){this._flowchartDataNodeItem=t,this._flowchartNodeOutputItems=[],this._flowchartNodeOutputItemsNameMap=new Map,$a.FlowchartDataManager.CreateDataItems(this._flowchartNodeOutputItems,e,eo,this);for(const s of this._flowchartNodeOutputItems)this._flowchartNodeOutputItemsNameMap.set(s.GetName(),s)}Release(){this._flowchartDataNodeItem=null;for(const e of this._flowchartNodeOutputItems)e.Release();$a.clearArray(this._flowchartNodeOutputItems),this._flowchartNodeOutputItems=null}GetFlowchartNodeDataItem(){return this._flowchartDataNodeItem}GetFlowchartNodeOutputDataItemCount(){return this._flowchartNodeOutputItems.length}GetFlowchartNodeOutputDataItems(){return this._flowchartNodeOutputItems}GetFlowchartNodeOutputDataItemByName(e){return this._flowchartNodeOutputItemsNameMap.get(e)}*flowchartNodeOutputDataItems(){for(const e of this._flowchartNodeOutputItems)yield e}}}{const to=self.C3;to.SolStack=class extends to.DefendedBase{constructor(e){super(),this._objectClass=e,this._stack=[],this._stack.push(to.New(to.Sol,this)),this._index=0,this._current=this._stack[0]}Release(){for(const e of this._stack)e.Release();to.clearArray(this._stack),this._current=null,this._objectClass=null}GetObjectClass(){return this._objectClass}GetCurrentSol(){return this._current}GetOneBelowCurrentSol(){return this._stack[this._index-1]}Clear(){this.GetCurrentSol().Clear()}PushClean(){const e=this._stack,t=++this._index;if(t===e.length){const s=to.New(to.Sol,this);e.push(s),this._current=s}else{const i=e[t];i.Reset(),this._current=i}}PushCopy(){const e=this._stack,t=++this._index,s=(t===e.length&&e.push(to.New(to.Sol,this)),e[t]);s.Copy(e[t-1]),this._current=s}Pop(){this._current=this._stack[--this._index]}RemoveInstances(s){const i=this._stack;for(let e=0,t=i.length;e<t;++e)i[e].RemoveInstances(s)}}}{const so=self.C3;so.Sol=class extends so.DefendedBase{constructor(e){super(),this._stack=e,this._objectClass=this._stack.GetObjectClass(),this._eventStack=this._objectClass.GetRuntime().GetEventStack(),this._selectAll=!0,this._instances=[],this._elseInstances=[]}Release(){this.ClearArrays(),this._stack=null,this._objectClass=null,this._eventStack=null}ClearArrays(){so.clearArray(this._instances),so.clearArray(this._elseInstances)}GetObjectClass(){return this._objectClass}IsSelectAll(){return this._selectAll}HasAnyInstances(){return this._selectAll?!!this._objectClass.GetInstanceCount():!!this._instances.length}GetInstances(){return this._selectAll?this._objectClass.GetInstances():this._instances}HasAnyElseInstances(){return!!this._elseInstances.length}GetElseInstances(){return this._elseInstances}GetExpressionInstances(){const e=this.GetInstances();return e.length?e:this._elseInstances}Reset(){this._selectAll=!0,so.clearArray(this._elseInstances)}Clear(){this._selectAll=!0}Copy(e){e.IsSelectAll()?this.Reset():(this._selectAll=!1,so.shallowAssignArray(this._instances,e._instances),so.clearArray(this._elseInstances))}_PushInstance(e){this._instances.push(e)}_PushElseInstance(e){this._elseInstances.push(e)}_SetSelectAll(e){this._selectAll=!!e}_GetOwnInstances(){return this._instances}_GetOwnElseInstances(){return this._elseInstances}SetSinglePicked(e){this._selectAll=!1,so.clearArray(this._instances),this._instances.push(e)}SetArrayPicked(e){this._selectAll=!1,so.shallowAssignArray(this._instances,e)}SetSetPicked(e){this._selectAll=!1,so.clearArray(this._instances);for(const t of e)this._instances.push(t)}AddElseInstances(e,t){for(const s of t)e.has(s)||this._elseInstances.push(s)}TransferElseInstancesToOwn(e){for(const t of e)this._instances.push(t);so.arrayRemoveAllInSet(this._elseInstances,e)}ClearElseInstances(){so.clearArray(this._elseInstances)}PickOne(e){if(e)if(this._eventStack.GetCurrentStackFrame().GetCurrentEvent().IsOrBlock()){this.IsSelectAll()&&(so.clearArray(this._instances),so.shallowAssignArray(this._elseInstances,e.GetObjectClass().GetInstances()),this._selectAll=!1);const t=this._elseInstances.indexOf(e);-1!==t&&(this._instances.push(this._elseInstances[t]),this._elseInstances.splice(t,1))}else this.SetSinglePicked(e)}RemoveInstances(e){so.arrayRemoveAllInSet(this._instances,e),so.arrayRemoveAllInSet(this._elseInstances,e)}}}{const io=self.C3;io.EventStack=class extends io.DefendedBase{constructor(e){super(),this._eventSheetManager=e,this._runtime=this._eventSheetManager.GetRuntime(),this._stack=[],this._stack.push(io.New(io.EventStackFrame,this,null)),this._index=0,this._expFuncStack=[]}Release(){for(const e of this._stack)e.Release();io.clearArray(this._stack),io.clearArray(this._expFuncStack),this._eventSheetManager=null,this._runtime=null}GetEventSheetManager(){return this._eventSheetManager}GetRuntime(){return this._runtime}GetCurrentStackFrame(){return this._stack[this._index]}GetAllStackFrames(){return this._stack}GetCurrentStackFrameIndex(){return this._index}Push(e){const t=this._stack,s=++this._index;if(s===t.length){const i=io.New(io.EventStackFrame,this,e);return t.push(i),i}{const r=t[s];return r.Reset(e),r}}Pop(){--this._index}PushExpFunc(e){this._expFuncStack.push(e)}PopExpFunc(){this._expFuncStack.pop()}GetCurrentExpFuncStackFrame(){const e=this._expFuncStack;return 0===e.length?null:e.at(-1)}}}{const ro=self.C3;ro.EventStackFrame=class extends ro.DefendedBase{constructor(e,t){super(),this._stack=e,this._runtime=this._stack.GetRuntime(),this._currentEvent=t,this._cndIndex=0,this._actIndex=0,this._lastEventTrue=!1,this._elseBranchRan=!1,this._expressionObjectClass=null,this._functionReturnType=0,this._functionReturnValue=0,this._dynamicSolModifiers=null}Release(){this.Reset(null),this._stack=null,this._runtime=null}Reset(e){this._currentEvent=e,this._cndIndex=0,this._actIndex=0,this._lastEventTrue=!1,this._elseBranchRan=!1,this._dynamicSolModifiers=null}_Restore(e,t){this._currentEvent=e,this._cndIndex=0,this._actIndex=t}ResetQuick(){this._cndIndex=0,this._actIndex=0}GetCurrentEvent(){return this._currentEvent}SetCurrentEvent(e){this._currentEvent=e}GetConditionIndex(){return this._cndIndex}SetConditionIndex(e){this._cndIndex=e}GetActionIndex(){return this._actIndex}SetActionIndex(e){this._actIndex=e}SetLastEventTrue(e){this._lastEventTrue=!!e}GetLastEventTrue(){return this._lastEventTrue}SetElseBranchRan(e){this._elseBranchRan=!!e}GetElseBranchRan(){return this._elseBranchRan}SetExpressionObjectClass(e){this._expressionObjectClass=e}GetExpressionObjectClass(){return this._expressionObjectClass}InitCallFunctionExpression(e,t){this._functionReturnType=e,this._functionReturnValue=t}GetFunctionReturnType(){return this._functionReturnType}SetFunctionReturnValue(e){this._functionReturnValue=e}GetFunctionReturnValue(){return this._functionReturnValue}IsSolModifierAfterCnds(){const e=this._currentEvent;return!!e.IsSolWriterAfterCnds()||this._cndIndex<e.GetConditionCount()-1&&!!e.GetSolModifiers().length}SetDynamicSolModifiers(e){this._dynamicSolModifiers=e}GetDynamicSolModifiers(){return this._dynamicSolModifiers}}}{const no=self.C3;no.LocalVarStack=class extends no.DefendedBase{constructor(e){super(),this._eventSheetManager=e,this._runtime=this._eventSheetManager.GetRuntime(),this._stack=[],this._index=-1,this._current=null,this._initialValues=[]}Release(){no.clearArray(this._stack),this._eventSheetManager=null,this._runtime=null}_SetInitialValues(e){this._initialValues=e;const t=this._initialValues.slice(0);this._stack.push(t),this._index=0,this._current=t}GetEventSheetManager(){return this._eventSheetManager}GetRuntime(){return this._runtime}GetCurrent(){return this._current}Push(){const e=++this._index,t=this._stack;e===t.length?t.push(this._initialValues.slice(0)):no.shallowAssignArray(t[e],this._initialValues),this._current=t[e]}Pop(){this._current=this._stack[--this._index]}}}{const ao=self.C3;ao.LoopStack=class extends ao.DefendedBase{constructor(e){super(),this._eventSheetManager=e,this._runtime=this._eventSheetManager.GetRuntime(),this._stack=[],this._index=-1}Release(){ao.clearArray(this._stack),this._eventSheetManager=null,this._runtime=null}GetEventSheetManager(){return this._eventSheetManager}GetRuntime(){return this._runtime}IsInLoop(){return 0<=this._index}GetCurrent(){return this._stack[this._index]}Push(){if(++this._index,this._index===this._stack.length){const e=ao.New(ao.Loop,this);return this._stack.push(e),e}{const t=this._stack[this._index];return t.Reset(),t}}Pop(){--this._index}FindByName(t){const s=this._stack;for(let e=this._index;0<=e;--e){const i=s[e];if(i.GetName()===t)return i}return null}_GetStack(){return this._stack.slice(0,this._index+1)}}}{const oo=self.C3;oo.Loop=class extends oo.DefendedBase{constructor(e){super(),this._loopStack=e,this._name=\"\",this._index=0,this._isStopped=!1,this._end=NaN}Reset(){this._name=\"\",this._index=0,this._isStopped=!1,this._end=NaN}SetName(e){this._name=e}GetName(){return this._name}SetIndex(e){this._index=e}GetIndex(){return this._index}Stop(){this._isStopped=!0}IsStopped(){return this._isStopped}SetEnd(e){this._end=e}GetEnd(){return this._end}}}{const ho=self.C3;ho.ArrayStack=class extends ho.DefendedBase{constructor(){super(),this._stack=[],this._index=-1}Release(){ho.clearArray(this._stack)}GetCurrent(){return this._stack[this._index]}Push(){if(++this._index,this._index!==this._stack.length)return this._stack[this._index];{const e=[];return this._stack.push(e),e}}Pop(){--this._index}}}{let e=function(e,t){return e.GetIndex()-t.GetIndex()},n=function(s,i){for(let e=0,t=s.length;e<t;++e)if(s[e]!==i[e])return!1;return!0};e,n;const lo=self.C3;lo.EventSheetManager=class extends lo.DefendedBase{constructor(e){super(),this._runtime=e,this._allSheets=[],this._sheetsByName=new Map,this._allGroups=[],this._groupsByName=new Map,this._blocksBySid=new Map,this._cndsBySid=new Map,this._actsBySid=new Map,this._allUniqueSolModifiers=new Map,this._eventVarsBySid=new Map,this._nextLocalVarIndex=0,this._allGlobalVars=[],this._allLocalVars=[],this._localVarInitialValues=[],this._functionBlocksByName=new Map,this._customActionBlocksMap=new Map,this._eventStack=lo.New(lo.EventStack,this),this._localVarStack=lo.New(lo.LocalVarStack,this),this._loopStack=lo.New(lo.LoopStack,this),this._triggersToPostInit=[],this._queuedTriggers=[],this._queuedDebugTriggers=[],this._runningEventsDepth=0,this._executingTriggerDepth=0,this._blockFlushingDepth=0,this._scheduledWaits=[],this._asyncActionPromises=[],this._signalTags=[],this._signalPromises=new Map,this._instSignals=new Map,self.c3_callFunction=(e,t)=>this._InvokeFunctionFromJS(e,t)}Release(){this.ClearAllScheduledWaits(),this._eventStack.Release(),this._eventStack=null,this._localVarStack.Release(),this._localVarStack=null,lo.clearArray(this._queuedTriggers),lo.clearArray(this._queuedDebugTriggers),this._runtime=null,lo.clearArray(this._allSheets),this._sheetsByName.clear()}Create(e){const t=lo.New(lo.EventSheet,this,e);this._allSheets.push(t),this._sheetsByName.set(t.GetName().toLowerCase(),t)}_AddTriggerToPostInit(e){this._triggersToPostInit.push(e)}_PostInit(){for(const e of this._customActionBlocksMap.values())e._CheckOverrideState();for(const t of this._functionBlocksByName.values())t._PostInit();for(const s of this._customActionBlocksMap.values())s._PostInit();for(const i of this._allSheets)i._PostInit();for(const r of this._allSheets)r._UpdateDeepIncludes();for(const n of this._triggersToPostInit)n._PostInit(!1);lo.clearArray(this._triggersToPostInit),this._localVarStack._SetInitialValues(this._localVarInitialValues)}GetRuntime(){return this._runtime}GetEventSheetByName(e){return this._sheetsByName.get(e.toLowerCase())||null}_RegisterGroup(e){this._allGroups.push(e),this._groupsByName.set(e.GetGroupName(),e)}_RegisterEventBlock(e){this._blocksBySid.set(e.GetSID(),e)}_RegisterCondition(e){this._cndsBySid.set(e.GetSID(),e)}_RegisterAction(e){this._actsBySid.set(e.GetSID(),e)}_RegisterFunctionBlock(e){switch(e.GetFunctionType()){case 0:this._functionBlocksByName.set(e.GetFunctionName().toLowerCase(),e);break;case 1:this._customActionBlocksMap.set(e.GetFunctionName().toLowerCase(),e)}}_RegisterEventVariable(e){this._eventVarsBySid.set(e.GetSID(),e),(e.IsGlobal()?this._allGlobalVars:this._allLocalVars).push(e)}_DeduplicateSolModifierList(s){2<=s.length&&s.sort(e);let i=this._allUniqueSolModifiers.get(s.length);i||(i=[],this._allUniqueSolModifiers.set(s.length,i));for(let e=0,t=i.length;e<t;++e){const r=i[e];if(n(s,r))return r}return i.push(s),s}_GetNextLocalVarIndex(e){return this._localVarInitialValues.push(e.GetInitialValue()),this._nextLocalVarIndex++}GetEventStack(){return this._eventStack}GetCurrentEventStackFrame(){return this.GetEventStack().GetCurrentStackFrame()}GetCurrentEvent(){return this.GetCurrentEventStackFrame().GetCurrentEvent()}GetCurrentCondition(){const e=this.GetCurrentEventStackFrame(),t=e.GetCurrentEvent();return t.GetConditionAt(e.GetConditionIndex())}GetCurrentAction(){const e=this.GetCurrentEventStackFrame(),t=e.GetCurrentEvent();return t.GetActionAt(e.GetActionIndex())}GetLocalVarStack(){return this._localVarStack}GetLoopStack(){return this._loopStack}GetAllLocalVariablesInScope(e){const t=[];for(e=e.GetScopeParent();e;)lo.appendArray(t,e._GetAllLocalVariablesInScope()),e=e.GetScopeParent();return t}_GetLocalVariablesScriptInterface(e){const t={};for(const s of this.GetAllLocalVariablesInScope(e))t[s.GetJsPropName()]=s._GetScriptInterfaceDescriptor();return Object.create(Object.prototype,t)}GetEventVariableBySID(e){return this._eventVarsBySid.get(e)||null}GetEventBlockBySID(e){return this._blocksBySid.get(e)||null}GetConditionBySID(e){return this._cndsBySid.get(e)||null}GetActionBySID(e){return this._actsBySid.get(e)||null}GetFunctionBlockByName(e){return this._functionBlocksByName.get(e.toLowerCase())||null}GetCustomActionBlockByName(e,t){let s=this._customActionBlocksMap.get((e.GetName()+\".\"+t).toLowerCase());if(s)return s;if(!e.IsFamily())for(const i of e.GetFamilies())if(s=this._customActionBlocksMap.get((i.GetName()+\".\"+t).toLowerCase()))return s;return null}GetAllGlobalVariables(){return this._allGlobalVars}GetAllLocalVariables(){return this._allLocalVars}ResetAllGlobalsToInitialValue(e){for(const t of this._allGlobalVars)t.ResetToInitialValue();if(e)for(const s of this._allLocalVars)s.IsStatic()&&s.ResetToInitialValue()}GetEventGroupByName(e){return this._groupsByName.get(e.toLowerCase())||null}GetEventGroupBySID(e){const t=this._blocksBySid.get(e);return t&&t.IsGroup()?t:null}GetAllGroups(){return this._allGroups}ResetAllGroupsInitialActivation(){for(const e of this._allGroups)e.ResetInitialActivation()}_ResetAllHasRunFlags(){for(const e of this._allSheets)e._ResetHasRunFlag()}RunEvents(e){this._ResetAllHasRunFlags(),this._runningEventsDepth++;for(const t of e.runningLayouts()){const s=t.GetEventSheet();s&&(this._runtime.PushCurrentLayout(t),s.Run(),this._runtime.PopCurrentLayout())}this._runningEventsDepth--}async DebugRunEvents(e){this._ResetAllHasRunFlags(),this._runningEventsDepth++;for(const t of this._DebugRunEventsGen(e))await this._runtime.DebugBreak(t);this._runningEventsDepth--}*_DebugRunEventsGen(e){for(const t of e.runningLayouts()){const s=t.GetEventSheet();s&&(this._runtime.PushCurrentLayout(t),yield*s.DebugRun(),this._runtime.PopCurrentLayout())}}_Trigger(e,t,s,i){let r=!1;if(!e.GetMainRunningLayout())return this.QueueTrigger(t,s,i);this._executingTriggerDepth++;for(const n of e.runningLayouts()){const a=n.GetEventSheet();if(a){this._runtime.PushCurrentLayout(n);for(const h of a.deepIncludes()){const l=h._Trigger(t,s,i);r=r||l}const o=a._Trigger(t,s,i);r=r||o,this._runtime.PopCurrentLayout()}}return this._executingTriggerDepth--,r}*_DebugTrigger(e,t,s,i){let r=!1;if(!e.GetMainRunningLayout())return this.QueueTrigger(t,s,i);this._executingTriggerDepth++;for(const n of e.runningLayouts()){const a=n.GetEventSheet();if(a){this._runtime.PushCurrentLayout(n);for(const h of a.deepIncludes()){const l=yield*h._DebugTrigger(t,s,i);r=r||l}const o=yield*a._DebugTrigger(t,s,i);r=r||o,this._runtime.PopCurrentLayout()}}return this._executingTriggerDepth--,r}QueueTrigger(e,t,s){return this._queuedTriggers.push([e,t,s]),!1}QueueDebugTrigger(e,t,s){let i=null,r=new Promise(e=>i=e);return this._queuedDebugTriggers.push([e,t,s,i]),r}*_RunQueuedDebugTriggersGen(){if(this._runtime.HitBreakpoint())throw new Error(\"should not be in breakpoint\");const e=this._runtime.GetLayoutManager();for(;this._queuedDebugTriggers.length;){const[t,s,i,r]=this._queuedDebugTriggers.shift(),n=yield*this._DebugTrigger(e,t,s,i);r(n)}}async RunQueuedDebugTriggersAsync(){for(const e of this._RunQueuedDebugTriggersGen())await this._runtime.DebugBreak(e)}_FastTrigger(e,s,i,r){let n=!1,t=e.GetMainRunningLayout(),a=t.GetEventSheet();if(a){this._executingTriggerDepth++,this._runtime.PushCurrentLayout(t);const o=a.deepIncludes();for(let e=0,t=o.length;e<t;++e){const l=o[e]._FastTrigger(s,i,r);n=n||l}const h=a._FastTrigger(s,i,r);return n=n||h,this._runtime.PopCurrentLayout(),this._executingTriggerDepth--,n}}*_DebugFastTrigger(e,s,i,r){let n=!1,t=e.GetMainRunningLayout(),a=t.GetEventSheet();if(a){this._executingTriggerDepth++,this._runtime.PushCurrentLayout(t);const o=a.deepIncludes();for(let e=0,t=o.length;e<t;++e){const l=yield*o[e]._DebugFastTrigger(s,i,r);n=n||l}const h=yield*a._DebugFastTrigger(s,i,r);return n=n||h,this._runtime.PopCurrentLayout(),this._executingTriggerDepth--,n}}GetTriggerDepth(){return this._executingTriggerDepth}IsInTrigger(){return 0<this.GetTriggerDepth()}_IncTriggerDepth(){return++this._executingTriggerDepth}_DecTriggerDepth(){--this._executingTriggerDepth}IsRunningEvents(){return 0<this._runningEventsDepth}IsInEventEngine(){return this.IsRunningEvents()||this.IsInTrigger()}_RunQueuedTriggers(e){for(const[t,s,i]of this._queuedTriggers)this._Trigger(e,t,s,i);lo.clearArray(this._queuedTriggers)}BlockFlushingInstances(e){e?this._blockFlushingDepth++:this._blockFlushingDepth--}IsFlushingBlocked(){return 0<this._blockFlushingDepth}ClearSol(s){for(let e=0,t=s.length;e<t;++e)s[e].GetSolStack().Clear()}PushCleanSol(s){for(let e=0,t=s.length;e<t;++e)s[e].GetSolStack().PushClean()}PushCopySol(s){for(let e=0,t=s.length;e<t;++e)s[e].GetSolStack().PushCopy()}PopSol(s){for(let e=0,t=s.length;e<t;++e)s[e].GetSolStack().Pop()}GetDynamicSolModifiersSet(t){const s=new Set,i=this._eventStack.GetAllStackFrames(),r=this._eventStack.GetCurrentStackFrameIndex();for(let e=0;e<=r;++e){const n=i[e].GetDynamicSolModifiers();if(n)for(const a of n)t&&t.has(a)||s.add(a)}return s}PushCleanSolDynamic(e){const t=new Set([...e]),s=this.GetDynamicSolModifiersSet(t);if(0<s.size){for(const i of s)i.GetSolStack().PushClean();return[...s]}return null}AddScheduledWait(){const e=lo.New(lo.ScheduledWait,this);return this._scheduledWaits.push(e),e}scheduledWaits(){return this._scheduledWaits}RunScheduledWaits(){if(this._scheduledWaits.length){let s=this.GetCurrentEventStackFrame(),i=!1;this._runningEventsDepth++;for(let e=0,t=this._scheduledWaits.length;e<t;++e){const r=this._scheduledWaits[e];r._ShouldRun()&&r._Run(s),r.ShouldRelease()&&(i=!0)}i&&(this._FilterScheduledWaitsToRelease(),s.Reset(null)),this._runningEventsDepth--}}async DebugRunScheduledWaits(){if(this._scheduledWaits.length){let s=this.GetCurrentEventStackFrame(),i=!1;this._runningEventsDepth++;for(let e=0,t=this._scheduledWaits.length;e<t;++e){const r=this._scheduledWaits[e];r._ShouldRun()&&await r._DebugRun(s),r.ShouldRelease()&&(i=!0)}i&&(this._FilterScheduledWaitsToRelease(),s.Reset(null)),this._runningEventsDepth--}}_FilterScheduledWaitsToRelease(){const e=lo.arrayFilterOut(this._scheduledWaits,e=>e.ShouldRelease());for(const t of e)t.Release()}ClearAllScheduledWaits(){for(const e of this._scheduledWaits)e.Release();lo.clearArray(this._scheduledWaits)}_OnInstancesReleased(e){for(const t of this._scheduledWaits)t.RemoveInstances(e);for(const s of e){const i=this._instSignals.get(s);if(this._instSignals.delete(s),i)for(const{resolve:r}of i.signalPromises.values())r(!0)}}AddAsyncActionPromise(e){this._asyncActionPromises.push({promise:e,triggerDepth:this.GetTriggerDepth()})}ClearAsyncActionPromises(){lo.clearArray(this._asyncActionPromises)}ClearNestedAsyncActionPromises(){const t=this.GetTriggerDepth();this._asyncActionPromises=this._asyncActionPromises.filter(e=>e.triggerDepth<=t)}GetPromiseForAllAsyncActions(){const e=Promise.all(this._asyncActionPromises.map(e=>e.promise));return this._asyncActionPromises=[],e}Signal(e){const t=e.toLowerCase();this._signalTags.push(t),this._runtime.Trigger(lo.Plugins.System.Cnds.OnSignal,null),this._signalTags.pop();for(const i of this._runtime.GetEventSheetManager().scheduledWaits())i.IsSignal()&&i.GetSignalTag()===t&&i.SetSignalled();const s=this._signalPromises.get(t);s&&(s.resolve(),this._signalPromises.delete(t))}WaitForSignal(e){const s=e.toLowerCase(),t=this._signalPromises.get(s);if(t)return t.promise;{let t=null,e=new Promise(e=>t=e);return this._signalPromises.set(s,{promise:e,resolve:t}),e}}GetCurrentSignalTag(){if(0===this._signalTags.length)throw new Error(\"not in a signal\");return this._signalTags.at(-1)}_GetInstanceSignalState(e){let t=this._instSignals.get(e);return t||(t={signalTags:[],signalPromises:new Map},this._instSignals.set(e,t)),t}InstanceSignal(e,t){const s=this._GetInstanceSignalState(e),i=t.toLowerCase();s.signalTags.push(i),this._runtime.Trigger(e.GetPlugin().GetConstructor().Cnds.OnInstanceSignal,e),s.signalTags.pop();for(const n of this._runtime.GetEventSheetManager().scheduledWaits())n.IsInstanceSignals()&&n.GetSignalTag()===i&&n.SetInstanceSignalled(e);const r=s.signalPromises.get(i);r&&(r.resolve(!1),s.signalPromises.delete(i)),0===s.signalTags.length&&0===s.signalPromises.size&&this._instSignals.delete(e)}WaitForInstanceSignal(e,t){const s=this._GetInstanceSignalState(e),i=t.toLowerCase(),r=s.signalPromises.get(i);if(r)return r.promise;{let t=null,e=new Promise(e=>t=e);return s.signalPromises.set(i,{promise:e,resolve:t}),e}}GetCurrentInstanceSignalTag(e){const t=this._GetInstanceSignalState(e);if(t&&0!==t.signalTags.length)return t.signalTags.at(-1);throw new Error(\"not in a signal\")}_SaveToJson(){return{groups:this._SaveGroupsToJson(),cnds:this._SaveCndsToJson(),acts:this._SaveActsToJson(),vars:this._SaveVarsToJson(),waits:this._SaveScheduledWaitsToJson()}}_LoadFromJson(e){this._LoadGroupsFromJson(e.groups),this._LoadCndsFromJson(e.cnds),this._LoadActsFromJson(e.acts),this._LoadVarsFromJson(e.vars),this._LoadScheduledWaitsFromJson(e.waits)}_SaveGroupsToJson(){const e={};for(const t of this.GetAllGroups())e[t.GetSID().toString()]=t.IsGroupActive();return e}_LoadGroupsFromJson(e){for(const[t,s]of Object.entries(e)){const i=parseInt(t,10),r=this.GetEventGroupBySID(i);r&&r.SetGroupActive(s)}}_SaveCndsToJson(){const e={};for(const[t,s]of this._cndsBySid){const i=s._SaveToJson();i&&(e[t.toString()]=i)}return e}_LoadCndsFromJson(e){const t=new Map;for(const[s,i]of Object.entries(e))t.set(parseInt(s,10),i);for(const[r,n]of this._cndsBySid)n._LoadFromJson(t.get(r)||null)}_SaveActsToJson(){const e={};for(const[t,s]of this._actsBySid){const i=s._SaveToJson();i&&(e[t.toString()]=i)}return e}_LoadActsFromJson(e){const t=new Map;for(const[s,i]of Object.entries(e))t.set(parseInt(s,10),i);for(const[r,n]of this._actsBySid)n._LoadFromJson(t.get(r)||null)}_SaveVarsToJson(){const e={};for(const[t,s]of this._eventVarsBySid)s.IsConstant()||!s.IsGlobal()&&!s.IsStatic()||(e[t.toString()]=s.GetValue());return e}_LoadVarsFromJson(e){for(const[t,s]of Object.entries(e)){const i=parseInt(t,10),r=this.GetEventVariableBySID(i);r&&r.SetValue(s)}}_SaveScheduledWaitsToJson(){return this._scheduledWaits.filter(e=>!e.IsPromise()).map(e=>e._SaveToJson())}_LoadScheduledWaitsFromJson(e){this.ClearAllScheduledWaits();for(const t of e){const s=lo.ScheduledWait._CreateFromJson(this,t);s&&this._scheduledWaits.push(s)}}_GetPerfRecords(){return[...this._runtime.GetLayoutManager().runningLayouts()].map(e=>e.GetEventSheet()).filter(e=>e).map(e=>e._GetPerfRecord())}FindFirstFunctionBlockParent(e){for(;e;){const t=e.GetScopeParent();if(t instanceof lo.FunctionBlock)return t;e=t}return null}_InvokeFunctionFromJS(e,t){Array.isArray(t)||(t=[]);const s=this.GetFunctionBlockByName(e.toLowerCase());if(!s)return null;if(!s.IsEnabled())return s.GetDefaultReturnValue();const i=s.GetFunctionParameters();if(t.length<i.length)for(t=t.slice(0);t.push(i[t.length].GetInitialValue()),t.length<i.length;);const r=s.GetEventBlock();return r.RunAsExpressionFunctionCall(r.GetSolModifiersIncludingParents(),!1,s.GetReturnType(),s.GetDefaultReturnValue(),...t)}}}{const co=self.C3;co.EventSheet=class extends co.DefendedBase{constructor(e,t){super(),this._eventSheetManager=e,this._runtime=e.GetRuntime(),this._name=t[0],this._events=[],this._triggers=new Map,this._fastTriggers=new Map,this._eventsByDisplayNumber=new Map,this._hasRun=!1,this._shallowIncludes=[],this._deepIncludes=[],this._alreadyIncludedSheets=new Set;for(const s of t[1])this._CreateEvent(s,null,this._events);this._perfRecord=this._runtime.IsDebug()?{type:\"sheet\",name:this._name,totalTimeCounter:0,children:[]}:null}Release(){this._eventSheetManager=null,this._runtime=null}_CreateEvent(e,t,s){switch(e[0]){case 0:case 3:this._CreateEventBlock(e,t,s);break;case 1:this._CreateEventVariable(e,t,s);break;case 2:this._CreateInclude(e,t,s);break;case 4:this._CreateFunctionBlock(e,t);break;case 5:this._CreateScriptBlock(e,t,s);break;case 6:this._CreateCustomACEBlock(e,t);break;default:throw new Error(\"invalid event type\")}}_CreateEventBlock(e,t,s){const i=co.EventBlock.Create(this,t,e);if(i.IsOrBlock()){s.push(i);const r=i.GetConditions();for(let e=0,t=r.length;e<t;++e)r[e].IsTrigger()&&this._InitTrigger(i,e)}else i.IsTrigger()?this._InitTrigger(i,0):s.push(i)}_CreateFunctionBlock(e,t){const s=co.FunctionBlock.CreateFunctionBlock(this,t,e);this._eventSheetManager._RegisterFunctionBlock(s)}_CreateCustomACEBlock(e,t){const s=co.FunctionBlock.CreateCustomACEBlock(this,t,e);this._eventSheetManager._RegisterFunctionBlock(s)}_CreateEventVariable(e,t,s){const i=co.EventVariable.Create(this,t,e);s.push(i)}_CreateInclude(e,t,s){const i=co.EventInclude.Create(this,t,e);s.push(i)}_CreateScriptBlock(e,t,s){const i=co.EventScript.Create(this,t,e);s.push(i)}_InitTrigger(r,n){r.IsOrBlock()||this._eventSheetManager._AddTriggerToPostInit(r);const a=r.GetConditionAt(n),o=a._GetFunc(),h=a.GetObjectClass();if(a.IsFastTrigger()){let e=this._fastTriggers.get(h),t=(e||(e=new Map,this._fastTriggers.set(h,e)),a.GetFastTriggerValue().toLowerCase()),s=e.get(o),i=(s||(s=new Map,e.set(o,s)),s.get(t));i||(i=[],s.set(t,i)),i.push([r,n])}else{let e=this._triggers.get(h),t=(e||(e={methodMap:new Map,behaviors:new Map},this._triggers.set(h,e)),a.GetBehaviorType()),s,i=(t?(s=e.behaviors.get(t))||(s=new Map,e.behaviors.set(t,s)):s=e.methodMap,s.get(o));i||(i=[],s.set(o,i)),i.push([r,n])}}_PostInit(){const s=this._events;for(let e=0,t=s.length;e<t;++e){const i=e<t-1&&s[e+1]instanceof co.EventBlock&&s[e+1].IsElseBlock();s[e]._PostInit(i)}}_AddShallowInclude(e){this._shallowIncludes.push(e)}_UpdateDeepIncludes(){co.clearArray(this._deepIncludes),this._AddDeepIncludes(this),this._alreadyIncludedSheets.clear()}_AddDeepIncludes(e){const t=e._deepIncludes,s=e._alreadyIncludedSheets;for(const i of this._shallowIncludes){const r=i.GetIncludeSheet();i.IsActive()&&e!==r&&!s.has(r)&&(s.add(r),r._AddDeepIncludes(e),t.push(r))}}deepIncludes(){return this._deepIncludes}GetEventSheetManager(){return this._eventSheetManager}GetRuntime(){return this._runtime}GetName(){return this._name}_RegisterEventByDisplayNumber(e,t){this._eventsByDisplayNumber.set(t,e)}_GetEventByDisplayNumber(e){return this._eventsByDisplayNumber.get(e)||null}_ResetHasRunFlag(){this._hasRun=!1}Run(){if(!this._hasRun){const e=this._runtime,t=e.IsCPUProfiling(),s=t?performance.now():0,i=(this._hasRun=!0,this.GetEventSheetManager()),r=i.GetCurrentEventStackFrame();for(const n of this._events)n.Run(r),i.ClearSol(n.GetSolModifiers()),i.ClearAsyncActionPromises(),e.FlushPendingInstances();r.Reset(null),t&&(this._perfRecord.totalTimeCounter+=performance.now()-s)}}*DebugRun(){if(!this._hasRun){this._hasRun=!0;const e=this._runtime,t=this.GetEventSheetManager(),s=t.GetCurrentEventStackFrame();for(const i of this._events)yield*i.DebugRun(s),t.ClearSol(i.GetSolModifiers()),t.ClearAsyncActionPromises(),e.FlushPendingInstances();s.Reset(null)}}_Trigger(i,r,n){if(!r)return this._TriggerForClass(i,r,null,null);{let e=r.GetObjectClass(),t=!1,s=this._TriggerForClass(i,r,e,n);t=t||s;for(const a of e.GetFamilies())s=this._TriggerForClass(i,r,a,n),t=t||s}}_TriggerForClass(e,t,s,i){const r=this._triggers.get(s);if(!r)return!1;const n=i?r.behaviors.get(i):r.methodMap;if(!n)return!1;const a=n.get(e);if(!a)return!1;let o=!1;for(const[h,l]of a){const c=this._ExecuteTrigger(t,h,l);o=o||c}return o}*_DebugTrigger(i,r,n){if(!r)return yield*this._DebugTriggerForClass(i,r,null,null);{let e=r.GetObjectClass(),t=!1,s=yield*this._DebugTriggerForClass(i,r,e,n);t=t||s;for(const a of e.GetFamilies())s=yield*this._DebugTriggerForClass(i,r,a,n),t=t||s}}*_DebugTriggerForClass(e,t,s,i){const r=this._triggers.get(s);if(!r)return!1;const n=i?r.behaviors.get(i):r.methodMap;if(!n)return!1;const a=n.get(e);if(!a)return!1;let o=!1;for(const[h,l]of a){let e;e=h.DebugCanRunFast()?this._ExecuteTrigger(t,h,l):yield*this._DebugExecuteTrigger(t,h,l),o=o||e}return o}_FastTrigger(e,t,s){const i=t.GetObjectClass(),r=this._fastTriggers.get(i);if(!r)return!1;const n=r.get(e);if(!n)return!1;const a=n.get(s);if(!a)return!1;let o=!1;for(let e=0,t=a.length;e<t;++e){const h=a[e],l=this._ExecuteTrigger(null,h[0],h[1]);o=o||l}return o}*_DebugFastTrigger(e,t,s){const i=t.GetObjectClass(),r=this._fastTriggers.get(i);if(!r)return!1;const n=r.get(e);if(!n)return!1;const a=n.get(s);if(!a)return!1;let o=!1;for(let r=0,e=a.length;r<e;++r){let e=a[r],t=e[0],s=e[1],i;i=t.DebugCanRunFast()?this._ExecuteTrigger(null,t,s):yield*this._DebugExecuteTrigger(null,t,s),o=o||i}return o}_ExecuteTrigger(e,t,s){let i=this._runtime,r=this._eventSheetManager,n=r.GetCurrentEvent(),a=r.GetEventStack(),o=r.GetTriggerDepth(),h=!1;n&&r.PushCleanSol(n.GetSolModifiersIncludingParents()),r.PushCleanSol(t.GetSolModifiersIncludingParents());const l=1<o,c=(l&&r.GetLocalVarStack().Push(),a.Push(t));if(e){const _=t.GetConditions()[s].GetObjectClass(),d=_.GetCurrentSol();d.SetSinglePicked(e),e.IsInContainer()&&e.SetSiblingsSinglePicked()}let u=!0;if(t.GetParent()){const p=t.GetTriggerParents();for(let e=0,t=p.length;e<t;++e)if(!p[e].RunPreTrigger(c)){u=!1;break}}return u&&(t.IsOrBlock()?t.RunOrBlockTrigger(c,s):t.Run(c),h=c.GetLastEventTrue()),a.Pop(),l&&r.GetLocalVarStack().Pop(),r.PopSol(t.GetSolModifiersIncludingParents()),n&&r.PopSol(n.GetSolModifiersIncludingParents()),n||1!==o||(r.ClearAsyncActionPromises(),r.IsFlushingBlocked())||i.FlushPendingInstances(),h}*_DebugExecuteTrigger(e,t,s){let i=this._runtime,r=this._eventSheetManager,n=r.GetCurrentEvent(),a=r.GetEventStack(),o=r.GetTriggerDepth(),h=!1;n&&r.PushCleanSol(n.GetSolModifiersIncludingParents()),r.PushCleanSol(t.GetSolModifiersIncludingParents());const l=1<o,c=(l&&r.GetLocalVarStack().Push(),a.Push(t));if(e){const _=t.GetConditions()[s].GetObjectClass(),d=_.GetCurrentSol();d.SetSinglePicked(e),e.IsInContainer()&&e.SetSiblingsSinglePicked()}let u=!0;if(t.GetParent()){const p=t.GetTriggerParents();for(let e=0,t=p.length;e<t;++e)if(!(yield*p[e].DebugRunPreTrigger(c))){u=!1;break}}return u&&(t.IsOrBlock()?yield*t.DebugRunOrBlockTrigger(c,s):yield*t.DebugRun(c),h=c.GetLastEventTrue()),a.Pop(),l&&r.GetLocalVarStack().Pop(),r.PopSol(t.GetSolModifiersIncludingParents()),n&&r.PopSol(n.GetSolModifiersIncludingParents()),n||1!==o||(r.ClearAsyncActionPromises(),r.IsFlushingBlocked())||i.FlushPendingInstances(),h}_GetPerfRecord(){return this._perfRecord}}}{let c=function(e,t){return!0};c;const uo=self.C3,_o=[];function*N(e,t){return!0}uo.EventBlock=class extends uo.DefendedBase{constructor(e,t,s){super(),this._eventSheet=e,this._runtime=e.GetRuntime(),this._parent=t,this._scopeParent=null,this._eventStack=this._runtime.GetEventSheetManager().GetEventStack(),this._solModifiers=[],this._solModifiersIncludingParents=[],this._hasGotSolModifiersIncludingParents=!1,this._isSolWriterAfterCnds=!1,this._isTopLevelGroup=!1,this._hasElseBlock=!1,this._isOrBlock=!!s[2],this._isElseBlock=!1,this._triggerParents=null,this._conditions=[],this._actions=[],this._subEvents=[],this._RunActions=c,this._DebugRunActions=N,this._isGroup=!1,this._isInitiallyActive=!1,this._groupName=\"\",this._isGroupActive=!1,this._containedIncludes=null,this._perfRecord=null,this._sid=s[4],this._displayNumber=s[5],this._eventSheet._RegisterEventByDisplayNumber(this,this._displayNumber),this._debugData=this._runtime.IsDebug()?{isBreakpoint:s[3][0],isBreakable:s[3][1],canRunAllConditionsFast:!1,canRunAllActionsFast:!1,canRunAllSubEventsFast:!1,canRunSelfFast:!1}:null,this.GetEventSheetManager()._RegisterEventBlock(this),3===s[0]&&this._InitGroup(s[1]);let i=0;for(const r of s[6]){const n=uo.Condition.Create(this,r,i++);this._conditions.push(n),this._AddSolModifier(n.GetObjectClass())}i=0;for(const a of s[7]){const o=uo.Action.Create(this,a,i++);this._actions.push(o)}if(9===s.length){const h=s[8];for(const l of h)this._eventSheet._CreateEvent(l,this,this._subEvents)}this._conditions.length&&(this._isElseBlock=null===this._conditions[0].GetObjectClass()&&this._conditions[0]._GetFunc()===uo.Plugins.System.Cnds.Else),0===this._conditions.length&&(this._conditions=_o),0===this._actions.length&&(this._actions=_o),0===this._subEvents.length&&(this._subEvents=_o)}static Create(e,t,s){return uo.New(uo.EventBlock,e,t,s)}_InitGroup(e){this._isGroup=!0,this._isInitiallyActive=!!e[0],this._isGroupActive=this._isInitiallyActive,this._groupName=e[1].toLowerCase(),this._containedIncludes=[],this.GetEventSheetManager()._RegisterGroup(this),this._runtime.IsDebug()&&(this._perfRecord={type:\"group\",name:e[1],totalTimeCounter:0,children:[]})}_AddContainedInclude(e){this._containedIncludes.push(e)}_AddContainerSolModifierToList(e,t){for(const s of e.GetContainer().objectTypes())t.includes(s)||t.push(s)}_AddSolModifierToList(e,t){if(e)if(t.includes(e)||t.push(e),e.IsFamily())for(const s of e.GetFamilyMembers())s.IsInContainer()&&this._AddContainerSolModifierToList(s,t);else e.IsInContainer()&&this._AddContainerSolModifierToList(e,t)}_AddSolModifier(e){this._AddSolModifierToList(e,this._solModifiers)}_AddParentSolModifier(e){this._AddSolModifierToList(e,this._solModifiersIncludingParents)}SetAllSolModifiers(){this._solModifiers=this._runtime.GetAllObjectClasses()}_PostInit(e){this._hasElseBlock=!!e,this._IdentifyTopLevelGroup(),this._IdentifyTriggerParents();for(const t of this._conditions)t._PostInit();if(0<this._actions.length){let e=!1;for(const i of this._actions)i._PostInit(),i.HasReturnType()&&(e=!0);e?(this._RunActions=this._RunActions_ReturnValue,this._DebugRunActions=this._DebugRunActions_ReturnValue):(this._RunActions=this._RunActions_Fast,this._DebugRunActions=this._DebugRunActions_Fast)}const s=this._subEvents;for(let e=0,t=s.length;e<t;++e){const r=e<t-1&&s[e+1]instanceof uo.EventBlock&&s[e+1].IsElseBlock();s[e]._PostInit(r)}this._debugData&&this._UpdateCanRunFast(),this._perfRecord&&this._GetPerfRecordParent()._GetPerfRecord().children.push(this._perfRecord)}_GetPerfRecord(){return this._perfRecord}_GetPerfRecordParent(){let e=this.GetParent();for(;e;){if(e.IsGroup())return e;e=e.GetParent()}return this._eventSheet}_UpdateCanRunFast(){const e=this._debugData;e.canRunAllConditionsFast=this._conditions.every(e=>e.DebugCanRunFast()),e.canRunAllActionsFast=this._actions.every(e=>e.DebugCanRunFast()),e.canRunAllSubEventsFast=this._subEvents.every(e=>e.DebugCanRunFast()),e.canRunSelfFast=e.canRunAllConditionsFast&&e.canRunAllActionsFast&&e.canRunAllSubEventsFast}_UpdateCanRunFastRecursive(){let e=this;for(;e._UpdateCanRunFast(),e=e.GetParent(););}_IdentifyTopLevelGroup(){if(this.IsGroup()){let e=this.GetParent();for(this._isTopLevelGroup=!0;e;){if(!e.IsGroup()){this._isTopLevelGroup=!1;break}e=e.GetParent()}}}_IdentifySolModifiersIncludingParents(){const e=this._runtime.GetAllObjectClasses();if(this._solModifiers===e)this._solModifiersIncludingParents=e;else{this._solModifiersIncludingParents=uo.cloneArray(this._solModifiers);let e=this.GetParent();for(;e;){for(const s of e._solModifiers)this._AddParentSolModifier(s);e=e.GetParent()}const t=this.GetEventSheetManager();this._solModifiers=t._DeduplicateSolModifierList(this._solModifiers),this._solModifiersIncludingParents=t._DeduplicateSolModifierList(this._solModifiersIncludingParents)}}_IdentifyTriggerParents(){if(this.HasAnyTriggeredCondition()){this._triggerParents=[];let e=this.GetParent();for(;e;)this._triggerParents.push(e),e=e.GetParent();this._triggerParents.reverse()}}SetSolWriterAfterCnds(){this._isSolWriterAfterCnds=!0,this._parent&&this._parent.SetSolWriterAfterCnds()}IsSolWriterAfterCnds(){return this._isSolWriterAfterCnds}GetSolModifiers(){return this._solModifiers}GetSolModifiersIncludingParents(){return this._hasGotSolModifiersIncludingParents||(this._hasGotSolModifiersIncludingParents=!0,this._IdentifySolModifiersIncludingParents()),this._solModifiersIncludingParents}HasSolModifier(e){return this._solModifiers.includes(e)}GetTriggerParents(){return this._triggerParents}GetEventSheet(){return this._eventSheet}GetEventSheetManager(){return this._eventSheet.GetEventSheetManager()}GetRuntime(){return this._runtime}GetParent(){return this._parent}_SetScopeParent(e){this._scopeParent=e}GetScopeParent(){return this._scopeParent||this._parent}GetDisplayNumber(){return this._displayNumber}IsDebugBreakable(){return this._debugData&&this._debugData.isBreakable}IsDebugBreakpoint(){return this.IsDebugBreakable()&&this._debugData.isBreakpoint}_SetDebugBreakpoint(e){this._debugData.isBreakpoint=!!e,this._UpdateCanRunFastRecursive()}IsGroup(){return this._isGroup}IsTopLevelGroup(){return this._isTopLevelGroup}IsElseBlock(){return this._isElseBlock}HasElseBlock(){return this._hasElseBlock}GetGroupName(){return this._groupName}IsGroupActive(){return this._isGroupActive}ResetInitialActivation(){this.SetGroupActive(this._isInitiallyActive)}SetGroupActive(e){if(e=!!e,!this._isGroup)throw new Error(\"not a group\");if(this._isGroupActive!==e){this._isGroupActive=e;for(const t of this._containedIncludes)t.UpdateActive();if(this._containedIncludes.length){const s=this._runtime.GetCurrentLayout(),i=s.GetEventSheet();i&&i._UpdateDeepIncludes()}}}GetSID(){return this._sid}IsOrBlock(){return this._isOrBlock}IsTrigger(){return this._conditions.length&&this._conditions[0].IsTrigger()}IsForFunctionBlock(){return this._scopeParent&&this._scopeParent instanceof uo.FunctionBlock}HasAnyTriggeredCondition(){return this.IsForFunctionBlock()||this._conditions.some(e=>e.IsTrigger())}GetConditions(){return this._conditions}GetConditionCount(){return this._conditions.length}GetConditionAt(e){if((e=Math.floor(e))<0||e>=this._conditions.length)throw new RangeError(\"invalid condition index\");return this._conditions[e]}GetConditionByDebugIndex(e){return this.GetConditionAt(e)}IsFirstConditionOfType(e){let t=e.GetIndex();if(0!==t){--t;const s=e.IsSystemOrSingleGlobalCondition()?e.GetFirstObjectParameterObjectClass():e.GetObjectClass();for(;0<=t;--t){const i=this._conditions[t];if(s===i.GetObjectClass()||i.IsSystemOrSingleGlobalCondition()&&i.GetFirstObjectParameterObjectClass()===s)return!1}}return!0}GetActions(){return this._actions}GetActionCount(){return this._actions.length}GetActionAt(e){if((e=Math.floor(e))<0||e>=this._actions.length)throw new RangeError(\"invalid action index\");return this._actions[e]}GetActionByDebugIndex(t){t=Math.floor(t);const e=this._actions.find(e=>e.GetDebugIndex()===t);if(e)return e;throw new RangeError(\"invalid action debug index\")}_HasActionIndex(e){return 0<=(e=Math.floor(e))&&e<this._actions.length}GetSubEvents(){return this._subEvents}_GetAllLocalVariablesInScope(){return this._subEvents.filter(e=>e instanceof uo.EventVariable)}RunPreTrigger(s){s.SetCurrentEvent(this);let i=this._conditions,r=0===i.length;for(let e=0,t=i.length;e<t;++e){const n=i[e];if(s.SetConditionIndex(e),n.IsLooping())throw new Error(\"trigger cannot be used as sub-event to a loop\");if(n.Run())r=!0;else if(!this._isOrBlock)return!1}return!this._isOrBlock||r}RunOrBlockTrigger(e,t){e.SetCurrentEvent(this),e.SetConditionIndex(t),this._conditions[t].Run()&&(this._RunActions(e,0)&&this._RunSubEvents(e),e.SetLastEventTrue(!0))}*DebugRunPreTrigger(s){s.SetCurrentEvent(this);let i=this._conditions,r=0===i.length;for(let e=0,t=i.length;e<t;++e){const n=i[e];if(s.SetConditionIndex(e),n.IsLooping())throw new Error(\"trigger cannot be used as sub-event to a loop\");if(n.DebugCanRunFast()?n.Run():yield*n.DebugRun())r=!0;else if(!this._isOrBlock)return!1}return!this._isOrBlock||r}*DebugRunOrBlockTrigger(e,t){e.SetCurrentEvent(this),e.SetConditionIndex(t);let s=this._conditions[t];if(s.DebugCanRunFast()?s.Run():yield*s.DebugRun())(this.DebugCanRunActionsFast()?this._RunActions(e,0):yield*this._DebugRunActions(e,0))&&(this.DebugCanRunSubEventsFast()?this._RunSubEvents():yield*this._DebugRunSubEvents()),e.SetLastEventTrue(!0)}Run(e){e.SetCurrentEvent(this),this._isElseBlock||e.SetElseBranchRan(!1),this._isOrBlock?this._RunOrBlock(e):this._RunAndBlock(e)}*DebugRun(e){(this.IsDebugBreakpoint()||this._runtime.DebugBreakNext())&&(yield this),e.SetCurrentEvent(this),this._isElseBlock||e.SetElseBranchRan(!1),this._isOrBlock?yield*this._DebugRunOrBlock(e):yield*this._DebugRunAndBlock(e)}_RunOrBlock(s){let i=this._conditions,r=0===i.length;for(let e=0,t=i.length;e<t;++e){const n=i[e];if(!n.IsTrigger()){s.SetConditionIndex(e);const a=n.Run();r=r||a}}s.SetLastEventTrue(r),r&&(this._RunActions(s,0)&&this._RunSubEvents(s),this._hasElseBlock)&&s.SetElseBranchRan(!0)}*_DebugRunOrBlock(s){let i=this._conditions,r=0===i.length;for(let t=0,e=i.length;t<e;++t){const n=i[t];if(!n.IsTrigger()){s.SetConditionIndex(t);let e;e=n.DebugCanRunFast()?n.Run():yield*n.DebugRun(),r=r||e}}if(s.SetLastEventTrue(r),r)(this.DebugCanRunActionsFast()?this._RunActions(s,0):yield*this._DebugRunActions(s,0))&&(this.DebugCanRunSubEventsFast()?this._RunSubEvents():yield*this._DebugRunSubEvents()),this._hasElseBlock&&s.SetElseBranchRan(!0)}_RunAndBlock(s){const i=this._conditions;for(let e=0,t=i.length;e<t;++e){const r=i[e],n=(s.SetConditionIndex(e),r.Run());if(!n)return void s.SetLastEventTrue(!1)}s.SetLastEventTrue(!0),this._RunActions(s,0)&&this._RunSubEvents(s),s.GetLastEventTrue()&&this._hasElseBlock&&s.SetElseBranchRan(!0)}*_DebugRunAndBlock(s){const i=this._conditions;for(let e=0,t=i.length;e<t;++e){const r=i[e];s.SetConditionIndex(e);if(!(r.DebugCanRunFast()?r.Run():yield*r.DebugRun()))return void s.SetLastEventTrue(!1)}s.SetLastEventTrue(!0);(this.DebugCanRunActionsFast()?this._RunActions(s,0):yield*this._DebugRunActions(s,0))&&(this.DebugCanRunSubEventsFast()?this._RunSubEvents():yield*this._DebugRunSubEvents()),s.GetLastEventTrue()&&this._hasElseBlock&&s.SetElseBranchRan(!0)}_RunActions_Fast(s,i){const r=this._actions;for(let e=i,t=r.length;e<t;++e){const n=r[e];s.SetActionIndex(e),n.Run()}return!0}*_DebugRunActions_Fast(s,i){const r=this._actions;for(let e=i,t=r.length;e<t;++e){const n=r[e];s.SetActionIndex(e),n.DebugCanRunFast()?n.Run():yield*n.DebugRun()}return!0}_RunActions_ReturnValue(s,i){const r=this.GetEventSheetManager(),n=this._actions;for(let e=i,t=n.length;e<t;++e){const a=n[e],o=(s.SetActionIndex(e),a.Run());if(a.CanBailOut()&&!0===o)return!1;a.IsAsync()&&o instanceof Promise&&r.AddAsyncActionPromise(o)}return!0}*_DebugRunActions_ReturnValue(s,i){const r=this.GetEventSheetManager(),n=this._actions;for(let t=i,e=n.length;t<e;++t){const a=n[t];s.SetActionIndex(t);let e;if(e=a.DebugCanRunFast()?a.Run():yield*a.DebugRun(),a.CanBailOut()&&!0===e)return!1;a.IsAsync()&&e instanceof Promise&&r.AddAsyncActionPromise(e)}return!0}_ResumeActionsAndSubEvents(e){this._RunActions(e,e.GetActionIndex())&&this._RunSubEvents()}*_DebugResumeActionsAndSubEvents(e){(yield*this._DebugRunActions(e,e.GetActionIndex()))&&(yield*this._DebugRunSubEvents())}_RunSubEvents(){if(this._subEvents.length){const e=this.IsGroup()&&this._runtime.IsCPUProfiling(),t=e?performance.now():0,s=this._eventStack,i=s.Push(this);this._isSolWriterAfterCnds?this._RunSubEvents_SolWriterAfterCnds(i):this._RunSubEvents_Fast(i),s.Pop(),e&&(this._perfRecord.totalTimeCounter+=performance.now()-t)}}_RunSubEvents_SolWriterAfterCnds(i){const r=this._isGroup,n=this._isTopLevelGroup,a=this.GetEventSheetManager(),o=this._subEvents;for(let e=0,t=o.length,s=t-1;e<t;++e){const h=o[e],l=h.GetSolModifiers(),c=!n||!r&&e<s;c&&a.PushCopySol(l),h.Run(i),c?a.PopSol(l):a.ClearSol(l)}}_RunSubEvents_Fast(s){const i=this._subEvents;for(let e=0,t=i.length;e<t;++e)i[e].Run(s)}*_DebugRunSubEvents(){if(this._subEvents.length){const e=this._eventStack,t=e.Push(this);this._isSolWriterAfterCnds?yield*this._DebugRunSubEvents_SolWriterAfterCnds(t):yield*this._DebugRunSubEvents_Fast(t),e.Pop()}}*_DebugRunSubEvents_SolWriterAfterCnds(i){const r=this._isGroup,n=this._isTopLevelGroup,a=this.GetEventSheetManager(),o=this._subEvents;for(let e=0,t=o.length,s=t-1;e<t;++e){const h=o[e],l=h.GetSolModifiers(),c=!n||!r&&e<s;c&&a.PushCopySol(l),yield*h.DebugRun(i),c?a.PopSol(l):a.ClearSol(l)}}*_DebugRunSubEvents_Fast(s){const i=this._subEvents;for(let e=0,t=i.length;e<t;++e)yield*i[e].DebugRun(s)}Retrigger(s,i){i.ResetQuick();const r=this._conditions;if(!this.IsOrBlock())for(let e=s.GetConditionIndex()+1,t=r.length;e<t;++e){const n=r[e],a=(i.SetConditionIndex(e),n.Run());if(!a)return!1}return this._RunActions(i,0)&&this._RunSubEvents(i),!0}*DebugRetrigger(s,i){i.ResetQuick();const r=this._conditions;if(!this.IsOrBlock())for(let e=s.GetConditionIndex()+1,t=r.length;e<t;++e){const n=r[e];i.SetConditionIndex(e);if(!(n.DebugCanRunFast()?n.Run():yield*n.DebugRun()))return!1}return(this.DebugCanRunActionsFast()?this._RunActions(i,0):yield*this._DebugRunActions(i,0))&&(this.DebugCanRunSubEventsFast()?this._RunSubEvents():yield*this._DebugRunSubEvents()),!0}DebugCanRunFast(){return!this.IsDebugBreakpoint()&&!this._runtime.DebugBreakNext()&&this._debugData.canRunSelfFast}DebugCanRunActionsFast(){return!this._runtime.DebugBreakNext()&&this._debugData.canRunAllActionsFast}DebugCanRunSubEventsFast(){return!this._runtime.DebugBreakNext()&&this._debugData.canRunAllSubEventsFast}_CheckParentsOKToRun(s){if(this.GetParent()){const i=this.GetTriggerParents();for(let e=0,t=i.length;e<t;++e)if(!i[e].RunPreTrigger(s))return!1}return!0}*_DebugCheckParentsOKToRun(s){if(this.GetParent()){const i=this.GetTriggerParents();for(let e=0,t=i.length;e<t;++e)if(!(yield*i[e].DebugRunPreTrigger(s)))return!1}return!0}_EvaluateFunctionCallParameters(e,t,s){if(0<t.length)if(s){const i=t.map(e=>e.Get(0));e.GetLocalVarStack().Push(),this._scopeParent.SetFunctionParameters(i)}else this._scopeParent.EvaluateFunctionParameters(t);else s&&e.GetLocalVarStack().Push()}RunAsFunctionCall(e,t,s,i){let r,n,a=0<e.length,o=null,h=this._runtime,l=this._eventStack,c=h.GetEventSheetManager(),u=this._scopeParent,_=u.IsAsync(),d=c._IncTriggerDepth(),p=1<d;if(this._EvaluateFunctionCallParameters(c,t,p),a&&(s?c.PushCopySol(e):c.PushCleanSol(e)),null!==i){if(i.copyFromObjectClass){const m=s?i.copyFromObjectClass.GetCurrentSol():i.copyFromObjectClass.GetSolStack().GetOneBelowCurrentSol(),g=i.copyToObjectClass.GetCurrentSol();g.SetArrayPicked(m.GetInstances()),g.ClearElseInstances(),s||i.copyToObjectClass.ApplySolToContainer()}else if(i.pickObjectClass){const S=i.pickObjectClass.GetCurrentSol();S.SetArrayPicked(i.pickInstances),S.ClearElseInstances()}i.pushCleanSolDynamic&&(o=c.PushCleanSolDynamic(e))}const f=l.Push(this);return s&&f.SetDynamicSolModifiers(e),this._CheckParentsOKToRun(f)&&(f.SetCurrentEvent(this),_&&([n,r]=u.StartAsyncFunctionCall()),this._RunAndBlock(f),_)&&u.MaybeFinishAsyncFunctionCall(n),l.Pop(),p&&c.GetLocalVarStack().Pop(),null!==o&&c.PopSol(o),a&&c.PopSol(e),c._DecTriggerDepth(),_||c.ClearNestedAsyncActionPromises(),r}*DebugRunAsFunctionCall(e,t,s,i){let r,n,a=((this.IsDebugBreakpoint()||this._runtime.DebugBreakNext())&&(yield this),0<e.length),o=null,h=this._runtime,l=this._eventStack,c=h.GetEventSheetManager(),u=this._scopeParent,_=u.IsAsync(),d=c._IncTriggerDepth(),p=1<d;if(this._EvaluateFunctionCallParameters(c,t,p),a&&(s?c.PushCopySol(e):c.PushCleanSol(e)),null!==i){if(i.copyFromObjectClass){const m=s?i.copyFromObjectClass.GetCurrentSol():i.copyFromObjectClass.GetSolStack().GetOneBelowCurrentSol(),g=i.copyToObjectClass.GetCurrentSol();g.SetArrayPicked(m.GetInstances()),g.ClearElseInstances(),s||i.copyToObjectClass.ApplySolToContainer()}else if(i.pickObjectClass){const S=i.pickObjectClass.GetCurrentSol();S.SetArrayPicked(i.pickInstances),S.ClearElseInstances()}i.pushCleanSolDynamic&&(o=c.PushCleanSolDynamic(e))}const f=l.Push(this);return s&&f.SetDynamicSolModifiers(e),(yield*this._DebugCheckParentsOKToRun(f))&&(f.SetCurrentEvent(this),_&&([n,r]=u.StartAsyncFunctionCall()),yield*this._DebugRunAndBlock(f),_)&&u.MaybeFinishAsyncFunctionCall(n),l.Pop(),p&&c.GetLocalVarStack().Pop(),null!==o&&c.PopSol(o),a&&c.PopSol(e),c._DecTriggerDepth(),_||c.ClearNestedAsyncActionPromises(),r}RunAsMappedFunctionCall(e,t){const s=this.GetSolModifiersIncludingParents(),i=0<s.length,r=this._runtime,n=this._eventStack,a=r.GetEventSheetManager(),o=a._IncTriggerDepth(),h=1<o,l=(h&&a.GetLocalVarStack().Push(),this._scopeParent.SetFunctionParameters(e),i&&(t?a.PushCopySol(s):a.PushCleanSol(s)),n.Push(this));this._CheckParentsOKToRun(l)&&(l.SetCurrentEvent(this),this._RunAndBlock(l)),n.Pop(),h&&a.GetLocalVarStack().Pop(),i&&a.PopSol(s),a._DecTriggerDepth(),a.ClearNestedAsyncActionPromises()}*DebugRunAsMappedFunctionCall(e,t){(this.IsDebugBreakpoint()||this._runtime.DebugBreakNext())&&(yield this);const s=this.GetSolModifiersIncludingParents(),i=0<s.length,r=this._runtime,n=this._eventStack,a=r.GetEventSheetManager(),o=a._IncTriggerDepth(),h=1<o,l=(h&&a.GetLocalVarStack().Push(),this._scopeParent.SetFunctionParameters(e),i&&(t?a.PushCopySol(s):a.PushCleanSol(s)),n.Push(this));(yield*this._DebugCheckParentsOKToRun(l))&&(l.SetCurrentEvent(this),yield*this._DebugRunAndBlock(l)),n.Pop(),h&&a.GetLocalVarStack().Pop(),i&&a.PopSol(s),a._DecTriggerDepth(),a.ClearNestedAsyncActionPromises()}RunAsExpressionFunctionCall(e,t,s,i,...r){let n,a,o=0<e.length,h=this._runtime,l=this._eventStack,c=h.GetEventSheetManager(),u=this._scopeParent,_=u.IsAsync(),d=c._IncTriggerDepth(),p=1<d,f=(p&&c.GetLocalVarStack().Push(),0<r.length&&this._scopeParent.SetFunctionParameters(r),o&&(t?c.PushCopySol(e):c.PushCleanSol(e)),l.Push(this));return f.InitCallFunctionExpression(s,i),l.PushExpFunc(f),h.SetDebuggingEnabled(!1),this._CheckParentsOKToRun(f)&&(f.SetCurrentEvent(this),_&&([a,n]=u.StartAsyncFunctionCall()),this._RunAndBlock(f),_)&&u.MaybeFinishAsyncFunctionCall(a),h.SetDebuggingEnabled(!0),l.Pop(),l.PopExpFunc(),p&&c.GetLocalVarStack().Pop(),o&&c.PopSol(e),c._DecTriggerDepth(),_||c.ClearNestedAsyncActionPromises(),n||f.GetFunctionReturnValue()}}}{let i=self.C3,e=[],t=!1;i.EventScript=class extends i.DefendedBase{constructor(e,t,s){super();const i=e.GetRuntime(),r=e.GetEventSheetManager(),n=(this._eventSheet=e,this._eventSheetManager=r,this._runtime=e.GetRuntime(),this._parent=t,i.GetObjectReference(s[1]));this._func=n,this._displayNumber=s[2],this._eventSheet._RegisterEventByDisplayNumber(this,this._displayNumber),this._debugData=i.IsDebug()?{isBreakpoint:s[3][0],isBreakable:s[3][1]}:null}static Create(e,t,s){return i.New(i.EventScript,e,t,s)}_PostInit(){const e=this._func,t=this._runtime.GetEventSheetManager()._GetLocalVariablesScriptInterface(this);this._func=e.bind(null,this._runtime.GetIRuntime(),t)}GetParent(){return this._parent}GetScopeParent(){return this._parent}GetEventSheet(){return this._eventSheet}GetDisplayNumber(){return this._displayNumber}IsDebugBreakable(){return this._debugData&&this._debugData.isBreakable}IsDebugBreakpoint(){return this.IsDebugBreakable()&&this._debugData.isBreakpoint}_SetDebugBreakpoint(e){this._debugData.isBreakpoint=!!e}IsElseBlock(){return!1}GetSolModifiers(){return e}GetSolModifiersIncludingParents(){return this._parent?this._parent.GetSolModifiersIncludingParents():e}Run(e){e.SetCurrentEvent(this),this._eventSheetManager.AddAsyncActionPromise(this._RunUserScript())}async _RunUserScript(){try{await this._func()}catch(e){console.error(`Unhandled exception running script %c${this.GetEventSheet().GetName()}, event ${this.GetDisplayNumber()}:`,\"font-size: 1.2em; font-weight: bold;\",e),self.C3Debugger&&self.C3Debugger._SetLastErrorScript(this),t||(console.info(\"%cTip:%c run this to highlight in Construct the last script that had an error: %cgoToLastErrorScript()\",\"font-weight: bold; text-decoration: underline\",\"\",\"font-weight: bold\"),t=!0)}}*DebugRun(e){e.SetCurrentEvent(this),(this.IsDebugBreakpoint()||this._runtime.DebugBreakNext())&&(yield this),this.Run(e)}DebugCanRunFast(){return!this.IsDebugBreakpoint()&&!this._runtime.DebugBreakNext()}static HadUserScriptException(){return t}static SetHadUserScriptException(){t=!0}}}{const po=self.C3;po.FunctionBlock=class extends po.DefendedBase{constructor(e,t,s){super(),this._eventSheet=e,this._runtime=e.GetRuntime(),this._parent=t,this._functionType=0,this._functionName=\"\",this._returnType=0,this._functionParameters=[],this._isEnabled=!0,this._aceName=\"\",this._objectClass=null,this._hasOverrides=!1,this._innerLocalVariables=[],this._isCopyPicked=!1,this._isAsync=!1,this._nextAsyncId=0,this._currentAsyncId=-1,this._asyncMap=new Map,this._eventBlock=po.EventBlock.Create(e,t,s),this._eventBlock._SetScopeParent(this)}InitFunctionBlock(e){this._functionType=0,this._functionName=e[0],this._returnType=e[1],this._functionParameters=e[2].map(e=>po.EventVariable.Create(this._eventSheet,this,e)),this._isEnabled=e[3],this._isAsync=e[4],this._isCopyPicked=e[5]}InitCustomACEBlock(e){this._functionType=1,this._aceName=e[1],this._objectClass=this._runtime.GetObjectClassByIndex(e[2]),this._eventBlock._AddSolModifier(this._objectClass),this._functionName=this._objectClass.GetName()+\".\"+this._aceName,this._returnType=e[3],this._functionParameters=e[4].map(e=>po.EventVariable.Create(this._eventSheet,this,e)),this._isEnabled=e[5],this._isAsync=e[6],this._isCopyPicked=e[7],this._objectClass.AddCustomAction(this)}static CreateFunctionBlock(e,t,s){const i=po.New(po.FunctionBlock,e,t,s),r=s[1];return i.InitFunctionBlock(r),i}static CreateCustomACEBlock(e,t,s){const i=po.New(po.FunctionBlock,e,t,s),r=s[1];return i.InitCustomACEBlock(r),i}_CheckOverrideState(){if(this._objectClass&&this._objectClass.IsFamily())for(const e of this._objectClass.GetFamilyMembers())if(e.HasOwnCustomActionByName(this._aceName)){this._hasOverrides=!0;break}}_PostInit(){for(const e of this._functionParameters)e._PostInit();this._eventBlock._PostInit(!1)}GetFunctionType(){return this._functionType}_GetAllLocalVariablesInScope(){return this._functionParameters}GetFunctionParameters(){return this._functionParameters}GetFunctionParameterCount(){return this._functionParameters.length}_RegisterLocalVariable(e){this._innerLocalVariables.push(e)}_GetAllInnerLocalVariables(){return this._innerLocalVariables}EvaluateFunctionParameters(s){const i=this._functionParameters;for(let e=0,t=i.length;e<t;++e)i[e].SetValue(s[e].Get(0))}SetFunctionParameters(s){const i=this._functionParameters;for(let e=0,t=i.length;e<t;++e)i[e].SetValue(s[e])}CaptureFunctionParameters(){return this._functionParameters.map(e=>e.GetValue())}GetParent(){return this._parent}GetScopeParent(){return this._parent}GetFunctionName(){return this._functionName}GetACEName(){return this._aceName}HasCustomACEOverrides(){return this._hasOverrides}GetReturnType(){return this._returnType}GetObjectClass(){return this._objectClass}IsEnabled(){return this._isEnabled}GetDefaultReturnValue(){switch(this._returnType){case 0:return null;case 2:return\"\";default:return 0}}GetEventBlock(){return this._eventBlock}IsCopyPicked(){return this._isCopyPicked}IsAsync(){return this._isAsync}StartAsyncFunctionCall(){const e=this._nextAsyncId++;this._currentAsyncId=e;let t,s=new Promise(e=>t=e);return this._asyncMap.set(e,{resolve:t,pauseCount:0}),[e,s]}MaybeFinishAsyncFunctionCall(e){const t=this._asyncMap.get(e);0===t.pauseCount&&(t.resolve(),this._asyncMap.delete(e)),this._currentAsyncId=-1}PauseCurrentAsyncFunction(){const e=this._asyncMap.get(this._currentAsyncId);return e.pauseCount++,this._currentAsyncId}ResumeAsyncFunction(e){this._currentAsyncId=e;const t=this._asyncMap.get(e);t.pauseCount--}RunAsFamilyCustomActionWithOverrides(e,t){const s=new Map,i=[];for(const r of this._objectClass.GetCurrentSol().GetInstances()){const n=r.GetObjectClass();if(n.HasOwnCustomActionByName(this._aceName)){const a=s.get(n);Array.isArray(a)?a.push(r):s.set(n,[r])}else i.push(r)}if(0<i.length&&this._eventBlock.RunAsFunctionCall(e,t,this._isCopyPicked,{pickObjectClass:this._objectClass,pickInstances:i}),0<s.size)for(const[o,h]of s){const l=o.GetOwnCustomActionByName(this._aceName).GetEventBlock(),c=[...new Set([...e,...l.GetSolModifiers()])];l.RunAsFunctionCall(c,t,this._isCopyPicked,{pickObjectClass:o,pickInstances:h})}}*DebugRunAsFamilyCustomActionWithOverrides(e,t){const s=new Map,i=[];for(const r of this._objectClass.GetCurrentSol().GetInstances()){const n=r.GetObjectClass();if(n.HasOwnCustomActionByName(this._aceName)){const a=s.get(n);Array.isArray(a)?a.push(r):s.set(n,[r])}else i.push(r)}if(0<i.length&&(yield*this._eventBlock.DebugRunAsFunctionCall(e,t,this._isCopyPicked,{pickObjectClass:this._objectClass,pickInstances:i})),0<s.size)for(const[o,h]of s){const l=o.GetOwnCustomActionByName(this._aceName).GetEventBlock(),c=[...new Set([...e,...l.GetSolModifiers()])];yield*l.DebugRunAsFunctionCall(c,t,this._isCopyPicked,{pickObjectClass:o,pickInstances:h})}}}}{const fo=self.C3,mo=[];fo.EventVariable=class extends fo.DefendedBase{constructor(e,t,s){super();const i=e.GetEventSheetManager();this._eventSheet=e,this._eventSheetManager=i,this._runtime=e.GetRuntime(),this._parent=t,this._localVarStack=i.GetLocalVarStack(),this._name=s[1],this._type=s[2],this._initialValue=s[3],this._isStatic=!!s[4],this._isConstant=!!s[5],this._isFunctionParameter=t instanceof fo.FunctionBlock,this._sid=s[6],this._jsPropName=this._runtime.GetJsPropName(s[8]),this._scriptSetter=e=>this.SetValue(e),this._scriptGetter=()=>this.GetValue(),this._hasSingleValue=!this._parent||this._isStatic||this._isConstant,this._value=this._initialValue,this._localIndex=-1,this.IsBoolean()&&(this._value=this._value?1:0),!this.IsLocal()||this.IsStatic()||this.IsConstant()||(this._localIndex=i._GetNextLocalVarIndex(this)),i._RegisterEventVariable(this)}static Create(e,t,s){return fo.New(fo.EventVariable,e,t,s)}_PostInit(){if(this.IsLocal()&&!this.IsStatic()&&!this.IsConstant()&&!this.IsFunctionParameter()){const e=this._eventSheetManager.FindFirstFunctionBlockParent(this);e&&e._RegisterLocalVariable(this)}}GetName(){return this._name}GetJsPropName(){return this._jsPropName}GetParent(){return this._parent}GetScopeParent(){return this.GetParent()}IsGlobal(){return!this.GetParent()}IsLocal(){return!this.IsGlobal()}IsFunctionParameter(){return this._isFunctionParameter}IsStatic(){return this._isStatic}IsConstant(){return this._isConstant}IsNumber(){return 0===this._type}IsString(){return 1===this._type}IsBoolean(){return 2===this._type}IsElseBlock(){return!1}GetSID(){return this._sid}GetInitialValue(){return this._initialValue}GetSolModifiers(){return mo}Run(e){!this.IsLocal()||this.IsStatic()||this.IsConstant()||this.SetValue(this.GetInitialValue())}DebugCanRunFast(){return!0}*DebugRun(e){this.Run(e)}SetValue(e){this.IsNumber()?\"number\"!=typeof e&&(e=parseFloat(e)):this.IsString()?\"string\"!=typeof e&&(e=e.toString()):this.IsBoolean()&&(e=e?1:0),this._hasSingleValue?this._value=e:this._localVarStack.GetCurrent()[this._localIndex]=e}GetValue(){return this._hasSingleValue?this._value:this._localVarStack.GetCurrent()[this._localIndex]}GetTypedValue(){let e=this.GetValue();return this.IsBoolean()?!!e:e}ResetToInitialValue(){this._value=this._initialValue}_GetScriptInterfaceDescriptor(){return{configurable:!1,enumerable:!0,get:this._scriptGetter,set:this._scriptSetter}}}}{const go=self.C3,So=[];go.EventInclude=class extends go.DefendedBase{constructor(e,t,s){super();const i=e.GetEventSheetManager();this._eventSheet=e,this._eventSheetManager=i,this._runtime=e.GetRuntime(),this._parent=t,this._includeSheet=null,this._includeSheetName=s[1],this._isActive=!0}static Create(e,t,s){return go.New(go.EventInclude,e,t,s)}_PostInit(){this._includeSheet=this._eventSheetManager.GetEventSheetByName(this._includeSheetName),this._eventSheet._AddShallowInclude(this);let e=this.GetParent();for(;e;)e instanceof go.EventBlock&&e.IsGroup()&&e._AddContainedInclude(this),e=e.GetParent();this.UpdateActive(),this._runtime.IsDebug()&&this._eventSheet._GetPerfRecord().children.push(this._includeSheet._GetPerfRecord())}GetParent(){return this._parent}GetSolModifiers(){return So}GetIncludeSheet(){return this._includeSheet}Run(e){const t=!!this.GetParent(),s=this._runtime.GetAllObjectClasses();t&&this._eventSheetManager.PushCleanSol(s),this._includeSheet.Run(),t&&this._eventSheetManager.PopSol(s)}*DebugRun(e){const t=!!this.GetParent(),s=this._runtime.GetAllObjectClasses();t&&this._eventSheetManager.PushCleanSol(s),yield*this._includeSheet.DebugRun(),t&&this._eventSheetManager.PopSol(s)}DebugCanRunFast(){return!1}IsActive(){return this._isActive}UpdateActive(){let e=this.GetParent();for(;e;){if(e instanceof go.EventBlock&&e.IsGroup()&&!e.IsGroupActive())return void(this._isActive=!1);e=e.GetParent()}this._isActive=!0}}}{let h=function(e,t){return t<=e?e%t:(e<0&&(e<=-t&&(e%=t),e<0)&&(e+=t),e)};h;const yo=self.C3;yo.ExpNode=class extends yo.DefendedBase{constructor(e){super(),this._owner=e,this._runtime=e.GetRuntime()}_PostInit(){}static CreateNode(e,t){const s=t[0],i=[bo,To,Co,wo,Go,Io];return yo.New(i[s],e,t)}};class Go extends yo.ExpNode{constructor(e,t){super(e),this._systemPlugin=this._runtime.GetSystemPlugin(),this._func=this._runtime.GetObjectReference(t[1]),this._func!==yo.Plugins.System.Exps.random&&this._func!==yo.Plugins.System.Exps.choose||this._owner.SetVariesPerInstance()}GetBoundMethod(){return this._systemPlugin._GetBoundACEMethod(this._func,this._systemPlugin)}}class Io extends yo.ExpNode{constructor(e,t){super(e),this._functionBlock=null,this._functionName=t[1],this._owner.SetVariesPerInstance()}_PostInit(){const e=this._runtime.GetEventSheetManager(),t=(this._functionBlock=e.GetFunctionBlockByName(this._functionName),this._functionName=null,this._owner.GetEventBlock()),s=this._functionBlock.GetEventBlock();this._combinedSolModifiers=[...new Set([...t.GetSolModifiersIncludingParents(),...s.GetSolModifiersIncludingParents()])],this._combinedSolModifiers=e._DeduplicateSolModifierList(this._combinedSolModifiers)}GetBoundMethod(){const e=this._functionBlock;if(e.IsEnabled()){const t=e.GetEventBlock();return yo.EventBlock.prototype.RunAsExpressionFunctionCall.bind(t,this._combinedSolModifiers,e.IsCopyPicked(),e.GetReturnType(),e.GetDefaultReturnValue())}{const s=e.GetDefaultReturnValue();return()=>s}}}class To extends yo.ExpNode{constructor(e,t){super(e),this._objectClass=this._runtime.GetObjectClassByIndex(t[1]),this._func=this._runtime.GetObjectReference(t[2]),this._returnsString=!!t[3],this._eventStack=this._runtime.GetEventSheetManager().GetEventStack(),this._owner._MaybeVaryFor(this._objectClass)}GetBoundMethod(){return this._objectClass.GetPlugin()._GetBoundACEMethod(this._func,this._objectClass.GetSingleGlobalInstance().GetSdkInstance())}ExpObject(...e){const t=this._objectClass,s=t.GetCurrentSol().GetExpressionInstances(),i=s.length;if(0===i)return this._returnsString?\"\":0;const r=h(this._owner.GetSolIndex(),i);return this._eventStack.GetCurrentStackFrame().SetExpressionObjectClass(t),this._func.apply(s[r].GetSdkInstance(),e)}ExpObject_InstExpr(e,...t){const s=this._objectClass,i=s.GetInstances(),r=i.length;if(0===r)return this._returnsString?\"\":0;const n=h(e,r);return this._eventStack.GetCurrentStackFrame().SetExpressionObjectClass(s),this._func.apply(i[n].GetSdkInstance(),t)}}class Co extends yo.ExpNode{constructor(e,t){super(e),this._objectClass=this._runtime.GetObjectClassByIndex(t[1]),this._varIndex=t[3],this._returnsString=!!t[2],this._owner._MaybeVaryFor(this._objectClass)}ExpInstVar(){const e=this._objectClass.GetCurrentSol().GetExpressionInstances(),t=e.length;if(0===t)return this._returnsString?\"\":0;const s=h(this._owner.GetSolIndex(),t);return e[s]._GetInstanceVariableValueUnchecked(this._varIndex)}ExpInstVar_Family(){const e=this._objectClass,t=e.GetCurrentSol().GetExpressionInstances(),s=t.length;if(0===s)return this._returnsString?\"\":0;const i=h(this._owner.GetSolIndex(),s),r=t[i],n=r.GetObjectClass().GetFamilyInstanceVariableOffset(e.GetFamilyIndex());return r._GetInstanceVariableValueUnchecked(this._varIndex+n)}ExpInstVar_InstExpr(e){const t=this._objectClass,s=t.GetInstances(),i=s.length;if(0===i)return this._returnsString?\"\":0;let r=h(e,i),n=s[r],a=0;return t.IsFamily()&&(a=n.GetObjectClass().GetFamilyInstanceVariableOffset(t.GetFamilyIndex())),n._GetInstanceVariableValueUnchecked(this._varIndex+a)}}class bo extends yo.ExpNode{constructor(e,t){super(e),this._objectClass=this._runtime.GetObjectClassByIndex(t[1]),this._behaviorType=this._objectClass.GetBehaviorTypeByName(t[2]),this._behaviorIndex=this._objectClass.GetBehaviorIndexByName(t[2]),this._func=this._runtime.GetObjectReference(t[3]),this._returnsString=!!t[4],this._eventStack=this._runtime.GetEventSheetManager().GetEventStack(),this._owner._MaybeVaryFor(this._objectClass)}ExpBehavior(...e){const t=this._objectClass,s=t.GetCurrentSol().GetExpressionInstances(),i=s.length;if(0===i)return this._returnsString?\"\":0;let r=h(this._owner.GetSolIndex(),i),n=(this._eventStack.GetCurrentStackFrame().SetExpressionObjectClass(t),s[r]),a=0;return t.IsFamily()&&(a=n.GetObjectClass().GetFamilyBehaviorOffset(t.GetFamilyIndex())),this._func.apply(n.GetBehaviorInstances()[this._behaviorIndex+a].GetSdkInstance(),e)}ExpBehavior_InstExpr(e,...t){const s=this._objectClass,i=s.GetInstances(),r=i.length;if(0===r)return this._returnsString?\"\":0;let n=h(e,r),a=(this._eventStack.GetCurrentStackFrame().SetExpressionObjectClass(s),i[n]),o=0;return s.IsFamily()&&(o=a.GetObjectClass().GetFamilyBehaviorOffset(s.GetFamilyIndex())),this._func.apply(a.GetBehaviorInstances()[this._behaviorIndex+o].GetSdkInstance(),t)}}class wo extends yo.ExpNode{constructor(e,t){super(e),this._eventVar=null,this._eventVarSid=t[1]}_PostInit(){this._eventVar=this._runtime.GetEventSheetManager().GetEventVariableBySID(this._eventVarSid)}GetVar(){return this._eventVar}}}{let n=function(e){const t=self.C3_ExpressionFuncs[e];if(t)return t;throw new Error(\"invalid expression number\")};n;const xo=self.C3;xo.Parameter=class extends xo.DefendedBase{constructor(e,t,s){super(),this._owner=e,this._index=s,this._type=t,this.Get=null,this._variesPerInstance=!1,this._isConstant=!1}static Create(e,t,s){const i=t[0],r=[vo,Po,Bo,Ao,Do,Ro,Eo,vo,Ao,Ao,Oo,Lo,Bo,No,Po,Fo,Mo,ko,Wo,Vo,Uo,jo];return xo.New(r[i],e,i,s,t)}_PostInit(){}SetVariesPerInstance(){this._variesPerInstance=!0}_MaybeVaryFor(e){this._variesPerInstance||!e||e.GetPlugin().IsSingleGlobal()||(this._variesPerInstance=!0)}VariesPerInstance(){return this._variesPerInstance}GetIndex(){return this._index}GetRuntime(){return this._owner.GetRuntime()}GetEventBlock(){return this._owner.GetEventBlock()}IsConstant(){return this._isConstant}IsObjectParameter(){return 4===this._type}};class vo extends xo.Parameter{constructor(e,t,s,i){super(e,t,s),this._solIndex=0;const r=i[1];this._expressionNumber=r[0],this._numberedNodes=[],this._expressionFunc=null;for(let e=1,t=r.length;e<t;++e)this._numberedNodes.push(xo.ExpNode.CreateNode(this,r[e]));this._numberedNodes.length?this.Get=this.GetExpression:(this.Get=n(this._expressionNumber),this._isConstant=!0)}_GetNode(e){if(e<0||e>=this._numberedNodes.length)throw new RangeError(\"invalid numbered node\");return this._numberedNodes[e]}_PostInit(){for(const t of this._numberedNodes)t._PostInit();const e=n(this._expressionNumber);this._numberedNodes.length?this._expressionFunc=e(this):this._expressionFunc=e}GetSolIndex(){return this._solIndex}GetExpression(e){return this._solIndex=e,this._expressionFunc()}}class Po extends vo{constructor(e,t,s,i){super(e,t,s,i),this.Get=this.GetStringExpression,14===t&&(this.GetEventBlock().SetAllSolModifiers(),this._owner instanceof xo.Action)&&this.GetEventBlock().SetSolWriterAfterCnds()}GetStringExpression(e){this._solIndex=e;const t=this._expressionFunc();return\"string\"==typeof t?t:\"\"}_GetFastTriggerValue(){return n(this._expressionNumber)()}}class Ro extends vo{constructor(e,t,s,i){super(e,t,s,i),2<=e.GetImplementationSdkVersion()?this.Get=this.GetILayer:this.Get=this.GetLayer,this._isConstant=!1}GetLayer(e){this._solIndex=e;const t=this._expressionFunc(),s=this.GetRuntime().GetCurrentLayout();return s.GetLayer(t)}GetILayer(e){const t=this.GetLayer(e);return t?t.GetILayer():null}}class Ao extends xo.Parameter{constructor(e,t,s,i){super(e,t,s),this._combo=i[1],this.Get=this.GetCombo,this._isConstant=!0}GetCombo(){return this._combo}}class Mo extends xo.Parameter{constructor(e,t,s,i){super(e,t,s),this._bool=i[1],this.Get=this.GetBoolean,this._isConstant=!0}GetBoolean(){return this._bool}}class Do extends xo.Parameter{constructor(e,t,s,i){super(e,t,s),this._objectClass=this.GetRuntime().GetObjectClassByIndex(i[1]),2<=e.GetImplementationSdkVersion()?this.Get=this.GetIObjectClass:this.Get=this.GetObjectClass;const r=this.GetEventBlock();r._AddSolModifier(this._objectClass),this._owner instanceof xo.Action?r.SetSolWriterAfterCnds():r.GetParent()&&r.GetParent().SetSolWriterAfterCnds(),this._isConstant=!0}GetObjectClass(){return this._objectClass}GetIObjectClass(){return this._objectClass?this._objectClass.GetIObjectClass():null}}class Eo extends xo.Parameter{constructor(e,t,s,i){super(e,t,s),this._layout=this.GetRuntime().GetLayoutManager().GetLayoutByName(i[1]),2<=e.GetImplementationSdkVersion()?this.Get=this.GetILayout:this.Get=this.GetLayout,this._isConstant=!0}GetLayout(){return this._layout}GetILayout(){return this._layout?this._layout.GetILayout():null}}class Fo extends xo.Parameter{constructor(e,t,s,i){super(e,t,s),this._timeline=this.GetRuntime().GetTimelineManager().GetTimelineByName(i[1]),2<=e.GetImplementationSdkVersion()?this.Get=this.GetITimelineState:this.Get=this.GetTimeline,this._isConstant=!0}GetTimeline(){return this._timeline}GetITimelineState(){return this._timeline?this._timeline.GetITimelineState():null}}class Bo extends xo.Parameter{constructor(e,t,s,i){super(e,t,s),this._fileInfo=i[1],this.Get=this.GetFile,this._isConstant=!0}GetFile(){return this._fileInfo}}class Oo extends xo.Parameter{constructor(e,t,s,i){super(e,t,s),this._instVarIndex=i[1];const r=this._owner.GetObjectClass();this._owner instanceof xo.Condition&&this._owner.IsStatic()||!r||!r.IsFamily()?(this.Get=this.GetInstanceVariable,this._isConstant=!0):(this.Get=this.GetFamilyInstanceVariable,this.SetVariesPerInstance())}GetInstanceVariable(){return this._instVarIndex}GetFamilyInstanceVariable(e){e=e||0;let t=this._owner.GetObjectClass(),s=t.GetCurrentSol(),i=s.GetInstances(),r=null;if(i.length)r=i[e%i.length].GetObjectClass();else if(s.HasAnyElseInstances()){const n=s.GetElseInstances();r=n[e%n.length].GetObjectClass()}else{if(!(0<t.GetInstanceCount()))return 0;{const a=t.GetInstances();r=a[e%a.length].GetObjectClass()}}return this._instVarIndex+r.GetFamilyInstanceVariableOffset(t.GetFamilyIndex())}}class Lo extends xo.Parameter{constructor(e,t,s,i){super(e,t,s),this._eventVarSid=i[1],this._eventVar=null,2<=e.GetImplementationSdkVersion()?this.Get=this.GetIEventVariable:this.Get=this.GetEventVariable,this._isConstant=!0}_PostInit(){this._eventVar=this.GetRuntime().GetEventSheetManager().GetEventVariableBySID(this._eventVarSid)}GetEventVariable(){return this._eventVar}GetIEventVariable(){return null}}class ko extends xo.Parameter{constructor(e,t,s,i){super(e,t,s),this._functionBlockName=i[1],this._functionBlock=null,2<=e.GetImplementationSdkVersion()?this.Get=this.GetIFunction:this.Get=this.GetFunction,this._isConstant=!0}_PostInit(){this._functionBlock=this.GetRuntime().GetEventSheetManager().GetFunctionBlockByName(this._functionBlockName),this._functionBlockName=null}GetFunction(){return this._functionBlock}GetIFunction(){return null}}class No extends xo.Parameter{constructor(e,t,s,i){super(e,t,s),this._subParams=[],this._variadicRet=[],this._isConstant=!0;for(let e=1,t=i.length;e<t;++e){const r=xo.Parameter.Create(this._owner,i[e],0);this._subParams.push(r),this._variadicRet.push(0),r.IsConstant()||(this._isConstant=!1)}this.Get=this.GetVariadic}_PostInit(){for(const e of this._subParams)e._PostInit()}GetVariadic(){const s=this._subParams,i=this._variadicRet;for(let e=0,t=s.length;e<t;++e)i[e]=s[e].Get(0);return i}}class Wo extends xo.Parameter{constructor(e,t,s,i){super(e,t,s),this._easeIndex=i[1],this.Get=this.GetEase,this._isConstant=!0}GetEase(){return this._easeIndex}}class Vo extends xo.Parameter{constructor(e,t,s,i){super(e,t,s),this._brushIndex=i[1],this.Get=this.GetTilemapBrush,this._isConstant=!0}GetTilemapBrush(){return this._brushIndex}}class Uo extends vo{constructor(e,t,s,i){super(e,t,s,i),this.Get=this.GetTemplateName,this._isConstant=!1}GetTemplateName(){return this._expressionFunc()}}class jo extends xo.Parameter{constructor(e,t,s,i){super(e,t,s),this._flowchartDataItem=this.GetRuntime().GetFlowchartManager().GetFlowchartDataItemByName(i[1]),this.Get=this.GetFlowchartName,this._isConstant=!0}GetFlowchartName(){return this._flowchartDataItem.GetName()}}}{let i=function(s,i){for(let e=0,t=s.length;e<t;++e)i[e]=s[e].Get(0)};i;const Ho=self.C3,Xo=[],zo=function(){};Ho.Condition=class extends Ho.DefendedBase{constructor(e,s,t){if(super(),this._eventBlock=e,this._runtime=e.GetRuntime(),this._index=t,this._func=this._runtime.GetObjectReference(s[1]),this._isTrigger=0<s[3],this._isFastTrigger=2===s[3],this._isLooping=!!s[4],this._isInverted=!!s[5],this._isStatic=!!s[6],this._sid=s[7],this._isInOrBlock=this._eventBlock.IsOrBlock(),this._objectClass=null,this._behaviorType=null,this._behaviorIndex=-1,this._systemPlugin=null,this.Run=zo,this.DebugRun=zo,this._parameters=[],this._results=[],this._anyParamVariesPerInstance=!1,this._savedData=null,this._unsavedData=null,this._debugData=this._runtime.IsDebug()?{isBreakpoint:s[8][0],canDebug:s[8][1]}:null,-1===s[0]?this._systemPlugin=this._runtime.GetSystemPlugin():(this._objectClass=this._runtime.GetObjectClassByIndex(s[0]),s[2]&&(this._behaviorType=this._objectClass.GetBehaviorTypeByName(s[2]),this._behaviorIndex=this._objectClass.GetBehaviorIndexByName(s[2])),this._eventBlock.GetParent()&&this._eventBlock.GetParent().SetSolWriterAfterCnds()),10===s.length){let t=s[9];for(let e of t)this._parameters.push(Ho.Parameter.Create(this,e,this._parameters.length)),this._results.push(0)}0===this._parameters.length&&(this._parameters=Xo,this._results=Xo),this._eventBlock.GetEventSheetManager()._RegisterCondition(this)}static Create(e,t,s){return Ho.New(Ho.Condition,e,t,s)}_PostInit(){for(const e of this._parameters)e._PostInit(),e.VariesPerInstance()&&(this._anyParamVariesPerInstance=!0);this._isFastTrigger?(this.Run=this._RunFastTrigger,this.DebugRun=this._DebugRunFastTrigger):this._systemPlugin?(this._SetSystemRunMethod(),this.DebugRun=this._DebugRunSystem):this._objectClass.GetPlugin().IsSingleGlobal()?(this._SetSingleGlobalRunMethod(),this.DebugRun=this._DebugRunSingleGlobal):this._isStatic?(this.Run=this._RunStatic,this.DebugRun=this._DebugRunStatic):(this.Run=this._RunObject,this.DebugRun=this._DebugRunObject)}_SetSystemRunMethod(){const e=this._systemPlugin,t=this._systemPlugin;this._SetRunMethodForBoundFunc(e,t,this._RunSystem)}_SetSingleGlobalRunMethod(){const e=this._objectClass.GetPlugin(),t=this._objectClass.GetSingleGlobalInstance().GetSdkInstance();this._SetRunMethodForBoundFunc(e,t,this._RunSingleGlobal)}_SetRunMethodForBoundFunc(e,t,s){const i=this._func,r=this._isInverted,n=this._parameters;if(0===n.length){const a=e._GetBoundACEMethod(i,t);r?this.Run=function(){return Ho.xor(a(),r)}:this.Run=a}else if(1===n.length){const o=n[0];if(!r&&o.IsConstant())this.Run=e._GetBoundACEMethod_1param(i,t,o.Get(0));else{const h=e._GetBoundACEMethod(i,t);this.Run=function(){return Ho.xor(h(o.Get(0)),r)}}}else if(2===n.length){const l=n[0],c=n[1];if(!r&&l.IsConstant()&&c.IsConstant())this.Run=e._GetBoundACEMethod_2params(i,t,l.Get(0),c.Get(0));else{const u=e._GetBoundACEMethod(i,t);this.Run=function(){return Ho.xor(u(l.Get(0),c.Get(0)),r)}}}else if(3===n.length){const _=n[0],d=n[1],p=n[2];if(!r&&_.IsConstant()&&d.IsConstant()&&p.IsConstant())this.Run=e._GetBoundACEMethod_3params(i,t,_.Get(0),d.Get(0),p.Get(0));else{const f=e._GetBoundACEMethod(i,t);this.Run=function(){return Ho.xor(f(_.Get(0),d.Get(0),p.Get(0)),r)}}}else this.Run=s}GetSID(){return this._sid}_GetFunc(){return this._func}GetObjectClass(){return this._objectClass}GetBehaviorType(){return this._behaviorType}GetImplementationAddon(){return this._behaviorType?this._behaviorType.GetBehavior():this._objectClass?this._objectClass.GetPlugin():null}GetImplementationSdkVersion(){const e=this.GetImplementationAddon();return e?e.GetSdkVersion():1}GetEventBlock(){return this._eventBlock}GetRuntime(){return this._runtime}GetIndex(){return this._index}GetDebugIndex(){return this.GetIndex()}IsTrigger(){return this._isTrigger}IsFastTrigger(){return this._isFastTrigger}IsInverted(){return this._isInverted}IsLooping(){return this._isLooping}IsStatic(){return this._isStatic}IsBreakpoint(){return this._debugData.isBreakpoint}IsSystemCondition(){return!!this._systemPlugin}IsSystemOrSingleGlobalCondition(){return this.IsSystemCondition()||this._objectClass.GetPlugin().IsSingleGlobal()}GetFirstObjectParameterObjectClass(){for(const e of this._parameters)if(e.IsObjectParameter())return e.GetObjectClass();return null}_SetBreakpoint(e){this._debugData.isBreakpoint=!!e,this._eventBlock._UpdateCanRunFastRecursive()}_DebugReturnsGenerator(){return this._debugData.canDebug}DebugCanRunFast(){return!this.IsBreakpoint()&&!this._runtime.DebugBreakNext()&&!this._DebugReturnsGenerator()}GetSavedDataMap(){return this._savedData||(this._savedData=new Map),this._savedData}GetUnsavedDataMap(){return this._unsavedData||(this._unsavedData=new Map),this._unsavedData}_RunSystem(){const e=this._results;return i(this._parameters,e),Ho.xor(this._func.apply(this._systemPlugin,e),this._isInverted)}*_DebugRunSystem(){if((this.IsBreakpoint()||this._runtime.DebugBreakNext())&&(yield this),this._DebugReturnsGenerator()){const t=this._results;i(this._parameters,t);let e=this._func.apply(this._systemPlugin,t);return Ho.IsIterator(e)&&(e=yield*e),Ho.xor(e,this._isInverted)}return this.Run()}_RunSingleGlobal(){const e=this._results,t=(i(this._parameters,e),this._objectClass.GetSingleGlobalInstance().GetSdkInstance());return Ho.xor(this._func.apply(t,e),this._isInverted)}*_DebugRunSingleGlobal(){if((this.IsBreakpoint()||this._runtime.DebugBreakNext())&&(yield this),this._DebugReturnsGenerator()){let e=this._results,t=(i(this._parameters,e),this._objectClass.GetSingleGlobalInstance().GetSdkInstance()),s=this._func.apply(t,e);return Ho.IsIterator(s)&&(s=yield*s),Ho.xor(s,this._isInverted)}return this.Run()}_RunFastTrigger(){return!0}*_DebugRunFastTrigger(){return(this.IsBreakpoint()||this._runtime.DebugBreakNext())&&(yield this),!0}_GetStaticConditionThis(){if(this._behaviorType){if(2<=this._behaviorType.GetBehavior().GetSdkVersion())throw new Error(\"not yet implemented\");return this._behaviorType}return 2<=this._objectClass.GetPlugin().GetSdkVersion()?this._objectClass.GetIObjectClass():this._objectClass}_RunStatic(){const e=this._results,t=(i(this._parameters,e),this._func.apply(this._GetStaticConditionThis(),e));return this._objectClass.ApplySolToContainer(),t}*_DebugRunStatic(){if((this.IsBreakpoint()||this._runtime.DebugBreakNext())&&(yield this),this._DebugReturnsGenerator()){const t=this._results;i(this._parameters,t);let e=this._func.apply(this._GetStaticConditionThis(),t);return Ho.IsIterator(e)&&(e=yield*e),this._objectClass.ApplySolToContainer(),e}return this.Run()}_RunObject(){const s=this._parameters,i=this._results,e=this._objectClass.GetCurrentSol();for(let e=0,t=s.length;e<t;++e){const r=s[e];r.VariesPerInstance()||(i[e]=r.Get(0))}return e.IsSelectAll()?this._RunObject_FirstFilter(e):this._RunObject_NextFilter(e)}*_DebugRunObject(){return(this.IsBreakpoint()||this._runtime.DebugBreakNext())&&(yield this),this._RunObject()}_EvaluateVaryingParameters(s){const i=this._parameters,r=this._results;for(let e=0,t=i.length;e<t;++e){const n=i[e];n.VariesPerInstance()&&(r[e]=n.Get(s))}}_RunObject_FirstFilter(s){const e=this._objectClass,i=e.IsFamily(),r=e.GetFamilyIndex(),n=this._behaviorIndex,a=0<=n,o=e.GetInstances(),h=this._anyParamVariesPerInstance,l=this._results,c=this._func,u=this._isInverted,_=this._isInOrBlock&&!this._isTrigger;s.ClearArrays();for(let t=0,e=o.length;t<e;++t){const d=o[t];h&&this._EvaluateVaryingParameters(t);let e;if(a){const p=i?d.GetObjectClass().GetFamilyBehaviorOffset(r):0;e=c.apply(d.GetBehaviorInstances()[n+p].GetSdkInstance(),l)}else e=c.apply(d.GetSdkInstance(),l);Ho.xor(e,u)?s._PushInstance(d):_&&s._PushElseInstance(d)}return e.FinishCondition(!0),s._SetSelectAll(!1),e.ApplySolToContainer(),s.HasAnyInstances()}_RunObject_NextFilter(e){let t=this._objectClass,s=t.IsFamily(),i=t.GetFamilyIndex(),r=t.IsInContainer(),n=this._behaviorIndex,a=0<=n,o=this._anyParamVariesPerInstance,h=this._results,l=this._func,c=this._isInverted,u=this._isInOrBlock&&!this._isTrigger,_=e._GetOwnInstances(),d=e._GetOwnElseInstances(),p=u&&!this._eventBlock.IsFirstConditionOfType(this),f=p?d:_,m=0,g=!1;for(let t=0,e=f.length;t<e;++t){const y=f[t];o&&this._EvaluateVaryingParameters(t);let e;if(a){const G=s?y.GetObjectClass().GetFamilyBehaviorOffset(i):0;e=l.apply(y.GetBehaviorInstances()[n+G].GetSdkInstance(),h)}else e=l.apply(y.GetSdkInstance(),h);Ho.xor(e,c)?(g=!0,p?(_.push(y),r&&y._PushSiblingsToSolInstances()):(f[m]=y,r&&y._SetSiblingsToSolInstancesIndex(m),++m)):p?(f[m]=y,r&&y._SetSiblingsToSolElseInstancesIndex(m),++m):u&&(d.push(y),r)&&y._PushSiblingsToSolElseInstances()}Ho.truncateArray(f,m),r&&t._TruncateContainerSols(p,m);const S=g;return p&&!g&&(g=this._OrBlockCheckInstances(_)),t.FinishCondition(S||u),u?g:e.HasAnyInstances()}_OrBlockCheckInstances(s){const e=this._objectClass,i=e.IsFamily(),r=e.GetFamilyIndex(),n=this._anyParamVariesPerInstance,a=this._behaviorIndex,o=0<=a,h=this._results,l=this._func,c=this._isInverted;for(let t=0,e=s.length;t<e;++t){const u=s[t];n&&this._EvaluateVaryingParameters(t);let e;if(o){const _=i?u.GetObjectClass().GetFamilyBehaviorOffset(r):0;e=l.apply(u.GetBehaviorInstances()[a+_].GetSdkInstance(),h)}else e=l.apply(u.GetSdkInstance(),h);if(Ho.xor(e,c))return!0}return!1}ReevaluateParameter(e,t){return this._parameters[e].Get(t)}GetFastTriggerValue(){const e=this._parameters;if(e.length)return e[0]._GetFastTriggerValue();throw new Error(\"no parameters\")}_SaveToJson(){if(!this._savedData||!this._savedData.size)return null;const t={};for(const[s,i]of this._savedData.entries()){let e=i;\"collmemory\"===s&&(e=[...i.entries()].map(e=>[e[0].GetUID(),e[1].GetUID(),e[2]])),t[s]=e}return{ex:t}}_LoadFromJson(e){if(this._savedData&&(this._savedData.clear(),this._savedData=null),e){const t=this._runtime,s=e.ex;if(s){const i=this.GetSavedDataMap();i.clear();for(const[r,n]of Object.entries(s)){let e=n;\"collmemory\"===r&&(e=Ho.New(Ho.PairMap,n.map(e=>[t.GetInstanceByUID(e[0]),t.GetInstanceByUID(e[1]),e[2]]).filter(e=>e[0]&&e[1]))),i.set(r,e)}}}}}}{let r=function(s,i){for(let e=0,t=s.length;e<t;++e)i[e]=s[e].Get(0)};r;const Yo=self.C3,qo=[],Ko=function(){},Jo=function*(){};Yo.Action=class extends Yo.DefendedBase{constructor(e,t,s){super();const i=(this._eventBlock=e).GetRuntime(),r=(this._runtime=i,this._index=s,this._sid=4<=t.length?t[3]:-1,this._actionType=5<=t.length?255&t[4]:0,this._flags=5<=t.length?t[4]>>8:0,this._func=null,this._objectClass=null,this._behaviorType=null,this._behaviorIndex=-1,this._systemPlugin=null,this._callFunctionName=\"\",this._callCustomAceObjectClass=null,this._callEventBlock=null,this.Run=Ko,this.DebugRun=Ko,this._parameters=[],this._results=[],this._anyParamVariesPerInstance=!1,this._savedData=null,this._unsavedData=null,-3===t[0]),n=r?t[2]:t[5];if(this._debugData=i.IsDebug()||r?{isBreakpoint:n[0],canDebug:n[1],index:n[2]}:null,-1===t[0])this._systemPlugin=i.GetSystemPlugin(),this._func=i.GetObjectReference(t[1]);else if(-2===t[0])this._callFunctionName=t[1];else if(r){const a=i.GetObjectReference(t[1]);this._func=a,this.Run=this.RunUserScript,this.DebugRun=this.DebugRunUserScript,this._flags|=8}else this._objectClass=i.GetObjectClassByIndex(t[0]),4&this._flags?(this._callFunctionName=t[1],this._callCustomAceObjectClass=i.GetObjectClassByIndex(t[2])):(t[2]&&(this._behaviorType=this._objectClass.GetBehaviorTypeByName(t[2]),this._behaviorIndex=this._objectClass.GetBehaviorIndexByName(t[2])),this._func=i.GetObjectReference(t[1]));if(7===t.length){const o=t[6];for(const h of o)this._parameters.push(Yo.Parameter.Create(this,h,this._parameters.length)),this._results.push(0)}0===this._parameters.length&&(this._parameters=qo,this._results=qo),this.CanPickAnyObjectClass()&&(this._eventBlock.SetAllSolModifiers(),this._eventBlock.SetSolWriterAfterCnds()),this._eventBlock.GetEventSheetManager()._RegisterAction(this)}static Create(e,t,s){return Yo.New(Yo.Action,e,t,s)}_PostInit(){for(const e of this._parameters)e._PostInit(),e.VariesPerInstance()&&(this._anyParamVariesPerInstance=!0);if(this._systemPlugin)this._SetSystemRunMethod(),this.DebugRun=this._DebugRunSystem;else if(this._callFunctionName)4&this._flags?this._SetCallCustomActionRunMethod():this._SetCallFunctionRunMethod(),this._callFunctionName=\"\",this._callCustomAceObjectClass=null;else if(this.Run===this.RunUserScript){const t=this._func,s=this._runtime.GetEventSheetManager()._GetLocalVariablesScriptInterface(this._eventBlock);this._func=t.bind(null,this._runtime.GetIRuntime(),s)}else this._behaviorType?this.IsAsync()?(this.Run=this._RunBehavior_Async,this.DebugRun=this._DebugRunBehavior_Async):(this.Run=this._RunBehavior,this.DebugRun=this._DebugRunBehavior):this._objectClass.GetPlugin().IsSingleGlobal()?(this._SetSingleGlobalRunMethod(),this.DebugRun=this._DebugRunSingleGlobal):this.IsStatic()?(this.Run=this._RunObject_Static,this.DebugRun=this._DebugRunObject_Static):this.IsAsync()?(this.Run=this._RunObject_Async,this.DebugRun=this._DebugRunObject_Async):this.CallBeforeAfterHooks()?(this.Run=this._RunObject_BeforeAfterHooks,this.DebugRun=this._DebugRunObject_BeforeAfterHooks):this._parameters.length?this._parameters.every(e=>e.VariesPerInstance())?(this.Run=this._RunObject_AllParamsVary,this.DebugRun=this._DebugRunObject_AllParamsVary):this._anyParamVariesPerInstance?(this.Run=this._RunObject_SomeParamsVary,this.DebugRun=this._DebugRunObject_SomeParamsVary):this._parameters.every(e=>e.IsConstant())?(r(this._parameters,this._results),this.Run=this._RunObject_ParamsConst,this.DebugRun=this._DebugRunObject_ParamsConst):(this.Run=this._RunObject_ParamsDontVary,this.DebugRun=this._DebugRunObject_ParamsDontVary):(this.Run=this._RunObject_ParamsConst,this.DebugRun=this._DebugRunObject_ParamsConst)}_SetSystemRunMethod(){const e=this._systemPlugin,t=this._systemPlugin;this._SetRunMethodForBoundFunc(e,t,this._RunSystem)}_SetSingleGlobalRunMethod(){const e=this._objectClass.GetPlugin(),t=this._objectClass.GetSingleGlobalInstance().GetSdkInstance();this._SetRunMethodForBoundFunc(e,t,this._RunSingleGlobal)}_SetCallFunctionRunMethod(){const e=this._eventBlock.GetEventSheetManager(),s=e.GetFunctionBlockByName(this._callFunctionName);if(s.IsEnabled()){const i=0!=(2&this._flags);this._callEventBlock=s.GetEventBlock();let t=[...new Set([...this._eventBlock.GetSolModifiersIncludingParents(),...this._callEventBlock.GetSolModifiersIncludingParents()])];t=e._DeduplicateSolModifierList(t);const r=!s.IsCopyPicked()&&this._HasCopyPickedParent()?{pushCleanSolDynamic:!0}:null;if(this.Run=Yo.EventBlock.prototype.RunAsFunctionCall.bind(this._callEventBlock,t,this._parameters,i,r),this._runtime.IsDebug()){const n=this;this.DebugRun=function*(){(n.IsBreakpoint()||n._runtime.DebugBreakNext())&&(yield n);const e=yield*n._callEventBlock.DebugRunAsFunctionCall(t,n._parameters,i,r);return e}}else this.DebugRun=Jo}else this.Run=Ko,this.DebugRun=Jo}_SetCallCustomActionRunMethod(){const n=this._eventBlock.GetEventSheetManager(),a=n.GetCustomActionBlockByName(this._callCustomAceObjectClass,this._callFunctionName);if(a.IsEnabled()){const o=0!=(2&this._flags);this._callEventBlock=a.GetEventBlock();let t=[...new Set([...this._eventBlock.GetSolModifiersIncludingParents(),...this._callEventBlock.GetSolModifiersIncludingParents(),this._objectClass,a.GetObjectClass()])],e=(t=n._DeduplicateSolModifierList(t),!this._objectClass.IsFamily()&&!a.GetObjectClass().IsFamily()),s=!this._objectClass.IsFamily()&&a.GetObjectClass().IsFamily(),i=this._objectClass.IsFamily(),r=null;if(!a.IsCopyPicked()&&this._HasCopyPickedParent()&&((r=r||{}).pushCleanSolDynamic=!0),!s&&o||((r=r||{}).copyFromObjectClass=this._objectClass,r.copyToObjectClass=a.GetObjectClass()),e||s||i&&!a.HasCustomACEOverrides()?this.Run=Yo.EventBlock.prototype.RunAsFunctionCall.bind(this._callEventBlock,t,this._parameters,o,r):i&&(this.Run=Yo.FunctionBlock.prototype.RunAsFamilyCustomActionWithOverrides.bind(a,t,this._parameters)),this._runtime.IsDebug()){const h=this;e||s||i&&!a.HasCustomACEOverrides()?this.DebugRun=function*(){(h.IsBreakpoint()||h._runtime.DebugBreakNext())&&(yield h);const e=yield*h._callEventBlock.DebugRunAsFunctionCall(t,h._parameters,o,r);return e}:i&&(this.DebugRun=function*(){(h.IsBreakpoint()||h._runtime.DebugBreakNext())&&(yield h);const e=yield*a.DebugRunAsFamilyCustomActionWithOverrides(t,h._parameters);return e})}else this.DebugRun=Jo}else this.Run=Ko,this.DebugRun=Jo}_SetRunMethodForBoundFunc(e,t,s){const i=this._func,r=this._parameters;if(0===r.length)this.Run=e._GetBoundACEMethod(i,t);else if(1===r.length){const n=r[0];if(n.IsConstant())this.Run=e._GetBoundACEMethod_1param(i,t,n.Get(0));else{const a=e._GetBoundACEMethod(i,t);this.Run=function(){return a(n.Get(0))}}}else if(2===r.length){const o=r[0],h=r[1];if(o.IsConstant()&&h.IsConstant())this.Run=e._GetBoundACEMethod_2params(i,t,o.Get(0),h.Get(0));else{const l=e._GetBoundACEMethod(i,t);this.Run=function(){return l(o.Get(0),h.Get(0))}}}else if(3===r.length){const c=r[0],u=r[1],_=r[2];if(c.IsConstant()&&u.IsConstant()&&_.IsConstant())this.Run=e._GetBoundACEMethod_3params(i,t,c.Get(0),u.Get(0),_.Get(0));else{const d=e._GetBoundACEMethod(i,t);this.Run=function(){return d(c.Get(0),u.Get(0),_.Get(0))}}}else this.Run=s}GetSID(){return this._sid}IsAsync(){return 0!=(8&this._flags)}CanBailOut(){return 0!=(16&this._flags)}CallBeforeAfterHooks(){return 1===this._actionType}IsStatic(){return 2===this._actionType}CanPickAnyObjectClass(){return 0!=(1&this._flags)}HasReturnType(){return this.IsAsync()||this.CanBailOut()}GetObjectClass(){return this._objectClass}GetImplementationAddon(){return this._behaviorType?this._behaviorType.GetBehavior():this._objectClass?this._objectClass.GetPlugin():null}GetImplementationSdkVersion(){const e=this.GetImplementationAddon();return e?e.GetSdkVersion():1}GetEventBlock(){return this._eventBlock}_HasCopyPickedParent(){let e=this._eventBlock;do{if(e instanceof Yo.FunctionBlock&&e.IsCopyPicked())return!0}while(e=e.GetScopeParent());return!1}GetRuntime(){return this._runtime}GetIndex(){return this._index}GetDebugIndex(){return this._debugData.index}IsBreakpoint(){return this._debugData.isBreakpoint}_SetBreakpoint(e){this._debugData.isBreakpoint=!!e,this._eventBlock._UpdateCanRunFastRecursive()}_DebugReturnsGenerator(){return this._debugData.canDebug}DebugCanRunFast(){return!this.IsBreakpoint()&&!this._runtime.DebugBreakNext()&&!this._DebugReturnsGenerator()}GetSavedDataMap(){return this._savedData||(this._savedData=new Map),this._savedData}GetUnsavedDataMap(){return this._unsavedData||(this._unsavedData=new Map),this._unsavedData}_RunSystem(){const e=this._results;return r(this._parameters,e),this._func.apply(this._systemPlugin,e)}*_DebugRunSystem(){if((this.IsBreakpoint()||this._runtime.DebugBreakNext())&&(yield this),this._DebugReturnsGenerator()){const e=this._results,t=(r(this._parameters,e),yield*this._func.apply(this._systemPlugin,e));return t}return this.Run()}_RunSingleGlobal(){const e=this._results;return r(this._parameters,e),this._func.apply(this._objectClass.GetSingleGlobalInstance().GetSdkInstance(),e)}*_DebugRunSingleGlobal(){if((this.IsBreakpoint()||this._runtime.DebugBreakNext())&&(yield this),this._DebugReturnsGenerator()){const e=this._results,t=(r(this._parameters,e),yield*this._func.apply(this._objectClass.GetSingleGlobalInstance().GetSdkInstance(),e));return t}return this.Run()}_RunObject_ParamsConst(){const s=this._results,i=this._objectClass.GetCurrentSol().GetInstances();for(let e=0,t=i.length;e<t;++e)this._func.apply(i[e].GetSdkInstance(),s)}*_DebugRunObject_ParamsConst(){if((this.IsBreakpoint()||this._runtime.DebugBreakNext())&&(yield this),this._DebugReturnsGenerator()){const s=this._results,i=this._objectClass.GetCurrentSol().GetInstances();for(let e=0,t=i.length;e<t;++e)yield*this._func.apply(i[e].GetSdkInstance(),s)}else this._RunObject_ParamsConst()}_RunObject_ParamsDontVary(){const s=this._results,i=(r(this._parameters,s),this._objectClass.GetCurrentSol().GetInstances());for(let e=0,t=i.length;e<t;++e)this._func.apply(i[e].GetSdkInstance(),s)}*_DebugRunObject_ParamsDontVary(){if((this.IsBreakpoint()||this._runtime.DebugBreakNext())&&(yield this),this._DebugReturnsGenerator()){const s=this._results,i=(r(this._parameters,s),this._objectClass.GetCurrentSol().GetInstances());for(let e=0,t=i.length;e<t;++e)yield*this._func.apply(i[e].GetSdkInstance(),s)}else this._RunObject_ParamsDontVary()}_RunObject_AllParamsVary(){const i=this._parameters,r=this._results,t=this._func,n=this._objectClass.GetCurrentSol().GetInstances();for(let s=0,e=n.length;s<e;++s){const a=n[s];for(let e=0,t=i.length;e<t;++e)r[e]=i[e].Get(s);t.apply(a.GetSdkInstance(),r)}}*_DebugRunObject_AllParamsVary(){if((this.IsBreakpoint()||this._runtime.DebugBreakNext())&&(yield this),this._DebugReturnsGenerator()){const i=this._parameters,r=this._results,t=this._func,n=this._objectClass.GetCurrentSol().GetInstances();for(let s=0,e=n.length;s<e;++s){const a=n[s];for(let e=0,t=i.length;e<t;++e)r[e]=i[e].Get(s);yield*t.apply(a.GetSdkInstance(),r)}}else this._RunObject_AllParamsVary()}_RunObject_SomeParamsVary(){const i=this._parameters,r=this._results,t=this._func,n=this._objectClass.GetCurrentSol().GetInstances();for(let e=0,t=i.length;e<t;++e){const s=i[e];s.VariesPerInstance()||(r[e]=s.Get(0))}for(let s=0,e=n.length;s<e;++s){const a=n[s];for(let e=0,t=i.length;e<t;++e){const o=i[e];o.VariesPerInstance()&&(r[e]=o.Get(s))}t.apply(a.GetSdkInstance(),r)}}*_DebugRunObject_SomeParamsVary(){if((this.IsBreakpoint()||this._runtime.DebugBreakNext())&&(yield this),this._DebugReturnsGenerator()){const i=this._parameters,r=this._results,t=this._func,n=this._objectClass.GetCurrentSol().GetInstances();for(let e=0,t=i.length;e<t;++e){const s=i[e];s.VariesPerInstance()||(r[e]=s.Get(0))}for(let s=0,e=n.length;s<e;++s){const a=n[s];for(let e=0,t=i.length;e<t;++e){const o=i[e];o.VariesPerInstance()&&(r[e]=o.Get(s))}yield*t.apply(a.GetSdkInstance(),r)}}else this._RunObject_SomeParamsVary()}_RunObject_BeforeAfterHooks(){const i=this._parameters,r=this._results,t=this._func,e=this._objectClass,s=e.GetSdkType(),n=e.GetCurrentSol().GetInstances();s.BeforeRunAction(t);for(let s=0,e=n.length;s<e;++s){const a=n[s];for(let e=0,t=i.length;e<t;++e)r[e]=i[e].Get(s);t.apply(a.GetSdkInstance(),r)}s.AfterRunAction(t)}*_DebugRunObject_BeforeAfterHooks(){if((this.IsBreakpoint()||this._runtime.DebugBreakNext())&&(yield this),this._DebugReturnsGenerator()){const i=this._parameters,r=this._results,t=this._func,e=this._objectClass,s=e.GetSdkType(),n=e.GetCurrentSol().GetInstances();s.BeforeRunAction(t);for(let s=0,e=n.length;s<e;++s){const a=n[s];for(let e=0,t=i.length;e<t;++e)r[e]=i[e].Get(s);yield*t.apply(a.GetSdkInstance(),r)}s.AfterRunAction(t)}else this._RunObject_BeforeAfterHooks()}_RunObject_Static(){const e=this._results;return r(this._parameters,e),this._func.apply(this._behaviorType||this._objectClass,e)}*_DebugRunObject_Static(){if((this.IsBreakpoint()||this._runtime.DebugBreakNext())&&(yield this),this._DebugReturnsGenerator()){const t=this._results;r(this._parameters,t);let e=this._func.apply(this._behaviorType||this._objectClass,t);return Yo.IsIterator(e)?yield*e:e}return this._RunObject_Static()}_RunBehavior(){const e=this._objectClass,t=e.IsFamily(),i=e.GetFamilyIndex(),r=this._parameters,n=this._anyParamVariesPerInstance,a=this._results,o=this._func,h=this._behaviorIndex,l=e.GetCurrentSol().GetInstances();for(let e=0,t=r.length;e<t;++e){const s=r[e];s.VariesPerInstance()||(a[e]=s.Get(0))}for(let s=0,e=l.length;s<e;++s){const c=l[s];if(n)for(let e=0,t=r.length;e<t;++e){const _=r[e];_.VariesPerInstance()&&(a[e]=_.Get(s))}const u=t?c.GetObjectClass().GetFamilyBehaviorOffset(i):0;o.apply(c.GetBehaviorInstances()[h+u].GetSdkInstance(),a)}}*_DebugRunBehavior(){if((this.IsBreakpoint()||this._runtime.DebugBreakNext())&&(yield this),this._DebugReturnsGenerator()){const e=this._objectClass,t=e.IsFamily(),i=e.GetFamilyIndex(),r=this._parameters,n=this._anyParamVariesPerInstance,a=this._results,o=this._func,h=this._behaviorIndex,l=e.GetCurrentSol().GetInstances();for(let e=0,t=r.length;e<t;++e){const s=r[e];s.VariesPerInstance()||(a[e]=s.Get(0))}for(let s=0,e=l.length;s<e;++s){const c=l[s];if(n)for(let e=0,t=r.length;e<t;++e){const _=r[e];_.VariesPerInstance()&&(a[e]=_.Get(s))}const u=t?c.GetObjectClass().GetFamilyBehaviorOffset(i):0;yield*o.apply(c.GetBehaviorInstances()[h+u].GetSdkInstance(),a)}}else this._RunBehavior()}_RunObject_Async(){const i=this._parameters,r=this._results,t=this._func,n=this._objectClass.GetCurrentSol().GetInstances(),a=[];for(let s=0,e=n.length;s<e;++s){const o=n[s];for(let e=0,t=i.length;e<t;++e)r[e]=i[e].Get(s);a.push(t.apply(o.GetSdkInstance(),r))}return Promise.all(a)}*_DebugRunObject_Async(){if((this.IsBreakpoint()||this._runtime.DebugBreakNext())&&(yield this),this._DebugReturnsGenerator()){const i=this._parameters,r=this._results,t=this._func,n=this._objectClass.GetCurrentSol().GetInstances(),a=[];for(let s=0,e=n.length;s<e;++s){const o=n[s];for(let e=0,t=i.length;e<t;++e)r[e]=i[e].Get(s);a.push(yield*t.apply(o.GetSdkInstance(),r))}return Promise.all(a)}return this._RunObject_Async()}_RunBehavior_Async(){const e=this._objectClass,t=e.IsFamily(),i=e.GetFamilyIndex(),r=this._parameters,n=this._results,a=this._func,o=this._behaviorIndex,h=e.GetCurrentSol().GetInstances(),l=[];for(let s=0,e=h.length;s<e;++s){const c=h[s];for(let e=0,t=r.length;e<t;++e)n[e]=r[e].Get(s);const u=t?c.GetObjectClass().GetFamilyBehaviorOffset(i):0;l.push(a.apply(c.GetBehaviorInstances()[o+u].GetSdkInstance(),n))}return Promise.all(l)}*_DebugRunBehavior_Async(){if((this.IsBreakpoint()||this._runtime.DebugBreakNext())&&(yield this),this._DebugReturnsGenerator()){const e=this._objectClass,t=e.IsFamily(),i=e.GetFamilyIndex(),r=this._parameters,n=this._results,a=this._func,o=this._behaviorIndex,h=e.GetCurrentSol().GetInstances(),l=[];for(let s=0,e=h.length;s<e;++s){const c=h[s];for(let e=0,t=r.length;e<t;++e)n[e]=r[e].Get(s);const u=t?c.GetObjectClass().GetFamilyBehaviorOffset(i):0;l.push(yield*a.apply(c.GetBehaviorInstances()[o+u].GetSdkInstance(),n))}return Promise.all(l)}return this._RunBehavior_Async()}async RunUserScript(){try{await this._func()}catch(e){console.error(`Unhandled exception running script %c${this._eventBlock.GetEventSheet().GetName()}, event ${this._eventBlock.GetDisplayNumber()}, action ${this.GetDebugIndex()+1}:`,\"font-size: 1.2em; font-weight: bold;\",e),self.C3Debugger&&self.C3Debugger._SetLastErrorScript(this),Yo.EventScript.HadUserScriptException()||(console.info(\"%cTip:%c run this to highlight in Construct the last script that had an error: %cgoToLastErrorScript()\",\"font-weight: bold; text-decoration: underline\",\"\",\"font-weight: bold\"),Yo.EventScript.SetHadUserScriptException())}}*DebugRunUserScript(){return(this.IsBreakpoint()||this._runtime.DebugBreakNext())&&(yield this),this.RunUserScript()}_SaveToJson(){return this._savedData&&this._savedData.size?{ex:Yo.ToSuperJSON(this._savedData)}:null}_LoadFromJson(e){if(this._savedData&&(this._savedData.clear(),this._savedData=null),e){const t=e.ex;t&&(this._savedData=Yo.FromSuperJSON(t))}}}}{let d=function(e){return e instanceof a?S._UnwrapScriptInterface(e):e.GetInstance()},c=function(e){return d(e).GetWorldInfo()},r=function(e){return S._UnwrapScriptInterface(e)},P=function(e,t,s,i){const r=t.GetUID(),n=s.GetUID();r<n?e.Set(t,s,i):e.Set(s,t,i)},R=function(e,t,s){const i=t.GetUID(),r=s.GetUID();i<r?e.Delete(t,s):e.Delete(s,t)},A=function(e,t){e.DeleteEither(t)},M=function(e,t,s){const i=t.GetUID(),r=s.GetUID();return i<r?e.Get(t,s):e.Get(s,t)},i=function(e,t,s,i){if(!t)return!1;const r=0!==s||0!==i,n=e.GetWorldInfo(),a=S.GetCollisionEngine(),o=S.GetCurrentCondition(),h=o.GetEventBlock().IsOrBlock(),l=o.GetObjectClass(),c=o.IsInverted(),u=t.GetCurrentSol(),_=l!==t;x=t,w=_&&!c;let d,p=0,f=0,m=v=!1;u.IsSelectAll()?(y.copy(n.GetBoundingBox()),y.offset(s,i),a.GetCollisionCandidates(n.GetLayer(),t,y,G),d=G):!h||S.IsCurrentConditionFirst()&&!u._GetOwnElseInstances().length&&u._GetOwnInstances().length?d=u._GetOwnInstances():(d=u._GetOwnElseInstances(),v=!0),r&&(p=n.GetX(),f=n.GetY(),n.OffsetXY(s,i),n.SetBboxChanged());for(const g of d)if(a.TestOverlap(e,g)){if(m=!0,c)break;_&&F.add(g)}return r&&(n.SetXY(p,f),n.SetBboxChanged()),D.clearArray(G),m},s=function(e){const t=S.GetCurrentEvent().IsOrBlock(),s=x.GetCurrentSol(),i=s._GetOwnInstances(),r=s._GetOwnElseInstances();s.IsSelectAll()?(s.SetSetPicked(F),t&&(D.clearArray(r),s.AddElseInstances(F,x.GetInstances()))):t?v?s.TransferElseInstancesToOwn(F):(s.AddElseInstances(F,i),s.SetSetPicked(F)):s.SetSetPicked(F),x.ApplySolToContainer()},I=function(e,t){w&&(t&&s(),F.clear(),x=null,w=!1)},t=function(e,t){const s=S.GetInstanceByUID(t);if(s){const i=e.GetCurrentSol();if(i.IsSelectAll()||i._GetOwnInstances().includes(s))if(e.IsFamily()){if(s.GetObjectClass().BelongsToFamily(e))return i.PickOne(s),e.ApplySolToContainer(),!0}else if(s.GetObjectClass()===e)return i.PickOne(s),e.ApplySolToContainer(),!0}return!1},n=function(e,r){const n=e.GetCurrentSol();if(n.IsSelectAll()){n._SetSelectAll(!1),n.ClearArrays();const s=e.GetInstances();for(let e=0,t=s.length;e<t;++e){const i=s[e];i.GetUID()===r?n._PushElseInstance(i):n._PushInstance(i)}return e.ApplySolToContainer(),!!n._GetOwnInstances().length}{let s=n._GetOwnInstances(),i=0;for(let e=0,t=s.length;e<t;++e){const a=s[e];(s[i]=a).GetUID()===r?n._PushElseInstance(a):++i}return D.truncateArray(s,i),e.ApplySolToContainer(),!!s.length}},D=(d,c,r,P,R,A,M,i,s,I,t,n,self.C3),l=new D.Color,T={},C={},b={},S=null,a=(D.CommonACES_SetRuntime=function(e){S=e},self.IInstance),y=(C.CompareX=function(e,t){return D.compare(this.GetWorldInfo().GetX(),e,t)},b.CompareX=function(e,t){return D.compare(this.x,e,t)},C.CompareY=function(e,t){return D.compare(this.GetWorldInfo().GetY(),e,t)},b.CompareY=function(e,t){return D.compare(this.y,e,t)},C.IsOnScreen=function(){return this.GetWorldInfo().IsInViewport2()},b.IsOnScreen=function(){return this.isOnScreen()},T.IsOutsideLayout=function(){const e=c(this),t=e.GetLayout(),s=e.GetBoundingBox();return s.getRight()<0||s.getBottom()<0||s.getLeft()>t.GetWidth()||s.getTop()>t.GetHeight()},T.PickDistance=function(s,i,r){const e=this.GetCurrentSol(),n=e.GetInstances();if(!n.length)return!1;let a=n[0],o=a.GetWorldInfo(),h=a,l=D.distanceSquared(o.GetX(),o.GetY(),i,r);for(let e=1,t=n.length;e<t;++e){a=n[e],o=a.GetWorldInfo();const c=D.distanceSquared(o.GetX(),o.GetY(),i,r);(0===s&&c<l||1===s&&c>l)&&(l=c,h=a)}return e.PickOne(h),!0},C.SetX=function(e){const t=this.GetWorldInfo();t.GetX()!==e&&(t.SetX(e),t.SetBboxChanged())},b.SetX=function(e){this.x=+e},C.SetY=function(e){const t=this.GetWorldInfo();t.GetY()!==e&&(t.SetY(e),t.SetBboxChanged())},b.SetY=function(e){this.y=+e},C.SetPos=function(e,t){const s=this.GetWorldInfo();s.EqualsXY(e,t)||(s.SetXY(e,t),s.SetBboxChanged())},b.SetPos=function(e,t){this.setPosition(e,t)},T.SetPosToObject=function(e,t){if(e){const s=d(this),i=e.GetPairedInstance(s);if(i){const[r,n]=i.GetImagePoint(t),a=s.GetWorldInfo();a.GetX()===r&&a.GetY()===n||(a.SetXY(r,n),a.SetBboxChanged())}}},T.MoveForward=function(e){if(0!==e){const t=c(this);t.OffsetXY(t.GetCosAngle()*e,t.GetSinAngle()*e),t.SetBboxChanged()}},C.MoveAtAngle=function(e,t){if(0!==t){const s=this.GetWorldInfo();e=D.toRadians(e),s.OffsetXY(Math.cos(e)*t,Math.sin(e)*t),s.SetBboxChanged()}},b.MoveAtAngle=function(e,t){0!==t&&(e=D.toRadians(e),this.offsetPosition(Math.cos(e)*t,Math.sin(e)*t))},C.GetX=function(){return this.GetWorldInfo().GetX()},b.GetX=function(){return this.x},C.GetY=function(){return this.GetWorldInfo().GetY()},b.GetY=function(){return this.y},T.GetDt=function(){return S.GetDt(d(this))},C.CompareWidth=function(e,t){return D.compare(this.GetWorldInfo().GetWidth(),e,t)},b.CompareWidth=function(e,t){return D.compare(this.width,e,t)},C.CompareHeight=function(e,t){return D.compare(this.GetWorldInfo().GetHeight(),e,t)},b.CompareHeight=function(e,t){return D.compare(this.height,e,t)},C.SetWidth=function(e){const t=this.GetWorldInfo();t.GetWidth()!==e&&(t.SetWidth(e),t.SetBboxChanged())},b.SetWidth=function(e){this.width=e},C.SetHeight=function(e){const t=this.GetWorldInfo();t.GetHeight()!==e&&(t.SetHeight(e),t.SetBboxChanged())},b.SetHeight=function(e){this.height=e},C.SetSize=function(e,t){const s=c(this);s.GetWidth()===e&&s.GetHeight()===t||(s.SetSize(e,t),s.SetBboxChanged())},b.SetSize=function(e,t){this.setSize(e,t)},C.GetWidth=function(){return this.GetWorldInfo().GetWidth()},b.GetWidth=function(){return this.width},C.GetHeight=function(){return this.GetWorldInfo().GetHeight()},b.GetHeight=function(){return this.height},T.GetBboxLeft=function(){return c(this).GetBoundingBox().getLeft()},T.GetBboxTop=function(){return c(this).GetBoundingBox().getTop()},T.GetBboxRight=function(){return c(this).GetBoundingBox().getRight()},T.GetBboxBottom=function(){return c(this).GetBoundingBox().getBottom()},T.GetBboxMidX=function(){const e=c(this).GetBoundingBox();return(e.getLeft()+e.getRight())/2},T.GetBboxMidY=function(){const e=c(this).GetBoundingBox();return(e.getTop()+e.getBottom())/2},T.IsAngleWithin=function(e,t){return D.angleDiff(c(this).GetAngle(),D.toRadians(t))<=D.toRadians(e)},T.IsAngleClockwiseFrom=function(e){return D.angleClockwise(c(this).GetAngle(),D.toRadians(e))},T.IsBetweenAngles=function(e,t){const s=D.toRadians(e),i=D.toRadians(t),r=c(this).GetAngle(),n=!D.angleClockwise(i,s);return n?!(!D.angleClockwise(r,s)&&D.angleClockwise(r,i)):D.angleClockwise(r,s)&&!D.angleClockwise(r,i)},C.SetAngle=function(e){const t=this.GetWorldInfo(),s=D.clampAngle(D.toRadians(e));isNaN(s)||t.GetAngle()===s||(t.SetAngle(s),t.SetBboxChanged())},b.SetAngle=function(e){this.angleDegrees=e},T.RotateClockwise=function(e){if(!isNaN(e)&&0!==e){const t=c(this);t.SetAngle(t.GetAngle()+D.toRadians(e)),t.SetBboxChanged()}},T.RotateCounterclockwise=function(e){if(!isNaN(e)&&0!==e){const t=c(this);t.SetAngle(t.GetAngle()-D.toRadians(e)),t.SetBboxChanged()}},T.RotateTowardAngle=function(e,t){const s=c(this),i=s.GetAngle(),r=D.angleRotate(i,D.toRadians(t),D.toRadians(e));isNaN(r)||i===r||(s.SetAngle(r),s.SetBboxChanged())},T.RotateTowardPosition=function(e,t,s){const i=c(this),r=i.GetAngle(),n=t-i.GetX(),a=s-i.GetY(),o=Math.atan2(a,n),h=D.angleRotate(r,o,D.toRadians(e));isNaN(h)||r===h||(i.SetAngle(h),i.SetBboxChanged())},T.SetTowardPosition=function(e,t){const s=c(this),i=s.GetAngle(),r=e-s.GetX(),n=t-s.GetY(),a=Math.atan2(n,r);isNaN(a)||i===a||(s.SetAngle(a),s.SetBboxChanged())},C.GetAngle=function(){return D.toDegrees(this.GetWorldInfo().GetAngle())},b.GetAngle=function(){return this.angleDegrees},T.CompareOpacity=function(e,t){return D.compare(D.roundToDp(100*c(this).GetOpacity(),6),e,t)},C.IsVisible=function(){return this.GetWorldInfo().IsVisible()},b.IsVisible=function(){return this.isVisible},T.SetVisible=function(e){const t=c(this);e=2===e?!t.IsVisible():0!==e,t.IsVisible()!==e&&(t.SetVisible(e),S.UpdateRender())},T.SetOpacity=function(e){const t=D.clamp(e/100,0,1),s=c(this);if(s.GetTransformWithParentOpacity()){if(s._GetSceneGraphInfo().GetOwnOpacity()===t)return}else if(s.GetOpacity()===t)return;s.SetOpacity(t),S.UpdateRender()},T.SetDefaultColor=function(e){l.setFromRgbValue(e);const t=c(this);t.GetUnpremultipliedColor().equalsIgnoringAlpha(l)||(t.SetUnpremultipliedColor(l),S.UpdateRender())},T.GetColor=function(){const e=c(this).GetUnpremultipliedColor();return D.PackRGBAEx(e.getR(),e.getG(),e.getB(),e.getA())},T.GetOpacity=function(){return D.roundToDp(100*c(this).GetOpacity(),6)},T.IsOnLayer=function(e){return!!e&&c(this).GetLayer()===e},T.PickTopBottom=function(s){const e=this.GetCurrentSol(),i=e.GetInstances();if(!i.length)return!1;let t=i[0],r=t;for(let e=1,t=i.length;e<t;++e){const n=i[e],a=n.GetWorldInfo(),o=r.GetWorldInfo(),h=a.GetLayer().GetIndex(),l=o.GetLayer().GetIndex();0===s?(l<h||h===l&&a.GetZIndex()>o.GetZIndex())&&(r=n):(h<l||h===l&&a.GetZIndex()<o.GetZIndex())&&(r=n)}return e.PickOne(r),!0},C.CompareZElevation=function(e,t,s){const i=this.GetWorldInfo(),r=0===e?i.GetZElevation():i.GetTotalZElevation();return D.compare(r,t,s)},b.CompareZElevation=function(e,t,s){const i=0===e?this.zElevation:this.totalZElevation;return D.compare(i,t,s)},C.MoveToTop=function(){this.GetWorldInfo().ZOrderMoveToTop()},b.MoveToTop=function(){this.moveToTop()},C.MoveToBottom=function(){this.GetWorldInfo().ZOrderMoveToBottom()},b.MoveToBottom=function(){this.moveToBottom()},T.MoveToLayer=function(e){e&&c(this).ZOrderMoveToLayer(e)},T.ZMoveToObject=function(e,t){const s=0===e;if(t){const i=d(this),r=t.GetFirstPicked(i);r&&i.GetWorldInfo().ZOrderMoveAdjacentToInstance(r,s)}},C.SetZElevation=function(e){const t=this.GetWorldInfo();t.GetZElevation()!==e&&(t.SetZElevation(e),S.UpdateRender())},b.SetZElevation=function(e){this.zElevation=e},T.LayerNumber=function(){return c(this).GetLayer().GetIndex()},T.LayerName=function(){return c(this).GetLayer().GetName()},C.ZIndex=function(){return this.GetWorldInfo().GetZIndex()},b.ZIndex=function(){return this.zIndex},C.ZElevation=function(){return this.GetWorldInfo().GetZElevation()},b.ZElevation=function(){return this.zElevation},C.TotalZElevation=function(){return this.GetWorldInfo().GetTotalZElevation()},b.TotalZElevation=function(){return this.totalZElevation},T.IsEffectEnabled=function(e){const t=d(this),s=t.GetObjectClass().GetEffectList().GetEffectTypeByName(e);if(s){const i=s.GetIndex(),r=t.GetWorldInfo().GetInstanceEffectList();return r.IsEffectIndexActive(i)}},T.SetEffectEnabled=function(e,t){const s=d(this),i=s.GetObjectClass().GetEffectList().GetEffectTypeByName(t);if(i){const r=i.GetIndex(),n=1===e,a=s.GetWorldInfo().GetInstanceEffectList();a.IsEffectIndexActive(r)!==n&&(a.SetEffectIndexActive(r,n),a.UpdateActiveEffects(),S.UpdateRender())}},T.SetEffectParam=function(e,t,s){const i=d(this),r=i.GetObjectClass().GetEffectList().GetEffectTypeByName(e);if(r){t=Math.floor(t);const n=r.GetShaderProgram().GetParameterType(t);if(n){\"color\"===n?(l.setFromRgbValue(s),s=l):\"percent\"===n&&(s/=100);const a=r.GetIndex(),o=i.GetWorldInfo().GetInstanceEffectList(),h=o.SetEffectParameter(a,t,s);h&&o.IsEffectIndexActive(a)&&S.UpdateRender()}}},D.New(D.Rect)),E=[],G=[],w=!1,x=null,v=!1,F=new Set;T.OnCollision=function(S){if(this._runtime.IsDebugging())return function*(S){if(S){let e=this._runtime,t=e.GetCollisionEngine(),i=e.GetEventSheetManager(),s=i.GetEventStack(),r=i.GetCurrentCondition(),n=r.GetObjectClass(),a=r.GetSavedDataMap(),o=r.GetUnsavedDataMap(),h=s.GetCurrentStackFrame(),l=e.GetTickCount(),c=l-1,u=h.GetCurrentEvent(),_=s.Push(u),d=a.get(\"collmemory\"),p=(d||(d=D.New(D.PairMap),a.set(\"collmemory\",d)),o.get(\"collisionCreatedDestroyCallback\")||(o.set(\"collisionCreatedDestroyCallback\",!0),e.Dispatcher().addEventListener(\"instancedestroy\",e=>A(d,e.instance))),n.GetCurrentSol()),f=S.GetCurrentSol(),m=p.GetInstances(),g=null;for(let e=0;e<m.length;++e){const y=m[e];f.IsSelectAll()?(t.GetCollisionCandidates(y.GetWorldInfo().GetLayer(),S,y.GetWorldInfo().GetBoundingBox(),E),g=E,t.AddRegisteredCollisionCandidates(y,S,g)):g=f.GetInstances();for(let e=0;e<g.length;++e){const G=g[e];if(t.TestOverlap(y,G)||t.CheckRegisteredCollision(y,G)){let e=M(d,y,G),t=!1,s=-2;\"number\"==typeof e&&(t=!0,s=e);const I=!t||s<c;if(P(d,y,G,l),I){const T=u.GetSolModifiers(),C=(i.PushCopySol(T),n.GetCurrentSol()),b=S.GetCurrentSol();if(C._SetSelectAll(!1),b._SetSelectAll(!1),n===S){const w=C._GetOwnInstances();D.clearArray(w),w.push(y),w.push(G),n.ApplySolToContainer()}else{const x=C._GetOwnInstances(),v=b._GetOwnInstances();D.clearArray(x),D.clearArray(v),x.push(y),v.push(G),n.ApplySolToContainer(),S.ApplySolToContainer()}yield*u.DebugRetrigger(h,_),i.PopSol(T)}}else R(d,y,G)}D.clearArray(E)}s.Pop()}return!1}.call(this,S);if(S){let e=this._runtime,t=e.GetCollisionEngine(),i=e.GetEventSheetManager(),s=i.GetEventStack(),r=i.GetCurrentCondition(),n=r.GetObjectClass(),a=r.GetSavedDataMap(),o=r.GetUnsavedDataMap(),h=s.GetCurrentStackFrame(),l=e.GetTickCount(),c=l-1,u=h.GetCurrentEvent(),_=s.Push(u),d=a.get(\"collmemory\"),p=(d||(d=D.New(D.PairMap),a.set(\"collmemory\",d)),o.get(\"collisionCreatedDestroyCallback\")||(o.set(\"collisionCreatedDestroyCallback\",!0),e.Dispatcher().addEventListener(\"instancedestroy\",e=>A(d,e.instance))),n.GetCurrentSol()),f=S.GetCurrentSol(),m=p.GetInstances(),g=null;for(let e=0;e<m.length;++e){const y=m[e];f.IsSelectAll()?(t.GetCollisionCandidates(y.GetWorldInfo().GetLayer(),S,y.GetWorldInfo().GetBoundingBox(),E),g=E,t.AddRegisteredCollisionCandidates(y,S,g)):g=f.GetInstances();for(let e=0;e<g.length;++e){const G=g[e];if(t.TestOverlap(y,G)||t.CheckRegisteredCollision(y,G)){let e=M(d,y,G),t=!1,s=-2;\"number\"==typeof e&&(t=!0,s=e);const I=!t||s<c;if(P(d,y,G,l),I){const T=u.GetSolModifiers(),C=(i.PushCopySol(T),n.GetCurrentSol()),b=S.GetCurrentSol();if(C._SetSelectAll(!1),b._SetSelectAll(!1),n===S){const w=C._GetOwnInstances();D.clearArray(w),w.push(y),w.push(G),n.ApplySolToContainer()}else{const x=C._GetOwnInstances(),v=b._GetOwnInstances();D.clearArray(x),D.clearArray(v),x.push(y),v.push(G),n.ApplySolToContainer(),S.ApplySolToContainer()}u.Retrigger(h,_),i.PopSol(T)}}else R(d,y,G)}D.clearArray(E)}s.Pop()}return!1},T.IsOverlapping=function(e){return i(d(this),e,0,0)},T.IsOverlappingOffset=function(e,t,s){return i(d(this),e,t,s)},T.HasParent=function(){return c(this).HasParent()},T.HasChildren=function(){return c(this).HasChildren()},T.PickParent=function(s,i){const e=this.GetCurrentSol(),r=e.GetInstances();if(0===r.length)return!1;let t=s.GetCurrentSol(),n=t.GetInstances();if(t.IsSelectAll()){const h=[...this._runtime.instancesPendingCreateForObjectClass(s)];0<h.length&&(n=n.concat(h))}if(0===n.length)return!1;const a=t.IsSelectAll()?null:new Set(n),o=new Set;for(let e=0,t=r.length;e<t;++e){const l=r[e];if(1===i)for(const c of l.parents())c.BelongsToObjectClass(s)&&(null===a||a.has(c))&&o.add(c);else{let e;if(0===i){if(null===(e=l.GetParent()))continue}else e=l.GetTopParent();e.BelongsToObjectClass(s)&&(null===a||a.has(e))&&o.add(e)}}return 0!==o.size&&(t.SetSetPicked(o),s.ApplySolToContainer(),!0)},T.PickChildren=function(s,i){const e=this.GetCurrentSol(),r=e.GetInstances();if(0===r.length)return!1;let t=s.GetCurrentSol(),n=t.GetInstances();if(t.IsSelectAll()){const h=[...this._runtime.instancesPendingCreateForObjectClass(s)];0<h.length&&(n=n.concat(h))}if(0===n.length)return!1;const a=t.IsSelectAll()?null:new Set(n),o=new Set;for(let e=0,t=r.length;e<t;++e){const l=r[e];2!==i||l.HasChildren()||!l.BelongsToObjectClass(s)||null!==a&&!a.has(l)||o.add(l);for(const c of 0===i?l.children():l.allChildren())2===i&&c.HasChildren()||c.BelongsToObjectClass(s)&&(null===a||a.has(c))&&o.add(c)}return 0!==o.size&&(t.SetSetPicked(o),s.ApplySolToContainer(),!0)},T.PickNthChild=function(s,i,r){const e=this.GetCurrentSol(),n=e.GetInstances();if(0===n.length)return!1;let t=s.GetCurrentSol(),a=t.GetInstances();if(t.IsSelectAll()){const l=[...this._runtime.instancesPendingCreateForObjectClass(s)];0<l.length&&(a=a.concat(l))}if(0===a.length)return!1;const o=t.IsSelectAll()?null:new Set(a),h=[];for(let e=0,t=n.length;e<t;++e){const c=n[e];if(0===i){const u=c.GetChildAt(r);null!==u&&u.BelongsToObjectClass(s)&&(null===o||o.has(u))&&h.push(u)}else if(1===i)for(const _ of c.children())if(_.BelongsToObjectClass(s)){if(0===r){null!==o&&!o.has(_)||h.push(_);break}--r}}return 0!==h.length&&(t.SetArrayPicked(h),s.ApplySolToContainer(),!0)},T.CompareChildCount=function(e,t,s){const i=d(this);switch(e){case 0:default:return D.compare(i.GetChildCount(),t,s);case 1:return D.compare(i.GetAllChildCount(),t,s)}},T.AddChild=function(e,t,s,i,r,n,a,o,h,l){const c=d(this),u=S.GetCurrentAction().GetObjectClass();for(const _ of e.allCorrespondingInstances(c,u)){if(!_.GetPlugin().SupportsSceneGraph())return;c.AddChild(_,{transformX:t,transformY:s,transformWidth:i,transformHeight:r,transformAngle:n,transformOpacity:a,transformZElevation:o,transformVisibility:h,destroyWithParent:l})}},T.RemoveChild=function(e){const t=d(this),s=S.GetCurrentAction().GetObjectClass();for(const i of e.allCorrespondingInstances(t,s))t.RemoveChild(i)},T.RemoveFromParent=function(){const e=d(this);if(e.HasParent()){const t=e.GetParent();t.RemoveChild(e)}},T.ChildCount=function(){return d(this).GetChildCount()},T.AllChildCount=function(){return d(this).GetAllChildCount()},T.SetMeshSize=function(e,t){e=Math.floor(e),t=Math.floor(t);const s=c(this);e<2||t<2||!isFinite(e)||!isFinite(t)?(s.ReleaseMesh(),s.SetBboxChanged()):s.CreateMesh(e,t)},T.SetMeshPoint=function(e,t,s,i,r,n,a,o){const h=c(this),l=h.SetMeshPoint(e,t,{mode:0===s?\"absolute\":\"relative\",x:i,y:r,zElevation:n,u:a,v:o});l&&h.SetBboxChanged()},T.MeshColumns=function(){const e=c(this);return e.HasMesh()?e.GetSourceMesh().GetHSize():0},T.MeshRows=function(){const e=c(this);return e.HasMesh()?e.GetSourceMesh().GetVSize():0},T.SetElementVisible=function(e){const t=c(this);e=2===e?!t.IsVisible():0!==e,t.IsVisible()!==e&&t.SetVisible(e)},T.SetElementCSSStyle=function(e,t){this instanceof self.IInstance?this.setElementCSSStyle(e,t):this.SetElementCSSStyle(e,t)},T.SetElementAttribute=function(e,t){this instanceof self.IInstance?this.setElementAttribute(e,\"\"+t):this.SetElementAttribute(e,\"\"+t)},T.RemoveElementAttribute=function(e){this instanceof self.IInstance?this.removeElementAttribute(e):this.RemoveElementAttribute(e)},T.SetElementFocus=function(){this instanceof self.IInstance?this.focusElement():this.FocusElement()},T.SetElementBlur=function(){this instanceof self.IInstance?this.blurElement():this.BlurElement()},T.IsElementFocused=function(){return this instanceof self.IInstance?this.isElementFocused():this.IsElementFocused()},T.SetElementEnabled=function(e){this instanceof self.IInstance?this._setEnabled(0!==e):this._SetEnabled(0!==e)},T.IsElementEnabled=function(){return this instanceof self.IInstance?this._isEnabled():this._IsEnabled()},C.CompareInstanceVar=function(e,t,s){return D.compare(this.GetInstance().GetInstanceVariableValue(e),t,s)},b.CompareInstanceVar=function(e,t,s){return D.compare(r(this).GetInstanceVariableValue(e),t,s)},C.IsBoolInstanceVarSet=function(e){return!!this.GetInstance().GetInstanceVariableValue(e)},b.IsBoolInstanceVarSet=function(e){return!!r(this).GetInstanceVariableValue(e)},T.PickInstVarHiLow=function(s,i){const e=this.GetCurrentSol(),r=e.GetInstances();if(!r.length)return!1;let n=this.IsFamily(),a=null,o=0;for(let e=0,t=r.length;e<t;++e){const h=r[e],l=n?h.GetObjectClass().GetFamilyInstanceVariableOffset(this.GetFamilyIndex()):0,c=h.GetInstanceVariableValue(l+i);(null===a||0===s&&c<o||1===s&&c>o)&&(o=c,a=h)}return e.PickOne(a),!0},T.PickByUID=function(e){return(this._runtime.GetCurrentCondition().IsInverted()?n:t)(this,e)},T.HasTags=function(e){const t=new Set(D.splitStringAndNormalize(e)),s=d(this).GetTagsSet();return t.isSubsetOf(s)},T.Tags=function(){return d(this).GetTagsString()},T.TagsCount=function(){return d(this).GetTagsSet().size},T.TagAt=function(e){return d(this).GetTagAt(e)},T.ChangeTags=function(e,t){const s=D.splitStringAndNormalize(t);if(0!==s.length){const i=d(this),r=new Set(i.GetTagsSet());if(0===e)for(const n of s)r.add(n);else if(1===e)for(const a of s)r.delete(a);i.SetTagsSet(r)}},T.Destroy=function(){S.DestroyInstance(d(this))},T.OnCreated=function(){return!0},T.OnDestroyed=function(){return!0},C.SetInstanceVar=function(e,t){this.GetInstance().SetInstanceVariableValue(e,t)},b.SetInstanceVar=function(e,t){r(this).SetInstanceVariableValue(e,t)},C.AddInstanceVar=function(e,t){const s=this.GetInstance(),i=s.GetInstanceVariableValue(e);\"number\"==typeof i&&\"number\"!=typeof t?t=parseFloat(t):\"string\"==typeof i&&\"string\"!=typeof t&&(t=t.toString()),s.SetInstanceVariableValue(e,i+t)},b.AddInstanceVar=function(e,t){const s=r(this),i=s.GetInstanceVariableValue(e);\"number\"==typeof i&&\"number\"!=typeof t?t=parseFloat(t):\"string\"==typeof i&&\"string\"!=typeof t&&(t=t.toString()),s.SetInstanceVariableValue(e,i+t)},C.SubInstanceVar=function(e,t){const s=this.GetInstance(),i=s.GetInstanceVariableValue(e);\"number\"==typeof i&&(\"number\"!=typeof t&&(t=parseFloat(t)),s.SetInstanceVariableValue(e,i-t))},b.SubInstanceVar=function(e,t){const s=r(this),i=s.GetInstanceVariableValue(e);\"number\"==typeof i&&(\"number\"!=typeof t&&(t=parseFloat(t)),s.SetInstanceVariableValue(e,i-t))},C.SetBoolInstanceVar=function(e,t){this.GetInstance().SetInstanceVariableValue(e,t?1:0)},b.SetBoolInstanceVar=function(e,t){r(this).SetInstanceVariableValue(e,t?1:0)},C.ToggleBoolInstanceVar=function(e){const t=this.GetInstance();t.SetInstanceVariableValue(e,0===t.GetInstanceVariableValue(e)?1:0)},b.ToggleBoolInstanceVar=function(e){const t=r(this);t.SetInstanceVariableValue(e,0===t.GetInstanceVariableValue(e)?1:0)},T.LoadFromJsonString=function(e){let t;try{t=JSON.parse(e)}catch(e){return void console.error(\"Failed to load from JSON string: \",e)}const s=d(this);S.ClearIntancesNeedingAfterLoad(),s._OnBeforeLoad(\"state\"),s.LoadFromJson(t,\"state\"),S.DoAfterLoad(\"state\",{setFromJson:!0})},T.AsJSON=function(){return JSON.stringify(d(this).SaveToJson(\"state\"))},T.ObjectTypeName=function(){return d(this).GetObjectClass().GetName()},T.Count=function(){let e=S.GetCurrentEventStackFrame().GetExpressionObjectClass(),t=e.GetInstanceCount();for(const s of S.instancesPendingCreateForObjectClass(e))++t;return t},T.PickedCount=function(){return S.GetCurrentEventStackFrame().GetExpressionObjectClass().GetCurrentSol().GetInstances().length},C.GetIID=function(){return this.GetInstance().GetIID()},b.GetIID=function(){return r(this).GetIID()},C.GetUID=function(){return this.GetInstance().GetUID()},b.GetUID=function(){return r(this).GetUID()},T.OnInstanceSignal=function(e){const t=d(this);return e.toLowerCase()===S.GetEventSheetManager().GetCurrentInstanceSignalTag(t)},T.InstanceSignal=function(e){const t=d(this);S.GetEventSheetManager().InstanceSignal(t,e)},T.InstanceWaitForSignal=function(e){return S.GetEventSheetManager().AddScheduledWait().InitInstanceSignals(this.GetCurrentSol().GetInstances(),e),!0},T.TemplateName=function(){return d(this).GetTemplateName()},D.AddCommonACEs=function(e,t,s){const i=e[1],r=e[3],n=e[4],a=e[5],o=e[6],h=e[7],l=e[8],c=e[10],u=e[11],_=e[12],d=e[13],p=e[14],f=e[15],m=e[16],g=t.Cnds,S=t.Acts,y=t.Exps,G=Object.assign({},T,2<=s?b:C);r&&(g.CompareX=G.CompareX,g.CompareY=G.CompareY,g.IsOnScreen=G.IsOnScreen,g.IsOutsideLayout=G.IsOutsideLayout,g.PickDistance=G.PickDistance,S.SetX=G.SetX,S.SetY=G.SetY,S.SetPos=G.SetPos,S.SetPosToObject=G.SetPosToObject,S.MoveForward=G.MoveForward,S.MoveAtAngle=G.MoveAtAngle,y.X=G.GetX,y.Y=G.GetY,y.dt=G.GetDt),n&&(g.CompareWidth=G.CompareWidth,g.CompareHeight=G.CompareHeight,S.SetWidth=G.SetWidth,S.SetHeight=G.SetHeight,S.SetSize=G.SetSize,y.Width=G.GetWidth,y.Height=G.GetHeight,y.BBoxLeft=G.GetBboxLeft,y.BBoxTop=G.GetBboxTop,y.BBoxRight=G.GetBboxRight,y.BBoxBottom=G.GetBboxBottom,y.BBoxMidX=G.GetBboxMidX,y.BBoxMidY=G.GetBboxMidY),a&&(g.AngleWithin=G.IsAngleWithin,g.IsClockwiseFrom=G.IsAngleClockwiseFrom,g.IsBetweenAngles=G.IsBetweenAngles,S.SetAngle=G.SetAngle,S.RotateClockwise=G.RotateClockwise,S.RotateCounterclockwise=G.RotateCounterclockwise,S.RotateTowardAngle=G.RotateTowardAngle,S.RotateTowardPosition=G.RotateTowardPosition,S.SetTowardPosition=G.SetTowardPosition,y.Angle=G.GetAngle),o&&(g.IsVisible=G.IsVisible,g.CompareOpacity=G.CompareOpacity,S.SetVisible=G.SetVisible,S.SetOpacity=G.SetOpacity,S.SetDefaultColor=G.SetDefaultColor,y.Opacity=G.GetOpacity,y.ColorValue=G.GetColor),h&&(g.IsOnLayer=G.IsOnLayer,g.PickTopBottom=G.PickTopBottom,g.CompareZElevation=G.CompareZElevation,S.MoveToTop=G.MoveToTop,S.MoveToBottom=G.MoveToBottom,S.MoveToLayer=G.MoveToLayer,S.ZMoveToObject=G.ZMoveToObject,S.SetZElevation=G.SetZElevation,y.LayerNumber=G.LayerNumber,y.LayerName=G.LayerName,y.ZIndex=G.ZIndex,y.ZElevation=G.ZElevation,y.TotalZElevation=G.TotalZElevation),l&&(g.IsEffectEnabled=G.IsEffectEnabled,S.SetEffectEnabled=G.SetEffectEnabled,S.SetEffectParam=G.SetEffectParam),d&&(g.HasParent=G.HasParent,g.HasChildren=G.HasChildren,g.PickParent=G.PickParent,g.PickChildren=G.PickChildren,g.PickNthChild=G.PickNthChild,g.CompareChildCount=G.CompareChildCount,S.AddChild=G.AddChild,S.RemoveChild=G.RemoveChild,S.RemoveFromParent=G.RemoveFromParent,y.ChildCount=G.ChildCount,y.AllChildCount=G.AllChildCount),p&&(S.SetMeshSize=G.SetMeshSize,S.SetMeshPoint=G.SetMeshPoint,y.MeshColumns=G.MeshColumns,y.MeshRows=G.MeshRows),c&&(g.IsVisible=G.IsVisible,S.SetVisible=G.SetElementVisible,S.SetCSSStyle=G.SetElementCSSStyle,S.SetElemAttribute=G.SetElementAttribute,S.RemoveElemAttribute=G.RemoveElementAttribute),u&&(g.IsFocused=G.IsElementFocused,S.SetFocus=G.SetElementFocus,S.SetBlur=G.SetElementBlur),_&&(g.IsEnabled=G.IsElementEnabled,S.SetEnabled=G.SetElementEnabled),f&&(g.OnCollision=G.OnCollision,g.IsOverlapping=G.IsOverlapping,g.IsOverlappingOffset=G.IsOverlappingOffset,t.FinishCollisionCondition=I),i||(g.CompareInstanceVar=G.CompareInstanceVar,g.IsBoolInstanceVarSet=G.IsBoolInstanceVarSet,g.PickInstVarHiLow=G.PickInstVarHiLow,g.PickByUID=G.PickByUID,g.HasTags=G.HasTags,S.SetInstanceVar=G.SetInstanceVar,S.AddInstanceVar=G.AddInstanceVar,S.SubInstanceVar=G.SubInstanceVar,S.SetBoolInstanceVar=G.SetBoolInstanceVar,S.ToggleBoolInstanceVar=G.ToggleBoolInstanceVar,S.ChangeTags=G.ChangeTags,g.OnCreated=G.OnCreated,g.OnDestroyed=G.OnDestroyed,S.Destroy=G.Destroy,S.LoadFromJsonString||(S.LoadFromJsonString=G.LoadFromJsonString),y.AsJSON||(y.AsJSON=G.AsJSON),y.Count=G.Count,y.PickedCount=G.PickedCount,y.IID=G.GetIID,y.UID=G.GetUID,y.ObjectTypeName=G.ObjectTypeName,y.Tags=G.Tags,y.TagsCount=G.TagsCount,y.TagAt=G.TagAt,g.OnInstanceSignal=G.OnInstanceSignal,S.InstanceSignal=G.InstanceSignal,S.InstanceWaitForSignal=G.InstanceWaitForSignal),m&&(y.TemplateName=G.TemplateName)}}{const Zo=self.C3;Zo.ScheduledWait=class extends Zo.DefendedBase{constructor(e){super(),this._eventSheetManager=e,this._type=\"\",this._time=-1,this._signalTag=\"\",this._isSignalled=!1,this._event=null,this._actIndex=0,this._solModifiers=[],this._dynamicSolModifiers=null,this._sols=new Map,this._pendingInstances=null,this._callingFunctionBlock=null,this._asyncId=-1,this._functionParameters=null,this._functionInnerLocalVars=null,this._shouldRelease=!1}Release(){this._type=\"\",this._time=-1,this._signalTag=\"\",this._event=null,this._callingFunctionBlock=null,this._functionParameters=null,this._functionInnerLocalVars=null,this._asyncId=-1,Zo.clearArray(this._solModifiers),this._dynamicSolModifiers&&(this._dynamicSolModifiers.clear(),this._dynamicSolModifiers=null);for(const e of this._sols.values())e.Release();this._sols.clear(),this._pendingInstances=null}_Init(){const e=this._eventSheetManager,t=e.GetRuntime().GetAllObjectClasses(),s=e.GetCurrentEventStackFrame(),i=(this._event=s.GetCurrentEvent(),this._actIndex=s.GetActionIndex()+1,e.FindFirstFunctionBlockParent(this._event));i&&(this._callingFunctionBlock=i,this._functionParameters=i.CaptureFunctionParameters(),this._functionInnerLocalVars=i._GetAllInnerLocalVariables().map(e=>e.GetValue()),i.IsAsync())&&(this._asyncId=i.PauseCurrentAsyncFunction());for(const n of t){const a=n.GetCurrentSol();a.IsSelectAll()&&!this._event.HasSolModifier(n)||(this._solModifiers.push(n),this._sols.set(n,Zo.New(Zo.SolState,a)))}const r=e.GetDynamicSolModifiersSet();this._dynamicSolModifiers=0<r.size?r:null}InitTimer(e){this._type=\"timer\",this._Init(),this._time=this._eventSheetManager.GetRuntime().GetGameTime()+e}InitSignal(e){this._type=\"signal\",this._Init(),this._signalTag=e.toLowerCase()}InitInstanceSignals(e,t){this._type=\"instance-signals\",this._Init(),this._signalTag=t.toLowerCase(),this._pendingInstances=new Set(e)}InitPromise(e){this._type=\"promise\",this._Init(),e.then(()=>this.SetSignalled()).catch(e=>{console.warn(\"[C3 runtime] Promise rejected in 'Wait for previous actions to complete': \",e),this.SetSignalled()})}IsTimer(){return\"timer\"===this._type}IsSignal(){return\"signal\"===this._type}IsInstanceSignals(){return\"instance-signals\"===this._type}IsPromise(){return\"promise\"===this._type}GetSignalTag(){return this._signalTag}IsSignalled(){return this._isSignalled}SetSignalled(){this._isSignalled=!0}SetInstanceSignalled(e){this._pendingInstances.delete(e),0===this._pendingInstances.size&&this.SetSignalled()}_ShouldRun(){return this.IsTimer()?this._time<=this._eventSheetManager.GetRuntime().GetGameTime():this.IsSignalled()}_RestoreState(e){e._Restore(this._event,this._actIndex);for(const[s,i]of this._sols.entries()){const r=s.GetCurrentSol();i._Restore(r)}this._dynamicSolModifiers&&e.SetDynamicSolModifiers([...this._dynamicSolModifiers]);const t=this._callingFunctionBlock;t&&(t.SetFunctionParameters(this._functionParameters),t._GetAllInnerLocalVariables().map((e,t)=>e.SetValue(this._functionInnerLocalVars[t])),t.IsAsync())&&t.ResumeAsyncFunction(this._asyncId)}_Run(e){this._RestoreState(e),this._event._ResumeActionsAndSubEvents(e),this._callingFunctionBlock&&this._callingFunctionBlock.IsAsync()&&this._callingFunctionBlock.MaybeFinishAsyncFunctionCall(this._asyncId),this._eventSheetManager.ClearSol(this._solModifiers),this._shouldRelease=!0}async _DebugRun(e){this._RestoreState(e);for(const t of this._event._DebugResumeActionsAndSubEvents(e))await this._eventSheetManager.GetRuntime().DebugBreak(t);this._callingFunctionBlock&&this._callingFunctionBlock.IsAsync()&&this._callingFunctionBlock.MaybeFinishAsyncFunctionCall(this._asyncId),this._eventSheetManager.ClearSol(this._solModifiers),this._shouldRelease=!0}ShouldRelease(){return this._shouldRelease}RemoveInstances(e){for(const t of this._sols.values())t.RemoveInstances(e);if(\"instance-signals\"===this._type){for(const s of e)this._pendingInstances.delete(s);0===this._pendingInstances.size&&this.SetSignalled()}}_SaveToJson(){const e={},t={wt:this._type,t:this._time,st:this._signalTag,s:this._isSignalled,ev:this._event.GetSID(),sm:this._solModifiers.map(e=>e.GetSID()),dsm:this._dynamicSolModifiers?[...this._dynamicSolModifiers].map(e=>e.GetSID()):null,sols:e};this._event._HasActionIndex(this._actIndex)&&(t.act=this._event.GetActionAt(this._actIndex).GetSID());for(const[s,i]of this._sols)e[s.GetSID().toString()]=i._SaveToJson();return\"instance-signals\"===this._type&&(t.pi=[...this._pendingInstances].map(e=>e.GetUID())),t}static _CreateFromJson(e,t){const s=e.GetRuntime(),i=e.GetEventBlockBySID(t.ev);if(!i)return null;let r=0;if(t.hasOwnProperty(\"act\")){const a=e.GetActionBySID(t.act);if(!a)return null;r=a.GetIndex()}const n=Zo.New(Zo.ScheduledWait,e);n._time=t.t,t.hasOwnProperty(\"wt\")?n._type=t.wt:n._type=-1===n._time?\"signal\":\"timer\",n._signalTag=t.st,n._isSignalled=t.s,n._event=i,n._actIndex=r;for(const o of t.sm){const h=s.GetObjectClassBySID(o);h&&n._solModifiers.push(h)}if(Array.isArray(t.dsm))for(const l of t.dsm){const c=s.GetObjectClassBySID(l);c&&(n._dynamicSolModifiers||(n._dynamicSolModifiers=new Set),n._dynamicSolModifiers.add(c))}for(const[u,_]of Object.entries(t.sols)){const d=parseInt(u,10),p=s.GetObjectClassBySID(d);if(p){const f=Zo.New(Zo.SolState,null);f._LoadFromJson(e,_),n._sols.set(p,f)}}if(\"instance-signals\"===n._type){n._pendingInstances=new Set;for(const m of t.pi){const g=s.GetInstanceByUID(m);g&&n._pendingInstances.add(g)}}return n}}}{const Qo=self.C3;Qo.SolState=class extends Qo.DefendedBase{constructor(e){super(),this._objectClass=null,this._isSelectAll=!0,this._instances=[],e&&(this._objectClass=e.GetObjectClass(),this._isSelectAll=e.IsSelectAll(),Qo.shallowAssignArray(this._instances,e._GetOwnInstances()))}Release(){this._objectClass=null,Qo.clearArray(this._instances)}_Restore(e){e._SetSelectAll(this._isSelectAll),Qo.shallowAssignArray(e._GetOwnInstances(),this._instances)}RemoveInstances(e){Qo.arrayRemoveAllInSet(this._instances,e)}_SaveToJson(){return{sa:this._isSelectAll,insts:this._instances.map(e=>e.GetUID())}}_LoadFromJson(e,t){const s=e.GetRuntime();this._isSelectAll=!!t.sa,Qo.clearArray(this._instances);for(const i of t.insts){const r=s.GetInstanceByUID(i);r&&this._instances.push(r)}}}}{let l=function(e,t){let s=e.get(t);return s||(s=new Map,e.set(t,s)),s};l;const $o=self.C3;$o.SDKPluginBase=class extends $o.DefendedBase{constructor(e){super(),this._runtime=e.runtime,this._isSingleGlobal=!!e.isSingleGlobal,this._isWorldType=!!e.isWorld,this._isRotatable=!!e.isRotatable,this._mustPredraw=!!e.mustPredraw,this._hasEffects=!!e.hasEffects,this._supportsSceneGraph=!!e.supportsSceneGraph,this._supportsMesh=!!e.supportsMesh,this._isHTMLElementType=!!e.isHTMLElementType,this._is3d=!!e.is3d,this._sdkVersion=e.sdkVersion,this._singleGlobalObjectClass=null,this._boundACEMethodCache=new Map,this._boundACEMethodCache_1param=new Map,this._boundACEMethodCache_2params=new Map,this._boundACEMethodCache_3params=new Map,this._scriptInterfaceClass=e.scriptInterfaceClass,this._iPlugin=null}Release(){this._runtime=null}GetRuntime(){return this._runtime}OnCreate(){}GetConstructor(){return(2<=this.GetSdkVersion()?this._iPlugin:this).constructor}GetSdkVersion(){return this._sdkVersion}GetScriptInterfaceClass(e=!1){let t=this._scriptInterfaceClass;return e&&\"function\"!=typeof t&&2<=this.GetSdkVersion()?globalThis.ISDKPluginBase:t}IsSingleGlobal(){return this._isSingleGlobal}IsWorldType(){return this._isWorldType}IsHTMLElementType(){return this._isHTMLElementType}Is3D(){return this._is3d}IsRotatable(){return this._isRotatable}MustPreDraw(){return this._mustPredraw}HasEffects(){return this._hasEffects}SupportsSceneGraph(){return this._supportsSceneGraph}SupportsMesh(){return this._supportsMesh}_GetBoundACEMethod(e,t){if(!t)throw new Error(\"missing 'this' binding\");let s=this._boundACEMethodCache.get(e);return s||(s=e.bind(t),this._boundACEMethodCache.set(e,s)),s}_GetBoundACEMethod_1param(e,t,s){if(!t)throw new Error(\"missing 'this' binding\");let i=l(this._boundACEMethodCache_1param,e),r=i.get(s);return r||(r=e.bind(t,s),i.set(s,r)),r}_GetBoundACEMethod_2params(e,t,s,i){if(!t)throw new Error(\"missing 'this' binding\");let r=l(this._boundACEMethodCache_2params,e),n=l(r,s),a=n.get(i);return a||(a=e.bind(t,s,i),n.set(i,a)),a}_GetBoundACEMethod_3params(e,t,s,i,r){if(!t)throw new Error(\"missing 'this' binding\");let n=l(this._boundACEMethodCache_3params,e),a=l(n,s),o=l(a,i),h=o.get(r);return h||(h=e.bind(t,s,i,r),o.set(r,h)),h}_SetSingleGlobalObjectClass(e){if(!this.IsSingleGlobal())throw new Error(\"must be single-global plugin\");this._singleGlobalObjectClass=e}GetSingleGlobalObjectClass(){if(this.IsSingleGlobal())return this._singleGlobalObjectClass;throw new Error(\"must be single-global plugin\")}GetSingleGlobalInstance(){if(this.IsSingleGlobal())return this._singleGlobalObjectClass.GetSingleGlobalInstance();throw new Error(\"must be single-global plugin\")}_InitScriptInterface(){const e=this.GetSdkVersion(),t=($o.AddonManager._PushInitObject(this,e),this.GetScriptInterfaceClass(!0));if(t){if(this._iPlugin=new t,!(this._iPlugin instanceof self.IPlugin))throw new TypeError(\"plugin class must derive from IPlugin\")}else this._iPlugin=new self.IPlugin;$o.AddonManager._PopInitObject(e)}GetIPlugin(){return this._iPlugin}}}{const eh=self.C3;eh.SDKDOMPluginBase=class extends eh.SDKPluginBase{constructor(e,t){super(e),this._domComponentId=t,this._nextElementId=0,this._instMap=new Map,this.AddElementMessageHandler(\"elem-focused\",e=>e._OnElemFocused()),this.AddElementMessageHandler(\"elem-blurred\",e=>{e&&e._OnElemBlurred()})}Release(){super.Release()}_AddElement(e){const t=this._nextElementId++;return this._instMap.set(t,e),t}_RemoveElement(e){this._instMap.delete(e)}AddElementMessageHandler(e,s){this._runtime.AddDOMComponentMessageHandler(this._domComponentId,e,e=>{const t=this._instMap.get(e.elementId);s(t,e)})}}}{const th=self.C3;th.SDKTypeBase=class extends th.DefendedBase{constructor(e){super(),this._objectClass=e,this._runtime=e.GetRuntime(),this._plugin=e.GetPlugin()}Release(){this._objectClass=null,this._runtime=null,this._plugin=null}GetObjectClass(){return this._objectClass}GetRuntime(){return this._runtime}GetPlugin(){return this._plugin}GetImageInfo(){return this._objectClass.GetImageInfo()}OnCreate(){}FinishCondition(e){}BeforeRunAction(e){}AfterRunAction(e){}LoadTextures(e){}ReleaseTextures(){}OnDynamicTextureLoadComplete(){}PreloadTexturesWithInstances(e){}LoadTilemapData(){}GetScriptInterfaceClass(){return null}DispatchScriptEvent(e,t,s){const i=th.New(th.Event,e,t);i.objectClass=this,s&&Object.assign(i,s),this.GetObjectClass().DispatchUserScriptEvent(i)}}}{const sh=self.C3;sh.SDKInstanceBase=class extends sh.DefendedBase{constructor(e,t){super(),this._inst=e,this._domComponentId=t,this._wrapperComponentId=null,this._runtime=e.GetRuntime(),this._objectClass=this._inst.GetObjectClass(),this._sdkType=this._objectClass.GetSdkType(),this._tickFunc=null,this._tick2Func=null,this._isTicking=!1,this._isTicking2=!1,this._disposables=null,this._wasReleased=!1}Release(){this._wasReleased=!0,this._StopTicking(),this._StopTicking2(),this._tickFunc=null,this._tick2Func=null,this._disposables&&(this._disposables.Release(),this._disposables=null),this._inst=null,this._runtime=null,this._objectClass=null,this._sdkType=null}WasReleased(){return this._wasReleased}GetInstance(){return this._inst}GetRuntime(){return this._runtime}GetObjectClass(){return this._objectClass}GetPlugin(){return this._sdkType.GetPlugin()}GetSdkType(){return this._sdkType}GetScriptInterface(){return this._inst.GetInterfaceClass()}Trigger(e){return this._runtime.Trigger(e,this._inst,null)}DebugTrigger(e){return this._runtime.DebugTrigger(e,this._inst,null)}TriggerAsync(e){return this._runtime.TriggerAsync(e,this._inst,null)}FastTrigger(e,t){return this._runtime.FastTrigger(e,this._inst,t)}DebugFastTrigger(e,t){return this._runtime.DebugFastTrigger(e,this._inst,t)}ScheduleTriggers(e){return this._runtime.ScheduleTriggers(e)}AddDOMMessageHandler(e,t){this._runtime.AddDOMComponentMessageHandler(this._domComponentId,e,t)}AddDOMMessageHandlers(e){for(const[t,s]of e)this.AddDOMMessageHandler(t,s)}PostToDOM(e,t){this._runtime.PostComponentMessageToDOM(this._domComponentId,e,t)}PostToDOMAsync(e,t){return this._runtime.PostComponentMessageToDOMAsync(this._domComponentId,e,t)}_PostToDOMMaybeSync(e,t){if(!this._runtime.IsInWorker())return window.c3_runtimeInterface._OnMessageFromRuntime({type:\"event\",component:this._domComponentId,handler:e,data:t,responseId:null});this.PostToDOM(e,t)}SetWrapperExtensionComponentId(e){if(!e)throw new Error(\"cannot set empty component id\");this._wrapperComponentId=e}IsWrapperExtensionAvailable(){if(this._wrapperComponentId)return this._runtime.HasWrapperComponentId(this._wrapperComponentId);throw new Error(\"wrapper extension component id not set\")}AddWrapperExtensionMessageHandler(e,t){if(!this._wrapperComponentId)throw new Error(\"wrapper extension component id not set\");this._runtime.AddWrapperExtensionMessageHandler(this._wrapperComponentId,e,t)}AddWrapperExtensionMessageHandlers(e){for(const[t,s]of e)this.AddWrapperExtensionMessageHandler(t,s)}SendWrapperExtensionMessage(e,t){if(!this._wrapperComponentId)throw new Error(\"wrapper extension component id not set\");this._runtime.SendWrapperExtensionMessage(this._wrapperComponentId,e,t)}SendWrapperExtensionMessageAsync(e,t){if(this._wrapperComponentId)return this._runtime.SendWrapperExtensionMessageAsync(this._wrapperComponentId,e,t);throw new Error(\"wrapper extension component id not set\")}Tick(){}Tick2(){}_StartTicking(){this._isTicking||(this._tickFunc||(this._tickFunc=()=>this.Tick()),this._runtime.Dispatcher().addEventListener(\"tick\",this._tickFunc),this._isTicking=!0)}_StopTicking(){this._isTicking&&(this._runtime.Dispatcher().removeEventListener(\"tick\",this._tickFunc),this._isTicking=!1)}IsTicking(){return this._isTicking}_StartTicking2(){this._isTicking2||(this._tick2Func||(this._tick2Func=()=>this.Tick2()),this._runtime.Dispatcher().addEventListener(\"tick2\",this._tick2Func),this._isTicking2=!0)}_StopTicking2(){this._isTicking2&&(this._runtime.Dispatcher().removeEventListener(\"tick2\",this._tick2Func),this._isTicking2=!1)}IsTicking2(){return this._isTicking2}GetDebuggerProperties(){return[]}SaveToJson(){return null}LoadFromJson(e){}GetPropertyValueByIndex(e){}SetPropertyValueByIndex(e,t){}OffsetPropertyValueByIndex(e,t,s){if(0!==t){const i=this.GetPropertyValueByIndex(e);if(\"number\"!=typeof i)throw new Error(\"expected number\");this.SetPropertyValueByIndex(e,i+t,s)}}SetPropertyColorOffsetValueByIndex(e,t,s,i){}CallAction(e,...t){e.call(this,...t)}CallExpression(e,...t){return e.call(this,...t)}GetScriptInterfaceClass(){return null}DispatchScriptEvent(e,t,s){if(this._inst.HasScriptInterface()){const i=this.GetScriptInterface(),r=sh.New(sh.Event,e,t);r.instance=i,s&&Object.assign(r,s),i.dispatchEvent(r)}}MustPreDraw(){return!1}}}{const ih=self.C3;ih.SDKWorldInstanceBase=class extends ih.SDKInstanceBase{constructor(e,t){super(e,t),this._worldInfo=e.GetWorldInfo(),this._renderercontextlost_handler=null,this._renderercontextrestored_handler=null}Release(){if(this._renderercontextlost_handler){const e=this._runtime.Dispatcher();e.removeEventListener(\"renderercontextlost\",this._renderercontextlost_handler),e.removeEventListener(\"renderercontextrestored\",this._renderercontextrestored_handler),this._renderercontextlost_handler=null,this._renderercontextrestored_handler=null}this._worldInfo=null,super.Release()}HandleWebGLContextLoss(){this.HandleRendererContextLoss()}OnWebGLContextLost(){}OnWebGLContextRestored(){}HandleRendererContextLoss(){if(!this._renderercontextlost_handler){this._renderercontextlost_handler=()=>this.OnRendererContextLost(),this._renderercontextrestored_handler=()=>this.OnRendererContextRestored();const e=this._runtime.Dispatcher();e.addEventListener(\"renderercontextlost\",this._renderercontextlost_handler),e.addEventListener(\"renderercontextrestored\",this._renderercontextrestored_handler)}}OnRendererContextLost(){this.OnWebGLContextLost()}OnRendererContextRestored(){this.OnWebGLContextRestored()}GetWorldInfo(){return this._worldInfo}IsOriginalSizeKnown(){return!1}GetOriginalWidth(){if(!this.IsOriginalSizeKnown())throw new Error(\"original size not known\");const e=this.GetCurrentImageInfo();if(e)return e.GetWidth()}GetOriginalHeight(){if(!this.IsOriginalSizeKnown())throw new Error(\"original size not known\");const e=this.GetCurrentImageInfo();if(e)return e.GetHeight()}GetCurrentImageInfo(){return null}GetCurrentSurfaceSize(){const e=this.GetCurrentImageInfo();if(e){const t=e.GetTexture();if(t)return[t.GetWidth(),t.GetHeight()]}return[100,100]}GetCurrentTexRect(){const e=this.GetCurrentImageInfo();return e?e.GetTexRect():null}GetCurrentTexQuad(){const e=this.GetCurrentImageInfo();return e?e.GetTexQuad():null}IsCurrentTexRotated(){const e=this.GetCurrentImageInfo();return!!e&&e.IsRotated()}GetImagePoint(e){const t=this._inst.GetWorldInfo();return[t.GetX(),t.GetY(),t.GetTotalZElevation()]}LoadTilemapData(e,t,s){}TestPointOverlapTile(e,t){}RendersToOwnZPlane(){return!0}}}{const rh=self.C3,nh=rh.New(rh.Rect);rh.SDKDOMInstanceBase=class extends rh.SDKWorldInstanceBase{constructor(e,t){super(e,t),this._elementId=this.GetPlugin()._AddElement(this),this._isElementShowing=!0,this._elemHasFocus=!1,this._autoFontSize=!1,this._autoFontSizeOffset=-.2,this._lastRect=rh.New(rh.Rect,0,0,-1,-1);const s=this._runtime.GetCanvasManager();this._lastWindowWidth=s.GetLastWidth(),this._lastWindowHeight=s.GetLastHeight(),this._lastHTMLIndex=-1,this._lastHTMLZIndex=-1,this._isPendingUpdateState=!1,this._StartTicking()}Release(){this.GetPlugin()._RemoveElement(this._elementId),this.PostToDOMElement(\"destroy\"),this._elementId=-1,super.Release()}_GetElementInDOMMode(){if(this._runtime.IsInWorker())throw new Error(\"not valid in worker mode\");return this._PostToDOMElementMaybeSync(\"get-element\")}PostToDOMElement(e,t){(t=t||{}).elementId=this._elementId,this.PostToDOM(e,t)}_PostToDOMElementMaybeSync(e,t){return(t=t||{}).elementId=this._elementId,this._PostToDOMMaybeSync(e,t)}PostToDOMElementAsync(e,t){return(t=t||{}).elementId=this._elementId,this.PostToDOMAsync(e,t)}CreateElement(e){e=e||{};const t=this.GetWorldInfo();e.elementId=this._elementId,e.isVisible=t.IsVisible(),e.htmlIndex=t.GetLayer().GetHTMLIndex(),e.htmlZIndex=t.GetHTMLZIndex(),Object.assign(e,this.GetElementState()),this._isElementShowing=!!e.isVisible,this._PostToDOMMaybeSync(\"create\",e),this._UpdatePosition(!0)}SetElementVisible(e){this._isElementShowing!==(e=!!e)&&(this._isElementShowing=e,this.PostToDOMElement(\"set-visible\",{isVisible:e}))}Tick(){this._UpdatePosition(!1)}_ShouldPreserveElement(){const e=this._runtime.GetCanvasManager().GetFullscreenMode();return\"Android\"===rh.Platform.OS&&(\"scale-inner\"===e||\"scale-outer\"===e||\"crop\"===e)}_UpdatePosition(c){if(!this.GetInstance().IsDestroyed()){let e=this.GetWorldInfo(),t=e.GetLayer(),s=e.GetBoundingBox(),[i,r]=t.LayerToCanvasCss(s.getLeft(),s.getTop()),[n,a]=t.LayerToCanvasCss(s.getRight(),s.getBottom()),o=this._runtime.GetCanvasManager(),h=o.GetCssWidth(),l=o.GetCssHeight();if(e.IsVisible()&&t.IsVisible())if(!this._ShouldPreserveElement()&&(n<=0||a<=0||h<=i||l<=r))this.SetElementVisible(!1);else{nh.set(i,r,n,a);const u=o.GetLastWidth(),_=o.GetLastHeight(),d=t.GetHTMLIndex(),p=e.GetHTMLZIndex();if(!c&&nh.equals(this._lastRect)&&this._lastWindowWidth===u&&this._lastWindowHeight===_&&this._lastHTMLIndex===d&&this._lastHTMLZIndex===p)this.SetElementVisible(!0);else{this._lastRect.copy(nh),this._lastWindowWidth=u,this._lastWindowHeight=_,this._lastHTMLIndex=d,this._lastHTMLZIndex=p,this.SetElementVisible(!0);let e=null;this._autoFontSize&&(e=t.GetDisplayScale()+this._autoFontSizeOffset),this.PostToDOMElement(\"update-position\",{left:Math.round(this._lastRect.getLeft()),top:Math.round(this._lastRect.getTop()),width:Math.round(this._lastRect.width()),height:Math.round(this._lastRect.height()),htmlIndex:d,htmlZIndex:p,fontSize:e})}}else this.SetElementVisible(!1)}}FocusElement(){this._PostToDOMElementMaybeSync(\"focus\",{focus:!0})}BlurElement(){this._PostToDOMElementMaybeSync(\"focus\",{focus:!1})}_OnElemFocused(){this._elemHasFocus=!0}_OnElemBlurred(){this._elemHasFocus=!1}IsElementFocused(){return this._elemHasFocus}SetElementCSSStyle(e,t){this.PostToDOMElement(\"set-css-style\",{prop:rh.CSSToCamelCase(e),val:t})}SetElementAttribute(e,t){this.PostToDOMElement(\"set-attribute\",{name:e,val:t})}RemoveElementAttribute(e){this.PostToDOMElement(\"remove-attribute\",{name:e})}UpdateElementState(){this._isPendingUpdateState||(this._isPendingUpdateState=!0,Promise.resolve().then(()=>{this._isPendingUpdateState=!1,this.PostToDOMElement(\"update-state\",this.GetElementState())}))}GetElementState(){}GetElementId(){return this._elementId}}}{const ah=self.C3,oh=self.IBehavior;ah.SDKBehaviorBase=class extends ah.DefendedBase{constructor(e){super(),this._runtime=e.runtime,this._myObjectClasses=ah.New(ah.ArraySet),this._myInstances=ah.New(ah.ArraySet),this._sdkVersion=e.sdkVersion,this._scriptInterfaceClass=e.scriptInterfaceClass,this._iBehavior=null}Release(){this._myInstances.Release(),this._myObjectClasses.Release(),this._runtime=null}GetRuntime(){return this._runtime}OnCreate(){}GetSdkVersion(){return this._sdkVersion}GetScriptInterfaceClass(e=!1){let t=this._scriptInterfaceClass;return e&&\"function\"!=typeof t&&2<=this.GetSdkVersion()?globalThis.ISDKBehaviorBase:t}_AddObjectClass(e){this._myObjectClasses.Add(e)}GetObjectClasses(){return this._myObjectClasses.GetArray()}_AddInstance(e){this._myInstances.Add(e)}_RemoveInstance(e){this._myInstances.Delete(e)}GetInstances(){return this._myInstances.GetArray()}_InitScriptInterface(){const e=this.GetSdkVersion(),t=(ah.AddonManager._PushInitObject(this,e),this.GetScriptInterfaceClass(!0));if(t){if(this._iBehavior=new t,!(this._iBehavior instanceof oh))throw new TypeError(\"behavior class must derive from IBehavior\")}else this._iBehavior=new oh;ah.AddonManager._PopInitObject(e)}GetIBehavior(){return this._iBehavior}}}{const hh=self.C3;hh.SDKBehaviorTypeBase=class extends hh.DefendedBase{constructor(e){super(),this._runtime=e.GetRuntime(),this._behaviorType=e,this._objectClass=e.GetObjectClass(),this._behavior=e.GetBehavior(),this._behavior._AddObjectClass(this._objectClass)}Release(){this._runtime=null,this._behaviorType=null,this._objectClass=null,this._behavior=null}OnCreate(){}GetBehaviorType(){return this._behaviorType}GetObjectClass(){return this._objectClass}GetRuntime(){return this._runtime}GetBehavior(){return this._behavior}}}{const lh=self.C3;lh.SDKBehaviorInstanceBase=class extends lh.DefendedBase{constructor(e,t){super(),this._behInst=e,this._domComponentId=t,this._inst=e.GetObjectInstance(),this._runtime=e.GetRuntime(),this._behaviorType=e.GetBehaviorType(),this._sdkType=this._behaviorType.GetSdkType(),this._isTicking=!1,this._isTicking2=!1,this._isPostTicking=!1,this._disposables=null}Release(){this._StopTicking(),this._StopTicking2(),this._StopPostTicking(),this._disposables&&(this._disposables.Release(),this._disposables=null),this._behInst=null,this._inst=null,this._runtime=null,this._behaviorType=null,this._sdkType=null}GetBehavior(){return this._behaviorType.GetBehavior()}GetBehaviorInstance(){return this._behInst}GetObjectInstance(){return this._inst}GetObjectClass(){return this._inst.GetObjectClass()}GetWorldInfo(){return this._inst.GetWorldInfo()}GetRuntime(){return this._runtime}GetBehaviorType(){return this._behaviorType}GetSdkType(){return this._sdkType}GetScriptInterface(){return this._behInst.GetScriptInterface()}Trigger(e){return this._runtime.Trigger(e,this._inst,this._behaviorType)}DebugTrigger(e){return this._runtime.DebugTrigger(e,this._inst,this._behaviorType)}TriggerAsync(e){return this._runtime.TriggerAsync(e,this._inst,this._behaviorType)}PostCreate(){}Tick(){}Tick2(){}PostTick(){}_StartTicking(){this._isTicking||(this._runtime._AddBehInstToTick(this),this._isTicking=!0)}_StopTicking(){this._isTicking&&(this._runtime._RemoveBehInstToTick(this),this._isTicking=!1)}IsTicking(){return this._isTicking}_StartTicking2(){this._isTicking2||(this._runtime._AddBehInstToTick2(this),this._isTicking2=!0)}_StopTicking2(){this._isTicking2&&(this._runtime._RemoveBehInstToTick2(this),this._isTicking2=!1)}IsTicking2(){return this._isTicking2}_StartPostTicking(){this._isPostTicking||(this._runtime._AddBehInstToPostTick(this),this._isPostTicking=!0)}_StopPostTicking(){this._isPostTicking&&(this._runtime._RemoveBehInstToPostTick(this),this._isPostTicking=!1)}IsPostTicking(){return this._isPostTicking}GetDebuggerProperties(){return[]}AddDOMMessageHandler(e,t){this._runtime.AddDOMComponentMessageHandler(this._domComponentId,e,t)}OnSpriteFrameChanged(e,t){}SaveToJson(){return null}LoadFromJson(e){}GetPropertyValueByIndex(e){}SetPropertyValueByIndex(e,t){}OffsetPropertyValueByIndex(e,t){if(0!==t){const s=this.GetPropertyValueByIndex(e);if(\"number\"!=typeof s)throw new Error(\"expected number\");this.SetPropertyValueByIndex(e,s+t)}}SetPropertyColorOffsetValueByIndex(e,t,s,i){}CallAction(e,...t){e.call(this,...t)}CallExpression(e,...t){return e.call(this,...t)}GetScriptInterfaceClass(){return null}DispatchScriptEvent(e,t,s){if(this._behInst.HasScriptInterface()){const i=this.GetScriptInterface(),r=lh.New(lh.Event,e,t);r.behaviorInstance=i,r.instance=i.instance,s&&Object.assign(r,s),i.dispatchEvent(r)}}}}{let t=function(e){if(e!==s)throw new Error(\"invalid internal API token\")},n=(t,self.C3),s=(n.Plugins={},n.Behaviors={},n._GetInternalAPIToken()),i=[],r=[],a=[],o=null,h=null,e=null,l=null,c=new Map,u=new Map;n.AddonManager=class extends n.DefendedBase{constructor(e,t){super(),this._runtime=e,this._allPlugins=[],this._systemPlugin=null,this._allBehaviors=[],this._delayCreateBehaviors=new Map,this._solidBehavior=null,this._jumpthruBehavior=null,this._wrapperComponentIds=new Set(t)}CreatePlugin(e){const t=e[19],s=this._runtime.GetObjectReference(e[0]);if(!s)throw new Error(\"missing plugin\");n.AddCommonACEs(e,s,t);const i=2<=t?n.SDKPluginBase:s,r=n.New(i,{runtime:this._runtime,isSingleGlobal:e[1],isWorld:e[2],isRotatable:e[5],hasEffects:e[8],mustPredraw:e[9],supportsSceneGraph:e[13],supportsMesh:e[14],isHTMLElementType:e[17],is3d:e[18],sdkVersion:t,scriptInterfaceClass:2<=t?s:null});r.OnCreate(),this._allPlugins.push(r),c.set(s,r)}CreateSystemPlugin(){this._systemPlugin=n.New(n.Plugins.System,{runtime:this._runtime,isSingleGlobal:!0}),this._systemPlugin.OnCreate()}CreateBehavior(e){const s=e[1],i=this._runtime.GetObjectReference(e[0]);if(!i)throw new Error(\"missing behavior\");this._delayCreateBehaviors.set(i,()=>{const e=2<=s?n.SDKBehaviorBase:i,t=n.New(e,{runtime:this._runtime,sdkVersion:s,scriptInterfaceClass:2<=s?i:null});t.OnCreate(),this._allBehaviors.push(t),u.set(i,t),!this._solidBehavior&&n.Behaviors.solid&&t instanceof n.Behaviors.solid?this._solidBehavior=t:!this._jumpthruBehavior&&n.Behaviors.jumpthru&&t instanceof n.Behaviors.jumpthru&&(this._jumpthruBehavior=t),t._InitScriptInterface()})}_DelayCreateBehavior(e){const t=this._delayCreateBehaviors.get(e);t&&(t(),this._delayCreateBehaviors.delete(e))}static _PushInitObject(e,t=1){if(n.AddonManager._PushInitObject!==o)throw new Error(\"invalid method\");1===t&&i.push(e),r.push(e)}static _PopInitObject(e=1){if(n.AddonManager._PopInitObject!==h)throw new Error(\"invalid method\");1===e&&i.pop(),r.pop()}static _GetInitObject(){if(n.AddonManager._GetInitObject!==e)throw new Error(\"invalid method\");if(0===i.length)throw new Error(\"no init object set\");return i.at(-1)}static _GetInitObject2(e){if(n.AddonManager._GetInitObject2!==l)throw new Error(\"invalid method\");if(t(e),0===r.length)throw new Error(\"no init object set\");return r.at(-1)}static _PushInitProperties(e){a.push(e)}static _PopInitProperties(){a.pop()}static _GetInitProperties(){if(0===a.length)throw new Error(\"no init properties set\");return a.at(-1)}_InitAddonScriptInterfaces(){for(const e of this._allPlugins)e._InitScriptInterface()}static GetPluginByConstructorFunction(e){return c.get(e)||null}static GetBehaviorByConstructorFunction(e){return u.get(e)||null}GetSystemPlugin(){return this._systemPlugin}GetSolidBehavior(){return this._solidBehavior}GetJumpthruBehavior(){return this._jumpthruBehavior}HasWrapperComponentId(e){return this._wrapperComponentIds.has(e)}},o=n.AddonManager._PushInitObject,h=n.AddonManager._PopInitObject,e=n.AddonManager._GetInitObject,l=n.AddonManager._GetInitObject2}{const ch=self.C3,uh=new Set;ch.ImageInfo=class extends ch.DefendedBase{constructor(){super(),this._generation=0,this._url=\"\",this._size=0,this._offsetX=0,this._offsetY=0,this._width=0,this._height=0,this._isRotated=!1,this._hasMetaData=!1,this._imageAsset=null,this._textureState=\"\",this._rcTex=ch.New(ch.Rect),this._quadTex=ch.New(ch.Quad),this._blobUrl=\"\",this._iImageInfo=new self.IImageInfo(this),uh.add(this)}Release(){this.ReleaseTexture(),this._imageAsset&&0===this._imageAsset.GetRefCount()&&this._imageAsset.Release(),this._imageAsset=null,uh.delete(this),this.ReleaseBlobURL()}static OnRendererContextLost(){for(const e of uh)e._textureState=\"\",e._rcTex.set(0,0,0,0),e._quadTex.setFromRect(e._rcTex)}LoadData(e){this._url=e[0],this._size=e[1],this._offsetX=e[2],this._offsetY=e[3],this._width=e[4],this._height=e[5],this._isRotated=e[6],this._hasMetaData=!0}LoadDynamicAsset(e,t){if(this._imageAsset)throw new Error(\"already loaded asset\");this._url=t;const s={};return ch.IsAbsoluteURL(t)&&(s.loadPolicy=\"remote\"),this.LoadAsset(e,s),this._imageAsset.Load()}LoadDynamicBlobAsset(e,t){if(this._imageAsset)throw new Error(\"already loaded asset\");this._url=\"\",this._size=t.size,this._imageAsset=ch.New(ch.ImageAsset,e.GetAssetManager(),{blob:t,size:this._size,loadPolicy:\"local\"})}ReplaceWith(e){if(e===this)throw new Error(\"cannot replace with self\");this._generation++,this.ReleaseTexture(),this._url=e._url,this._size=e._size,this._offsetX=e._offsetX,this._offsetY=e._offsetY,this._width=e._width,this._height=e._height,this._isRotated=e._isRotated,this._hasMetaData=e._hasMetaData,this._imageAsset=e._imageAsset,this._textureState=e._textureState,this._rcTex=e._rcTex,this._quadTex=e._quadTex,this.ReleaseBlobURL()}GetURL(){return this._url}GetSize(){return this._size}GetOffsetX(){return this._offsetX}GetOffsetY(){return this._offsetY}IsRotated(){return this._isRotated}GetWidth(){return this._width}GetHeight(){return this._height}GetSheetWidth(){return this._imageAsset.GetWidth()}GetSheetHeight(){return this._imageAsset.GetHeight()}LoadAsset(e,t){if(this._imageAsset)throw new Error(\"already got asset\");t=Object.assign({},t,{url:this.GetURL(),size:this.GetSize()}),this._imageAsset=e.LoadImage(t)}IsLoaded(){return this._imageAsset&&this._imageAsset.IsLoaded()}async LoadStaticTexture(e,t){if(!this._imageAsset)throw new Error(\"no asset\");if(this._textureState)throw new Error(\"already loaded texture\");const s=this._generation,i=(this._textureState=\"loading\",await this._imageAsset.LoadStaticTexture(e,t));if(this._generation!==s)return null;if(!i)return this._textureState=\"\",null;this._textureState=\"loaded\",this._hasMetaData||(this._width=i.GetWidth(),this._height=i.GetHeight(),this._hasMetaData=!0);const r=this._isRotated?this._height:this._width,n=this._isRotated?this._width:this._height;return this._rcTex.set(this._offsetX,this._offsetY,this._offsetX+r,this._offsetY+n),this._rcTex.divide(i.GetWidth(),i.GetHeight()),this._quadTex.setFromRect(this._rcTex),this._isRotated&&this._quadTex.rotatePointsAnticlockwise(),i}ReleaseTexture(){this._textureState&&(this._imageAsset&&this._imageAsset.ReleaseTexture(),this._textureState=\"\",this._rcTex.set(0,0,0,0),this._quadTex.setFromRect(this._rcTex))}GetTexture(){return this._imageAsset&&\"loaded\"===this._textureState?this._imageAsset.GetTexture():null}GetTexRect(){return this._rcTex}GetTexQuad(){return this._quadTex}GetIImageInfo(){return this._iImageInfo}GetImageAsset(){return this._imageAsset}async ExtractImageToCanvas(e){e=e||await this._imageAsset.LoadToDrawable();const t=ch.CreateCanvas(this._width,this._height),s=t.getContext(\"2d\");return this._isRotated?(s.rotate(Math.PI/-2),s.translate(-this._height,0),s.drawImage(e,this._offsetX,this._offsetY,this._height,this._width,0,0,this._height,this._width)):s.drawImage(e,this._offsetX,this._offsetY,this._width,this._height,0,0,this._width,this._height),t}async ExtractImageToBlobURL(e){if(!this._blobUrl){const t=await this.ExtractImageToCanvas(e),s=await ch.CanvasToBlob(t);this._blobUrl=URL.createObjectURL(s)}return this._blobUrl}ReleaseBlobURL(){this._blobUrl&&(URL.revokeObjectURL(this._blobUrl),this._blobUrl=\"\")}}}{const _h=self.C3;_h.AnimationInfo=class extends _h.DefendedBase{constructor(e){super(),this._name=e[0],this._speed=e[1],this._isLooping=!!e[2],this._repeatCount=e[3],this._repeatTo=e[4],this._isPingPong=!!e[5],this._sid=e[6],this._frames=e[7].map(e=>_h.New(_h.AnimationFrameInfo,e)),this._iAnimation=new self.IAnimation(this)}static CreateDynamic(e,t){const s=_h.New(_h.AnimationInfo,[t,0,!1,0,0,!1,Math.floor(1e15*Math.random()),[]]);return s._frames.push(_h.AnimationFrameInfo.CreateDynamic(e)),s}Release(){for(const e of this._frames)e.Release();_h.clearArray(this._frames)}LoadAllAssets(e){for(const t of this._frames)t.GetImageInfo().LoadAsset(e)}LoadAllTextures(t,s){return Promise.all(this._frames.map(e=>e.GetImageInfo().LoadStaticTexture(t,s)))}ReleaseAllTextures(){for(const e of this._frames)e.GetImageInfo().ReleaseTexture()}GetName(){return this._name}GetSID(){return this._sid}GetFrameCount(){return this._frames.length}GetFrames(){return this._frames}GetFrameAt(e){if((e=Math.floor(e))<0||e>=this._frames.length)throw new RangeError(\"invalid frame\");return this._frames[e]}InsertFrameAt(e,t){(t=Math.floor(t))<0?this._frames.unshift(e):t>=this._frames.length?this._frames.push(e):this._frames.splice(t,0,e)}RemoveFrameAt(e){if((e=Math.floor(e))<0||e>=this._frames.length)throw new RangeError(\"invalid frame\");this._frames[e].Release(),this._frames.splice(e,1)}GetFrameIndexByTag(s){for(let e=0,t=this._frames.length;e<t;++e)if(_h.equalsNoCase(this._frames[e].GetTag(),s))return e;return-1}FrameTagOrIndexToIndex(e){if(\"string\"!=typeof e)return e;{const t=this.GetFrameIndexByTag(e);if(-1===t)throw new Error(\"cannot find animation frame with tag \"+e);return t}}GetSpeed(){return this._speed}IsLooping(){return this._isLooping}GetRepeatCount(){return this._repeatCount}GetRepeatTo(){return this._repeatTo}IsPingPong(){return this._isPingPong}GetIAnimation(){return this._iAnimation}}}{const dh=self.C3,ph=(()=>{const s=atob(\"iVBORw0KGgoAAAANSUhEUgAAAGQAAABkAQMAAABKLAcXAAAAAXNSR0IArs4c6QAAAANQTFRFAAAAp3o92gAAAAF0Uk5TAEDm2GYAAAATSURBVBgZYxgFo2AUjIJRQFcAAAV4AAHcRQIbAAAAAElFTkSuQmCC\"),i=new Uint8Array(s.length);for(let e=0,t=s.length;e<t;++e)i[e]=s.charCodeAt(e);return new Blob([i],{type:\"image/png\"})})();dh.AnimationFrameInfo=class extends dh.DefendedBase{constructor(e){super(),this._imageInfo=dh.New(dh.ImageInfo),this._imageInfo.LoadData(e),this._duration=e[7],this._origin=dh.New(dh.Vector2,e[8],e[9]),this._imagePoints=e[10].map(e=>dh.New(dh.ImagePoint,this,e)),this._imagePointsByName=new Map;for(const s of this._imagePoints)this._imagePointsByName.set(s.GetName().toLowerCase(),s);this._collisionPoly=null;const t=e[11];6<=t.length&&(this._collisionPoly=dh.New(dh.CollisionPoly,t)),this._tag=e[12]||\"\",this._iAnimationFrame=new self.IAnimationFrame(this)}static CreateDynamic(e){const t=dh.New(dh.AnimationFrameInfo,[\"\",0,0,0,100,100,!1,1,0,0,[],[],\"\"]);return t._imageInfo.LoadDynamicBlobAsset(e,ph),t}Release(){this._collisionPoly&&(this._collisionPoly.Release(),this._collisionPoly=null),this._imageInfo.Release(),this._imageInfo=null}GetImageInfo(){return this._imageInfo}GetDuration(){return this._duration}GetOriginX(){return this._origin.getX()}GetOriginY(){return this._origin.getY()}GetCollisionPoly(){return this._collisionPoly}GetImagePointByName(e){return this._imagePointsByName.get(e.toLowerCase())||null}GetImagePointByIndex(e){return(e=Math.floor(e))<0||e>=this._imagePoints.length?null:this._imagePoints[e]}GetImagePointCount(){return this._imagePoints.length}GetTag(){return this._tag}GetIAnimationFrame(){return this._iAnimationFrame}}}{const fh=self.C3;fh.ImagePoint=class extends fh.DefendedBase{constructor(e,t){super(),this._afi=e,this._name=t[0],this._pos=fh.New(fh.Vector2,t[1],t[2])}Release(){}GetName(){return this._name}GetX(){return this._pos.getX()}GetY(){return this._pos.getY()}GetVec2(){return this._pos}}}{const C=self.C3,mh=self.C3Debugger,gh=self.IObjectClass;C.ObjectClass=class extends C.DefendedBase{constructor(t,e,s){super();const i=t.GetObjectReference(s[1]),[r,n]=(this._runtime=t,this._plugin=C.AddonManager.GetPluginByConstructorFunction(i),this._sdkType=null,this._instSdkCtor=i.Instance,this._index=e,this._sid=s[11],this._name=s[0],this._jsPropName=this._runtime.GetJsPropName(s[14]),this._isGlobal=!!s[9],this._isFamily=!!s[2],this._isOnLoaderLayout=!!s[10],this._instVars=s[3].map(e=>({sid:e[0],type:e[1],name:e[2],jsPropName:t.GetJsPropName(e[3])})),this._behaviorsCount=s[4],this._effectsCount=s[5],this._isWorldType=this._plugin.IsWorldType(),this._dispatcher=C.New(C.Event.Dispatcher),this._effectList=null,t.GetCollisionEngine().GetCollisionCellSize());if(this._collisionGrid=C.New(C.SparseGrid,r,n),this._anyCollisionCellChanged=!0,this._familyMembers=null,this._familyMembersSet=null,this._familyIndex=-1,this._families=null,this._familiesSet=null,this._familyInstVarMap=null,this._familyBehaviorMap=null,this._familyEffectMap=null,this._isInContainer=!1,this._container=null,this._behaviorTypes=s[8].map(e=>C.BehaviorType.Create(this,e)),this._behaviorTypesIncludingInherited=[],this._behaviorsByName=new Map,this._behaviorNameToIndex=new Map,this._usedBehaviorCtors=new Set,this._customActionMap=new Map,this._solStack=C.New(C.SolStack,this),this._defaultInstanceData=null,this._defaultLayerIndex=0,this._isContained=!1,this._container=null,this._imageInfo=null,this._animations=null,this._animationsByName=null,this._animationsBySid=null,this._textureRefCount=0,this._savedData=new Map,this._unsavedData=new Map,this._instances=[],this._worldInfosByLayer=new Map,this._iidsStale=!0,this._plugin.HasEffects()&&(this._effectList=C.New(C.EffectList,this,s[12])),s[6]&&(this._imageInfo=C.New(C.ImageInfo),this._imageInfo.LoadData(s[6])),s[7]){this._animations=s[7].map(e=>C.New(C.AnimationInfo,e)),this._animationsByName=new Map,this._animationsBySid=new Map;for(const h of this._animations)this._animationsByName.set(h.GetName().toLowerCase(),h),this._animationsBySid.set(h.GetSID(),h)}this._isFamily?(this._familyMembers=[],this._familyMembersSet=new Set,this._familyIndex=this._runtime._GetNextFamilyIndex()):(this._families=[],this._familiesSet=new Set,this._familyInstVarMap=[],this._familyBehaviorMap=[],this._familyEffectMap=[]);const a=this._plugin.GetSdkVersion();if(a<2&&(this._sdkType=C.New(i.Type,this,s[15]),!(this._sdkType instanceof C.SDKTypeBase)))throw new Error(\"v1 sdk type must derive from SDKTypeBase\");this._iObjectClass=null,this._instanceUserScriptClass=null,this._userScriptDispatcher=C.New(C.Event.Dispatcher),C.AddonManager._PushInitObject(this,a);let o;if(o=2<=a?(o=i.Type)||globalThis.ISDKObjectTypeBase:this._sdkType.GetScriptInterfaceClass()){if(this._iObjectClass=new o(a<2?this:null),a<2&&!(this._iObjectClass instanceof gh))throw new TypeError(\"script interface class must derive from IObjectClass\");if(2<=a&&!(this._iObjectClass instanceof globalThis.ISDKObjectTypeBase))throw new TypeError(\"script interface class must derive from ISDKObjectTypeBase\")}else this._iObjectClass=new gh;if(C.AddonManager._PopInitObject(a),s[13]){const l=s[13];if(l){const c=l[0],u=l[1],_=l[2];this._sdkType.LoadTilemapData(c,u,_)}}this._runtime.UsesLoaderLayout()&&!this._isFamily&&!this._isOnLoaderLayout&&this._isWorldType||this.OnCreate(),this._plugin.IsSingleGlobal()&&(this._plugin._SetSingleGlobalObjectClass(this),this._CreateSingleGlobalInstance(s)),this._loadInstancesJson=null}static Create(e,t,s){return C.New(C.ObjectClass,e,t,s)}Release(){if(this._dispatcher.Release(),this._dispatcher=null,this._imageInfo&&(this._imageInfo.Release(),this._imageInfo=null),this._animations){for(const e of this._animations)e.Release();C.clearArray(this._animations),this._animationsByName.clear(),this._animationsBySid.clear()}this._loadInstancesJson=null,this._solStack.Release(),this._solStack=null,this._savedData.clear(),this._unsavedData.clear(),this._container=null,this._runtime=null}_LoadFamily(s){for(let e=1,t=s.length;e<t;++e){const i=this._runtime.GetObjectClassByIndex(s[e]);this._familyMembers.push(i),this._familyMembersSet.add(i),i._families.push(this),i._familiesSet.add(this)}}_SetContainer(e){this._isInContainer=!0,this._container=e}IsInContainer(){return this._isInContainer}GetContainer(){return this._container}_OnAfterCreate(){let e=0;if(!this._isFamily)for(const t of this._families)for(const s of t.GetBehaviorTypes()){const i=s.GetName().toLowerCase();this._behaviorsByName.set(i,s),this._behaviorNameToIndex.set(i,e),this._behaviorTypesIncludingInherited.push(s),++e}for(const r of this.GetBehaviorTypes()){const n=r.GetName().toLowerCase();this._behaviorsByName.set(n,r),this._behaviorNameToIndex.set(n,e),this._behaviorTypesIncludingInherited.push(r),++e}for(const a of this._behaviorTypesIncludingInherited)this._usedBehaviorCtors.add(a.GetBehavior().constructor);if(!this._isFamily&&this._families.length){let e=this._runtime.GetFamilyCount(),t=(C.extendArray(this._familyInstVarMap,e,0),C.extendArray(this._familyBehaviorMap,e,0),C.extendArray(this._familyEffectMap,e,0),[]),s=0,i=0,r=0;for(const o of this._families){const h=o.GetFamilyIndex(),l=(this._familyInstVarMap[h]=s,s+=o.GetInstanceVariablesCount(),this._familyBehaviorMap[h]=i,i+=o.GetBehaviorTypesCount(),this._familyEffectMap[h]=r,r+=o.GetEffectTypesCount(),o.GetEffectList());if(l&&this._effectList)for(const c of l.GetAllEffectTypes())t.push(c.Clone(this._effectList))}this._effectList&&this._effectList.PrependEffectTypes(t)}}_CreateSingleGlobalInstance(e){const t=this._runtime._GetNewUID(),s=C.New(C.Instance,{runtime:this._runtime,objectType:this,uid:t});s._CreateSdkInstance(e[16],[]),this._runtime._MapInstanceByUID(t,s),this._instances.push(s)}GetSdkType(){return this._sdkType}IsOnLoaderLayout(){return this._isOnLoaderLayout}Dispatcher(){return this._dispatcher}OnCreate(){this._isFamily||(this._sdkType?this._sdkType.OnCreate():this._iObjectClass._onCreate())}HasLoadedTextures(){return 0<this._textureRefCount}async LoadTextures(e){this._isFamily||(this._textureRefCount++,1===this._textureRefCount&&(this._sdkType?await this._sdkType.LoadTextures(e):await this._iObjectClass._loadTextures(this._runtime.GetCanvasManager().GetIRenderer())))}ReleaseTextures(){if(!this._isFamily){if(this._textureRefCount--,this._textureRefCount<0)throw new Error(\"released textures too many times\");0===this._textureRefCount&&(this._sdkType?this._sdkType.ReleaseTextures():this._iObjectClass._releaseTextures(this._runtime.GetCanvasManager().GetIRenderer()))}}OnDynamicTextureLoadComplete(){if(this._isFamily)throw new Error(\"not applicable to family\");this._sdkType?this._sdkType.OnDynamicTextureLoadComplete():this._iObjectClass._onDynamicTextureLoadComplete()}async PreloadTexturesWithInstances(e){this._isFamily||(this._sdkType?await this._sdkType.PreloadTexturesWithInstances(e):await this._iObjectClass._preloadTexturesWithInstances(this._runtime.GetCanvasManager().GetIRenderer()))}GetRuntime(){return this._runtime}GetPlugin(){return this._plugin}GetInstanceSdkCtor(){return this._instSdkCtor}GetName(){return this._name}GetJsPropName(){return this._jsPropName}GetIndex(){return this._index}GetSID(){return this._sid}IsFamily(){return this._isFamily}IsGlobal(){return this._isGlobal}IsWorldType(){return this._isWorldType}GetFamilyIndex(){return this._familyIndex}GetBehaviorTypes(){return this._behaviorTypes}GetBehaviorTypesCount(){return this._behaviorsCount}UsesBehaviorByCtor(e){return e&&this._usedBehaviorCtors.has(e)}GetInstanceVariablesCount(){return this._instVars.length}GetInstanceVariableSIDs(){return this._instVars.map(e=>e.sid)}GetInstanceVariableIndexBySID(t){return this._instVars.findIndex(e=>e.sid===t)}GetInstanceVariableIndexByName(t){return this._instVars.findIndex(e=>e.name===t)}_GetAllInstanceVariableNames(){return this._instVars.map(e=>e.name)}_GetAllInstanceVariableJsPropNames(){return this._instVars.map(e=>e.jsPropName)}GetInstanceVariableType(e){if((e=Math.floor(e))<0||e>=this._instVars.length)throw new RangeError(\"invalid instance variable index\");return this._instVars[e].type}GetInstanceVariableName(e){if((e=Math.floor(e))<0||e>=this._instVars.length)throw new RangeError(\"invalid instance variable index\");return this._instVars[e].name}GetEffectTypesCount(){return this._effectsCount}GetBehaviorTypesIncludingInherited(){return this._behaviorTypesIncludingInherited}GetBehaviorTypeByName(e){return this._behaviorsByName.get(e.toLowerCase())||null}GetBehaviorIndexByName(e){const t=this._behaviorNameToIndex.get(e.toLowerCase());return void 0===t?-1:t}GetEffectList(){return this._effectList}HasEffects(){return this._plugin.HasEffects()}UsesEffects(){return this._effectList&&this._effectList.HasAnyEffectType()}GetSolStack(){return this._solStack}GetCurrentSol(){return this._solStack.GetCurrentSol()}GetImageInfo(){return this._imageInfo}SetDefaultInstanceData(e){this._defaultInstanceData=e}GetDefaultInstanceData(){return this._defaultInstanceData}_SetDefaultLayerIndex(e){this._defaultLayerIndex=e}GetDefaultLayerIndex(){return this._defaultLayerIndex}GetAnimations(){return this._animations}GetAnimationCount(){return this._animations.length}GetFamilies(){return this._families}BelongsToFamily(e){return this._familiesSet.has(e)}GetFamilyMembers(){return this._familyMembers}FamilyHasMember(e){return this._familyMembersSet.has(e)}GetFamilyBehaviorOffset(e){return this._familyBehaviorMap[e]}GetFamilyInstanceVariableOffset(e){return this._familyInstVarMap[e]}AddCustomAction(e){this._customActionMap.set(e.GetACEName().toLowerCase(),e)}HasOwnCustomActionByName(e){return!!this.GetOwnCustomActionByName(e)}GetOwnCustomActionByName(e){const t=this._customActionMap.get(e.toLowerCase());return t&&t.IsEnabled()?t:null}GetAllAnimations(){return this._animations}GetAnimationByName(e){if(this._animations)return this._animationsByName.get(e.toLowerCase())||null;throw new Error(\"no animations\")}GetAnimationBySID(e){if(this._animations)return this._animationsBySid.get(e)||null;throw new Error(\"no animations\")}AddAnimation(e){if(this.GetAnimationByName(e))throw new Error(`animation name '${e}' already exists`);const t=C.AnimationInfo.CreateDynamic(this.GetRuntime(),e);return this._animations.push(t),this._animationsByName.set(t.GetName().toLowerCase(),t),this._animationsBySid.set(t.GetSID(),t),t}RemoveAnimation(e){const t=this.GetAnimationByName(e);if(!t)throw new Error(`animation name '${e}' does not exist`);if(1===this._animations.length)throw new Error(\"cannot remove last animation\");const s=this._animations.indexOf(t);this._animations.splice(s,1),this._animationsByName.delete(t.GetName().toLowerCase()),this._animationsBySid.delete(t.GetSID()),t.Release()}GetFirstAnimation(){if(this._animations)return this._animations[0];throw new Error(\"no animations\")}GetFirstAnimationFrame(){return this.GetFirstAnimation().GetFrameAt(0)}GetDefaultInstanceSize(){if(this._animations){const e=this.GetFirstAnimationFrame().GetImageInfo();return[e.GetWidth(),e.GetHeight()]}return this._imageInfo?[this._imageInfo.GetWidth(),this._imageInfo.GetHeight()]:[100,100]}GetSingleGlobalInstance(){if(this._plugin.IsSingleGlobal())return this._instances[0];throw new Error(\"not a single-global plugin\")}GetInstances(){return this._instances}*instances(){yield*this._instances}*instancesIncludingPendingCreate(){yield*this._instances,yield*this._runtime.instancesPendingCreateForObjectClass(this)}GetInstanceCount(){return this._instances.length}_AddInstance(e){this._instances.push(e)}_SetIIDsStale(){this._iidsStale=!0}_UpdateIIDs(){if(this._iidsStale&&!this._isFamily){let t=this._instances,s=0;for(let e=t.length;s<e;++s)t[s]._SetIID(s);const e=this._runtime._GetInstancesPendingCreate();for(const i of e)i.GetObjectClass()===this&&i._SetIID(s++);this._iidsStale=!1}}GetInstanceByIID(e){const t=this._instances;if(e<t.length)return t[e];e-=t.length;const s=this._runtime._GetInstancesPendingCreate();for(const i of s)if(i.GetObjectClass()===this){if(0===e)return i;--e}return null}GetFirstPicked(e){if(e&&e.IsInContainer()&&e.GetObjectClass()!==this)for(const s of e.siblings())if(s.GetObjectClass()===this)return s;const t=this.GetCurrentSol().GetInstances();return t.length?t[0]:null}GetPairedInstance(e){const t=this.GetCurrentSol().GetInstances();return 0<t.length?t[e.GetIID()%t.length]:null}*allCorrespondingInstances(e,t){let s=this.GetCurrentSol().GetInstances(),i=s.length,r=t.GetCurrentSol(),n=t.GetCurrentSol().GetInstances(),a=n.length,o=e.GetIID(),h=(!t.IsFamily()&&r.IsSelectAll()||(o=n.indexOf(e)),Math.ceil(i/a)),l=i%a,c=0,u;u=0==l||o<l?(c=o*h,h):(c=l*h+(o-l)*(h-1),h-1);for(let e=c,t=c+u;e<t;++e)yield s[e]}FinishCondition(e){this._sdkType?.FinishCondition(e)}ApplySolToContainer(){if(this._isInContainer&&!this._isFamily){this._UpdateIIDs();const e=this.GetCurrentSol(),t=e._GetOwnInstances(),s=e.IsSelectAll(),i=this._runtime.GetCurrentEventStackFrame(),r=i&&i.GetCurrentEvent()&&i.GetCurrentEvent().IsOrBlock();for(const n of this._container.objectTypes())if(n!==this){n._UpdateIIDs();const a=n.GetCurrentSol();if(a._SetSelectAll(s),!s){const o=a._GetOwnInstances();C.clearArray(o);for(const h of t)o.push(n.GetInstanceByIID(h.GetIID()));if(r){const l=e._GetOwnElseInstances(),c=a._GetOwnElseInstances();C.clearArray(c);for(const u of l)c.push(n.GetInstanceByIID(u.GetIID()))}}}}}_TruncateContainerSols(e,t){for(const s of this.GetContainer().objectTypes()){const i=s.GetCurrentSol();e?C.truncateArray(i._GetOwnElseInstances(),t):C.truncateArray(i._GetOwnInstances(),t)}}_GetCollisionCellGrid(){return this._collisionGrid}_SetAnyCollisionCellChanged(e){this._anyCollisionCellChanged=!!e}_UpdateAllCollisionCells(){if(this._anyCollisionCellChanged&&this._isWorldType){for(const e of this._instances)e.GetWorldInfo()._UpdateCollisionCell();for(const t of this._runtime._GetInstancesPendingCreate())t.GetObjectClass()===this&&t.GetWorldInfo()._UpdateCollisionCell();this._anyCollisionCellChanged=!1}}_OnWorldInstanceLayerChanged(t,e,s){if(e){const i=this._worldInfosByLayer.get(e);i&&(i.delete(t),0===i.size)&&this._worldInfosByLayer.delete(e)}if(s){let e=this._worldInfosByLayer.get(s);e||(e=new Set,this._worldInfosByLayer.set(s,e)),e.add(t)}}layersHasInstancesOn(){if(this.IsFamily()){const e=new Set;for(const t of this._familyMembers)for(const s of t.layersHasInstancesOn())e.add(s);return e.values()}return this._worldInfosByLayer.keys()}GetSavedDataMap(){return this._savedData||(this._savedData=new Map),this._savedData}GetUnsavedDataMap(){return this._unsavedData||(this._unsavedData=new Map),this._unsavedData}HasSolidBehavior(){return this.UsesBehaviorByCtor(C.Behaviors.solid)}HasJumpthruBehavior(){return this.UsesBehaviorByCtor(C.Behaviors.jumpthru)}HasNoSaveBehavior(){return this.UsesBehaviorByCtor(C.Behaviors.NoSave)}HasPersistBehavior(){return this.UsesBehaviorByCtor(C.Behaviors.Persist)}_SaveToJson(){const e={instances:this._instances.map(e=>e.SaveToJson())};return this._savedData&&this._savedData.size&&(e.ex=C.ToSuperJSON(this._savedData)),e}_LoadFromJson(e,i){this._savedData&&(this._savedData.clear(),this._savedData=null);const t=e.ex,r=(t&&(this._savedData=C.FromSuperJSON(t)),this._instances),n=e.instances;for(let e=0,t=Math.min(r.length,n.length);e<t;++e)r[e].LoadFromJson(n[e]);for(let e=n.length,t=r.length;e<t;++e)this._runtime.DestroyInstance(r[e]);for(let s=r.length,e=n.length;s<e;++s){let e=n[s],t=null;if(!this.IsWorldType()||(t=this._runtime.GetMainRunningLayout().GetLayerBySID(e.w.l))){const a=this._runtime.CreateInstanceFromData(this._defaultInstanceData||this,t,!1,0,0,!0);a.LoadFromJson(e),i&&i.add(a)}}this._loadInstancesJson=n,this._SetIIDsStale()}_GetLoadInstancesJson(){return this._loadInstancesJson}_ClearLoadInstancesJson(){this._loadInstancesJson=null}_SetupSceneGraphConnectionsOnChangeOfLayout(){for(let e=0,t=this._instances;e<t;++e)this._instances[e]._SetupSceneGraphConnectionsOnChangeOfLayout()}GetIObjectClass(){return this._iObjectClass}UserScriptDispatcher(){return this._userScriptDispatcher}_GetUserScriptInstanceClass(){return this._instanceUserScriptClass}_SetUserScriptInstanceClass(e){this._instanceUserScriptClass=e}DispatchUserScriptEvent(e){const t=this._runtime,s=t.IsDebug()&&!t.GetEventSheetManager().IsInEventEngine();s&&mh.StartMeasuringScriptTime(),this._userScriptDispatcher.dispatchEvent(e),s&&mh.AddScriptTime()}}}{const Sh=self.C3;Sh.Container=class extends Sh.DefendedBase{constructor(e,t){super(),this._runtime=e,this._objectTypes=t;for(const s of this._objectTypes)s._SetContainer(this)}Release(){this._runtime=null}GetRuntime(){return this._runtime}GetObjectTypes(){return this._objectTypes}objectTypes(){return this._objectTypes}HasAnyWorldType(){return this._objectTypes.some(e=>e.IsWorldType())}}}{let y=self.C3,r=self.C3Debugger,a=y.AddonManager,o=[],h=0,G=new WeakMap,i=new WeakMap;y.Instance=class extends y.DefendedBase{constructor(e){if(y.AddonManager!==a)throw new Error(\"invalid addon manager\");super(),this._runtime=e.runtime,this._objectType=e.objectType,this._worldInfo=null,this._sdkInst=null,this._iScriptInterface=null,this._iid=0,this._uid=e.uid,this._puid=h++,this._flags=0,this._tagsSet=null;const t=y.splitStringAndNormalize(e.tags),s=(0<t.length&&(this._tagsSet=new Set(t)),this._instVarValues=o,this._behaviorInstances=o,this._objectType.GetBehaviorTypesIncludingInherited()),i=(0<s.length&&(this._behaviorInstances=s.map((e,t)=>y.New(y.BehaviorInstance,{runtime:this._runtime,behaviorType:e,instance:this,index:t}))),this._siblings=this._objectType.IsInContainer()?[]:null,this._timeScale=-1,this._dispatcher=null,this.GetPlugin());if(i.MustPreDraw()&&(this._flags|=4),i.IsWorldType())if(this._worldInfo=y.New(y.WorldInfo,this,e.layer),e.worldData)this._worldInfo.Init(e.worldData);else{this._worldInfo.InitNoData();const[r,n]=this._objectType.GetDefaultInstanceSize();this._worldInfo.SetSize(r,n),this.GetObjectClass().UsesEffects()&&this._worldInfo.GetInstanceEffectList().LoadDefaultEffectParameters()}e.instVarData?this._LoadInstanceVariableData(e.instVarData):this._LoadDefaultInstanceVariables()}Release(){if(this._iScriptInterface&&(this._iScriptInterface._release(),this._iScriptInterface=null),0<this._behaviorInstances.length){for(const s of this._behaviorInstances)s.Release();y.clearArray(this._behaviorInstances)}this._sdkInst&&(this._sdkInst.Release(),this._sdkInst=null);const e=G.get(this),t=(e&&(e.clear(),G.delete(this)),i.get(this));t&&(t.clear(),i.delete(this)),this._siblings&&y.clearArray(this._siblings),this._dispatcher&&(this._dispatcher.Release(),this._dispatcher=null),this._tagsSet&&this._tagsSet.clear(),this._tagsSet=null,this._runtime=null,this._objectType=null,0<this._instVarValues.length&&y.clearArray(this._instVarValues),this._worldInfo&&(this._worldInfo.Release(),this._worldInfo=null)}_LoadInstanceVariableData(e){0<e.length&&(this._instVarValues=[],y.shallowAssignArray(this._instVarValues,e))}_LoadDefaultInstanceVariables(){const t=this._objectType.GetInstanceVariablesCount();if(0!==t){this._instVarValues=[];const s=[0,0,\"\"];for(let e=0;e<t;++e)this._instVarValues.push(s[this._objectType.GetInstanceVariableType(e)])}}_CreateSdkInstance(e,s){if(this._sdkInst)throw new Error(\"already got sdk instance\");for(let e=0,t=this._behaviorInstances.length;e<t;++e){const i=this._behaviorInstances[e];i._CreateSdkInstance(s?s[e]:null)}const t=this.GetPlugin().GetSdkVersion();if(t<2){if(this._sdkInst=y.New(this._objectType.GetInstanceSdkCtor(),this,e),!(this._sdkInst instanceof y.SDKInstanceBase))throw new Error(\"sdk type must derive from SDKInstanceBase\");!this.GetPlugin().IsWorldType()&&this._objectType._GetUserScriptInstanceClass()&&this.GetInterfaceClass()}else{const r=this.GetPlugin().GetScriptInterfaceClass();this._InitUserScriptInterface(r.Instance,e)}}GetSdkInstance(){return this._sdkInst??this._iScriptInterface}GetWorldInfo(){return this._worldInfo}GetRuntime(){return this._runtime}GetTimeScale(){return this._timeScale}GetActiveTimeScale(){const e=this._timeScale;return-1===e?this.GetRuntime().GetTimeScale():e}SetTimeScale(e){((e=+e)<0||!isFinite(e))&&(e=0),this._timeScale=e,this.GetObjectClass().UsesEffects()&&this._runtime._SetTrackingInstanceTime(this,!0)}RestoreTimeScale(){this._timeScale=-1,this.GetObjectClass().UsesEffects()&&this._runtime._SetTrackingInstanceTime(this,!1)}GetInstanceGameTime(){return this._runtime._GetInstanceGameTime(this)}Dispatcher(){return this._dispatcher||(this._dispatcher=y.New(y.Event.Dispatcher)),this._dispatcher}Draw(e){this._sdkInst?this._sdkInst.Draw(e):this._iScriptInterface._draw(this._runtime.GetCanvasManager().GetIRenderer())}OnCreate(e){this._sdkInst.OnCreate(e)}_SetHasTilemap(){this._flags|=2}HasTilemap(){return 0!=(2&this._flags)}_MarkDestroyed(){this._flags|=1}IsDestroyed(){return 0!=(1&this._flags)}MustPreDraw(){return 0!=(4&this._flags)||this._sdkInst.MustPreDraw()}SetMustMitigateZFighting(){this._flags|=32}MustMitigateZFighting(){return 0!=(32&this._flags)}_IsSolidEnabled(){return 0!=(8&this._flags)}_SetSolidEnabled(e){e?this._flags|=8:this._flags&=-9}_IsJumpthruEnabled(){return 0!=(16&this._flags)}_SetJumpthruEnabled(e){e?this._flags|=16:this._flags&=-17}_IsDrawingWithEffects(){return 0!=(64&this._flags)}_SetIsDrawingWithEffects(e){e?this._flags|=64:this._flags&=-65}SetFlag(e,t){e<<=16,t?this._flags|=e:this._flags&=~e}GetFlag(e){return 0!=(this._flags&e<<16)}GetCurrentImageInfo(){return this._sdkInst.GetCurrentImageInfo()}GetCurrentSurfaceSize(){return this._sdkInst.GetCurrentSurfaceSize()}GetCurrentTexRect(){return this._sdkInst.GetCurrentTexRect()}GetCurrentTexQuad(){return this._sdkInst.GetCurrentTexQuad()}IsCurrentTexRotated(){return this._sdkInst.IsCurrentTexRotated()}GetImagePoint(e){return this._sdkInst.GetImagePoint(e)}GetObjectClass(){return this._objectType}RendersToOwnZPlane(){return this._sdkInst.RendersToOwnZPlane()}BelongsToObjectClass(e){return e.IsFamily()?e.FamilyHasMember(this.GetObjectClass()):this.GetObjectClass()===e}CollectInstancesToPick(r,e,t){const s=(e,t)=>{const s=t||e.GetObjectClass(),i=r.get(s);i?i.add(e):r.set(s,new Set([e]))};if(s(this,e),this.IsInContainer())for(const i of this.siblings())s(i);if(t)for(const n of this.allChildren())s(n)}VerifySupportsSceneGraph(){if(!this.GetPlugin().SupportsSceneGraph())throw new Error(\"object does not support scene graph\")}HasParent(){return null!==this.GetParent()}GetParent(){const e=this.GetWorldInfo();if(!e)return null;const t=e.GetParent();return t?t.GetInstance():null}GetTopParent(){const e=this.GetWorldInfo();if(!e)return null;const t=e.GetTopParent();return t?t.GetInstance():null}*parents(){const e=this.GetWorldInfo();if(e)for(const t of e.parents())yield t.GetInstance()}HasChild(e){if(e)for(const t of this.children())if(t===e)return!0;return!1}HasChildren(){const e=this.GetWorldInfo();return!!e&&e.HasChildren()}GetChildrenOfObjectClass(e){const t=this.GetWorldInfo();if(!t)return[];const s=e.GetName();return t.GetChildren().map(e=>e.GetInstance()).filter(e=>e.GetObjectClass().GetName()===s)}GetChildren(){const e=this.GetWorldInfo();return e?e.GetChildren().map(e=>e.GetInstance()):[]}*children(){const e=this.GetWorldInfo();if(e)for(const t of e.children())yield t.GetInstance()}*allChildren(){const e=this.GetWorldInfo();if(e)for(const t of e.allChildren())yield t.GetInstance()}GetChildCount(){const e=this.GetWorldInfo();return e?e.GetChildCount():0}GetParentCount(){return[...this.parents()].length}GetAllChildCount(){const e=this.GetWorldInfo();return e?e.GetAllChildCount():0}GetChildAt(e){const t=this.GetWorldInfo();if(!t)return null;const s=t.GetChildAt(e);return s?s.GetInstance():null}GetIndexInParent(){const e=this.GetWorldInfo();if(!e)return NaN;const t=e.GetParent();return t?t.GetChildIndex(e):NaN}HasChildWithUID(e){for(const t of this.GetWorldInfo().GetChildren())if(t.GetInstance().GetUID()===e)return!0;return!1}AddChild(e,t){this.VerifySupportsSceneGraph(),e.VerifySupportsSceneGraph(),this.GetWorldInfo().AddChild(e.GetWorldInfo(),t||{})}RemoveChild(e){const t=this.GetWorldInfo();t&&t.RemoveChild(e.GetWorldInfo())}GetDestroyWithParent(){const e=this.GetWorldInfo();return!!e&&e.GetDestroyWithParent()}SetupInitialSceneGraphConnections(){const e=this.GetWorldInfo();if(e){const t=e.GetSceneGraphChildrenExportData();if(t)for(const s of t){const i=this._runtime.GetInstanceByUID(s[2]);if(i){const r=s[3];this.AddChild(i,{transformX:!!(r>>0&1),transformY:!!(r>>1&1),transformWidth:!!(r>>2&1),transformHeight:!!(r>>3&1),transformAngle:!!(r>>4&1),destroyWithParent:!!(r>>5&1),transformZElevation:!!(r>>6&1),transformOpacity:!!(r>>7&1),transformVisibility:!!(r>>8&1)})}}}}SetupPersistedSceneGraphConnections(e,t){const s=e.get(this);if(s)for(const i of s.sceneGraphJson.children){const r=t.get(i.index);if(r){const n=i.flags;this.AddChild(r,{transformX:!!(n>>0&1),transformY:!!(n>>1&1),transformWidth:!!(n>>2&1),transformHeight:!!(n>>3&1),transformAngle:!!(n>>4&1),destroyWithParent:!!(n>>5&1),transformZElevation:!!(n>>6&1),transformOpacity:!!(n>>7&1),transformVisibility:!!(n>>8&1)})}}}GetTemplateName(){const e=this._runtime.GetTemplateManager();return e?e.GetInstanceTemplateName(this):\"\"}IsInContainer(){return null!==this._siblings}_AddSibling(e){this._siblings.push(e)}GetSiblings(){return this._siblings}HasSibling(e){return!!this.GetSibling(e)}GetSibling(e){const t=this.siblings();if(null===t||0===t.length)return!1;for(const s of t)if(s.GetObjectClass()===e)return s;return null}siblings(){return this._siblings}SetSiblingsSinglePicked(){for(const e of this.siblings())e.GetObjectClass().GetCurrentSol().SetSinglePicked(e)}_PushSiblingsToSolInstances(){for(const e of this.siblings())e.GetObjectClass().GetCurrentSol()._PushInstance(e)}_SetSiblingsToSolInstancesIndex(e){for(const t of this.siblings())t.GetObjectClass().GetCurrentSol()._GetOwnInstances()[e]=t}_PushSiblingsToSolElseInstances(){for(const e of this.siblings())e.GetObjectClass().GetCurrentSol()._PushElseInstance(e)}_SetSiblingsToSolElseInstancesIndex(e){for(const t of this.siblings())t.GetObjectClass().GetCurrentSol()._GetOwnElseInstances()[e]=t}GetPlugin(){return this._objectType.GetPlugin()}_SetIID(e){this._iid=e}GetIID(){return this._objectType._UpdateIIDs(),this._iid}GetUID(){return this._uid}GetPUID(){return this._puid}_SetTagsSetFromJson(e){e?this.SetTagsSet(new Set(e)):this._tagsSet=null}SetTagsSet(e){if(0===e.size)this._tagsSet=null;else{this._tagsSet?this._tagsSet.clear():this._tagsSet=new Set;for(const t of e)this._tagsSet.add(t)}}GetTagsSet(){return this._tagsSet??new Set}GetTagsString(){return Array.from(this.GetTagsSet()).join(\" \")}GetTagAt(e){e=Math.floor(e);for(const t of this.GetTagsSet()){if(0===e)return t;--e}return\"\"}GetBehaviorInstances(){return this._behaviorInstances}GetBehaviorInstanceFromCtor(e){if(e)for(const t of this._behaviorInstances)if(t.GetBehavior()instanceof e)return t;return null}GetBehaviorSdkInstanceFromCtor(e){if(!e)return null;const t=this.GetBehaviorInstanceFromCtor(e);return t?t.GetSdkInstance():null}GetBehaviorIndexBySID(s){const i=this._behaviorInstances;for(let e=0,t=i.length;e<t;++e)if(i[e].GetBehaviorType().GetSID()===s)return e;return-1}GetAllInstanceVariableValues(){return this._instVarValues}_GetAllInstanceVariableNames(){return this._objectType._GetAllInstanceVariableNames()}GetInstanceVariableCount(){return this._instVarValues.length}GetInstanceVariableValue(e){const t=this._instVarValues;if((e|=0)<0||e>=t.length)throw new RangeError(\"invalid instance variable\");return t[e]}_GetInstanceVariableValueUnchecked(e){return this._instVarValues[e]}_GetInstanceVariableTypedValue(e){const t=this._instVarValues[e];return 0===this._objectType.GetInstanceVariableType(e)?!!t:t}SetInstanceVariableValue(e,t){const s=this._instVarValues;if((e|=0)<0||e>=s.length)throw new RangeError(\"invalid instance variable\");const i=this._objectType.GetInstanceVariableType(e);switch(i){case 0:s[e]=t?1:0;break;case 1:s[e]=\"number\"==typeof t?t:parseFloat(t);break;case 2:s[e]=\"string\"==typeof t?t:t.toString();break;default:throw new Error(\"unknown instance variable type\")}}SetInstanceVariableOffset(e,t){if(0!==t){const s=this._instVarValues;if((e|=0)<0||e>=s.length)throw new RangeError(\"invalid instance variable\");const i=s[e];if(\"number\"!=typeof i)throw\"boolean\"==typeof i?new Error(\"can not set offset of boolean variable\"):\"string\"==typeof i?new Error(\"can not set offset of string variable\"):new Error(\"unknown instance variable type\");s[e]+=\"number\"==typeof t?t:parseFloat(t)}}GetSavedDataMap(){let e=G.get(this);return e||(e=new Map,G.set(this,e)),e}GetUnsavedDataMap(){let e=i.get(this);return e||(e=new Map,i.set(this,e)),e}_HasAnyCreateDestroyHandler(e){const t=this.GetObjectClass();if(t.UserScriptDispatcher().HasAnyHandlerFor(e))return!0;for(const s of t.GetFamilies())if(s.UserScriptDispatcher().HasAnyHandlerFor(e))return!0;return!!this._runtime.UserScriptDispatcher().HasAnyHandlerFor(e)}_TriggerOnCreatedOnSelfAndRelated(){const e=new Set,t=(e.add(this),this.GetWorldInfo());if(t&&t.HasChildren())for(const s of this.allChildren())if(e.add(s),s.IsInContainer())for(const i of s.siblings())e.add(i);if(this.IsInContainer())for(const r of this.siblings())e.add(r);for(const n of e.values())n._TriggerOnCreated()}_OnCreatedCommon(){this._objectType._GetUserScriptInstanceClass()&&this.GetInterfaceClass();for(const e of this._behaviorInstances)e.PostCreate()}_OnCreatedForLoadingSavegame(){this._OnCreatedCommon()}_TriggerOnCreated(){if(this._OnCreatedCommon(),this._HasAnyCreateDestroyHandler(\"instancecreate\")){const e=this.GetObjectClass(),t=new y.Event(\"instancecreate\");t.instance=this.GetInterfaceClass(),e.DispatchUserScriptEvent(t);for(const s of e.GetFamilies())s.DispatchUserScriptEvent(t);this._runtime.DispatchUserScriptEvent(t)}this._runtime.Trigger(this.GetPlugin().GetConstructor().Cnds.OnCreated,this,null)}_TriggerOnDestroyed(){this._runtime.Trigger(this.GetPlugin().GetConstructor().Cnds.OnDestroyed,this,null)}_FireDestroyedScriptEvents(e){if(this._iScriptInterface){const t=new y.Event(\"destroy\");t.isEndingLayout=e,this.DispatchUserScriptEvent(t)}if(this._HasAnyCreateDestroyHandler(\"instancedestroy\")){const s=this.GetObjectClass(),i=new y.Event(\"instancedestroy\");i.instance=this.GetInterfaceClass(),i.isEndingLayout=e,s.DispatchUserScriptEvent(i);for(const r of s.GetFamilies())r.DispatchUserScriptEvent(i);this._runtime.DispatchUserScriptEvent(i)}}_GetDebuggerProperties(){return this._sdkInst?this._sdkInst.GetDebuggerProperties():this._iScriptInterface._getDebuggerProperties()}SaveToJson(e=\"full\",t=null){const s={},i=(\"full\"===e?s.uid=this.GetUID():s.c3=!0,this.GetTagsSet());if(0<i.size&&(s.tags=Array.from(i)),\"visual-state\"!==e){const n=G.get(this);if(n&&n.size&&(s.ex=y.ToSuperJSON(n)),-1!==this.GetTimeScale()&&(s.mts=this.GetTimeScale()),0<this._objectType.GetInstanceVariablesCount()){const a={},o=this._objectType.GetInstanceVariableSIDs();for(let e=0,t=this._instVarValues.length;e<t;++e)a[o[e].toString()]=this._instVarValues[e];s.ivs=a}if(this._behaviorInstances.length){const h={};for(const l of this._behaviorInstances){const c=l.SaveToJson(e);c&&(h[l.GetBehaviorType().GetSID().toString()]=c)}s.behs=h}}this._worldInfo&&(s.w=this._worldInfo._SaveToJson(e,t));const r=this._sdkInst?this._sdkInst.SaveToJson():this._iScriptInterface._saveToJson();return r&&(s.data=r),s}_OnBeforeLoad(e=\"full\",t){this._worldInfo&&this._worldInfo._OnBeforeLoad(e)}_OnAfterLoad(e,t=\"full\",s=null){this._worldInfo&&this._worldInfo._OnAfterLoad(e,t,s)}_OnAfterLoad2(e,t=\"full\",s=null){this._worldInfo&&this._worldInfo._OnAfterLoad2(e,t,s)}_SetupSceneGraphConnectionsOnChangeOfLayout(){this.GetPlugin().IsWorldType()&&this._worldInfo._SetupSceneGraphConnectionsOnChangeOfLayout()}LoadFromJson(t,e=\"full\",s){if(\"full\"===e)this._uid=t.uid;else if(!t.c3)return;if(this._SetTagsSetFromJson(t.tags),\"visual-state\"!==e){let e=G.get(this);e&&(e.clear(),G.delete(this));const r=t.ex,n=(r&&(e=y.FromSuperJSON(r),G.set(this,e)),this._timeScale=t.hasOwnProperty(\"mts\")?t.mts:-1,t.ivs);if(n)for(const[a,o]of Object.entries(n)){const h=parseInt(a,10),l=this._objectType.GetInstanceVariableIndexBySID(h);if(!(l<0||l>=this._instVarValues.length)){let e=o;null===e&&(e=NaN),this._instVarValues[l]=e}}}if(this.GetPlugin().IsWorldType()){const c=t.w;if(c){const u=c.l;if(this._worldInfo.GetLayer().GetSID()!==u){const _=this._worldInfo.GetLayer(),d=_.GetLayout().GetLayerBySID(u);d?(this._worldInfo._SetLayer(d),_._RemoveInstance(this,!0),d._AddInstance(this,!0),d.SetZIndicesChanged(this),this._worldInfo.SetBboxChanged()):\"full\"===e&&this._runtime.DestroyInstance(this)}this._worldInfo._LoadFromJson(c,e)}}if(\"visual-state\"!==e){const p=t.behs;if(p)for(const[f,m]of Object.entries(p)){const g=parseInt(f,10),S=this.GetBehaviorIndexBySID(g);S<0||S>=this._behaviorInstances.length||this._behaviorInstances[S].LoadFromJson(m,e)}}const i=t.data;i&&(this._sdkInst?this._sdkInst.LoadFromJson(i,e):this._iScriptInterface._loadFromJson(i))}GetInterfaceClass(){return this._iScriptInterface||this._InitUserScriptInterface()}HasScriptInterface(){return!!this._iScriptInterface}_InitUserScriptInterface(e,t){const s=this._worldInfo?e?self.ISDKWorldInstanceBase:self.IWorldInstance:e?self.ISDKInstanceBase:self.IInstance,i=e||this._sdkInst.GetScriptInterfaceClass(),r=this._objectType._GetUserScriptInstanceClass(),n=r||i||s,a=this.GetPlugin().GetSdkVersion();if(y.AddonManager._PushInitObject(this,a),y.AddonManager._PushInitProperties(t),this._iScriptInterface=new n,y.AddonManager._PopInitProperties(),y.AddonManager._PopInitObject(a),i&&!(this._iScriptInterface instanceof s))throw new TypeError(`script interface class '${i.name}' does not extend the right base class '${s.name}'`);if(r){const o=i||s;if(!(this._iScriptInterface instanceof o))throw new TypeError(`setInstanceClass(): class '${r.name}' does not extend the right base class - check it extends the right class, e.g. globalThis.InstanceType.MyObjectName`)}return this._iScriptInterface}_GetInstVarsScriptDescriptor(e){if(0!==this._instVarValues.length){const s={},i=this._objectType._GetAllInstanceVariableJsPropNames();for(let e=0,t=i.length;e<t;++e)s[i[e]]={configurable:!1,enumerable:!0,get:y.Instance.prototype._GetInstanceVariableTypedValue.bind(this,e),set:y.Instance.prototype.SetInstanceVariableValue.bind(this,e)};const t=Object.create(Object.prototype,s);e.instVars={value:t,writable:!1}}}_GetBehaviorsScriptDescriptor(e){const t=this._behaviorInstances;if(0!==t.length){const s={};for(const r of t)s[r.GetBehaviorType().GetJsPropName()]={value:r.GetScriptInterface(),writable:!1};const i=Object.create(Object.prototype,s);e.behaviors={value:i,writable:!1}}}DispatchUserScriptEvent(e){if(this.HasScriptInterface()){const t=this.GetInterfaceClass(),s=(e.instance=t,this._runtime),i=s.IsDebug()&&!s.GetEventSheetManager().IsInEventEngine();i&&r.StartMeasuringScriptTime(),t.dispatchEvent(e),i&&r.AddScriptTime()}}}}{const yh=self.C3;yh.SceneGraphInfo=class extends yh.DefendedBase{constructor(i){super(),this._owner=i,this._parent=null,this._children=[],this._startWidth=i.GetWidth(),this._startHeight=i.GetHeight(),this._startScaleX=1,this._startScaleY=1,this._parentStartAngle=0,this._ownOpacity=1,this._startOpacity=i.GetOpacity(),this._tmpSceneGraphChildren=null,this._tmpSceneGraphChildrenIndexes=null,this._indexInParent=NaN,this._originalSizeKnown=!1,this._originalWidth=NaN,this._originalHeight=NaN,this._on_instance_create=e=>{if(e.instance===this._parent.GetInstance()){const t=i.GetRuntime(),s=(t.Dispatcher().removeEventListener(\"instancecreate\",this._on_instance_create),this._parent.GetInstance().GetSdkInstance());this._originalSizeKnown=!!s.IsOriginalSizeKnown(),this._originalWidth=this._originalSizeKnown?s.GetOriginalWidth():NaN,this._originalHeight=this._originalSizeKnown?s.GetOriginalHeight():NaN}}}Release(){this._parent=null,this._tmpSceneGraphChildren=null,this._tmpSceneGraphChildrenIndexes=null,this._indexInParent=NaN,this._originalSizeKnown=!1,this._originalWidth=NaN,this._originalHeight=NaN,yh.clearArray(this._children)}SetParent(e){if(this._ownOpacity=this._owner.GetOpacity(),this._startOpacity=this._ownOpacity,this._parent=e,this._parentStartAngle=e?e.GetAngle():0,this._parent){const t=this._owner,s=t.GetRuntime(),i=this._parent.GetInstance().GetPlugin().GetSdkVersion();if(i<2){const r=this._parent.GetInstance().GetSdkInstance();r?(this._originalSizeKnown=!!r.IsOriginalSizeKnown(),this._originalWidth=this._originalSizeKnown?r.GetOriginalWidth():NaN,this._originalHeight=this._originalSizeKnown?r.GetOriginalHeight():NaN):this._parent.GetInstance().IsDestroyed()||s.Dispatcher().addEventListener(\"instancecreate\",this._on_instance_create)}else this._originalSizeKnown=!1,this._originalWidth=NaN,this._originalHeight=NaN}else this._originalSizeKnown=!1,this._originalWidth=NaN,this._originalHeight=NaN}GetParent(){return this._parent}HasChildren(){return 0<this._children.length}GetChildren(){return this._children}_MaybeSortChildren(){this.HasChildren()&&1!==this._children.length&&(this._tmpSceneGraphChildrenIndexes?this._children.sort((e,t)=>{const s=this._tmpSceneGraphChildrenIndexes.get(e.GetInstance()),i=this._tmpSceneGraphChildrenIndexes.get(t.GetInstance());return yh.IsFiniteNumber(s)&&yh.IsFiniteNumber(i)?s-i:0}):this._children.sort((e,t)=>{const s=e._GetSceneGraphInfo()._GetIndexInParent(),i=t._GetSceneGraphInfo()._GetIndexInParent();return yh.IsFiniteNumber(s)&&yh.IsFiniteNumber(i)?s-i:0}))}_GetIndexInParent(){return this._indexInParent}GetStartScaleX(){return this._startScaleX}SetStartScaleX(e){this._startScaleX=e}GetStartScaleY(){return this._startScaleY}SetStartScaleY(e){this._startScaleY=e}GetStartOpacity(){return this._startOpacity}GetOwnOpacity(){return this._ownOpacity}SetOwnOpacity(e){this._ownOpacity=e}_GetStartWidth(){return 0===this._startWidth?Number.EPSILON:this._startWidth}_GetStartHeight(){return 0===this._startHeight?Number.EPSILON:this._startHeight}GetParentScaleX(){if(this._owner.GetTransformWithParentWidth()){let e=this._parent,t=e.GetWidth(),s=e._GetSceneGraphInfo()._GetStartWidth();return 0===t&&(t=Number.EPSILON),s===Number.EPSILON&&t===Number.EPSILON?1:s===Number.EPSILON&&t!==Number.EPSILON&&this._originalSizeKnown?1+t/this._originalWidth:t/s}return 1}GetParentScaleY(){if(this._owner.GetTransformWithParentHeight()){let e=this._parent,t=e.GetHeight(),s=e._GetSceneGraphInfo()._GetStartHeight();return 0===t&&(t=Number.EPSILON),s===Number.EPSILON&&t===Number.EPSILON?1:s===Number.EPSILON&&t!==Number.EPSILON&&this._originalSizeKnown?1+t/this._originalHeight:t/s}return 1}GetParentStartAngle(){return 0}_SaveToJsonProperties(){return{sw:this._startWidth,sh:this._startHeight,sx:this._startScaleX,sy:this._startScaleY,psa:this._parentStartAngle,oo:this._ownOpacity,so:this._startOpacity,pi:this._owner.GetInstance().GetIndexInParent()}}_SaveToJson(e,t=null){const s=this._SaveToJsonProperties();return t&&t.selfOnly?Object.assign(s,{p:null,c:[]}):Object.assign(s,{p:this._GetParentJson(e),c:this._GetChildrenJson(e)})}_GetFlagsString(e){let t=\"\";return e.GetTransformWithParentX()&&(t+=\"x\"),e.GetTransformWithParentY()&&(t+=\"y\"),e.GetTransformWithParentWidth()&&(t+=\"w\"),e.GetTransformWithParentHeight()&&(t+=\"h\"),e.GetTransformWithParentAngle()&&(t+=\"a\"),e.GetTransformWithParentZElevation()&&(t+=\"z\"),e.GetDestroyWithParent()&&(t+=\"d\"),e.GetTransformWithParentOpacity()&&(t+=\"o\"),e.GetTransformWithParentVisibility()&&(t+=\"v\"),t}_GetParentJson(e){return this._parent&&this._parent.GetInstance()&&!this._parent.GetInstance().IsDestroyed()?this._GetInstanceJson(this._parent,this._owner,e):null}_GetChildrenJson(t){return this._children.map(e=>this._GetInstanceJson(e,e,t)).filter(e=>e)}_GetInstanceJson(e,t,s){const i=e.GetInstance();if(i&&i.IsDestroyed())return null;const r={};return r.uid=i.GetUID(),r.f=this._GetFlagsString(t),r.offsets=t._SaveSceneGraphPropertiesToJson(),r.data=yh.SceneGraphInfo.GetSceneGraphInstanceDataFromInstance(i),r.oci=i.GetObjectClass().GetIndex(),\"state\"===s?(r.inst=i.SaveToJson(\"full\",{selfOnly:!0}),r.instIndex=NaN):(r.instIndex=i.GetObjectClass().GetInstances().indexOf(i),r.inst=null),r}_LoadFromJson(e){this._startWidth=e.sw,this._startHeight=e.sh,this._startScaleX=e.sx,this._startScaleY=e.sy,this._parentStartAngle=e.psa,this._ownOpacity=e.oo,this._startOpacity=e.so,this._indexInParent=yh.IsFiniteNumber(e.pi)?e.pi:NaN}_SetTmpSceneGraphChildren(e,t){if(!e&&!t&&this._tmpSceneGraphChildren)for(const s of this._tmpSceneGraphChildren)s.IsDestroyed()||s.HasParent()||s.GetRuntime().DestroyInstance(s);this._tmpSceneGraphChildren=e,this._tmpSceneGraphChildrenIndexes=t}_OnAfterLoad(e,t){const s=this._owner,i=s.GetRuntime(),r=new Set;if(e.p&&!this._parent){const o=e.p.uid,h=i.GetInstanceByUID(o);if(t?.setFromJson,h){const l=h.GetWorldInfo();if(h.HasChild(s.GetInstance()))this._parent=l;else{h.HasChildWithUID(s.GetInstance().GetUID())?i.DestroyInstance(s.GetInstance()):h.AddChild(s.GetInstance(),this._GetFlagsObj(e.p.f)),r.has(s)||(s._LoadSceneGraphPropertiesFromJson(e.p.offsets),this._LoadInstancePropertiesFromJson(h,e.p,t)),r.add(s);const c=h.GetWorldInfo();c._GetSceneGraphInfo()._MaybeSortChildren()}}else if(yh.IsFiniteNumber(e.p.oci)){const u=i.GetObjectClassByIndex(e.p.oci),_=(i.GetSystemPlugin(),i.CreateInstance(u,s.GetLayer(),0,0,!0));if(t?.setFromJson,_){const d=this._GetInstanceData(e.p,i),p=(d&&_.LoadFromJson(d),_.GetWorldInfo()),f=(p.GetLayer().SortAndAddInstancesByZIndex(_),_.AddChild(s.GetInstance(),this._GetFlagsObj(e.p.f)),_.GetWorldInfo());f._GetSceneGraphInfo()._MaybeSortChildren()}}}const n=[];for(const m of e.c){const g=m.uid,S=i.GetInstanceByUID(g);S&&n.push(S)}let a=0;for(const y of e.c){const G=y.uid,I=i.GetInstanceByUID(G);if(t?.setFromJson,I){if(this._tmpSceneGraphChildren){if(this._tmpSceneGraphChildren.includes(I)){const w=I;if(w.GetObjectClass()!==I.GetObjectClass()){a++;continue}if(w.IsDestroyed()){a++;continue}const x=e.c[a];if(!t?.setFromJson&&this._HasAllChildrenOfType(w,n,s)){this._UpdateInstance(a,x,s,r,t),a++;continue}if(w.HasParent()&&w.GetParent()!==s.GetInstance()){const v=this._CreateNewChildInstance(x,t);this._AddAndSetChildInstance(v,x,r,t),a++;continue}this._AddAndSetChildInstance(w.GetWorldInfo(),x,r,t,!0),a++;continue}if(this._tmpSceneGraphChildren[a]){const P=this._tmpSceneGraphChildren[a];if(P.GetObjectClass()!==I.GetObjectClass()){a++;continue}if(P.IsDestroyed()){a++;continue}const R=e.c[a];if(!t?.setFromJson&&this._HasAllChildrenOfType(P,n,s)){this._UpdateInstance(a,R,s,r,t),a++;continue}if(P.HasParent()&&P.GetParent()!==s.GetInstance()){const A=this._CreateNewChildInstance(R,t);this._AddAndSetChildInstance(A,R,r,t),a++;continue}this._AddAndSetChildInstance(P.GetWorldInfo(),R,r,t,!0),a++;continue}}const T=I.GetObjectClass(),C=this._GetInstancesOfObjectClassCount(n,T),b=s.GetInstance().GetChildrenOfObjectClass(T).length;if(C===b){const M=s.GetInstance().GetChildAt(a);if(M){const D=M.GetWorldInfo();D&&(r.has(D)||(D._LoadSceneGraphPropertiesFromJson(y.offsets),this._LoadInstancePropertiesFromJson(M,y,t)),r.add(D))}a++;continue}if(I.HasParent()&&I.GetParent()!==s.GetInstance()){const E=this._CreateNewChildInstance(y,t);this._AddAndSetChildInstance(E,y,r,t),a++;continue}this._AddAndSetChildInstance(I.GetWorldInfo(),y,r,t)}else if(this._tmpSceneGraphChildren&&this._tmpSceneGraphChildren[a]){const F=this._tmpSceneGraphChildren[a],O=i.GetObjectClassByIndex(this._GetObjectClassIndex(y));if(F.GetObjectClass()!==O){a++;continue}if(F.IsDestroyed()){a++;continue}const B=e.c[a];if(!t?.setFromJson&&this._HasAllChildrenOfType(F,n,s)){this._UpdateInstance(a,B,s,r,t),a++;continue}if(F.HasParent()&&F.GetParent()!==s.GetInstance()){const L=this._CreateNewChildInstance(B,t);this._AddAndSetChildInstance(L,B,r,t),a++;continue}this._AddAndSetChildInstance(F.GetWorldInfo(),B,r,t)}else{const k=this._CreateNewChildInstance(y,t);this._AddAndSetChildInstance(k,y,r,t)}a++}}_HasAllChildrenOfType(e,t,s){const i=e.GetObjectClass(),r=this._GetInstancesOfObjectClassCount(t,i),n=s.GetInstance().GetChildrenOfObjectClass(i).length;return r===n}_UpdateInstance(e,t,s,i,r){const n=s.GetInstance().GetChildAt(e,t);if(n){const a=n.GetWorldInfo();a&&(i.has(a)||(a._LoadSceneGraphPropertiesFromJson(t.offsets),this._LoadInstancePropertiesFromJson(n,t,r)),i.add(a))}}_GetFlagsObj(e){const t={};return t.transformX=e.includes(\"x\"),t.transformY=e.includes(\"y\"),t.transformWidth=e.includes(\"w\"),t.transformHeight=e.includes(\"h\"),t.transformAngle=e.includes(\"a\"),t.transformZElevation=e.includes(\"z\"),t.destroyWithParent=e.includes(\"d\"),t.transformOpacity=e.includes(\"o\"),t.transformVisibility=e.includes(\"v\"),t}_GetObjectClassIndex(e){return yh.IsFiniteNumber(e.oci)?e.oci:e[1]}_CreateNewChildInstance(i,r){if(yh.IsFiniteNumber(i.oci)){let e=this._owner,t=e.GetRuntime(),s;if(i.data)s=t.CreateInstanceFromData(i.data,e.GetLayer(),!1,0,0,!1,!0);else{const n=t.GetObjectClassByIndex(i.oci);s=t.CreateInstance(n,e.GetLayer(),0,0,!0)}if(r?.setFromJson,s){const a=this._GetInstanceData(i,t),o=(a&&s.LoadFromJson(a),s.GetWorldInfo());return o.GetLayer().SortAndAddInstancesByZIndex(s,!0),o}}}_AddAndSetChildInstance(e,t,s,i,r=!0){const n=this._owner,a=n.AddChild(e,this._GetFlagsObj(t.f));a&&r&&(s.has(e)||(e._LoadSceneGraphPropertiesFromJson(t.offsets),this._LoadInstancePropertiesFromJson(e.GetInstance(),t,i)),s.add(e)),this._MaybeSortChildren()}_LoadInstancePropertiesFromJson(e,t,s){let i=this._GetInstanceData(t,this._owner.GetRuntime());i&&((i=JSON.parse(JSON.stringify(i))).w=null,e.LoadFromJson(i))}_GetInstancesOfObjectClassCount(e,t){return e.filter(e=>e.GetObjectClass().GetName()===t.GetName()).length}_GetInstanceData(e,t){if(yh.IsFiniteNumber(e.instIndex)){const s=t.GetObjectClassByIndex(e.oci),i=s._GetLoadInstancesJson();return i?i[e.instIndex]:null}return yh.IsString(e.inst)?JSON.parse(e.inst):e.inst||void 0}static GetSceneGraphInstanceDataFromInstance(e){let t=e.GetWorldInfo().GetLayer().GetInitialInstanceData(e.GetUID());if(!t)return null;t=JSON.parse(JSON.stringify(t));const s=[];for(const i of[...e.GetChildren()]){const r=i.GetWorldInfo();s.push([r.GetLayout().GetSID(),r.GetLayer().GetIndex(),i.GetUID(),yh.SceneGraphInfo._GetFlagsNumber(r),i.GetObjectClass().IsInContainer()?1:0,r.GetZIndex(),yh.SceneGraphInfo.GetSceneGraphInstanceDataFromInstance(i)])}return yh.IsArray(t[0][14])?t[0][14][1]=s:(t[0][14]=[],t[0][14][0]=yh.SceneGraphInfo._GetDefaultFlagsNumber(),t[0][14][1]=s,t[0][14][2]=e.GetWorldInfo().GetZIndex()),t}static _GetFlagsNumber(e){let t=0;return(t|=Number(e.GetTransformWithParentVisibility())<<8)|Number(e.GetTransformWithParentOpacity())<<7|Number(e.GetTransformWithParentZElevation())<<6|Number(e.GetDestroyWithParent())<<5|Number(e.GetTransformWithParentAngle())<<4|Number(e.GetTransformWithParentHeight())<<3|Number(e.GetTransformWithParentWidth())<<2|Number(e.GetTransformWithParentY())<<1|Number(e.GetTransformWithParentX())<<0}static _GetDefaultFlagsNumber(e){let t=0;return t,511}}}{let d=self.C3,e=self.glMatrix,n=(e.vec3,d.New(d.Rect)),a=d.New(d.Quad),t=d.New(d.Event,\"bboxchange\",!1),_=d.New(d.Color,0,0,0,0),c=d.New(d.CollisionPoly),s=d.New(d.Color,1,1,1,1),o=d.New(d.Rect,0,0,-1,-1),r=d.New(d.Rect,0,0,-1,-1),p=new Set([\"absolute\",\"relative\"]),i=[],f=!0,m=new WeakMap,h=new WeakMap;d.WorldInfo=class extends d.DefendedBase{constructor(e,t){super(),this._inst=e,this._objectClass=e.GetObjectClass(),this._runtime=e.GetRuntime(),this._layer=t,this._objectClass._OnWorldInstanceLayerChanged(this,null,t),this._zIndex=-1,this._htmlZIndex=-1,this._flags=196635,this._objectClass.GetPlugin().IsRotatable()&&(this._flags|=128),this._x=NaN,this._y=NaN,this._zElevation=NaN,this._w=NaN,this._h=NaN,this._depth=NaN,this._a=NaN,this._sinA=NaN,this._cosA=NaN,this._ox=NaN,this._oy=NaN,this._boundingBox=d.New(d.Rect),this._boundingQuad=d.New(d.Quad),this._collisionCells=r,this._renderCells=o,this._sourceCollisionPoly=null,this._transformedPolyInfo=null,this._solidFilterTags=null,this._color=s,this._colorPremultiplied=s,this._stateGroup=null,this._instanceEffectList=null,this._inst.GetObjectClass().UsesEffects()&&(this._instanceEffectList=d.New(d.InstanceEffectList,this._inst,this)),this._sceneGraphInfo=null,this._tmpSceneGraphChildren=null,this._tmpSceneGraphChildrenIndexes=null,this._tmpHierarchyPosition=-1,this._meshInfo=null}_MarkDestroyed(){this._flags|=256}Release(){if(this._objectClass._OnWorldInstanceLayerChanged(this,this._layer,null),this._stateGroup&&(this._runtime.GetRenderer().ReleaseStateGroup(this._stateGroup),this._stateGroup=null),this._sourceCollisionPoly=null,this._transformedPolyInfo&&(this._transformedPolyInfo.poly.Release(),this._transformedPolyInfo=null),this._solidFilterTags&&(this._solidFilterTags.clear(),this._solidFilterTags=null),this.ReleaseMesh(),this._instanceEffectList&&this._instanceEffectList.Release(),this.HasParent()&&this.GetParent().RemoveChild(this),this.HasChildren()){const e=[...this.GetChildren()];for(const t of e)this.RemoveChild(t)}this._ReleaseSceneGraphInfo(),this._ReleaseTmpSceneGraphInfo(),m.delete(this),h.delete(this),this._inst=null,this._objectClass=null,this._runtime=null,this._layer=null}Init(e){if(f=!1,this.SetXY(e[0],e[1]),this.SetZElevation(e[2]),this.SetSize(e[3],e[4]),this._depth=0,this.IsRotatable()?this.SetAngle(e[6]):this._a=0,_.setFromJSON(e[7]),this._SetColor(_),this.SetOriginX(e[8]),this.SetOriginY(e[9]),this.SetBlendMode(e[10]),this._instanceEffectList&&this._instanceEffectList._LoadEffectParameters(e[12]),e[14]&&m.set(this,{childrenData:e[14][1],zIndexData:e[14][2]}),e[15]){const t=e[15],i=(this.CreateMesh(t[0],t[1]),this.GetSourceMesh()),r=t[2];for(let s=0,e=r.length;s<e;++s){const n=r[s];for(let e=0,t=n.length;e<t;++e){const a=n[e],o=i.GetMeshPointAt(e,s);o.SetX(a[0]),o.SetY(a[1]),o.SetZElevation(a[2]),o.SetU(a[3]),o.SetV(a[4])}}}if(e[16]){const s=e[16][0],h=e[16][1],l=!!h,c=!l,u=this._runtime.GetTemplateManager();l&&u&&u.MapInstanceToTemplateName(this.GetInstance(),h),c&&u&&u.MapInstanceToTemplateName(this.GetInstance(),s)}f=!0,this._UpdateRendererStateGroup()}InitNoData(){this._x=0,this._y=0,this._zElevation=0,this._w=0,this._h=0,this._depth=0,this._a=0,this._sinA=0,this._cosA=1,this._ox=0,this._oy=0,this._UpdateRendererStateGroup()}GetRuntime(){return this._runtime}GetObjectClass(){return this._objectClass}GetInstance(){return this._inst}_GetParentOffsetAngle(){return this.GetTransformWithParentAngle()?this._MaybeReflectAngleForMirrorFlip(this.GetParent()._GetAngleNoReflect()-this._sceneGraphInfo.GetParentStartAngle()):0}SetX(e){if(e=+e,this.GetTransformWithParentX()){const t=this._sceneGraphInfo,s=e-this.GetX(),i=-this._GetParentOffsetAngle();0==i?this._x+=s/t.GetParentScaleX():(this._x+=Math.cos(i)*s/t.GetParentScaleX(),this.GetTransformWithParentY()&&(this._y+=Math.sin(i)*s/t.GetParentScaleY()))}else this._x=e}OffsetX(e,t=!1){e=+e,!t&&this.GetTransformWithParentX()?this.SetX(this.GetX()+e):this._x+=e}GetX(){if(this.GetTransformWithParentX()){let e=this._x,t=this._sceneGraphInfo,s=this.GetParent(),i=this._GetParentOffsetAngle();return 0===i?e*=t.GetParentScaleX():(e=e*t.GetParentScaleX()*Math.cos(i),this.GetTransformWithParentY()&&(e-=this._y*t.GetParentScaleY()*Math.sin(i))),s.GetX()+e}return this._x}SetY(e){if(e=+e,this.GetTransformWithParentY()){const t=this._sceneGraphInfo,s=e-this.GetY(),i=-this._GetParentOffsetAngle();0==i?this._y+=s/t.GetParentScaleY():(this.GetTransformWithParentX()&&(this._x-=Math.sin(i)*s/t.GetParentScaleX()),this._y+=Math.cos(i)*s/t.GetParentScaleY())}else this._y=e}OffsetY(e,t=!1){e=+e,!t&&this.GetTransformWithParentY()?this.SetY(this.GetY()+e):this._y+=e}GetY(){if(this.GetTransformWithParentY()){let e=this._y,t=this._sceneGraphInfo,s=this.GetParent(),i=this._GetParentOffsetAngle();return 0===i?e*=t.GetParentScaleY():(e=e*t.GetParentScaleY()*Math.cos(i),this.GetTransformWithParentX()&&(e+=this._x*t.GetParentScaleX()*Math.sin(i))),s.GetY()+e}return this._y}SetXY(e,t){if(e=+e,t=+t,this.GetTransformWithParentXOrY()){const s=this.GetTransformWithParentX(),i=this.GetTransformWithParentY(),r=this._sceneGraphInfo,n=e-this.GetX(),a=t-this.GetY(),o=-this._GetParentOffsetAngle();if(0==o)s?this._x+=n/r.GetParentScaleX():this._x=e,i?this._y+=a/r.GetParentScaleY():this._y=t;else{const h=Math.sin(o),l=Math.cos(o);s?this._x+=i?(l*n-h*a)/r.GetParentScaleX():l*n/r.GetParentScaleX():this._x=e,i?this._y+=s?(h*n+l*a)/r.GetParentScaleY():l*a/r.GetParentScaleY():this._y=t}}else this._x=e,this._y=t}GetXY(){return[this.GetX(),this.GetY()]}OffsetXY(e,t){e=+e,t=+t,this.GetTransformWithParentXOrY()?this.SetXY(this.GetX()+e,this.GetY()+t):(this._x+=e,this._y+=t)}EqualsXY(e,t){return this.GetX()===e&&this.GetY()===t}SetZElevation(e){if(e=+e,this.GetTransformWithParentZElevation()&&(e-=this.GetParent().GetZElevation()),this._zElevation!==e){this._zElevation=e,this._UpdateZElevation();const t=this.GetLayer();0!==this._zElevation&&t._SetAnyInstanceZElevated(),t.SetZIndicesChanged(this)}}_UpdateZElevation(){if(this._UpdateRendererStateGroup(),this.HasChildren()){const s=this.GetChildren();for(let e=0,t=s.length;e<t;e++){const i=s[e];i.GetTransformWithParentZElevation()&&i._UpdateZElevation()}}}OffsetZElevation(e){this.SetZElevation(this.GetZElevation()+e)}GetZElevation(){return this.GetTransformWithParentZElevation()?this.GetParent().GetZElevation()+this._zElevation:this._zElevation}GetTotalZElevation(){return this.GetLayer().GetZElevation()+this.GetZElevation()}IsOriginalSizeKnown(){const e=this.GetInstance().GetPlugin().GetSdkVersion();return e<2&&this.GetInstance().GetSdkInstance().IsOriginalSizeKnown()}SetWidth(e){if(e=+e,this.GetTransformWithParentWidth()){const t=this.GetWidth();0===t?this._w=Number.EPSILON:this._w*=e/t}else this._w=e;this._MarkSinCosAngleChanged()}OffsetWidth(e,t){e=+e,!t&&this.GetTransformWithParentWidth()?this.SetWidth(this.GetWidth()+e):this._w+=e,this._MarkSinCosAngleChanged()}GetWidth(){if(this.GetTransformWithParentWidth()){const e=this.GetParent(),t=e.GetWidth(),s=e._GetSceneGraphInfo()._GetStartWidth();return s===Number.EPSILON?(this._GetSceneGraphInfo()._GetStartWidth()+t)*this._w:t*this._w}return this._w}SetHeight(e){if(e=+e,this.GetTransformWithParentHeight()){const t=this.GetHeight();0===t?this._h=Number.EPSILON:this._h*=e/t}else this._h=e;this._MarkSinCosAngleChanged()}OffsetHeight(e,t){e=+e,!t&&this.GetTransformWithParentHeight()?this.SetHeight(this.GetHeight()+e):this._h+=e,this._MarkSinCosAngleChanged()}GetHeight(){if(this.GetTransformWithParentHeight()){const e=this.GetParent(),t=e.GetHeight(),s=e._GetSceneGraphInfo()._GetStartHeight();return s===Number.EPSILON?(this._GetSceneGraphInfo()._GetStartHeight()+t)*this._h:t*this._h}return this._h}SetSize(e,t){if(e=+e,t=+t,this.GetTransformWithParentWidth()){const s=this.GetWidth();0===s?this._w=Number.EPSILON:this._w*=e/s}else this._w=e;if(this.GetTransformWithParentHeight()){const i=this.GetHeight();0===i?this._h=Number.EPSILON:this._h*=t/i}else this._h=t;this._MarkSinCosAngleChanged()}GetSize(){return[this.GetWidth(),this.GetHeight()]}GetDepth(){return this._depth}SetDepth(e){if(e<0)throw new RangeError(\"invalid depth\");this._depth=e}GetSceneGraphScale(){if(this.HasParent()){const e=this._sceneGraphInfo;return Math.min(e.GetParentScaleX(),e.GetParentScaleY())}return 1}IsRotatable(){return 0!=(128&this._flags)}SetAngle(e){e=+e,this.IsRotatable()&&(this.GetTransformWithParentAngle()&&(e-=this.GetParent().GetAngle()),e=d.clampAngle(e),this._a!==e)&&(this._a=e,this._MarkSinCosAngleChanged())}OffsetAngle(e){0!=(e=+e)&&this.IsRotatable()&&(this._a=d.clampAngle(this._a+e),this._MarkSinCosAngleChanged())}_MarkSinCosAngleChanged(){if(this._flags|=1<<18,this.HasChildren()){const s=this.GetChildren();for(let e=0,t=s.length;e<t;e++)s[e]._MarkSinCosAngleChanged()}}GetAngle(){return this.GetTransformWithParentAngle()&&this.IsRotatable()?this._MaybeReflectAngleForMirrorFlip(d.clampAngle(this.GetParent()._GetAngleNoReflect()+this._a)):this._a}_GetAngleNoReflect(){return this.GetTransformWithParentAngle()&&this.IsRotatable()?d.clampAngle(this.GetParent()._GetAngleNoReflect()+this._a):this._a}_MaybeReflectAngleForMirrorFlip(e){return this.GetTransformWithParentWidth()&&this.GetTopParent().GetWidth()<0&&(e=d.clampAngle(d.angleReflect(e,this.GetTopParent().GetAngle()+Math.PI))),this.GetTransformWithParentHeight()&&this.GetTopParent().GetHeight()<0?d.angleReflect(e,this.GetTopParent().GetAngle()):e}_NeedsReflectAngleForMirrorOrFlip(){const e=this.GetParent();return!!(this.GetTransformWithParentWidth()&&e.GetWidth()<0)||!!(this.GetTransformWithParentHeight()&&e.GetHeight()<0)}_NeedsReflectAngleForMirrorAndFlip(){const e=this.GetParent();return!!(this.GetTransformWithParentWidth()&&e.GetWidth()<0&&this.GetTransformWithParentHeight()&&e.GetHeight()<0)}_MaybeUpdateSinCosAngle(){const e=this._flags;if(0!=(e&1<<18)){const t=this.GetAngle();this._sinA=Math.sin(t),this._cosA=Math.cos(t),this._flags=-262145&e}}GetSinAngle(){return this._MaybeUpdateSinCosAngle(),this._sinA}GetCosAngle(){return this._MaybeUpdateSinCosAngle(),this._cosA}SetOriginX(e){this._ox=+e}OffsetOriginX(e){this._ox+=+e}GetOriginX(){return this._ox}SetOriginY(e){this._oy=+e}OffsetOriginY(e){this._oy+=+e}GetOriginY(){return this._oy}_SetColor(e){this._color.equals(e)||(this._color===s?(this._color=d.New(d.Color,e),this._colorPremultiplied=d.New(d.Color,e),this._colorPremultiplied.premultiply()):e.equalsRgba(1,1,1,1)?(this._color=s,this._colorPremultiplied=s):(this._color.set(e),this._colorPremultiplied.set(e),this._colorPremultiplied.premultiply()),this._UpdateRendererStateGroup())}SetOpacity(e){if(e=d.clamp(+e,0,1),this.GetTransformWithParentOpacity()){if(this._GetSceneGraphInfo().GetOwnOpacity()===e)return;this._GetSceneGraphInfo().SetOwnOpacity(e),e=this.GetOpacity()}else if(this._color.a===e)return;this._SetColorWithOpacity(e)}_SetOpacityOfChildren(){if(this.HasChildren()){const s=this.GetChildren();for(let e=0,t=s.length;e<t;e++){const i=s[e];i._SetColorWithOpacity(i.GetOpacity())}}}_SetColorWithOpacity(e){_.copyRgb(this._color),_.a=e,this._SetColor(_),this._SetOpacityOfChildren()}OffsetOpacity(e){this.GetTransformWithParentOpacity()?this.SetOpacity(this._GetSceneGraphInfo().GetOwnOpacity()+e):this.SetOpacity(this.GetOpacity()+e)}GetOpacity(){return this.GetTransformWithParentOpacity()?this.GetParent().GetOpacity()*this._GetSceneGraphInfo().GetOwnOpacity():this._color.a}SetUnpremultipliedColor(e){this._color.equalsIgnoringAlpha(e)||(_.copyRgb(e),_.a=this.GetOpacity(),this._SetColor(_))}SetUnpremultipliedColorRGB(e,t,s){_.setRgb(e,t,s),this.SetUnpremultipliedColor(_)}OffsetUnpremultipliedColorRGB(e,t,s){0===e&&0===t&&0===s||(_.copyRgb(this._color),_.r+=e,_.g+=t,_.b+=s,this.SetUnpremultipliedColor(_))}GetUnpremultipliedColor(){return this._color}GetPremultipliedColor(){return this._colorPremultiplied}GetDestroyWithParent(){return 0!=(512&this._flags)}SetDestroyWithParent(e){this._SetFlag(512,e)}GetTransformWithParentX(){return 0!=(1024&this._flags)}SetTransformWithParentX(e){this._SetFlag(1024,e)}GetTransformWithParentY(){return 0!=(2048&this._flags)}GetTransformWithParentXOrY(){return 0!=(3072&this._flags)}SetTransformWithParentY(e){this._SetFlag(2048,e)}GetTransformWithParentWidth(){return 0!=(4096&this._flags)}SetTransformWithParentWidth(e){this._SetFlag(4096,e)}GetTransformWithParentHeight(){return 0!=(8192&this._flags)}SetTransformWithParentHeight(e){this._SetFlag(8192,e)}GetTransformWithParentAngle(){return 0!=(16384&this._flags)}SetTransformWithParentAngle(e){this._SetFlag(16384,e)}GetTransformWithParentZElevation(){return 0!=(32768&this._flags)}SetTransformWithParentZElevation(e){this._SetFlag(32768,e)}GetTransformWithParentOpacity(){return 0!=(this._flags&1<<22)}SetTransformWithParentOpacity(e){this._SetFlag(1<<22,e)}GetTransformWithParentVisibility(){return 0!=(this._flags&1<<23)}SetTransformWithParentVisibility(e){this._SetFlag(1<<23,e)}_ClearAllSceneGraphFlags(){this._flags&=-12647937}AddChild(e,t){if(e===this)return!1;if(e.HasParent())return!1;if(this._HasChildRecursive(e))return!1;if(this._HasAnyParent(e))return!1;const s=e.GetX(),i=e.GetY(),r=e.GetWidth(),n=e.GetHeight(),a=e.GetAngle(),o=e.GetZElevation(),h=e.GetOpacity(),l=(e._SetParent(this),e.SetTransformWithParentX(t.transformX),e.SetTransformWithParentY(t.transformY),e.SetTransformWithParentWidth(t.transformWidth),e.SetTransformWithParentHeight(t.transformHeight),e.SetTransformWithParentAngle(t.transformAngle),e.SetTransformWithParentZElevation(t.transformZElevation),e.SetTransformWithParentOpacity(t.transformOpacity),e.SetTransformWithParentVisibility(t.transformVisibility),e.SetDestroyWithParent(t.destroyWithParent),s-this.GetX()),c=i-this.GetY(),u=-this.GetAngle(),_=Math.cos(u),d=Math.sin(u);if(t.transformX&&(t.transformAngle?e._x=l*_-c*d:e._x=l,t.transformWidth)){const p=this.GetWidth()/this._sceneGraphInfo._GetStartWidth();0!=p&&(e._x/=p)}if(t.transformY&&(t.transformAngle?e._y=l*d+c*_:e._y=c,t.transformHeight)){const f=this.GetHeight()/this._sceneGraphInfo._GetStartHeight();0!=f&&(e._y/=f)}if(t.transformWidth){const m=this.GetWidth();0===m||m===Number.EPSILON?(e._w=1,e._sceneGraphInfo.SetStartScaleX(1)):(e._w=r/this.GetWidth(),e._sceneGraphInfo.SetStartScaleX(e._w))}if(t.transformHeight){const g=this.GetHeight();0===g||g===Number.EPSILON?(e._h=1,e._sceneGraphInfo.SetStartScaleY(1)):(e._h=n/this.GetHeight(),e._sceneGraphInfo.SetStartScaleY(e._h))}return t.transformAngle&&(e._a=a-this.GetAngle()),t.transformZElevation&&(e._zElevation=o-this.GetZElevation()),t.transformOpacity&&e._sceneGraphInfo.SetOwnOpacity(h),t.transformVisibility&&e.SetVisible(this.IsVisible()),this._AddChildToSceneGraphInfo(e),this.SetBboxChanged(),this._SetOpacityOfChildren(),!0}RemoveChild(e){if(e.GetParent()===this){const t=e.GetX(),s=e.GetY(),i=e.GetWidth(),r=e.GetHeight(),n=e.GetAngle(),a=e.GetZElevation(),o=e.GetOpacity();e._SetParent(null),e._ClearAllSceneGraphFlags(),e.SetXY(t,s),e.SetSize(i,r),e.SetAngle(n),e.SetZElevation(a),e.SetOpacity(o),this._RemoveChildFromSceneGraphInfo(e),this.SetBboxChanged()}}GetTmpHierarchyPosition(){return this._tmpHierarchyPosition}_ResetAllSceneGraphState(){this._BuildTmpSceneGraphData();const e=[...this.children()];for(const s of e)this.RemoveChild(s);const t=this.GetParent();t&&t.RemoveChild(this),this._ClearAllSceneGraphFlags()}_BuildTmpSceneGraphData(){if(this._SetTmpHierarchyPosition(),!this._tmpSceneGraphChildren){const t=[...this.children()];t.length&&(this._tmpSceneGraphChildren=[],this._tmpSceneGraphChildrenIndexes=new WeakMap);let e=0;for(const s of t){const i=s.GetInstance();this._tmpSceneGraphChildren.push(i),this._tmpSceneGraphChildrenIndexes.set(i,e),e++}}const e=this.GetParent();e&&e._BuildTmpSceneGraphData()}_SetTmpHierarchyPosition(){if(-1===this._tmpHierarchyPosition){const e=[...this.parents()];this._tmpHierarchyPosition=e.length;for(const s of e)s._SetTmpHierarchyPosition();const t=[...this.children()];for(const i of t)i._SetTmpHierarchyPosition()}}_ReleaseTmpSceneGraphInfo(){this._tmpSceneGraphChildren&&(this._tmpSceneGraphChildren.length=0),this._tmpSceneGraphChildren=null,this._tmpSceneGraphChildrenIndexes=null;const e=this.GetParent();e&&e._ReleaseTmpSceneGraphInfo(),this._tmpHierarchyPosition=-1}HasParent(){return null!==this.GetParent()}GetParent(){const e=this._sceneGraphInfo;return null!==e?e.GetParent():null}GetTopParent(){let e=this;for(;e.HasParent();)e=e.GetParent();return e}*parents(){let e=this.GetParent();for(;e;)yield e,e=e.GetParent()}HasChild(e){return this.GetChildren().includes(e)}HasChildren(){const e=this._sceneGraphInfo;return null!==e&&e.HasChildren()}GetChildren(){const e=this._sceneGraphInfo;return null!==e?e.GetChildren():i}children(){return this.GetChildren()}*allChildren(){for(const e of this.children())yield e,yield*e.allChildren()}GetChildCount(){return this.GetChildren().length}GetAllChildCount(){return[...this.allChildren()].length}GetChildAt(e){const t=this.GetChildren();return(e=Math.floor(+e))<0||e>=t.length?null:t[e]}GetChildIndex(t){if(t){const s=this.GetChildren();if(s)for(let e=0;e<s.length;e++)if(t===s[e])return e}return NaN}_CreateSceneGraphInfo(e){this._sceneGraphInfo||(this._sceneGraphInfo=d.New(d.SceneGraphInfo,this)),e&&this._sceneGraphInfo.SetParent(e)}_GetSceneGraphInfo(){return this._sceneGraphInfo}_ReleaseSceneGraphInfo(){this._sceneGraphInfo&&(this._sceneGraphInfo.Release(),this._sceneGraphInfo=null)}_SetParent(e){e?(e._CreateSceneGraphInfo(null),this._CreateSceneGraphInfo(e)):(this._sceneGraphInfo&&this._sceneGraphInfo.SetParent(null),this.HasChildren()||this._ReleaseSceneGraphInfo())}_HasAnyParent(e){if(!this.HasParent())return!1;const t=this.GetParent();return t===e||t._HasAnyParent(e)}_HasChildRecursive(e){if(this.HasChild(e))return!0;for(const t of this.GetChildren())if(t._HasChildRecursive(e))return!0;return!1}_AddChildToSceneGraphInfo(e){this._sceneGraphInfo.GetChildren().push(e)}_RemoveChildFromSceneGraphInfo(e){const t=this._sceneGraphInfo.GetChildren(),s=t.indexOf(e);-1!==s&&t.splice(s,1),0!==t.length||this.HasParent()||this._ReleaseSceneGraphInfo(),e.HasChildren()||e._ReleaseSceneGraphInfo()}GetSceneGraphChildrenExportData(){const e=m.get(this);return e?e.childrenData:null}GetSceneGraphZIndexExportData(){const e=m.get(this);return e?e.zIndexData:NaN}GetSceneGraphZIndex(){const e=h.get(this);return d.IsFiniteNumber(e)?e:NaN}SetSceneGraphZIndex(e){h.set(this,e)}SetUsePointsShaderProgram(){this._SetFlag(1<<19,!0),this._UpdateRendererStateGroup()}_UpdateRendererStateGroup(){if(f){const t=this._runtime.GetRenderer();this._stateGroup&&t.ReleaseStateGroup(this._stateGroup);let e;e=0!=(this._flags&1<<19)?t.GetPointsRenderingProgram()||\"<point>\":t.GetTextureFillShaderProgram()||\"<default>\",this._stateGroup=t.AcquireStateGroup(e,this.GetBlendMode(),this._colorPremultiplied,this.GetZElevation())}}GetRendererStateGroup(){return this._stateGroup}HasDefaultColor(){return this._color===s}SetBlendMode(e){if((e|=0)<0||31<e)throw new RangeError(\"invalid blend mode\");this.GetBlendMode()!==e&&(this._flags=this._flags&~(31<<26)|e<<26,this._UpdateRendererStateGroup())}GetBlendMode(){return(this._flags&31<<26)>>26}_SetLayer(e,t){const s=t&&this._layer!==e;s&&this._RemoveFromRenderCells(),this._objectClass._OnWorldInstanceLayerChanged(this,this._layer,e),this._layer=e,s&&this._UpdateRenderCell(),0!==this.GetZElevation()&&this._layer._SetAnyInstanceZElevated()}GetLayer(){return this._layer}GetLayout(){return this.GetLayer().GetLayout()}_SetZIndex(e){this._zIndex=0|e}GetZIndex(){return this._layer._UpdateZIndices(),this._zIndex}_SetHTMLZIndex(e){this._htmlZIndex=0|e}GetHTMLZIndex(){return this._layer._UpdateHTMLZIndices(),this._htmlZIndex}_GetLastCachedZIndex(){return this._zIndex}_SetFlag(e,t){t?this._flags|=e:this._flags&=~e}IsVisible(){return 0!=(1&this._flags)}SetVisible(e){if(this._SetFlag(1,e),this.HasChildren())for(const t of this.GetChildren())t.GetTransformWithParentVisibility()&&t.SetVisible(e)}IsCollisionEnabled(){return 0!=(8&this._flags)}SetCollisionEnabled(e){e=!!e,this.IsCollisionEnabled()!==e&&(this._SetFlag(8,e),e?this.SetBboxChanged():this._RemoveFromCollisionCells())}SetSolidCollisionFilter(e,t){if(this._SetFlag(32,e),this._solidFilterTags&&this._solidFilterTags.clear(),t.trim()){this._solidFilterTags||(this._solidFilterTags=new Set);for(const s of t.split(\" \"))s&&this._solidFilterTags.add(s.toLowerCase())}else this._solidFilterTags=null}IsSolidCollisionAllowed(e){const t=0!=(32&this._flags),s=this._solidFilterTags;if(e&&s)for(const i of s)if(e.has(i))return t;return!t}SetBboxChanged(){if(this._flags|=65554,this._objectClass._SetAnyCollisionCellChanged(!0),this._runtime.UpdateRender(),this._layer.UsesRenderCells()&&(this.CalculateBbox(this._boundingBox,this._boundingQuad,!0),this._flags&=-3,this._UpdateRenderCell()),0!=(4&this._flags)&&this._inst.Dispatcher().dispatchEvent(t),null!==this._sceneGraphInfo){const s=this._sceneGraphInfo.GetChildren();for(let e=0,t=s.length;e<t;++e)s[e].SetBboxChanged()}}CalculateBbox(e,t,s){const i=this.GetX(),r=this.GetY(),n=this.GetWidth(),a=this.GetHeight(),o=this.GetAngle();e.setWH(i-this._ox*n,r-this._oy*a,n,a),s&&this.HasMesh()&&this._ExpandBboxForMesh(e),0===o?t.setFromRect(e):(e.offset(-i,-r),t.setFromRotatedRectPrecalc(e,this.GetSinAngle(),this.GetCosAngle()),t.offset(i,r),t.getBoundingBox(e)),e.normalize()}_UpdateBbox(){const e=this._flags;0!=(2&e)&&(this.CalculateBbox(this._boundingBox,this._boundingQuad,!0),this._flags=-3&e)}GetBoundingBox(){return this._UpdateBbox(),this._boundingBox}GetBoundingQuad(){return this._UpdateBbox(),this._boundingQuad}PixelRoundQuad(e){const t=this.GetX(),s=this.GetY(),i=Math.round(t)-t,r=Math.round(s)-s;return 0==i&&0==r?e:(a.copy(e),a.offset(i,r),a)}OverwriteBoundingBox(e){this._boundingBox.copy(e),this._boundingQuad.setFromRect(this._boundingBox),this._flags&=-3,this._UpdateCollisionCell(),this._UpdateRenderCell()}SetBboxChangeEventEnabled(e){this._SetFlag(4,e)}IsBboxChangeEventEnabled(){return 0!=(4&this._flags)}IsInViewport(e,t,s){return t&&0!==this.GetDepth()?this.IsInViewport3D(this.GetLayer()._GetViewFrustum()):0===this.GetZElevation()||s?e.intersectsRect(this.GetBoundingBox()):this._IsInViewport_ZElevated()}_IsInViewport_ZElevated(){const e=this.GetLayer(),t=this.GetTotalZElevation();return!(t>=e.Get2DCameraZ())&&(e.GetViewportForZ(t,n),n.intersectsRect(this.GetBoundingBox()))}IsInViewport3D(e){const t=this.GetBoundingBox(),s=t.getLeft(),i=t.getRight(),r=t.getTop(),n=t.getBottom(),a=this.GetTotalZElevation(),o=a+this.GetDepth();return e.ContainsAABB(s,r,a,i,n,o)}IsInViewport2(){const e=this.GetLayer();if(e.Has3DCamera())return this.IsInViewport3D(e._GetViewFrustum());{const t=e.GetLayout();return this.IsInViewport(e.GetViewport(),t.HasVanishingPointOutsideViewport(),t.IsOrthographicProjection())}}_SetDrawBackFaceOnly(e){this._SetFlag(1<<20,e)}_SetDrawNonBackFacesOnly(e){this._SetFlag(1<<21,e)}IsDrawBackFaceOnly(){return 0!=(this._flags&1<<20)}IsDrawNonBackFacesOnly(){return 0!=(this._flags&1<<21)}SetSourceCollisionPoly(e){this._sourceCollisionPoly=e,this._DiscardTransformedCollisionPoly(),this.HasMesh()&&(this._meshInfo.meshPoly=null)}GetSourceCollisionPoly(){return this._sourceCollisionPoly}HasOwnCollisionPoly(){return null!==this._sourceCollisionPoly||this.HasMesh()}GetTransformedCollisionPoly(){return this._GetCustomTransformedCollisionPolyPrecalc(this.GetWidth(),this.GetHeight(),this.GetAngle(),this.GetSinAngle(),this.GetCosAngle())}GetCustomTransformedCollisionPoly(e,t,s){let i=0,r=1;return 0!==s&&(i=Math.sin(s),r=Math.cos(s)),this._GetCustomTransformedCollisionPolyPrecalc(e,t,s,i,r)}_GetCustomTransformedCollisionPolyPrecalc(r,n,e,a,o){let t=this._transformedPolyInfo;null===t&&(t={poly:d.New(d.CollisionPoly),width:NaN,height:NaN,angle:NaN},this._transformedPolyInfo=t);const h=t.poly;if(t.width!==r||t.height!==n||t.angle!==e){const l=this._sourceCollisionPoly;if(this.HasMesh()){let e=this.GetOriginX(),t=this.GetOriginY(),s=this.GetSourceMesh(),i=this._meshInfo.meshPoly;i||(l?(c.copy(l),c.offset(e,t)):c.setDefaultPoints(),i=s.InsertPolyMeshVertices(c),this._meshInfo.meshPoly=i),s.TransformCollisionPoly(i,h),h.offset(-e,-t),h.transformPrecalc(r,n,a,o)}else l?(h.copy(l),h.transformPrecalc(r,n,a,o)):h.setFromQuad(this.GetBoundingQuad(),-this.GetX(),-this.GetY());t.width=r,t.height=n,t.angle=e}return h}_DiscardTransformedCollisionPoly(){this.SetPhysicsBodyChanged(!0);const e=this._transformedPolyInfo;null!==e&&(e.width=NaN)}CreateMesh(e,t){if(e=Math.floor(e),t=Math.floor(t),!this.GetInstance().GetPlugin().SupportsMesh())throw new Error(\"object does not support mesh\");this.ReleaseMesh(),this._meshInfo={sourceMesh:d.New(d.Gfx.Mesh,e,t),transformedMesh:d.New(d.Gfx.Mesh,e,t),meshPoly:null}}HasMesh(){return null!==this._meshInfo}GetSourceMesh(){if(this.HasMesh())return this._meshInfo.sourceMesh;throw new Error(\"no mesh\")}GetTransformedMesh(){if(this.HasMesh())return this._meshInfo.transformedMesh;throw new Error(\"no mesh\")}SetMeshChanged(e){this._SetFlag(65536,e)}IsMeshChanged(){return 0!=(65536&this._flags)}SetPhysicsBodyChanged(e){this._SetFlag(1<<17,e)}IsPhysicsBodyChanged(){return 0!=(this._flags&1<<17)}_ExpandBboxForMesh(e){const t=this._meshInfo.sourceMesh,s=Math.min(t.GetMinX(),0),i=Math.min(t.GetMinY(),0),r=Math.max(t.GetMaxX(),1),n=Math.max(t.GetMaxY(),1),a=e.width(),o=e.height();e.offsetLeft(s*a),e.offsetTop(i*o),e.offsetRight((r-1)*a),e.offsetBottom((n-1)*o),this._depth=t.GetMaxZ()}ReleaseMesh(){this._meshInfo&&(this._meshInfo.sourceMesh.Release(),this._meshInfo.transformedMesh.Release(),this._meshInfo=null,this._DiscardTransformedCollisionPoly())}SetMeshPoint(e,t,s){e=Math.floor(e),t=Math.floor(t);const i=s.mode||\"absolute\";if(!p.has(i))throw new Error(\"invalid mode\");let r=\"relative\"===i,n=s.x,a=s.y,o=s.zElevation,h=\"number\"==typeof s.u?s.u:r?0:-1,l=\"number\"==typeof s.v?s.v:r?0:-1;if(!this.HasMesh())return!1;const c=this.GetSourceMesh(),u=c.GetMeshPointAt(e,t);if(null===u)return!1;let _=!1;return\"number\"==typeof o&&u.GetZElevation()!==o&&(u.SetZElevation(o),_=!0),r&&(n+=e/(c.GetHSize()-1),a+=t/(c.GetVSize()-1)),h=-1!==h||r?(r&&(h+=e/(c.GetHSize()-1)),d.clamp(h,0,1)):u.GetU(),l=-1!==l||r?(r&&(l+=t/(c.GetVSize()-1)),d.clamp(l,0,1)):u.GetV(),u.GetX()===n&&u.GetY()===a&&u.GetU()===h&&u.GetV()===l?_:(u.SetX(n),u.SetY(a),u.SetU(h),u.SetV(l),this._DiscardTransformedCollisionPoly(),!0)}HasTilemap(){return this._inst.HasTilemap()}ContainsPoint(e,t){return!!this.GetBoundingBox().containsPoint(e,t)&&!!this.GetBoundingQuad().containsPoint(e,t)&&(this.HasTilemap()?this._inst.GetSdkInstance().TestPointOverlapTile(e,t):!this.HasOwnCollisionPoly()||this.GetTransformedCollisionPoly().containsPoint(e-this.GetX(),t-this.GetY()))}_IsCollisionCellChanged(){return 0!=(16&this._flags)}_UpdateCollisionCell(){if(this._IsCollisionCellChanged()&&this.IsCollisionEnabled()&&0==(256&this._flags)){const e=this.GetBoundingBox(),t=this._objectClass._GetCollisionCellGrid(),s=this._collisionCells;if(n.set(t.XToCell(e.getLeft()),t.YToCell(e.getTop()),t.XToCell(e.getRight()),t.YToCell(e.getBottom())),!s.equals(n)){const i=this._inst;s===r?(t.Update(i,null,n),this._collisionCells=d.New(d.Rect,n)):(t.Update(i,s,n),s.copy(n)),this._flags&=-17}}}_SetCollisionCellChanged(){this._flags|=16}_RemoveFromCollisionCells(){const e=this._collisionCells;e!==r&&(this._objectClass._GetCollisionCellGrid().Update(this._inst,e,null),this._collisionCells=r)}_UpdateRenderCell(){const e=this.GetLayer();if(e.UsesRenderCells()&&0==(256&this._flags)){const t=e.GetRenderGrid(),s=this.GetBoundingBox(),i=this._renderCells;if(n.set(t.XToCell(s.getLeft()),t.YToCell(s.getTop()),t.XToCell(s.getRight()),t.YToCell(s.getBottom())),!i.equals(n)){const r=this._inst;i===o?(t.Update(r,null,n),this._renderCells=d.New(d.Rect,n)):(t.Update(r,i,n),i.copy(n)),e.SetRenderListStale()}}}_RemoveFromRenderCells(){const e=this._renderCells;e!==o&&(this.GetLayer().GetRenderGrid().Update(this._inst,e,null),this._renderCells=o)}GetRenderCellRange(){return this._renderCells}ZOrderMoveToTop(){const e=this._inst,t=this._layer,s=t._GetInstances();s.length&&s.at(-1)===e||(t._RemoveInstance(e,!1),t._AddInstance(e,!1),this._runtime.UpdateRender())}ZOrderMoveToBottom(){const e=this._inst,t=this._layer,s=t._GetInstances();s.length&&s[0]===e||(t._RemoveInstance(e,!1),t._PrependInstance(e,!1),this._runtime.UpdateRender())}ZOrderMoveToLayer(e){const t=this._inst,s=this._layer;if(s.GetLayout()!==e.GetLayout())throw new Error(\"layer from different layout\");e!==s&&(s._RemoveInstance(t,!0),this._SetLayer(e),e._AddInstance(t,!0),this._runtime.UpdateRender())}ZOrderMoveAdjacentToInstance(e,t){let s=this._inst,i=!1,r=this._layer;if(e.GetUID()!==s.GetUID()){const n=e.GetWorldInfo();if(!n)throw new Error(\"expected world instance\");const a=n.GetLayer(),o=(r.GetIndex()!==a.GetIndex()&&(r._RemoveInstance(s,!0),this._SetLayer(a),a._AddInstance(s,!0),i=!0),a.MoveInstanceAdjacent(s,e,!!t));(i||o)&&this._runtime.UpdateRender()}}GetInstanceEffectList(){return this._instanceEffectList}_SetHasAnyActiveEffect(e){this._SetFlag(64,e)}HasAnyActiveEffect(){return 0!=(64&this._flags)}_SaveToJson(e,t=null){const s={x:this.GetX(),y:this.GetY(),w:this.GetWidth(),h:this.GetHeight(),l:this.GetLayer().GetSID(),zi:this.GetZIndex()},i=(0!==this.GetZElevation()&&(s.ze=this.GetZElevation()),0!==this.GetAngle()&&(s.a=this._GetAngleNoReflect()),this.HasDefaultColor()||(s.c=this._color.toJSON()),.5!==this.GetOriginX()&&(s.oX=this.GetOriginX()),.5!==this.GetOriginY()&&(s.oY=this.GetOriginY()),0!==this.GetBlendMode()&&(s.bm=this.GetBlendMode()),this.IsVisible()||(s.v=this.IsVisible()),this.IsCollisionEnabled()||(s.ce=this.IsCollisionEnabled()),this.IsBboxChangeEventEnabled()&&(s.be=this.IsBboxChangeEventEnabled()),this._instanceEffectList&&(s.fx=this._instanceEffectList._SaveToJson()),0!=(32&this._flags));return i&&(s.sfi=i),this._solidFilterTags&&(s.sft=[...this._solidFilterTags].join(\" \")),this._sceneGraphInfo&&\"visual-state\"!==e&&(s.sgi=this._sceneGraphInfo._SaveToJson(e,t),m.has(this))&&(s.sgcd=m.get(this).childrenData,s.sgzid=m.get(this).zIndexData),this.HasMesh()&&(s.mesh=this.GetSourceMesh().SaveToJson()),s}_SaveSceneGraphPropertiesToJson(){return{x:this._x,y:this._y,z:this._zElevation,w:this._w,h:this._h,a:this._a,sgi:this._GetSceneGraphInfo()?this._GetSceneGraphInfo()._SaveToJsonProperties():null}}_LoadSceneGraphPropertiesFromJson(e){e&&(this._x=e.x,this._y=e.y,this._zElevation=e.z,this._w=e.w,this._h=e.h,this._a=e.a,e.sgi&&this._GetSceneGraphInfo()&&this._GetSceneGraphInfo()._LoadFromJson(e.sgi),this._MarkSinCosAngleChanged(),this.SetBboxChanged())}_SetupSceneGraphConnectionsOnChangeOfLayout(){this._ReleaseTmpSceneGraphInfo(),this._ResetAllSceneGraphState(),this._CreateSceneGraphInfo(null),this._sceneGraphInfo&&this._sceneGraphInfo._SetTmpSceneGraphChildren(this._tmpSceneGraphChildren,this._tmpSceneGraphChildrenIndexes)}_OnBeforeLoad(e){\"visual-state\"!==e&&this._ResetAllSceneGraphState()}_OnAfterLoad(e,t=\"full\",s=null){e.hasOwnProperty(\"sgi\")&&\"visual-state\"!==t&&0==(256&this._flags)&&this._sceneGraphInfo._OnAfterLoad(e.sgi,s)}_OnAfterLoad2(e,t=\"full\",s){e.hasOwnProperty(\"sgi\")&&\"visual-state\"!==t&&0==(256&this._flags)&&(this._sceneGraphInfo._SetTmpSceneGraphChildren(null,null),this._ReleaseTmpSceneGraphInfo(),this.SetBboxChanged())}_LoadFromJson(e,t){if(f=!1,this.SetX(e.x),this.SetY(e.y),this.SetWidth(e.w),this.SetHeight(e.h),this._SetZIndex(e.zi),this.SetZElevation(e.hasOwnProperty(\"ze\")?e.ze:0),this.SetAngle(e.hasOwnProperty(\"a\")?e.a:0),e.hasOwnProperty(\"c\")?_.setFromJSON(e.c):e.hasOwnProperty(\"o\")?(_.copyRgb(this._color),_.a=e.o):_.setRgba(1,1,1,1),this._SetColor(_),this.SetOriginX(e.hasOwnProperty(\"oX\")?e.oX:.5),this.SetOriginY(e.hasOwnProperty(\"oY\")?e.oY:.5),this.SetBlendMode(e.hasOwnProperty(\"bm\")?e.bm:0),this.SetVisible(!e.hasOwnProperty(\"v\")||e.v),this.SetCollisionEnabled(!e.hasOwnProperty(\"ce\")||e.ce),this.SetBboxChangeEventEnabled(!!e.hasOwnProperty(\"be\")&&e.be),this.SetSolidCollisionFilter(!!e.hasOwnProperty(\"sfi\")&&e.sfi,e.hasOwnProperty(\"sft\")?e.sft:\"\"),this._instanceEffectList&&e.hasOwnProperty(\"fx\")&&this._instanceEffectList._LoadFromJson(e.fx),!e.hasOwnProperty(\"sgi\")&&\"visual-state\"!==t&&this._tmpSceneGraphChildren)for(const s of this._tmpSceneGraphChildren)s.IsDestroyed()||this._runtime.DestroyInstance(s);if(e.hasOwnProperty(\"sgi\")&&\"visual-state\"!==t){this._CreateSceneGraphInfo(null);const i=this._sceneGraphInfo,r=e.sgi;i._LoadFromJson(r),i._SetTmpSceneGraphChildren(this._tmpSceneGraphChildren,this._tmpSceneGraphChildrenIndexes),e.sgcd&&d.IsFiniteNumber(e.sgzid)&&m.set(this,{childrenData:e.sgcd,zIndexData:e.sgzid})}if(e.hasOwnProperty(\"mesh\")){const n=e.mesh;this.CreateMesh(n.cols,n.rows),this.GetSourceMesh().LoadFromJson(n)}else this.ReleaseMesh();this.SetBboxChanged(),f=!0,this._UpdateRendererStateGroup(),\"visual-state\"!==t&&this._runtime.AddInstanceNeedingAfterLoad(this.GetInstance(),e)}}}{const Gh=self.C3;Gh.BehaviorType=class extends Gh.DefendedBase{constructor(e,t){super();const s=e.GetRuntime(),i=s.GetObjectReference(t[1]),r=(s.GetAddonManager()._DelayCreateBehavior(i),this._runtime=s,this._objectClass=e,this._behavior=Gh.AddonManager.GetBehaviorByConstructorFunction(i),this._sdkType=null,this._iBehaviorType=null,this._instSdkCtor=i.Instance,this._sid=t[2],this._name=t[0],this._jsPropName=this._runtime.GetJsPropName(t[3]),this._behavior.GetSdkVersion());if(r<2&&(this._sdkType=Gh.New(i.Type,this),!(this._sdkType instanceof Gh.SDKBehaviorTypeBase)))throw new Error(\"v1 sdk type must derive from SDKBehaviorBase\");if(Gh.AddonManager._PushInitObject(this,r),2<=r){const n=i.Type??globalThis.ISDKBehaviorTypeBase;if(this._iBehaviorType=new n,!(this._iBehaviorType instanceof globalThis.ISDKBehaviorTypeBase))throw new Error(\"script interface class must derive from ISDKBehaviorTypeBase\")}else this._iBehaviorType=new globalThis.IBehaviorType;Gh.AddonManager._PopInitObject(r),this.OnCreate()}static Create(e,t){return Gh.New(Gh.BehaviorType,e,t)}Release(){this._runtime=null,this._behavior=null,this._sdkType&&(this._sdkType.Release(),this._sdkType=null),this._instSdkCtor=null}GetSdkType(){return this._sdkType}OnCreate(){this._sdkType?this._sdkType.OnCreate():this._iBehaviorType&&this._iBehaviorType._onCreate()}GetRuntime(){return this._runtime}GetObjectClass(){return this._objectClass}GetBehavior(){return this._behavior}GetInstanceSdkCtor(){return this._instSdkCtor}GetName(){return this._name}GetSID(){return this._sid}GetIBehaviorType(){return this._iBehaviorType}GetJsPropName(){return this._jsPropName}}}{const Ih=self.C3,Th=self.IBehaviorInstance;Ih.BehaviorInstance=class extends Ih.DefendedBase{constructor(e){super(),this._runtime=e.runtime,this._behaviorType=e.behaviorType,this._behavior=this._behaviorType.GetBehavior(),this._inst=e.instance,this._index=e.index,this._sdkInst=null,this._iScriptInterface=null,this._behavior._AddInstance(this._inst)}Release(){this._iScriptInterface&&(this._iScriptInterface._release(),this._iScriptInterface=null),this._behavior._RemoveInstance(this._inst),this._sdkInst&&(this._sdkInst.Release(),this._sdkInst=null),this._runtime=null,this._behaviorType=null,this._behavior=null,this._inst=null}_CreateSdkInstance(e){if(this._sdkInst)throw new Error(\"already got sdk instance\");const t=this.GetBehavior().GetSdkVersion();if(t<2){if(this._sdkInst=Ih.New(this._behaviorType.GetInstanceSdkCtor(),this,e),!(this._sdkInst instanceof Ih.SDKBehaviorInstanceBase))throw new Error(\"v1 sdk type must derive from SDKBehaviorInstanceBase\")}else{const s=this.GetBehavior().GetScriptInterfaceClass();this._InitScriptInterface(s.Instance,e)}}GetSdkInstance(){return this._sdkInst??this._iScriptInterface}GetObjectInstance(){return this._inst}GetRuntime(){return this._runtime}GetBehaviorType(){return this._behaviorType}GetBehavior(){return this._behavior}_GetIndex(){return this._index}PostCreate(){this._sdkInst?this._sdkInst.PostCreate():this._iScriptInterface._postCreate()}OnSpriteFrameChanged(e,t){this._sdkInst&&this._sdkInst.OnSpriteFrameChanged(e,t)}_GetDebuggerProperties(){return this._sdkInst?this._sdkInst.GetDebuggerProperties():this._iScriptInterface._getDebuggerProperties()}SaveToJson(e=\"full\"){return this._sdkInst?this._sdkInst.SaveToJson(e):this._iScriptInterface._saveToJson(e)}LoadFromJson(e,t=\"full\"){if(this._sdkInst)return this._sdkInst.LoadFromJson(e,t);this._iScriptInterface._loadFromJson(e,t)}static SortByTickSequence(e,t,s){let i=globalThis.ISDKBehaviorInstanceBase,r,n;r=t instanceof i?e._UnwrapScriptInterface(t):t.GetBehaviorInstance(),n=s instanceof i?e._UnwrapScriptInterface(s):s.GetBehaviorInstance();const a=r.GetObjectInstance(),o=n.GetObjectInstance(),h=a.GetObjectClass().GetIndex(),l=o.GetObjectClass().GetIndex();if(h!==l)return h-l;const c=a.GetPUID(),u=o.GetPUID();return c!==u?c-u:r._GetIndex()-n._GetIndex()}_InitScriptInterface(e,t){const s=Th,i=e??this._sdkInst.GetScriptInterfaceClass(),r=i||s,n=this.GetBehavior().GetSdkVersion();if(Ih.AddonManager._PushInitObject(this,n),Ih.AddonManager._PushInitProperties(t),this._iScriptInterface=new r,Ih.AddonManager._PopInitProperties(),Ih.AddonManager._PopInitObject(n),!i||this._iScriptInterface instanceof s)return this._iScriptInterface;throw new TypeError(`script interface class '${i.name}' does not extend the right base class '${s.name}'`)}GetScriptInterface(){return this._iScriptInterface||this._InitScriptInterface()}HasScriptInterface(){return!!this._iScriptInterface}}}{const Ch=self.C3;Ch.EffectList=class extends Ch.DefendedBase{constructor(e,t){super(),this._owner=e,this._allEffectTypes=[],this._activeEffectTypes=[],this._effectTypesByName=new Map,this._effectParams=[],this._effectParamBuffers=[],this._allInstanceEffectLists=new Set,this._preservesOpaqueness=!0;for(const s of t){const i=Ch.New(Ch.EffectType,this,s,this._allEffectTypes.length);this._allEffectTypes.push(i),this._effectTypesByName.set(i.GetName().toLowerCase(),i),3<=s.length&&this._effectParams.push(this._LoadSingleEffectParameters(i,s[2]))}this.GetRuntime()._AddEffectList(this)}Release(){this.GetRuntime()._RemoveEffectList(this);for(const e of this._effectParamBuffers)e.Release();Ch.clearArray(this._effectParamBuffers),Ch.clearArray(this._allEffectTypes),Ch.clearArray(this._activeEffectTypes),this._effectTypesByName.clear(),Ch.clearArray(this._effectParams),this._owner=null}_AddInstanceEffectList(e){this._allInstanceEffectLists.add(e)}_RemoveInstanceEffectList(e){this._allInstanceEffectLists.delete(e)}_InitRenderer(e){e.IsWebGPU()&&(this._effectParamBuffers=this._allEffectTypes.map(e=>{const t=e.GetShaderProgram();return 0<t.GetCustomParametersByteSize()?Ch.New(Ch.Gfx.WebGPUEffectCustomParamsBuffer,t):null}),this._UpdateAllEffectParamBuffers());for(const t of this._allInstanceEffectLists)t._InitRenderer(e)}PrependEffectTypes(e){if(e.length){this._allEffectTypes=e.concat(this._allEffectTypes);for(const t of e)this._effectTypesByName.set(t.GetName().toLowerCase(),t);for(let e=0,t=this._allEffectTypes.length;e<t;++e)this._allEffectTypes[e]._SetIndex(e)}}_LoadSingleEffectParameters(e,t){e.SetActive(t[0]);const s=t.slice(1);for(let e=0,t=s.length;e<t;++e){const i=s[e];if(Array.isArray(i)){const r=Ch.New(Ch.Color);r.setFromJSON(i),s[e]=r}}return s}GetOwner(){return this._owner}GetRuntime(){return this._owner.GetRuntime()}UpdateActiveEffects(){Ch.clearArray(this._activeEffectTypes);let e=!0;for(const t of this._allEffectTypes)t.IsActive()&&(this._activeEffectTypes.push(t),t.GetShaderProgram().PreservesOpaqueness()||(e=!1));this._preservesOpaqueness=e}GetAllEffectTypes(){return this._allEffectTypes}HasAnyEffectType(){return 0<this._allEffectTypes.length}GetEffectTypeByName(e){return this._effectTypesByName.get(e.toLowerCase())||null}GetEffectTypeByIndex(e){if((e=Math.floor(+e))<0||e>=this._allEffectTypes.length)throw new RangeError(\"invalid effect type index\");return this._allEffectTypes[e]}IsEffectIndexActive(e){return this.GetEffectTypeByIndex(e).IsActive()}SetEffectIndexActive(e,t){this.GetEffectTypeByIndex(e).SetActive(t)}GetActiveEffectTypes(){return this._activeEffectTypes}HasAnyActiveEffect(){return 0<this._activeEffectTypes.length}PreservesOpaqueness(){return this._preservesOpaqueness}GetEffectParametersForIndex(e){return this._effectParams[e]}_GetEffectChainShaderParametersForIndex(e){return(e<this._effectParamBuffers.length?this._effectParamBuffers:this._effectParams)[e]}GetEffectParameter(e,t){if(e<0||e>=this._effectParams.length)return null;const s=this._effectParams[e];return t<0||t>=s.length?null:s[t]}SetEffectParameter(e,t,s){if(e<0||e>=this._effectParams.length)return!1;const i=this._effectParams[e];if(t<0||t>=i.length)return!1;const r=i[t];if(r instanceof Ch.Color){if(r.equalsIgnoringAlpha(s))return!1;r.copyRgb(s)}else{if(r===s)return!1;i[t]=s}return e<this._effectParamBuffers.length&&this._effectParamBuffers[e].SetParameterValue(t,s),!0}_UpdateAllEffectParamBuffers(){const s=this._effectParams,i=this._effectParamBuffers;for(let e=0,t=Math.min(s.length,i.length);e<t;++e){const r=i[e],n=s[e];for(let e=0,t=n.length;e<t;++e)r.SetParameterValue(e,n[e])}}static SaveFxParamToJson(e){return e&&e instanceof Ch.Color?{t:\"color\",v:e.toJSON()}:e}static LoadFxParamFromJson(e){if(null===e)return NaN;if(\"object\"!=typeof e)return e;{const t=e.t;if(\"color\"!==t)throw new Error(\"invalid effect parameter type\");{const s=Ch.New(Ch.Color);return s.setFromJSON(e.v),s}}}static SaveFxParamsToJson(e){return e.map(Ch.EffectList.SaveFxParamToJson)}static LoadFxParamsFromJson(e){return e.map(Ch.EffectList.LoadFxParamFromJson)}SaveToJson(){return this._allEffectTypes.map(e=>({name:e.GetName(),active:e.IsActive(),params:Ch.EffectList.SaveFxParamsToJson(this._effectParams[e.GetIndex()])}))}LoadFromJson(e){for(const t of e){const s=this.GetEffectTypeByName(t.name);s&&(s.SetActive(t.active),this._effectParams[s.GetIndex()]=Ch.EffectList.LoadFxParamsFromJson(t.params))}this.UpdateActiveEffects(),this._UpdateAllEffectParamBuffers()}}}{const bh=self.C3;bh.EffectType=class extends bh.DefendedBase{constructor(e,t,s){super(),this._effectList=e,this._id=t[0],this._name=t[1],this._index=s,this._shaderProgram=null,this._isActive=!0}Release(){this._effectList=null,this._shaderProgram=null}Clone(e){const t=bh.New(bh.EffectType,e,[this._id,this._name],-1);return t._shaderProgram=this._shaderProgram,t._isActive=this._isActive,t}_InitRenderer(e){const t=e.GetShaderProgramByName(this._id);if(!t)throw new Error(\"failed to find shader program '\"+this._id+\"'\");this._shaderProgram=t}GetEffectList(){return this._effectList}GetName(){return this._name}_SetIndex(e){this._index=e}GetIndex(){return this._index}GetOwner(){return this._effectList.GetOwner()}GetRuntime(){return this._effectList.GetRuntime()}SetActive(e){this._isActive=!!e}IsActive(){return this._isActive}GetShaderProgram(){return this._shaderProgram}GetDefaultParameterValues(){const s=[];for(let e=0,t=this._shaderProgram.GetParameterCount();e<t;++e){const i=this._shaderProgram.GetParameterType(e);if(\"float\"===i||\"percent\"===i)s.push(0);else{if(\"color\"!==i)throw new TypeError(\"unknown effect parameter type\");s.push(bh.New(bh.Color,1,1,1,1))}}return s}}}{const wh=self.C3;wh.InstanceEffectList=class extends wh.DefendedBase{constructor(e,t){super(),this._inst=e,this._wi=t,this._effectList=e.GetObjectClass().GetEffectList(),this._needsRebuildSteps=!0,this._wasDefaultColor=!0,this._was3D=!1,this._wasRotatedOrNegativeSize=!1,this._wasTexRotated=!1,this._wasMustPreDraw=!1,this._effectChain=wh.New(wh.Gfx.EffectChain,e.GetRuntime().GetCanvasManager().GetEffectChainManager(),{drawContent:(e,t)=>{const s=t.GetContentObject(),i=s.GetWorldInfo();e.SetColor(i.GetPremultipliedColor()),e.SetCurrentZ(i.GetTotalZElevation()),s.Draw(e),e.SetCurrentZ(0)},getSourceTextureInfo:e=>{const t=e.GetCurrentTexRect(),[s,i]=e.GetCurrentSurfaceSize();return{srcTexRect:t,srcWidth:s,srcHeight:i}},getShaderParameters:e=>this._GetEffectChainShaderParametersForIndex(e)}),this._activeEffectFlags=[],this._activeEffectTypes=[],this._preservesOpaqueness=!0,this._effectParams=[],this._effectParamBuffers=[],this._InitRenderer(e.GetRuntime().GetRenderer());for(let e=0,t=this._effectList.GetAllEffectTypes().length;e<t;++e)this._activeEffectFlags.push(!0);this.UpdateActiveEffects(),this._effectList._AddInstanceEffectList(this)}Release(){this._effectList._RemoveInstanceEffectList(this);for(const e of this._effectParamBuffers)e&&e.Release();wh.clearArray(this._effectParamBuffers),this._effectChain.Release(),this._effectChain=null,wh.clearArray(this._activeEffectFlags),wh.clearArray(this._activeEffectTypes),wh.clearArray(this._effectParams),this._inst=null,this._effectList=null}_InitRenderer(e){e.IsWebGPU()&&(this._effectParamBuffers=this._effectList.GetAllEffectTypes().map(e=>{const t=e.GetShaderProgram();return 0<t.GetCustomParametersByteSize()?wh.New(wh.Gfx.WebGPUEffectCustomParamsBuffer,t):null}))}_LoadEffectParameters(e){let t=0;for(const s of e)this._effectParams.push(this._LoadSingleEffectParameters(t,s)),++t;this._UpdateAllEffectParamBuffers(),this.UpdateActiveEffects()}_LoadSingleEffectParameters(e,t){this._activeEffectFlags[e]=t[0];const s=t.slice(1);for(let e=0,t=s.length;e<t;++e){const i=s[e];if(Array.isArray(i)){const r=wh.New(wh.Color);r.setFromJSON(i),s[e]=r}}return s}LoadDefaultEffectParameters(){for(const e of this._effectList.GetAllEffectTypes())this._effectParams.push(e.GetDefaultParameterValues());this._UpdateAllEffectParamBuffers()}GetOwner(){return this._owner}GetEffectList(){return this._effectList}GetEffectChain(){return this._MaybeRebuildEffectChainSteps(),this._effectChain}GetRuntime(){return this._inst.GetRuntime()}UpdateActiveEffects(){wh.clearArray(this._activeEffectTypes);let e=this._wi,s=this._effectList.GetAllEffectTypes(),i=this._activeEffectTypes,r=this._activeEffectFlags,n=!0;for(let e=0,t=s.length;e<t;++e)if(r[e]){const a=s[e];i.push(a),a.GetShaderProgram().PreservesOpaqueness()||(n=!1)}this._preservesOpaqueness=n,e._SetHasAnyActiveEffect(!!i.length),this._needsRebuildSteps=!0}_MaybeRebuildEffectChainSteps(){const e=this._inst,t=this._wi,s=t.HasDefaultColor(),i=e.GetPlugin().Is3D(),r=0!==t.GetAngle()||0!==t.GetLayer().GetAngle()||t.GetWidth()<0||t.GetHeight()<0,n=e.IsCurrentTexRotated(),a=e.MustPreDraw();(this._needsRebuildSteps||s!==this._wasDefaultColor||i!==this._was3D||r!==this._wasRotatedOrNegativeSize||n!==this._wasTexRotated||a!==this._wasMustPreDraw||this._effectChain.NeedsRebuild())&&(this._effectChain.BuildSteps(this._activeEffectTypes.map(e=>e.GetShaderProgram()),{indexMap:this._activeEffectTypes.map(e=>e.GetIndex()),forcePreDraw:!s||a,is3D:i,isSourceTextureRotated:n,isRotatedOrNegativeSizeInstance:r}),this._needsRebuildSteps=!1,this._wasDefaultColor=s,this._was3D=i,this._wasRotatedOrNegativeSize=r,this._wasTexRotated=n,this._wasMustPreDraw=a)}GetActiveEffectTypes(){return this._activeEffectTypes}GetEffectParametersForIndex(e){return this._effectParams[e]}_GetEffectChainShaderParametersForIndex(e){return(e<this._effectParamBuffers.length?this._effectParamBuffers:this._effectParams)[e]}GetEffectParameter(e,t){if(e<0||e>=this._effectParams.length)return null;const s=this._effectParams[e];return t<0||t>=s.length?null:s[t]}SetEffectParameter(e,t,s){if(e<0||e>=this._effectParams.length)return!1;const i=this._effectParams[e];if(t<0||t>=i.length)return!1;const r=i[t];if(r instanceof wh.Color){if(r.equalsIgnoringAlpha(s))return!1;r.copyRgb(s)}else{if(r===s)return!1;i[t]=s}return e<this._effectParamBuffers.length&&this._effectParamBuffers[e].SetParameterValue(t,s),!0}_UpdateAllEffectParamBuffers(){const s=this._effectParams,i=this._effectParamBuffers;for(let e=0,t=i.length;e<t;++e){const r=i[e],n=s[e];for(let e=0,t=n.length;e<t;++e)r.SetParameterValue(e,n[e])}}PreservesOpaqueness(){return this._preservesOpaqueness}HasAnyActiveBackgroundBlendingEffect(){return this._activeEffectTypes.some(e=>e.GetShaderProgram().BlendsBackground())}IsEffectIndexActive(e){return this._activeEffectFlags[e]}SetEffectIndexActive(e,t){this._activeEffectFlags[e]=!!t}GetAllEffectTypes(){return this._effectList.GetAllEffectTypes()}_SaveToJson(){return this._effectList.GetAllEffectTypes().map(e=>({name:e.GetName(),active:this._activeEffectFlags[e.GetIndex()],params:wh.EffectList.SaveFxParamsToJson(this._effectParams[e.GetIndex()])}))}_LoadFromJson(e){for(const t of e){const s=this._effectList.GetEffectTypeByName(t.name);s&&(this._activeEffectFlags[s.GetIndex()]=t.active,this._effectParams[s.GetIndex()]=wh.EffectList.LoadFxParamsFromJson(t.params))}this.UpdateActiveEffects(),this._UpdateAllEffectParamBuffers()}}}{let x=self.C3,n=[],G=[],a=[],I=x.New(x.CollisionPoly),S=x.New(x.CollisionPoly),T=x.New(x.Quad),d=x.New(x.Rect),p=x.New(x.Rect),f=null,m=null,g=null;x.CollisionEngine=class extends x.DefendedBase{constructor(e){super(),this._runtime=e,this._collisionCellWidth=0,this._collisionCellHeight=0,this._registeredCollisions=[],this._collisionCheckCount=0,this._collisionCheckSec=0,this._polyCheckCount=0,this._polyCheckSec=0,this._iCollisionEngine=new self.ICollisionEngine(this)}Release(){this._runtime=null}GetRuntime(){return this._runtime}GetICollisionEngine(){return this._iCollisionEngine}_Update1sStats(){this._collisionCheckSec=this._collisionCheckCount,this._collisionCheckCount=0,this._polyCheckSec=this._polyCheckCount,this._polyCheckCount=0}Get1secCollisionChecks(){return this._collisionCheckSec}Get1secPolyChecks(){return this._polyCheckSec}RegisterCollision(e,t){const s=e.GetWorldInfo(),i=t.GetWorldInfo();s&&i&&s.IsCollisionEnabled()&&i.IsCollisionEnabled()&&this._registeredCollisions.push([e,t])}AddRegisteredCollisionCandidates(t,s,i){for(const[r,n]of this._registeredCollisions){let e=null;if(t===r)e=n;else{if(t!==n)continue;e=r}e.BelongsToObjectClass(s)&&!i.includes(e)&&i.push(e)}}CheckRegisteredCollision(e,t){if(this._registeredCollisions.length)for(const[s,i]of this._registeredCollisions)if(e===s&&t===i||e===i&&t===s)return!0;return!1}ClearRegisteredCollisions(){x.clearArray(this._registeredCollisions)}TestOverlap(e,t){if(!e||!t||e===t)return!1;const s=e.GetWorldInfo(),i=t.GetWorldInfo();if(!s.IsCollisionEnabled()||!i.IsCollisionEnabled())return!1;this._collisionCheckCount++;const r=s.GetLayer(),n=i.GetLayer(),a=r.IsTransformCompatibleWith(n);return a?this._TestOverlap_SameLayers(s,i):this._TestOverlap_DifferentLayers(s,i)}_TestOverlap_SameLayers(e,t){if(!e.GetBoundingBox().intersectsRect(t.GetBoundingBox()))return!1;if(this._polyCheckCount++,!e.GetBoundingQuad().intersectsQuad(t.GetBoundingQuad()))return!1;if(e.HasTilemap()&&t.HasTilemap())return!1;if(e.HasTilemap())return this.TestTilemapOverlap(e,t);if(t.HasTilemap())return this.TestTilemapOverlap(t,e);if(!e.HasOwnCollisionPoly()&&!t.HasOwnCollisionPoly())return!0;const s=e.GetTransformedCollisionPoly(),i=t.GetTransformedCollisionPoly();return s.intersectsPoly(i,t.GetX()-e.GetX(),t.GetY()-e.GetY())}_TestOverlap_DifferentLayers(s,i){const e=s.HasTilemap(),t=i.HasTilemap();if(e&&!t)return this.TestTilemapOverlapDifferentLayers(s,i);if(t&&!e)return this.TestTilemapOverlapDifferentLayers(i,s);if(t||e)return!1;{const r=s.GetLayer(),n=i.GetLayer(),a=(I.copy(s.GetTransformedCollisionPoly()),S.copy(i.GetTransformedCollisionPoly()),I.pointsArr());for(let e=0,t=a.length;e<t;e+=2){const h=e+1,l=a[e],c=a[h],[u,_]=r.LayerToCanvasCss(l+s.GetX(),c+s.GetY());a[e]=u,a[h]=_}const o=S.pointsArr();for(let e=0,t=o.length;e<t;e+=2){const d=e+1,p=o[e],f=o[d],[m,g]=n.LayerToCanvasCss(p+i.GetX(),f+i.GetY());o[e]=m,o[d]=g}return I.setBboxChanged(),S.setBboxChanged(),this._polyCheckCount++,I.intersectsPoly(S,0,0)}}TestTilemapOverlapDifferentLayers(e,t){const s=e.GetLayer(),i=t.GetLayer(),r=(f=f||x.New(x.CollisionPoly),m=m||x.New(x.Rect),g=g||x.New(x.Quad),t.GetX()),n=t.GetY(),[a,o]=i.LayerToCanvasCss(r,n),[h,l]=s.CanvasCssToLayer(a,o),c=h-r,u=l-n;if(m.copy(t.GetBoundingBox()),m.offset(c,u),!e.GetBoundingBox().intersectsRect(m))return!1;if(g.copy(t.GetBoundingQuad()),g.offset(c,u),this._polyCheckCount++,!e.GetBoundingQuad().intersectsQuad(g))return!1;f.copy(t.GetTransformedCollisionPoly());const _=f.pointsArr();for(let e=0,t=_.length;e<t;e+=2){const d=e+1;_[e]+=c,_[d]+=u}return f.setBboxChanged(),this.TestTilemapOverlap(e,t,h,l,f,m,g)}TestTilemapOverlap(e,i,t,s,r,n,a){const o=void 0!==n?n:i.GetBoundingBox(),h=e.GetX(),l=e.GetY(),c=e.GetInstance().GetSdkInstance(),u=void 0!==t?t:i.GetX(),_=void 0!==s?s:i.GetY(),d=i.HasOwnCollisionPoly(),p=void 0!==a?a:i.GetBoundingQuad(),f=G;c.GetCollisionRectCandidates(o,f);for(let e=0,t=f.length;e<t;++e){const m=f[e],g=m.GetRect();if(this._collisionCheckCount++,o.intersectsRectOffset(g,h,l)&&(T.setFromRect(g),T.offset(h,l),T.intersectsQuad(p)))if(d){let e=void 0!==r?r:i.GetTransformedCollisionPoly(),t=u,s=_;void 0!==r&&(t=i.GetX(),s=i.GetY());const S=m.GetPoly();if(S){if(this._polyCheckCount++,S.intersectsPoly(e,t-(h+g.getLeft()),s-(l+g.getTop())))return x.clearArray(f),!0}else if(I.setFromQuad(T,0,0),I.intersectsPoly(e,t,s))return x.clearArray(f),!0}else{const y=m.GetPoly();if(!y)return x.clearArray(f),!0;if(I.setFromQuad(p,0,0),y.intersectsPoly(I,-(h+g.getLeft()),-(l+g.getTop())))return x.clearArray(f),!0}}return x.clearArray(f),!1}TestAndSelectCanvasPointOverlap(e,o,h){const l=e.GetCurrentSol(),t=this._runtime.GetCurrentEvent();if(!t)throw new Error(\"cannot call outside event\");const c=t.IsOrBlock(),s=new Map,u=e=>{let t=s.get(e);return void 0===t&&(t=e.IsSelfAndParentsInteractive(),s.set(e,t)),t};if(l.IsSelectAll()){h||(l._SetSelectAll(!1),x.clearArray(l._GetOwnInstances())),c&&x.clearArray(l._GetOwnElseInstances());for(const i of e.GetInstances()){let r=i.GetWorldInfo(),n=r.GetLayer();if(!(!u(n)||!r.IsInViewport2())&&o.some(([e,t])=>{const[s,i]=n.CanvasCssToLayer(e,t,r.GetTotalZElevation());return r.ContainsPoint(s,i)})){if(h)return!1;l._PushInstance(i)}else c&&l._PushElseInstance(i)}}else{let s,i=!1,a=(!c||t.IsFirstConditionOfType(this._runtime.GetCurrentCondition())||this._runtime.IsCurrentConditionFirst()&&!l._GetOwnElseInstances().length&&l._GetOwnInstances().length?s=l._GetOwnInstances():(s=l._GetOwnElseInstances(),i=!0),0);for(let t=0,e=s.length;t<e;++t){let e=s[t],r=e.GetWorldInfo(),n=r.GetLayer();if(!(!u(n)||!r.IsInViewport2())&&o.some(([e,t])=>{const[s,i]=n.CanvasCssToLayer(e,t,r.GetTotalZElevation());return r.ContainsPoint(s,i)})){if(h)return!1;i?l._PushInstance(e):s[a++]=e}else i?s[a++]=e:c&&l._PushElseInstance(e)}h||(s.length=a)}return e.ApplySolToContainer(),s.clear(),!!h||l.HasAnyInstances()}_ObjectClassCanUseCollisionCells(e,t){if(e)for(const s of t.layersHasInstancesOn())if(!e.IsTransformCompatibleWith(s))return!1;return!0}GetCollisionCandidates(e,t,s,i){if(t.IsFamily())for(const r of t.GetFamilyMembers())this._ObjectClassCanUseCollisionCells(e,r)?(r._UpdateAllCollisionCells(),r._GetCollisionCellGrid().QueryRange(s,i)):x.appendArray(i,r.GetInstances());else this._ObjectClassCanUseCollisionCells(e,t)?(t._UpdateAllCollisionCells(),t._GetCollisionCellGrid().QueryRange(s,i)):x.appendArray(i,t.GetInstances())}GetObjectClassesCollisionCandidates(e,t,s,i){for(const r of t)this.GetCollisionCandidates(e,r,s,i)}GetSolidCollisionCandidates(e,t,s){const i=this._runtime.GetSolidBehavior();i&&this.GetObjectClassesCollisionCandidates(e,i.GetObjectClasses(),t,s)}GetJumpthruCollisionCandidates(e,t,s){const i=this._runtime.GetJumpthruBehavior();i&&this.GetObjectClassesCollisionCandidates(e,i.GetObjectClasses(),t,s)}IsSolidCollisionAllowed(e,t){return e._IsSolidEnabled()&&(!t||t.GetWorldInfo().IsSolidCollisionAllowed(e.GetSavedDataMap().get(\"solidTags\")))}TestOverlapSolid(e){const t=e.GetWorldInfo();this.GetSolidCollisionCandidates(t.GetLayer(),t.GetBoundingBox(),n);for(const s of n)if(this.IsSolidCollisionAllowed(s,e)&&this.TestOverlap(e,s))return x.clearArray(n),s;return x.clearArray(n),null}TestRectOverlapSolid(e,t){this.GetSolidCollisionCandidates(null,e,n);for(const s of n)if(this.IsSolidCollisionAllowed(s,t)&&this.TestRectOverlap(e,s))return x.clearArray(n),s;return x.clearArray(n),null}TestOverlapJumpthru(e,t){let s=null;t&&(s=a,x.clearArray(s));const i=e.GetWorldInfo();this.GetJumpthruCollisionCandidates(i.GetLayer(),i.GetBoundingBox(),n);for(const r of n)if(r._IsJumpthruEnabled()&&this.TestOverlap(e,r)){if(!t)return x.clearArray(n),r;s.push(r)}return x.clearArray(n),s}PushOut(t,s,i,r,n){r=r||50;const a=t.GetWorldInfo(),o=a.GetX(),h=a.GetY();for(let e=0;e<r;++e)if(a.SetXY(o+s*e,h+i*e),a.SetBboxChanged(),!this.TestOverlap(t,n))return!0;return a.SetXY(o,h),a.SetBboxChanged(),!1}PushOutSolid(t,s,i,r,n,a){r=r||50;let o=t.GetWorldInfo(),h=o.GetX(),l=o.GetY(),c=null,u=null;for(let e=0;e<r;++e)if(o.SetXY(h+s*e,l+i*e),o.SetBboxChanged(),!this.TestOverlap(t,c))if(c=this.TestOverlapSolid(t))u=c;else if(n&&(c=a?this.TestOverlap(t,a)?a:null:this.TestOverlapJumpthru(t))&&(u=c),!c)return u&&this.PushInFractional(t,s,i,u,16,!0),!0;return o.SetXY(h,l),o.SetBboxChanged(),!1}PushOutSolidAxis(s,i,r,e){e=e||50;let n=s.GetWorldInfo(),a=n.GetX(),o=n.GetY(),h=null,l=null;for(let t=0;t<e;++t)for(let e=0;e<2;++e){const c=2*e-1;if(n.SetXY(a+i*t*c,o+r*t*c),n.SetBboxChanged(),!this.TestOverlap(s,h)){if(!(h=this.TestOverlapSolid(s)))return l&&this.PushInFractional(s,i*c,r*c,l,16,!0),!0;l=h}}return n.SetXY(a,o),n.SetBboxChanged(),!1}PushInFractional(e,t,s,i,r,n){let a=2,o=!1,h=!1,l=e.GetWorldInfo(),c=l.GetX(),u=l.GetY();for(;a<=r;){const _=1/a;a*=2,l.OffsetXY(t*_*(o?1:-1),s*_*(o?1:-1)),l.SetBboxChanged(),this.TestOverlap(e,i)||n&&this.TestOverlapSolid(e)?(o=!0,h=!0):(o=!1,h=!1,c=l.GetX(),u=l.GetY())}h&&(l.SetXY(c,u),l.SetBboxChanged())}PushOutSolidNearest(s,e=100){let i=0,r=s.GetWorldInfo(),n=r.GetX(),a=r.GetY(),o=0,h=this.TestOverlapSolid(s);if(!h)return!0;for(;i<=e;){let e=0,t=0;switch(o){case 0:e=0,t=-1,i++;break;case 1:e=1,t=-1;break;case 2:e=1,t=0;break;case 3:e=1,t=1;break;case 4:e=0,t=1;break;case 5:e=-1,t=1;break;case 6:e=-1,t=0;break;case 7:e=-1,t=-1}if(o=(o+1)%8,r.SetXY(Math.floor(n+e*i),Math.floor(a+t*i)),r.SetBboxChanged(),!this.TestOverlap(s,h)&&!(h=this.TestOverlapSolid(s)))return!0}return r.SetXY(n,a),r.SetBboxChanged(),!1}CalculateBounceAngle(e,t,s,i){const r=e.GetWorldInfo(),n=r.GetX(),a=r.GetY(),o=Math.max(10,x.distanceTo(t,s,n,a)),h=x.angleTo(t,s,n,a),l=i||this.TestOverlapSolid(e);if(!l)return x.clampAngle(h+Math.PI);let c=l,u=0,_=0,d=x.toRadians(5),p;for(p=1;p<36;++p){const b=h-p*d;if(r.SetXY(t+Math.cos(b)*o,s+Math.sin(b)*o),r.SetBboxChanged(),!this.TestOverlap(e,c)&&!(c=i?null:this.TestOverlapSolid(e))){u=b;break}}for(36===p&&(u=x.clampAngle(h+Math.PI)),c=l,p=1;p<36;++p){const w=h+p*d;if(r.SetXY(t+Math.cos(w)*o,s+Math.sin(w)*o),r.SetBboxChanged(),!this.TestOverlap(e,c)&&!(c=i?null:this.TestOverlapSolid(e))){_=w;break}}if(36===p&&(_=x.clampAngle(h+Math.PI)),r.SetXY(n,a),r.SetBboxChanged(),_===u)return _;let f=x.angleDiff(_,u)/2,m;m=x.angleClockwise(_,u)?x.clampAngle(u+f+Math.PI):x.clampAngle(_+f);const g=Math.cos(h),S=Math.sin(h),y=Math.cos(m),G=Math.sin(m),I=g*y+S*G,T=g-2*I*y,C=S-2*I*G;return x.angleTo(0,0,T,C)}TestSegmentOverlap(e,t,s,i,r){if(!r)return!1;const n=r.GetWorldInfo();if(!n.IsCollisionEnabled())return!1;if(this._collisionCheckCount++,d.set(Math.min(e,s),Math.min(t,i),Math.max(e,s),Math.max(t,i)),!n.GetBoundingBox().intersectsRect(d))return!1;if(r.HasTilemap())return this._TestSegmentOverlapTilemap(e,t,s,i,r,n);if(this._polyCheckCount++,!n.GetBoundingQuad().intersectsSegment(e,t,s,i))return!1;if(!n.HasOwnCollisionPoly())return!0;const a=n.GetTransformedCollisionPoly();return a.intersectsSegment(n.GetX(),n.GetY(),e,t,s,i)}_TestSegmentOverlapTilemap(s,i,r,n,e,t){const a=t.GetX(),o=t.GetY(),h=e.GetSdkInstance(),l=G;p.set(s,i,r,n),p.normalize(),h.GetCollisionRectCandidates(p,l);for(let e=0,t=l.length;e<t;++e){const c=l[e],u=c.GetRect();if(this._collisionCheckCount++,d.intersectsRectOffset(u,a,o)&&(T.setFromRect(u),T.offset(a,o),T.intersectsSegment(s,i,r,n))){const _=c.GetPoly();if(!_)return x.clearArray(l),!0;if(this._polyCheckCount++,_.intersectsSegment(a+u.getLeft(),o+u.getTop(),s,i,r,n))return x.clearArray(l),!0}}return x.clearArray(l),!1}TestRectOverlap(e,t){if(!t)return!1;const s=t.GetWorldInfo();if(!s.IsCollisionEnabled())return!1;if(this._collisionCheckCount++,!s.GetBoundingBox().intersectsRect(e))return!1;if(t.HasTilemap())return this._TestRectOverlapTilemap(e,t,s);if(this._polyCheckCount++,T.setFromRect(e),!s.GetBoundingQuad().intersectsQuad(T))return!1;if(!s.HasOwnCollisionPoly())return!0;const i=I,r=(i.setFromRect(e,s.GetX(),s.GetY()),s.GetTransformedCollisionPoly());return i.intersectsPoly(r,0,0)}_TestRectOverlapTilemap(s,e,t){const i=t.GetX(),r=t.GetY(),n=e.GetSdkInstance(),a=G;n.GetCollisionRectCandidates(s,a);for(let e=0,t=a.length;e<t;++e){const o=a[e],h=o.GetRect();if(this._collisionCheckCount++,s.intersectsRectOffset(h,i,r)){const l=o.GetPoly();if(!l)return x.clearArray(a),!0;if(this._polyCheckCount++,I.setFromRect(s,0,0),l.intersectsPoly(I,-(i+h.getLeft()),-(r+h.getTop())))return x.clearArray(a),!0}}return x.clearArray(a),!1}TestRayIntersectsInstance(e,t){if(e){const s=e.GetWorldInfo();s.IsCollisionEnabled()&&(this._collisionCheckCount++,s.GetBoundingBox().intersectsRect(t.rect))&&(e.HasTilemap()?this._TestRayIntersectsTilemap(e,s,t):(this._polyCheckCount++,s.HasOwnCollisionPoly()?t.TestInstancePoly(e,s.GetX(),s.GetY(),s.GetTransformedCollisionPoly()):t.TestInstanceQuad(e,s.GetBoundingQuad())))}}_TestRayIntersectsTilemap(s,i,r){const n=i.GetX(),a=i.GetY(),o=G;s.GetSdkInstance().GetCollisionRectCandidates(r.rect,o);for(let e=0,t=o.length;e<t;e++){const h=o[e],l=h.GetRect();if(this._collisionCheckCount++,r.rect.intersectsRectOffset(l,n,a)){const c=h.GetPoly();this._polyCheckCount++,c?r.TestInstancePoly(s,n+l.getLeft(),a+l.getTop(),c):r.TestInstanceRect(s,i.GetX(),i.GetY(),l)}}x.clearArray(o)}SetCollisionCellSize(e,t){if(e!==this._collisionCellWidth||t!==this._collisionCellHeight){this._collisionCellWidth=e,this._collisionCellHeight=t;const s=this._runtime.GetAllObjectClasses();for(const i of s)if(i.IsWorldType()){for(const r of i.instancesIncludingPendingCreate())r.GetWorldInfo()._RemoveFromCollisionCells();i._GetCollisionCellGrid().SetCellSize(e,t),i._SetAnyCollisionCellChanged();for(const n of i.instancesIncludingPendingCreate()){const a=n.GetWorldInfo();a._SetCollisionCellChanged(),a._UpdateCollisionCell()}}}}GetCollisionCellSize(){return[this._collisionCellWidth,this._collisionCellHeight]}_InitCollisionCellSize(e,t){this._collisionCellWidth=e,this._collisionCellHeight=t}}}{const xh=self.C3;xh.SparseGrid=class extends xh.DefendedBase{constructor(e,t){super(),this._cellWidth=e,this._cellHeight=t,this._cells=xh.New(xh.PairMap)}Release(){this._cells.Release(),this._cells=null}SetCellSize(e,t){if(!this._cells.IsEmpty())throw new Error(\"grid not empty\");this._cellWidth=e,this._cellHeight=t}GetCell(e,t,s){let i=this._cells.Get(e,t);return i||(s?(i=xh.New(xh.GridCell,this,e,t),this._cells.Set(e,t,i),i):null)}XToCell(e){const t=Math.floor(e/this._cellWidth);return isFinite(t)?t:0}YToCell(e){const t=Math.floor(e/this._cellHeight);return isFinite(t)?t:0}Update(i,r,n){if(r)for(let s=r.getLeft(),e=r.getRight();s<=e;++s)for(let e=r.getTop(),t=r.getBottom();e<=t;++e)if(!n||!n.containsPoint(s,e)){const a=this.GetCell(s,e,!1);a&&(a.Remove(i),a.IsEmpty())&&this._cells.Delete(s,e)}if(n)for(let s=n.getLeft(),e=n.getRight();s<=e;++s)for(let e=n.getTop(),t=n.getBottom();e<=t;++e)r&&r.containsPoint(s,e)||this.GetCell(s,e,!0).Insert(i)}QueryRange(e,t){let s=this.XToCell(e.getLeft()),i=this.YToCell(e.getTop()),r=this.XToCell(e.getRight()),n=this.YToCell(e.getBottom());if(isFinite(r)&&isFinite(n))for(;s<=r;++s)for(let e=i;e<=n;++e){const a=this.GetCell(s,e,!1);a&&a.Dump(t)}}}}{const vh=self.C3;vh.GridCell=class extends vh.DefendedBase{constructor(e,t,s){super(),this._grid=e,this._x=t,this._y=s,this._instances=vh.New(vh.ArraySet)}Release(){this._instances.Release(),this._instances=null,this._grid=null}IsEmpty(){return this._instances.IsEmpty()}Insert(e){this._instances.Add(e)}Remove(e){this._instances.Delete(e)}Dump(e){vh.appendArray(e,this._instances.GetArray())}}}{const Ph=self.C3;Ph.Ray=class{constructor(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.dx=0,this.dy=0,this.rect=new Ph.Rect,this.hitFraction=2,this.hitUid=null,this.hitNormal=0,this.hitNormalDx=0,this.hitNormalDy=0,this.hitX=0,this.hitY=0,this.distance=0,this.normalX=1,this.normalY=0,this.reflectionX=1,this.reflectionY=0}DidCollide(){return this.hitFraction<1+1e-6}Reset(){this.hitFraction=2}Set(e,t,s,i){return this.x1=e,this.y1=t,this.x2=s,this.y2=i,this.dx=s-e,this.dy=i-t,this.rect.set(e,t,s,i),this.rect.normalize(),this.hitFraction=2,this.hitUid=null,this.hitNormal=0,this.hitNormalDx=0,this.hitNormalDy=0,this.hitX=0,this.hitY=0,this.distance=0,this.normalX=1,this.normalY=0,this.reflectionX=1,this.reflectionY=0,this}Complete(){if(!1!==this.DidCollide()){const e=this.dx*this.hitFraction,t=this.dy*this.hitFraction,s=Math.hypot(e,t),i=e/s,r=t/s,n=(this.distance=s-1e-6,this.hitX=this.x1+i*this.distance,this.hitY=this.y1+r*this.distance,this.hitNormal=Math.atan2(this.hitNormalDy,this.hitNormalDx)+Math.PI/2,this.normalX=Math.cos(this.hitNormal),this.normalY=Math.sin(this.hitNormal),i*this.normalX+r*this.normalY);if(this.reflectionX=i-2*this.normalX*n,this.reflectionY=r-2*this.normalY*n,0<n){const a=Math.PI;this.hitNormal=Ph.clampAngle(this.hitNormal+a),this.normalX=-this.normalX,this.normalY=-this.normalY}}}TestInstanceSegment(e,t,s,i,r){const n=Ph.rayIntersect(this.x1,this.y1,this.x2,this.y2,t,s,i,r);0<=n&&n<this.hitFraction&&(this.hitFraction=n,this.hitUid=e.GetUID(),this.hitNormalDx=t-i,this.hitNormalDy=s-r)}TestInstanceRect(e,t,s,i){const r=t+i.getLeft(),n=t+i.getRight(),a=s+i.getTop(),o=s+i.getBottom();this.TestInstanceSegment(e,r,a,n,a),this.TestInstanceSegment(e,n,a,n,o),this.TestInstanceSegment(e,n,o,r,o),this.TestInstanceSegment(e,r,o,r,a)}TestInstanceQuad(e,t){const s=t.getTlx(),i=t.getTly(),r=t.getTrx(),n=t.getTry(),a=t.getBrx(),o=t.getBry(),h=t.getBlx(),l=t.getBly();this.TestInstanceSegment(e,s,i,r,n),this.TestInstanceSegment(e,r,n,a,o),this.TestInstanceSegment(e,a,o,h,l),this.TestInstanceSegment(e,h,l,s,i)}TestInstancePoly(s,i,r,e){const n=e.pointsArr();for(let e=0,t=n.length;e<t;e+=2){const a=(e+2)%t,o=n[e]+i,h=n[e+1]+r,l=n[a]+i,c=n[1+a]+r;this.TestInstanceSegment(s,o,h,l,c)}}}}{const b=self.C3,Rh=new Set([\"off\",\"crop\",\"scale-inner\",\"scale-outer\",\"letterbox-scale\",\"letterbox-integer-scale\"]),Ah=new Set([\"high\",\"low\"]),Mh=self.glMatrix,Cr=Mh.mat4,br=Mh.vec3,Dh=Cr.create(),Eh=b.New(b.Quad),w=b.New(b.Rect);b.CanvasManager=class extends b.DefendedBase{constructor(e){super(),this._runtime=e,this._canvasLayers=[],this._isWebGPUEnabled=!1,this._webglRenderer=null,this._webgpuRenderer=null,this._iRenderer=null,this._gpuPreference=\"high-performance\",this._isLimitedToWebGL1=!1,this._windowInnerWidth=0,this._windowInnerHeight=0,this._cssDisplayMode=\"\",this._canvasCssWidth=0,this._canvasCssHeight=0,this._canvasDeviceWidth=0,this._canvasDeviceHeight=0,this._canvasCssOffsetX=0,this._canvasCssOffsetY=0,this._zAxisScale=\"normalized\",this._initFieldOfView=0,this._zNear=1,this._zFar=1e4,this._enableMipmaps=!0,this._textureAnisotropy=0,this._drawWidth=0,this._drawHeight=0,this._fullscreenMode=\"letterbox-scale\",this._documentFullscreenMode=\"letterbox-scale\",this._deviceTransformOffX=0,this._deviceTransformOffY=0,this._defaultProjectionMatrix=Cr.create(),this._wantFullscreenScalingQuality=\"high\",this._fullscreenScalingQuality=this._wantFullscreenScalingQuality,this._isDocumentFullscreen=!1,this._availableAdditionalRenderTargets=[],this._usedAdditionalRenderTargets=new Set,this._shaderData=self.C3_Shaders,this._effectChainManager=b.New(b.Gfx.EffectChainManager,{getDrawSize:()=>[this.GetDrawWidth(),this.GetDrawHeight()],getRenderTarget:()=>this.GetEffectCompositorRenderTarget(),releaseRenderTarget:e=>this.ReleaseEffectCompositorRenderTarget(e),getTime:()=>this.GetRuntime().GetGameTime(),redraw:()=>this.GetRuntime().UpdateRender()}),this._gpuTimeStartFrame=0,this._gpuTimeEndFrame=0,this._gpuLastUtilisation=NaN,this._gpuFrameTimingsBuffer=null,this._layersGpuProfile=new Map,this._gpuCurUtilisation=NaN,this._webgpuFrameTimings=new Map,this._snapshotFormat=\"\",this._snapshotQuality=1,this._snapshotArea=b.New(b.Rect),this._snapshotUrl=\"\",this._snapshotPromise=null,this._snapshotResolve=null,this._isPastingToDrawingCanvas=0,this._loaderStartTime=0,this._rafId=-1,this._loadingProgress=0,this._loadingprogress_handler=e=>this._loadingProgress=e.progress,this._percentText=null,this._splashTextures={logo:null,powered:null,website:null},this._splashFrameNumber=0,this._splashFadeInFinishTime=0,this._splashFadeOutStartTime=0,this._splashState=\"fade-in\",this._splashDoneResolve=null,this._splashDonePromise=new Promise(e=>this._splashDoneResolve=e)}_SetGPUPowerPreference(e){this._gpuPreference=e}_SetWebGPUEnabled(e){this._isWebGPUEnabled=!!e}_SetZAxisScale(e){this._zAxisScale=e}GetZAxisScale(){return this._zAxisScale}_SetInitFieldOfView(e){this._initFieldOfView=e}_SetZDistances(e,t){this._zNear=e,this._zFar=t}_SetLimitedToWebGL1(e){this._isLimitedToWebGL1=!!e}async CreateCanvas(e){let t=e.canvas,s=(this._canvasLayers.push({canvas:t,ctx:null}),this._runtime.AddDOMComponentMessageHandler(\"runtime\",\"window-resize\",e=>this._OnWindowResize(e)),this._runtime.AddDOMComponentMessageHandler(\"runtime\",\"fullscreenchange\",e=>this._OnFullscreenChange(e)),this._runtime.AddDOMComponentMessageHandler(\"runtime\",\"fullscreenerror\",e=>this._OnFullscreenError(e)),t.addEventListener(\"webglcontextlost\",e=>this._OnWebGLContextLost(e)),t.addEventListener(\"webglcontextrestored\",e=>this._OnWebGLContextRestored(e)),this._isDocumentFullscreen=!!e.isFullscreen,this._cssDisplayMode=e.cssDisplayMode,navigator.gpu&&this._isWebGPUEnabled),i=!1;if(s)try{await this._InitWebGPUContext(!0)}catch(e){this._MaybeLogRendererError(\"WebGPU\",e),this._webgpuRenderer=null}if(!this.GetRenderer())try{await this._InitWebGLContext(!0)}catch(e){this._MaybeLogRendererError(\"WebGL\",e),this._webglRenderer=null}if(this.GetRenderer()||(i=!0),!this.GetRenderer()&&s)try{await this._InitWebGPUContext(!1)}catch(e){this._MaybeLogRendererError(\"WebGPU\",e),this._webgpuRenderer=null}if(!this.GetRenderer())try{await this._InitWebGLContext(!1)}catch(e){this._MaybeLogRendererError(\"WebGL\",e),this._webglRenderer=null}const r=this.GetRenderer();if(!r)throw new Error(\"failed to acquire a renderer - check WebGL or WebGPU is supported\");r.SetHasMajorPerformanceCaveat(i),this._webgpuRenderer&&(this._webgpuRenderer.ondevicelost=()=>this._OnWebGPUDeviceLost(),this._webgpuRenderer.ondevicerestored=()=>this._OnWebGPUDeviceRestored()),\"normalized\"===this._zAxisScale?r.SetZAxisScaleNormalized():(r.SetZAxisScaleRegular(),r.SetFovY(this._initFieldOfView)),this.SetSize(e.windowInnerWidth,e.windowInnerHeight,!0),await this._InitRenderer()}_MaybeLogRendererError(e,t){t&&\"string\"==typeof t.message&&t.message.startsWith(\"renderer-unavailable\")||console.error(`Error creating ${e} renderer: `,t)}async _InitWebGPUContext(e){const t={nearZ:this._zNear,farZ:this._zFar},s={powerPreference:this._gpuPreference,depth:this._runtime.Uses3DFeatures(),failIfMajorPerformanceCaveat:e,usesBackgroundBlending:this._runtime.UsesAnyBackgroundBlending(),canSampleBackbuffer:this._runtime.UsesAnyCrossSampling(),canSampleDepth:this._runtime.UsesAnyDepthSampling()};this._webgpuRenderer=b.New(b.Gfx.WebGPURenderer,t),await this._webgpuRenderer.Create(this._canvasLayers[0].canvas,s)}async _InitWebGLContext(e){const t={alpha:!0,powerPreference:this._gpuPreference,enableGpuProfiling:\"xbox-uwp-webview2\"!==this._runtime.GetExportType(),depth:this._runtime.Uses3DFeatures(),canSampleDepth:this._runtime.UsesAnyDepthSampling(),failIfMajorPerformanceCaveat:e,nearZ:this._zNear,farZ:this._zFar};this._isLimitedToWebGL1&&(t.maxWebGLVersion=1),this._webglRenderer=b.New(b.Gfx.WebGLRenderer,this._canvasLayers[0].canvas,t),await this._webglRenderer.InitState()}async _InitWebGPU(){if(this._shaderData){const e=[];for(const[t,s]of Object.entries(this._shaderData)){s.src=s.wgsl;const i=b.Gfx.WebGPUShaderProgram.GetDefaultVertexShaderSource();e.push(this._webgpuRenderer.CreateShaderProgram(Object.assign({vertexSrc:i,name:t},s)))}await Promise.all(e)}}async _InitWebGL(){if(this._shaderData){const t=[];for(const[s,i]of Object.entries(this._shaderData)){let e;if(i.glslWebGL2&&2<=this._webglRenderer.GetWebGLVersionNumber())i.src=i.glslWebGL2,e=b.Gfx.WebGLShaderProgram.GetDefaultVertexShaderSource_WebGL2();else{if(!i.glsl)throw new Error(`shader '${s}' does not support WebGL 1`);i.src=i.glsl,e=b.Gfx.WebGLShaderProgram.GetDefaultVertexShaderSource()}t.push(this._webglRenderer.CreateShaderProgram(Object.assign({vertexSrc:e,name:s},i)))}await Promise.all(t),this._webglRenderer.ResetLastProgram(),this._webglRenderer.SetTextureFillMode()}this._webglRenderer.SupportsGPUProfiling()&&(this._gpuFrameTimingsBuffer=b.New(b.Gfx.WebGLQueryResultBuffer,this._webglRenderer))}async _InitRenderer(){this._webgpuRenderer?await this._InitWebGPU():this._webglRenderer&&await this._InitWebGL();const e=this.GetRenderer();e.SetMipmapsEnabled(this._enableMipmaps),e.SupportsGPUProfiling()&&(this._gpuLastUtilisation=0);for(const t of this._runtime._GetAllEffectLists()){for(const s of t.GetAllEffectTypes())s._InitRenderer(e);t._InitRenderer(e),t.UpdateActiveEffects()}this._iRenderer=new self.IRenderer(this._runtime,e)}Release(){this._runtime=null,this._webglRenderer=null,this._canvasLayers.length=0}IsInWorker(){return this._runtime.IsInWorker()}_OnWindowResize(e){const t=this._runtime;if(!t.IsExportToVideo()){const s=e.devicePixelRatio,i=(this.IsInWorker()&&(self.devicePixelRatio=s),t._SetDevicePixelRatio(s),this._isDocumentFullscreen=!!e.isFullscreen,this._cssDisplayMode=e.cssDisplayMode,this.SetSize(e.innerWidth,e.innerHeight),t.UpdateRender(),new b.Event(\"window-resize\")),r=(i.data=e,t.Dispatcher().dispatchEventAndWaitAsyncSequential(i),new b.Event(\"resize\"));r.cssWidth=this.GetCssWidth(),r.cssHeight=this.GetCssHeight(),r.deviceWidth=this.GetDeviceWidth(),r.deviceHeight=this.GetDeviceHeight(),t.DispatchUserScriptEvent(r),t.IsDebug()&&(t.HitBreakpoint()||self.C3Debugger.IsDebuggerPaused())&&t.Render()}}_OnFullscreenChange(e){this._isDocumentFullscreen=!!e.isFullscreen,this.SetSize(e.innerWidth,e.innerHeight,!0),this._runtime.UpdateRender()}_OnFullscreenError(e){this._isDocumentFullscreen=!!e.isFullscreen,this.SetSize(e.innerWidth,e.innerHeight,!0),this._runtime.UpdateRender()}SetSize(e,t,s=!1){if(e=Math.floor(e),t=Math.floor(t),e<=0||t<=0)throw new Error(\"invalid size\");if(this._windowInnerWidth!==e||this._windowInnerHeight!==t||s){this._windowInnerWidth=e,this._windowInnerHeight=t;const i=this.GetCurrentFullscreenMode();\"letterbox-scale\"===i?this._CalculateLetterboxScale(e,t):\"letterbox-integer-scale\"===i?this._CalculateLetterboxIntegerScale(e,t):\"off\"===i?this._CalculateFixedSizeCanvas(e,t):this._CalculateFullsizeCanvas(e,t),this._UpdateFullscreenScalingQuality(i);for(const{canvas:a}of this._canvasLayers)a.width=this._canvasDeviceWidth,a.height=this._canvasDeviceHeight;this._runtime.PostComponentMessageToDOM(\"canvas\",\"update-size\",{marginLeft:this._canvasCssOffsetX,marginTop:this._canvasCssOffsetY,styleWidth:this._canvasCssWidth,styleHeight:this._canvasCssHeight,displayScale:this.GetDisplayScale()});const r=this.GetRenderer();r.SetSize(this._canvasDeviceWidth,this._canvasDeviceHeight,!0);for(const o of this._availableAdditionalRenderTargets)r.DeleteRenderTarget(o);b.clearArray(this._availableAdditionalRenderTargets),this.UpdateDefaultProjectionMatrix();const n=this._runtime.GetLayoutManager();n.SetAllLayerProjectionChanged(),n.SetAllLayerMVChanged()}}UpdateDefaultProjectionMatrix(){this.GetRenderer().CalculatePerspectiveMatrix(this._defaultProjectionMatrix,this.GetDrawWidth()/this.GetDrawHeight())}GetDefaultProjectionMatrix(){return this._defaultProjectionMatrix}_CalculateLetterboxScale(e,t){const s=this._runtime.GetDevicePixelRatio(),i=this._runtime.GetOriginalViewportWidth(),r=this._runtime.GetOriginalViewportHeight(),n=i/r,a=e/t;if(n<a){const o=t*n;this._canvasCssWidth=Math.round(o),this._canvasCssHeight=t,this._canvasCssOffsetX=Math.floor((e-this._canvasCssWidth)/2),this._canvasCssOffsetY=0}else{const h=e/n;this._canvasCssWidth=e,this._canvasCssHeight=Math.round(h),this._canvasCssOffsetX=0,this._canvasCssOffsetY=Math.floor((t-this._canvasCssHeight)/2)}this._canvasDeviceWidth=Math.round(this._canvasCssWidth*s),this._canvasDeviceHeight=Math.round(this._canvasCssHeight*s),this._runtime.SetViewportSize(i,r)}_CalculateLetterboxIntegerScale(e,t){let s=this._runtime.GetDevicePixelRatio(),i=(1!==s&&(e+=1,t+=1),this._runtime.GetOriginalViewportWidth()),r=this._runtime.GetOriginalViewportHeight(),n=i/r,a=e/t,o;if(n<a){const h=t*n;o=h*s/i}else{const l=e/n;o=l*s/r}1<o?o=Math.floor(o):o<1&&(o=1/Math.ceil(1/o)),this._canvasDeviceWidth=Math.round(i*o),this._canvasDeviceHeight=Math.round(r*o),this._canvasCssWidth=this._canvasDeviceWidth/s,this._canvasCssHeight=this._canvasDeviceHeight/s,this._canvasCssOffsetX=Math.max(Math.floor((e-this._canvasCssWidth)/2),0),this._canvasCssOffsetY=Math.max(Math.floor((t-this._canvasCssHeight)/2),0),this._runtime.SetViewportSize(i,r)}_CalculateFullsizeCanvas(e,t){const s=this._runtime.GetDevicePixelRatio(),i=(this._canvasCssWidth=e,this._canvasCssHeight=t,this._canvasDeviceWidth=Math.round(this._canvasCssWidth*s),this._canvasDeviceHeight=Math.round(this._canvasCssHeight*s),this._canvasCssOffsetX=0,this._canvasCssOffsetY=0,this.GetDisplayScale());this._runtime.SetViewportSize(this._canvasCssWidth/i,this._canvasCssHeight/i)}_CalculateFixedSizeCanvas(e,t){const s=this._runtime.GetDevicePixelRatio();this._canvasCssWidth=this._runtime.GetViewportWidth(),this._canvasCssHeight=this._runtime.GetViewportHeight(),this._canvasDeviceWidth=Math.round(this._canvasCssWidth*s),this._canvasDeviceHeight=Math.round(this._canvasCssHeight*s),this.IsDocumentFullscreen()?(this._canvasCssOffsetX=Math.floor((e-this._canvasCssWidth)/2),this._canvasCssOffsetY=Math.floor((t-this._canvasCssHeight)/2)):(this._canvasCssOffsetX=0,this._canvasCssOffsetY=0),this._runtime.SetViewportSize(this._runtime.GetViewportWidth(),this._runtime.GetViewportHeight())}_UpdateFullscreenScalingQuality(s){if(\"high\"===this._wantFullscreenScalingQuality)this._drawWidth=this._canvasDeviceWidth,this._drawHeight=this._canvasDeviceHeight,this._fullscreenScalingQuality=\"high\";else{let e,t;if(t=\"off\"===this.GetCurrentFullscreenMode()?(e=this._runtime.GetViewportWidth(),this._runtime.GetViewportHeight()):(e=this._runtime.GetOriginalViewportWidth(),this._runtime.GetOriginalViewportHeight()),this._canvasDeviceWidth<e||this._canvasDeviceHeight<t)this._drawWidth=this._canvasDeviceWidth,this._drawHeight=this._canvasDeviceHeight,this._fullscreenScalingQuality=\"high\";else if(this._drawWidth=e,this._drawHeight=t,this._fullscreenScalingQuality=\"low\",\"scale-inner\"===s){const i=e/t,r=this._windowInnerWidth/this._windowInnerHeight;r<i?this._drawWidth=this._drawHeight*r:i<r&&(this._drawHeight=this._drawWidth/r)}else if(\"scale-outer\"===s){const n=e/t,a=this._windowInnerWidth/this._windowInnerHeight;n<a?this._drawWidth=this._drawHeight*a:a<n&&(this._drawHeight=this._drawWidth/a)}}}GetRuntime(){return this._runtime}GetMainCanvas(){return this._canvasLayers[0].canvas}GetEffectChainManager(){return this._effectChainManager}IsDocumentFullscreen(){return this._isDocumentFullscreen}GetCssDisplayMode(){return this._cssDisplayMode}SetFullscreenMode(e){if(!Rh.has(e))throw new Error(\"invalid fullscreen mode\");this._fullscreenMode=e;const t=this._runtime.GetLayoutManager();t.SetAllLayerProjectionChanged(),t.SetAllLayerMVChanged()}GetFullscreenMode(){return this._fullscreenMode}SetDocumentFullscreenMode(e){if(!Rh.has(e))throw new Error(\"invalid fullscreen mode\");this._documentFullscreenMode=e;const t=this._runtime.GetLayoutManager();t.SetAllLayerProjectionChanged(),t.SetAllLayerMVChanged()}GetDocumentFullscreenMode(){return this._documentFullscreenMode}GetCurrentFullscreenMode(){return this.IsDocumentFullscreen()?this.GetDocumentFullscreenMode():this.GetFullscreenMode()}SetFullscreenScalingQuality(e){if(!Ah.has(e))throw new Error(\"invalid fullscreen scaling quality\");this._wantFullscreenScalingQuality=e,this._runtime.GetLayoutManager().SetAllLayerProjectionChanged()}GetSetFullscreenScalingQuality(){return this._wantFullscreenScalingQuality}GetCurrentFullscreenScalingQuality(){return this._fullscreenScalingQuality}static _FullscreenModeNumberToString(e){switch(e){case 0:return\"off\";case 1:return\"crop\";case 2:return\"scale-inner\";case 3:return\"scale-outer\";case 4:return\"letterbox-scale\";case 5:return\"letterbox-integer-scale\";default:throw new Error(\"invalid fullscreen mode\")}}GetLastWidth(){return this._windowInnerWidth}GetLastHeight(){return this._windowInnerHeight}GetDrawWidth(){return this._drawWidth}GetDrawHeight(){return this._drawHeight}SetMipmapsEnabled(e){this._enableMipmaps=!!e}_SetTextureAnisotropy(e){this._textureAnisotropy=e}GetTextureAnisotropy(){return this._textureAnisotropy}IsRendererContextLost(){return this.GetRenderer().IsContextLost()}_OnWebGLContextLost(e){console.log(\"[Construct] WebGL context lost\"),e.preventDefault(),this._availableAdditionalRenderTargets=[],this._usedAdditionalRenderTargets.clear(),this._effectChainManager.OnContextLost(),this._webglRenderer.OnContextLost(),this._runtime._OnRendererContextLost()}_OnWebGPUDeviceLost(){console.log(\"[Construct] WebGPU device lost\"),this._availableAdditionalRenderTargets=[],this._usedAdditionalRenderTargets.clear(),this._effectChainManager.OnContextLost(),this._runtime._OnRendererContextLost()}async _OnWebGLContextRestored(e){await this._webglRenderer.OnContextRestored(),await this._InitRenderer(),await this._runtime._OnRendererContextRestored(),console.log(\"[Construct] WebGL context restored\")}async _OnWebGPUDeviceRestored(){await this._InitRenderer(),await this._runtime._OnRendererContextRestored(),console.log(\"[Construct] WebGPU device restored\")}GetWebGLRenderer(){return this._webglRenderer}GetWebGPURenderer(){return this._webgpuRenderer}GetRenderer(){return this._webgpuRenderer||this._webglRenderer}GetIRenderer(){return this._iRenderer}GetRendererString(){let e=\"\";return e=this._runtime.GetWebGPURenderer()?\"webgpu\":\"webgl\"+this._runtime.GetWebGLRenderer().GetWebGLVersionNumber(),this._runtime.GetRenderer().HasMajorPerformanceCaveat()&&(e+=\"-software\"),e}GetRendererDetailString(){return this._runtime.GetWebGPURenderer()?this._runtime.GetWebGPURenderer().GetAdapterInfoString():this._runtime.GetWebGLRenderer().GetUnmaskedRenderer()}GetRenderScale(){return\"low\"===this._fullscreenScalingQuality?1/this._runtime.GetDevicePixelRatio():this.GetDisplayScale()}GetDisplayScale(){const e=this.GetCurrentFullscreenMode();if(\"off\"===e||\"crop\"===e)return 1;const t=this._runtime.GetOriginalViewportWidth(),s=this._runtime.GetOriginalViewportHeight(),i=t/s,r=this._canvasDeviceWidth/this._canvasDeviceHeight;return\"scale-inner\"!==e&&i<r||\"scale-inner\"===e&&r<i?this._canvasCssHeight/s:this._canvasCssWidth/t}GetEffectLayerScaleParam(){return\"low\"===this.GetCurrentFullscreenScalingQuality()?1:this.GetDisplayScale()}GetEffectDevicePixelRatioParam(){return\"low\"===this.GetCurrentFullscreenScalingQuality()?1:this._runtime.GetDevicePixelRatio()}SetDeviceTransformOffset(e,t){this._deviceTransformOffX=e,this._deviceTransformOffY=t}SetDeviceTransform(t,s,i,e=!0){s=s||this._drawWidth,i=i||this._drawHeight;const r=s/2+this._deviceTransformOffX,n=i/2+this._deviceTransformOffY;if(e){let e=this.GetDefaultProjectionMatrix();s===this._drawWidth&&i===this._drawHeight||(t.CalculatePerspectiveMatrix(Dh,s/i),e=Dh),t.SetProjectionMatrix(e)}const a=t.CalculateLookAtModelView2(r,n,t.GetDefaultCameraZ(i),r,n,0,i);t.SetModelViewMatrix(a)}SetCssTransform(e,t=!0){const s=this.GetCssWidth(),i=this.GetCssHeight(),r=s/2,n=i/2,a=(t&&e.SetProjectionMatrix(this.GetDefaultProjectionMatrix()),e.CalculateLookAtModelView2(r,n,e.GetDefaultCameraZ(i),r,n,0,i));e.SetModelViewMatrix(a)}GetDeviceWidth(){return this._canvasDeviceWidth}GetDeviceHeight(){return this._canvasDeviceHeight}GetCssWidth(){return this._canvasCssWidth}GetCssHeight(){return this._canvasCssHeight}GetCanvasClientX(){return this._canvasCssOffsetX}GetCanvasClientY(){return this._canvasCssOffsetY}GetHTMLLayerCount(){return this._canvasLayers.length}_CanUseImageBitmapRenderingContext(){return\"undefined\"!=typeof OffscreenCanvas&&this.GetMainCanvas()instanceof OffscreenCanvas&&(\"Chromium\"!==b.Platform.BrowserEngine||124<=b.Platform.BrowserVersionNumber)}async SetHTMLLayerCount(i,r=!1){if(i<1)throw new Error(\"invalid HTML layer count\");if(this._canvasLayers.length!==i){let e=this._runtime.GetLayoutManager().GetMainRunningLayout(),t={count:i,layersDomState:e._GetRootLayers().filter(e=>e.IsHTMLElementsLayer()).map(e=>e._GetHTMLLayerDOMState()),immediate:r,marginLeft:this._canvasCssOffsetX,marginTop:this._canvasCssOffsetY,styleWidth:this._canvasCssWidth,styleHeight:this._canvasCssHeight},s;if(s=this.IsInWorker()?await this._runtime.PostComponentMessageToDOMAsync(\"canvas\",\"set-html-layer-count\",t):self.c3_runtimeInterface._OnSetHTMLLayerCount(t),i<this._canvasLayers.length)this._canvasLayers.length=i;else for(const n of s.addedCanvases){n.width=this._canvasDeviceWidth,n.height=this._canvasDeviceHeight;const a=this._CanUseImageBitmapRenderingContext()?\"bitmaprenderer\":\"2d\",o=n.getContext(a);if(!o)throw new Error(`failed to acquire '${a}' canvas context`);this._canvasLayers.push({canvas:n,ctx:o})}this._runtime.UpdateRender()}}BlitMainCanvasToHTMLLayerCanvas(e){if(!(e>=this._canvasLayers.length)){const t=this.GetMainCanvas(),s=this._canvasLayers[e].ctx;this._CanUseImageBitmapRenderingContext()?s.transferFromImageBitmap(t.transferToImageBitmap()):(s.globalCompositeOperation=\"copy\",s.drawImage(t,0,0))}}GetAdditionalRenderTarget(t){t.depth=this._runtime.Uses3DFeatures();let e=this._availableAdditionalRenderTargets,s=e.findIndex(e=>e.IsCompatibleWithOptions(t)),i;return-1!==s?(i=e[s],e.splice(s,1)):i=this.GetRenderer().CreateRenderTarget(t),this._usedAdditionalRenderTargets.add(i),i}ReleaseAdditionalRenderTarget(e){if(!this._usedAdditionalRenderTargets.has(e))throw new Error(\"render target not in use\");this._usedAdditionalRenderTargets.delete(e),this._availableAdditionalRenderTargets.push(e)}GetEffectCompositorRenderTarget(){const e={sampling:this._runtime.GetSampling()};return\"low\"===this.GetCurrentFullscreenScalingQuality()&&(e.width=this.GetDrawWidth(),e.height=this.GetDrawHeight()),this.GetAdditionalRenderTarget(e)}ReleaseEffectCompositorRenderTarget(e){this.ReleaseAdditionalRenderTarget(e)}*activeLayersGpuProfiles(){for(const e of this._runtime.GetLayoutManager().runningLayouts())for(const t of e.GetLayers()){const s=this._layersGpuProfile.get(t);s&&(yield s)}}GetLayerTimingsBuffer(e){if(!this.GetRenderer().SupportsGPUProfiling())return null;let t=this._layersGpuProfile.get(e);return t||(t={layer:e,name:e.GetName(),timingsBuffer:b.New(b.Gfx.WebGLQueryResultBuffer,this._webglRenderer),curUtilisation:0,lastTotalUtilisation:0,lastSelfUtilisation:0},this._layersGpuProfile.set(e,t)),t.timingsBuffer}_Update1sFrameRange(){const e=this.GetRenderer();if(e.SupportsGPUProfiling()&&0===this._gpuTimeEndFrame){this._gpuTimeEndFrame=e.GetFrameNumber(),this._gpuCurUtilisation=NaN;for(const t of this.activeLayersGpuProfiles())t.curUtilisation=NaN}}_UpdateTick(){this._webglRenderer&&this._webglRenderer.SupportsGPUProfiling()&&this._UpdateTick_WebGL(),this._webgpuRenderer&&this._webgpuRenderer.SupportsGPUProfiling()&&this._UpdateTick_WebGPU()}_UpdateTick_WebGL(){if(isNaN(this._gpuCurUtilisation)&&(this._gpuCurUtilisation=this._gpuFrameTimingsBuffer.GetFrameRangeResultSum(this._gpuTimeStartFrame,this._gpuTimeEndFrame),!isNaN(this._gpuCurUtilisation))){if(this._runtime.IsDebug())for(const e of this.activeLayersGpuProfiles())if(e.curUtilisation=e.timingsBuffer.GetFrameRangeResultSum(this._gpuTimeStartFrame,this._gpuTimeEndFrame),isNaN(e.curUtilisation))return;if(this._gpuFrameTimingsBuffer.DeleteAllBeforeFrameNumber(this._gpuTimeEndFrame),this._gpuLastUtilisation=Math.min(this._gpuCurUtilisation,1),this._runtime.IsDebug()){const s=new Map;for(const r of this.activeLayersGpuProfiles())r.timingsBuffer.DeleteAllBeforeFrameNumber(this._gpuTimeEndFrame),r.lastTotalUtilisation=Math.min(r.curUtilisation,1),s.set(r.layer,r.lastTotalUtilisation);for(const n of this.activeLayersGpuProfiles()){const a=n.layer,o=s.get(a)||0,h=o-a.GetSubLayers().reduce((e,t)=>e+(s.get(t)||0),0);n.lastSelfUtilisation=b.clamp(h,0,1)}const t=this._runtime.GetMainRunningLayout(),i=this._gpuLastUtilisation-t._GetRootLayers().reduce((e,t)=>e+(s.get(t)||0),0);self.C3Debugger.UpdateGPUProfile(b.clamp(i,0,1),this._gpuLastUtilisation,[...this.activeLayersGpuProfiles()])}this._gpuTimeStartFrame=this._gpuTimeEndFrame,this._gpuTimeEndFrame=0}}GetGPUFrameTimingsBuffer(){return this._gpuFrameTimingsBuffer}_UpdateTick_WebGPU(){if(0!==this._gpuTimeEndFrame){for(let e=this._gpuTimeStartFrame;e<this._gpuTimeEndFrame;++e){const s=this._webgpuFrameTimings.get(e);if(s&&!s.HasResult())return}let e=this._runtime.GetMainRunningLayout(),a=b.MakeFilledArray(e.GetLayerCount()+1,0),t=0;for(let e=this._gpuTimeStartFrame;e<this._gpuTimeEndFrame;++e){const o=this._webgpuFrameTimings.get(e);if(o){let s=o.GetResult(),i=BigInt(0),r=BigInt(0),n=BigInt(0);for(let e=0,t=Math.min(a.length,s.length/2);e<t;++e){const c=s[2*e],u=s[2*e+1],_=(c!==n&&(i===n||c<i)&&(i=c),u>r&&(r=u),u-c),d=Number(_)/1e9;a[e]+=d}const h=r-i,l=Number(h)/1e9;t+=l}}if(this._gpuLastUtilisation=b.clamp(t,0,1),this._runtime.IsDebug()){const i=e.GetLayers(),r=new Map;for(let e=0,t=Math.min(i.length,a.length-1);e<t;++e){const m=a[e+1];r.set(i[e],m)}const n=[],p=new Map;for(const[g,S]of r){const y=[...g.selfAndAllSubLayers()].reduce((e,t)=>e+(r.get(t)||0),0);p.set(g,y),n.push({name:g.GetName(),lastSelfUtilisation:b.clamp(S,0,1),lastTotalUtilisation:b.clamp(y,0,1)})}const f=this._gpuLastUtilisation-e._GetRootLayers().reduce((e,t)=>e+(p.get(t)||0),0);self.C3Debugger.UpdateGPUProfile(b.clamp(f,0,1),this._gpuLastUtilisation,n)}for(let e=this._gpuTimeStartFrame;e<this._gpuTimeEndFrame;++e)this._webgpuFrameTimings.delete(e);this._gpuTimeStartFrame=this._gpuTimeEndFrame,this._gpuTimeEndFrame=0}}_AddWebGPUFrameTiming(e){this._webgpuFrameTimings.set(this._webgpuRenderer.GetFrameNumber(),e)}GetGPUUtilisation(){return this._gpuLastUtilisation}SnapshotCanvas(e,t,s,i,r,n){return this._snapshotFormat=e,this._snapshotQuality=t,this._snapshotArea.setWH(s,i,r,n),this._snapshotPromise||(this._snapshotPromise=new Promise(e=>{this._snapshotResolve=e})),this._snapshotPromise}_MaybeTakeSnapshot(){if(this._snapshotFormat){let e=this.GetMainCanvas(),t=this._snapshotArea,s=b.clamp(Math.floor(t.getLeft()),0,e.width),i=b.clamp(Math.floor(t.getTop()),0,e.height),r=t.width(),n=(r=0===r?e.width-s:b.clamp(Math.floor(r),0,e.width-s),t.height());if(n=0===n?e.height-i:b.clamp(Math.floor(n),0,e.height-i),(0!==s||0!==i||r!==e.width||n!==e.height)&&0<r&&0<n){const a=b.CreateCanvas(r,n),o=a.getContext(\"2d\");o.drawImage(e,s,i,r,n,0,0,r,n),e=a}b.CanvasToBlob(e,this._snapshotFormat,this._snapshotQuality).then(e=>{this._snapshotUrl&&URL.revokeObjectURL(this._snapshotUrl),this._snapshotUrl=URL.createObjectURL(e),this._snapshotPromise=null,this._snapshotResolve(this._snapshotUrl)}),this._snapshotFormat=\"\",this._snapshotQuality=1}}GetCanvasSnapshotUrl(){return this._snapshotUrl}SetIsPastingToDrawingCanvas(e){e?this._isPastingToDrawingCanvas++:this._isPastingToDrawingCanvas--}IsPastingToDrawingCanvas(){return 0<this._isPastingToDrawingCanvas}InitLoadingScreen(e){const t=this.GetRenderer();if(2===e)this._percentText=b.New(b.Gfx.RendererText,this.GetRenderer()),this._percentText.SetFontName(\"Arial\"),this._percentText.SetFontSize(16),this._percentText.SetHorizontalAlignment(\"center\"),this._percentText.SetVerticalAlignment(\"center\"),this._percentText.SetSize(300,200);else if(0===e){const s=this._runtime.GetLoadingLogoAsset();s&&s.LoadStaticTexture(t).catch(e=>console.warn(\"[C3 runtime] Failed to create texture for loading logo: \",e))}else 4===e&&(this._LoadSvgSplashImage(\"splash-images/splash-logo.svg\").then(e=>{\"done\"===this._splashState?t.DeleteTexture(e):this._splashTextures.logo=e}).catch(e=>console.warn(\"Failed to load splash image: \",e)),this._LoadBitmapSplashImage(\"splash-images/splash-poweredby-512.png\").then(e=>{\"done\"===this._splashState?t.DeleteTexture(e):this._splashTextures.powered=e}).catch(e=>console.warn(\"Failed to load splash image: \",e)),this._LoadBitmapSplashImage(\"splash-images/splash-website-512.png\").then(e=>{\"done\"===this._splashState?t.DeleteTexture(e):this._splashTextures.website=e}).catch(e=>console.warn(\"Failed to load splash image: \",e)))}async _LoadSvgSplashImage(e){e=new URL(e,this._runtime.GetRuntimeBaseURL()).toString();const t=await b.FetchBlob(e),s=await this._runtime.RasterSvgImage(t,2048,2048);return this.GetRenderer().CreateStaticTextureAsync(s,{mipMapQuality:\"high\"})}async _LoadBitmapSplashImage(e){e=new URL(e,this._runtime.GetRuntimeBaseURL()).toString();const t=await b.FetchBlob(e);return this.GetRenderer().CreateStaticTextureAsync(t,{mipMapQuality:\"high\"})}HideCordovaSplashScreen(){this._runtime.PostComponentMessageToDOM(\"runtime\",\"hide-cordova-splash\")}StartLoadingScreen(){this._loaderStartTime=Date.now(),this._runtime.Dispatcher().addEventListener(\"loadingprogress\",this._loadingprogress_handler),this._rafId=requestAnimationFrame(()=>this._DrawLoadingScreen());const e=this._runtime.GetLoaderStyle();3!==e&&this.HideCordovaSplashScreen()}async EndLoadingScreen(){const e=this.GetRenderer(),t=(this._loadingProgress=1,this._runtime.GetLoaderStyle());4===t&&await this._splashDonePromise,this._splashDoneResolve=null,this._splashDonePromise=null,-1!==this._rafId&&(cancelAnimationFrame(this._rafId),this._rafId=-1),this._runtime.Dispatcher().removeEventListener(\"loadingprogress\",this._loadingprogress_handler),this._loadingprogress_handler=null,this._percentText&&(this._percentText.Release(),this._percentText=null),this._runtime.ReleaseLoadingLogoAsset(),e.Start(),this._splashTextures.logo&&(e.DeleteTexture(this._splashTextures.logo),this._splashTextures.logo=null),this._splashTextures.powered&&(e.DeleteTexture(this._splashTextures.powered),this._splashTextures.powered=null),this._splashTextures.website&&(e.DeleteTexture(this._splashTextures.website),this._splashTextures.website=null),e.ClearRgba(0,0,0,0),e.Finish(),this._splashState=\"done\",this._gpuTimeStartFrame=e.GetFrameNumber(),3===t&&this.HideCordovaSplashScreen()}_DrawLoadingScreen(){if(-1!==this._rafId){const e=this.GetRenderer(),t=(e.Start(),this._rafId=-1,this._runtime.GetAssetManager().HasHadErrorLoading()),s=this._runtime.GetLoaderStyle();if(3!==s&&(this.SetCssTransform(e),e.ClearRgba(0,0,0,0),e.ResetColor(),e.SetTextureFillMode(),e.SetTexture(null)),0===s)this._DrawProgressBarAndLogoLoadingScreen(t);else if(1===s)this._DrawProgressBarLoadingScreen(t,120,0);else if(2===s)this._DrawPercentTextLoadingScreen(t);else if(3===s)b.noop();else{if(4!==s)throw new Error(\"invalid loader style\");this._DrawSplashLoadingScreen(t)}e.Finish(),this._rafId=requestAnimationFrame(()=>this._DrawLoadingScreen())}}_DrawPercentTextLoadingScreen(e){e?this._percentText.SetColorRgb(1,0,0):this._percentText.SetColorRgb(.6,.6,.6),this._percentText.SetText(Math.round(100*this._loadingProgress)+\"%\");const t=this._canvasCssWidth/2,s=this._canvasCssHeight/2,i=(Eh.setRect(t-150,s-100,150+t,100+s),this.GetRenderer());i.SetTexture(this._percentText.GetTexture()),i.Quad3(Eh,this._percentText.GetTexRect())}_DrawProgressBarLoadingScreen(e,t,s){const i=this.GetRenderer(),r=(i.SetColorFillMode(),e?i.SetColorRgba(1,0,0,1):i.SetColorRgba(.118,.565,1,1),this._canvasCssWidth/2),n=this._canvasCssHeight/2,a=t/2;w.setWH(r-a,n-4+s,Math.floor(t*this._loadingProgress),8),i.Rect(w),w.setWH(r-a,n-4+s,t,8),w.offset(-.5,-.5),w.inflate(.5,.5),i.SetColorRgba(0,0,0,1),i.LineRect2(w),w.inflate(1,1),i.SetColorRgba(1,1,1,1),i.LineRect2(w)}_DrawProgressBarAndLogoLoadingScreen(e){const t=this.GetRenderer(),s=this._runtime.GetLoadingLogoAsset();if(s){const i=s.GetTexture();if(i){const r=i.GetWidth(),n=i.GetHeight(),a=this._canvasCssWidth/2,o=this._canvasCssHeight/2,h=r/2,l=n/2;Eh.setRect(a-h,o-l,a+h,o+l),t.SetTexture(i),t.Quad(Eh),this._DrawProgressBarLoadingScreen(e,r,16+l)}else this._DrawProgressBarLoadingScreen(e,120,0)}else this._DrawProgressBarLoadingScreen(e,120,0)}_DrawSplashLoadingScreen(e){let t=this.GetRenderer(),s=this._splashTextures.logo,i=this._splashTextures.powered,r=this._splashTextures.website,n=Date.now(),a=(0===this._splashFrameNumber&&(this._loaderStartTime=n),this._runtime.IsPreview()||this._runtime.IsFBInstantAvailable()&&!this._runtime.IsCordova()),o=a?0:200,h=a?0:3e3,l=1,c=(\"fade-in\"===this._splashState?l=Math.min((n-this._loaderStartTime)/300,1):\"fade-out\"===this._splashState&&(l=Math.max(1-(n-this._splashFadeOutStartTime)/300,0)),t.SetColorFillMode(),t.SetColorRgba(.231*l,.251*l,.271*l,l),w.set(0,0,this._canvasCssWidth,this._canvasCssHeight),t.Rect(w),Math.ceil(this._canvasCssWidth)),u=Math.ceil(this._canvasCssHeight),_,d;256<this._canvasCssHeight?(t.SetColorRgba(.302*l,.334*l,.365*l,l),_=c,d=Math.max(.005*u,2),w.setWH(0,.8*u-d/2,_,d),t.Rect(w),e?t.SetColorRgba(l,0,0,l):t.SetColorRgba(.161*l,.953*l,.816*l,l),_=c*this._loadingProgress,w.setWH(.5*c-_/2,.8*u-d/2,_,d),t.Rect(w),t.SetColorRgba(l,l,l,l),t.SetTextureFillMode(),i&&(_=1.5*b.clamp(.22*u,105,.6*c),d=_/8,w.setWH(.5*c-_/2,.2*u-d/2,_,d),t.SetTexture(i),t.Rect(w)),s&&(_=Math.min(.395*u,.95*c),d=_,w.setWH(.5*c-_/2,.485*u-d/2,_,d),t.SetTexture(s),t.Rect(w)),r&&(_=1.5*b.clamp(.22*u,105,.6*c),d=_/8,w.setWH(.5*c-_/2,.868*u-d/2,_,d),t.SetTexture(r),t.Rect(w))):(t.SetColorRgba(.302*l,.334*l,.365*l,l),_=c,d=Math.max(.005*u,2),w.setWH(0,.85*u-d/2,_,d),t.Rect(w),e?t.SetColorRgba(l,0,0,l):t.SetColorRgba(.161*l,.953*l,.816*l,l),_=c*this._loadingProgress,w.setWH(.5*c-_/2,.85*u-d/2,_,d),t.Rect(w),t.SetColorRgba(l,l,l,l),t.SetTextureFillMode(),s&&(_=.55*u,d=_,w.setWH(.5*c-_/2,.45*u-d/2,_,d),t.SetTexture(s),t.Rect(w))),this._splashFrameNumber++,\"fade-in\"===this._splashState&&300<=n-this._loaderStartTime&&2<=this._splashFrameNumber&&(this._splashState=\"wait\",this._splashFadeInFinishTime=n),\"wait\"===this._splashState&&n-this._splashFadeInFinishTime>=h&&1<=this._loadingProgress&&(this._splashState=\"fade-out\",this._splashFadeOutStartTime=n),(\"fade-out\"===this._splashState&&n-this._splashFadeOutStartTime>=300+o||a&&1<=this._loadingProgress&&n-this._loaderStartTime<500)&&this._splashDoneResolve()}}}{let U=self.C3,j=self.C3Debugger,s={messagePort:null,runtimeBaseUrl:\"\",headless:!1,hasDom:!0,isInWorker:!1,useAudio:!0,exportType:\"\"},a=!0;U.Runtime=class extends U.DefendedBase{constructor(e){e=Object.assign({},s,e),super(),this._messagePort=e.messagePort,this._runtimeBaseUrl=e.runtimeBaseUrl,this._previewUrl=e.previewUrl,this._isHeadless=!!e.headless,this._hasDom=!!e.hasDom,this._isInWorker=!!e.isInWorker,a=e.ife,this._useAudio=!!e.useAudio,this._exportType=e.exportType,this._isNWjs=e.isNWjs,this._isiOSCordova=!!e.isiOSCordova,this._isiOSWebView=!!e.isiOSWebView,this._isWindowsWebView2=!!e.isWindowsWebView2,this._isAnyWebView2Wrapper=!!e.isAnyWebView2Wrapper,this._isFBInstantAvailable=!!e.isFBInstantAvailable,this._isDebug=!(\"preview\"!==this._exportType||!e.isDebug),this._breakpointsEnabled=this._isDebug,this._isDebugging=this._isDebug,this._debuggingDisabled=0,this._additionalLoadPromises=[],this._additionalCreatePromises=[],this._isUsingCreatePromises=!1,this._projectName=\"\",this._projectVersion=\"\",this._projectUniqueId=\"\",this._appId=\"\",this._originalViewportWidth=0,this._originalViewportHeight=0,this._devicePixelRatio=self.devicePixelRatio,this._parallaxXorigin=0,this._parallaxYorigin=0,this._viewportWidth=0,this._viewportHeight=0,this._loaderStyle=0,this._usesLoaderLayout=!1,this._isLoading=!0,this._usesAnyBackgroundBlending=!1,this._usesAnyCrossSampling=!1,this._usesAnyDepthSampling=!1,this._loadingLogoAsset=null,this._assetManager=U.New(U.AssetManager,this,e),this._layoutManager=U.New(U.LayoutManager,this),this._eventSheetManager=U.New(U.EventSheetManager,this),this._addonManager=U.New(U.AddonManager,this,e.wrapperComponentIds),this._collisionEngine=U.New(U.CollisionEngine,this),this._timelineManager=U.New(U.TimelineManager,this),this._transitionManager=U.New(U.TransitionManager,this),this._templateManager=U.New(U.TemplateManager,this),this._flowchartManager=U.New(U.FlowchartManager,this),this._textIconManager=U.New(U.TextIconManager,{getIconSetMeta:e=>this._GetTextIconSetMeta(e),getIconSetContent:e=>this._GetTextIconSetContent(e)}),this._iconChangeHandlers=new Map,this._allObjectClasses=[],this._objectClassesByName=new Map,this._objectClassesBySid=new Map,this._familyCount=0,this._allContainers=[],this._allEffectLists=new Set,this._currentLayoutStack=[],this._instancesPendingCreate=[],this._instancesPendingDestroy=new Map,this._hasPendingInstances=!1,this._isFlushingPendingInstances=!1,this._objectCount=0,this._nextUid=0,this._instancesByUid=new Map,this._instancesPendingRelease=new Set,this._instancesPendingReleaseAffectedObjectClasses=new Set,this._objectReferenceTable=[],this._jsPropNameTable=[],this._canvasManager=null,this._uses3dFeatures=!1,this._framerateMode=\"vsync\",this._sampling=\"trilinear\",this._isPixelRoundingEnabled=!1,this._needRender=!0,this._pauseOnBlur=!1,this._isPausedOnBlur=!1,this._exportToVideo=null,this._tickCallbacks={normal:e=>{this._rafId=-1,this._ruafId=-1,this.Tick(e)},tickOnly:e=>{this._ruafId=-1,this.Tick(e,!1,\"skip-render\")},renderOnly:()=>{this._rafId=-1,this.Render()}},this._rafId=-1,this._ruafId=-1,this._tickCount=0,this._tickCountNoSave=0,this._hasStarted=!1,this._isInTick=!1,this._hasStartedTicking=!1,this._isLayoutFirstTick=!0,this._isAutoSuspendEnabled=!0,this._isPageVisibilitySuspended=!1,this._suspendCount=0,this._scheduleTriggersThrottle=new U.PromiseThrottle(1),this._randomNumberCallback=()=>Math.random(),this._startTime=0,this._lastTickTime=0,this._dtRaw=0,this._dt1=0,this._dt=0,this._timeScale=1,this._maxDt=1/30,this._minDt=0,this._gameTime=U.New(U.KahanSum),this._gameTimeRaw=U.New(U.KahanSum),this._wallTime=U.New(U.KahanSum),this._instanceTimes=new Map,this._fpsFrameCount=-1,this._fpsLastTime=0,this._fps=0,this._tpsTickCount=-1,this._tps=0,this._mainThreadTimeCounter=0,this._mainThreadTime=0,this._isLoadingState=!1,this._saveToSlotName=\"\",this._saveToJsonString=!1,this._loadFromSlotName=\"\",this._loadFromJson=null,this._lastSaveJson=\"\",this._projectStorage=null,this._savegamesStorage=null,this._dispatcher=U.New(U.Event.Dispatcher),this._domEventHandlers=new Map,this._pendingResponsePromises=new Map,this._nextDomResponseId=0,this._didRequestDeviceOrientationEvent=!1,this._didRequestDeviceMotionEvent=!1,this._isReadyToHandleEvents=!1,this._waitingToHandleEvents=[],this._eventObjects={pretick:U.New(U.Event,\"pretick\",!1),tick:U.New(U.Event,\"tick\",!1),tick2:U.New(U.Event,\"tick2\",!1),instancecreate:U.New(U.Event,\"instancecreate\",!1),instancedestroy:U.New(U.Event,\"instancedestroy\",!1),beforelayoutchange:U.New(U.Event,\"beforelayoutchange\",!1),layoutchange:U.New(U.Event,\"layoutchange\",!1)},this._eventObjects.instancecreate.instance=null,this._eventObjects.instancedestroy.instance=null,this._userScriptDispatcher=U.New(U.Event.Dispatcher),this._userScriptEventObjects=null;const t=(e,t)=>U.BehaviorInstance.SortByTickSequence(this,e,t);this._behInstsToTick=U.New(U.RedBlackSet,t),this._behInstsToPostTick=U.New(U.RedBlackSet,t),this._behInstsToTick2=U.New(U.RedBlackSet,t),this._jobScheduler=U.New(U.JobSchedulerRuntime,this,e.jobScheduler),e.canvas&&(this._canvasManager=U.New(U.CanvasManager,this)),this._messagePort.onmessage=e=>this._OnMessageFromDOM(e.data),this.AddDOMComponentMessageHandler(\"runtime\",\"visibilitychange\",e=>this._OnVisibilityChange(e)),this.AddDOMComponentMessageHandler(\"runtime\",\"wrapper-extension-message\",e=>this._OnWrapperExtensionMessage(e)),this.AddDOMComponentMessageHandler(\"runtime\",\"opus-decode\",e=>this._WasmDecodeWebMOpus(e.arrayBuffer)),this.AddDOMComponentMessageHandler(\"runtime\",\"get-remote-preview-status-info\",()=>this._GetRemotePreviewStatusInfo()),this.AddDOMComponentMessageHandler(\"runtime\",\"js-invoke-function\",e=>this._InvokeFunctionFromJS(e)),this.AddDOMComponentMessageHandler(\"runtime\",\"go-to-last-error-script\",self.goToLastErrorScript),this.AddDOMComponentMessageHandler(\"runtime\",\"offline-audio-render-completed\",e=>this._OnOfflineAudioRenderCompleted(e)),this._dispatcher.addEventListener(\"window-blur\",e=>this._OnWindowBlur(e)),this._dispatcher.addEventListener(\"window-focus\",()=>this._OnWindowFocus()),this._timelineManager.AddRuntimeListeners(),this._templateManager.AddRuntimeListeners(),this._iRuntime=null,this._interfaceMap=new WeakMap,this._commonScriptInterfaces={keyboard:null,mouse:null,touch:null,timelineController:null},this._instancesNeedingAfterLoadMap=new WeakMap,this._instancesNeedingAfterLoadArray=[]}static Create(e){return U.New(U.Runtime,e)}Release(){U.clearArray(this._allObjectClasses),this._objectClassesByName.clear(),this._objectClassesBySid.clear(),this._layoutManager.Release(),this._layoutManager=null,this._eventSheetManager.Release(),this._eventSheetManager=null,this._addonManager.Release(),this._addonManager=null,this._assetManager.Release(),this._assetManager=null,this._collisionEngine.Release(),this._collisionEngine=null,this._timelineManager.Release(),this._timelineManager=null,this._transitionManager.Release(),this._transitionManager=null,this._templateManager.Release(),this._templateManager=null,this._flowchartManager.Release(),this._flowchartManager=null,this._textIconManager.Release(),this._textIconManager=null,this._canvasManager&&(this._canvasManager.Release(),this._canvasManager=null),this._dispatcher.Release(),this._dispatcher=null,this._tickEvent=null}[\"_OnMessageFromDOM\"](e){const t=e.type;if(\"event\"===t)this._OnEventFromDOM(e);else{if(\"result\"!==t)throw new Error(`unknown message '${t}'`);this._OnResultFromDOM(e)}}_OnEventFromDOM(e){if(this._isReadyToHandleEvents){const t=e.component,s=e.handler,i=e.data,r=e.dispatchOpts,n=!(!r||!r.dispatchRuntimeEvent),a=!(!r||!r.dispatchUserScriptEvent),o=e.responseId;if(\"runtime\"===t){if(n){const l=new U.Event(s);l.data=i,this._dispatcher.dispatchEventAndWaitAsyncSequential(l)}if(a){const c=new U.Event(s,!0);for(const[u,_]of Object.entries(i))c[u]=_;this.DispatchUserScriptEvent(c)}}const h=this._domEventHandlers.get(t);if(h){const d=h.get(s);if(d){let e=null;try{e=d(i)}catch(e){return console.error(`Exception in '${t}' handler '${s}':`,e),void(null!==o&&this._PostResultToDOM(o,!1,\"\"+e))}null!==o&&(e&&e.then?e.then(e=>this._PostResultToDOM(o,!0,e)).catch(e=>{console.error(`Rejection from '${t}' handler '${s}':`,e),this._PostResultToDOM(o,!1,\"\"+e)}):this._PostResultToDOM(o,!0,e))}else n||a||console.warn(`[Runtime] No DOM handler '${s}' for component '${t}'`)}else n||a||console.warn(`[Runtime] No DOM event handlers for component '${t}'`)}else this._waitingToHandleEvents.push(e)}_PostResultToDOM(e,t,s){this._messagePort.postMessage({type:\"result\",responseId:e,isOk:t,result:s})}_OnResultFromDOM(e){const t=e.responseId,s=e.isOk,i=e.result,r=this._pendingResponsePromises.get(t);s?r.resolve(i):r.reject(i),this._pendingResponsePromises.delete(t)}AddDOMComponentMessageHandler(e,t,s){let i=this._domEventHandlers.get(e);if(i||(i=new Map,this._domEventHandlers.set(e,i)),i.has(t))throw new Error(`[Runtime] Component '${e}' already has handler '${t}'`);i.set(t,s)}PostComponentMessageToDOM(e,t,s,i){this._messagePort.postMessage({type:\"event\",component:e,handler:t,data:s,responseId:null},i)}PostComponentMessageToDOMAsync(e,t,s,i){const r=this._nextDomResponseId++,n=new Promise((e,t)=>{this._pendingResponsePromises.set(r,{resolve:e,reject:t})});return this._messagePort.postMessage({type:\"event\",component:e,handler:t,data:s,responseId:r},i),n}SendWrapperExtensionMessage(e,t,s,i=-1){this.PostComponentMessageToDOM(\"runtime\",\"send-wrapper-extension-message\",{componentId:e,messageId:t,params:s,asyncId:i})}SendWrapperExtensionMessageAsync(e,t,s){const i=this._nextDomResponseId++,r=new Promise((e,t)=>{this._pendingResponsePromises.set(i,{resolve:e,reject:t})});return this.SendWrapperExtensionMessage(e,t,s,i),r}_OnWrapperExtensionMessage(e){if(-1!==e.asyncId){const t=e.asyncId,s=this._pendingResponsePromises.get(t);s.resolve(e.params),this._pendingResponsePromises.delete(t)}else this._OnEventFromDOM({component:\"wrapper-extension:\"+e.componentId,handler:e.messageId,data:e.params,responseId:null})}AddWrapperExtensionMessageHandler(e,t,s){this.AddDOMComponentMessageHandler(\"wrapper-extension:\"+e,t,s)}HasWrapperComponentId(e){return this._addonManager.HasWrapperComponentId(e)}PostToDebugger(e){if(!this.IsDebug())throw new Error(\"not in debug mode\");this.PostComponentMessageToDOM(\"runtime\",\"post-to-debugger\",e)}async Init(e){U.CommonACES_SetRuntime(this),this.IsDebug()?await j.Init(this):self.C3Debugger&&self.C3Debugger.InitPreview(this);const[t]=await Promise.all([this._assetManager.FetchJson(\"data.json\"),this._MaybeLoadOpusDecoder(),this._jobScheduler.Init()]);if(await this._LoadDataJson(t),await this._InitialiseCanvas(e),this.IsPreview()||console.info(\"%cMade with Construct, the game and animation creation tool. Visit: https://www.construct.net\",\"font-weight: bold\"),this.GetWebGLRenderer()){const s=this.GetWebGLRenderer();console.info(`[C3 runtime] Hosted in ${this.IsInWorker()?\"worker\":\"DOM\"}, rendering with WebGL ${s.GetWebGLVersionNumber()} [${s.GetUnmaskedRenderer()}]`)}else this.GetWebGPURenderer()&&console.info(`[C3 runtime] Hosted in ${this.IsInWorker()?\"worker\":\"DOM\"}, rendering with WebGPU [${this.GetWebGPURenderer().GetAdapterInfoString()}]`);this.GetRenderer().HasMajorPerformanceCaveat()&&console.warn(\"[C3 runtime] The renderer indicates a major performance caveat. Software rendering may be in use. This can result in significantly degraded performance.\"),this._isReadyToHandleEvents=!0;for(const i of this._waitingToHandleEvents)this._OnEventFromDOM(i);U.clearArray(this._waitingToHandleEvents),this._canvasManager&&this._canvasManager.StartLoadingScreen();for(const r of e.runOnStartupFunctions)this._additionalLoadPromises.push(this._RunOnStartupFunction(r));if(await Promise.all([this._assetManager.WaitForAllToLoad(),...this._additionalLoadPromises]),U.clearArray(this._additionalLoadPromises),!this._assetManager.HasHadErrorLoading())return this._canvasManager&&await this._canvasManager.EndLoadingScreen(),await this._dispatcher.dispatchEventAndWaitAsync(new U.Event(\"beforeruntimestart\")),await this.Start(),this._messagePort.postMessage({type:\"runtime-ready\"}),this;this._canvasManager&&this._canvasManager.HideCordovaSplashScreen()}async _RunOnStartupFunction(e){try{await e(this._iRuntime)}catch(e){console.error(\"[C3 runtime] Error in runOnStartup function: \",e)}}async _LoadDataJson(e){const t=e.project,s=(this._projectName=t[0],this._projectVersion=t[16],this._projectUniqueId=t[31],this._appId=t[38],t[39]||\"loading-logo.png\"),i=(this._isPixelRoundingEnabled=!!t[9],this._originalViewportWidth=this._viewportWidth=t[10],this._originalViewportHeight=this._viewportHeight=t[11],this._collisionEngine._InitCollisionCellSize(this._originalViewportWidth,this._originalViewportHeight),this._parallaxXorigin=this._originalViewportWidth/2,this._parallaxYorigin=this._originalViewportHeight/2,this._framerateMode=t[37],this._uses3dFeatures=!!t[40],this._sampling=t[14],this._usesAnyBackgroundBlending=t[15],this._usesAnyCrossSampling=t[42],this._usesAnyDepthSampling=t[17],this._usesLoaderLayout=!!t[18],this._loaderStyle=t[19],this._nextUid=t[21],this._pauseOnBlur=t[22],this._assetManager);if(i._SetFileStructure(t[45]),i._SetAudioFiles(t[7],t[25]),i._SetMediaSubfolder(t[8]),i._SetFontsSubfolder(t[32]),i._SetIconsSubfolder(t[28]),i._SetWebFonts(t[29]),0===this._loaderStyle){let e;(e=\"flat\"===i.GetFileStructure()?i.GetIconsSubfolder()+s:s)&&(this._loadingLogoAsset=i.LoadImage({url:e}))}this._canvasManager&&(this._canvasManager.SetFullscreenMode(U.CanvasManager._FullscreenModeNumberToString(t[12])),this._canvasManager.SetFullscreenScalingQuality(t[23]?\"high\":\"low\"),this._canvasManager.SetMipmapsEnabled(0!==t[24]),this._canvasManager._SetGPUPowerPreference(t[34]),this._canvasManager._SetTextureAnisotropy(t[41]),this._canvasManager._SetWebGPUEnabled(t[13]),this._canvasManager._SetZAxisScale(t[30]),this._canvasManager._SetZDistances(t[46],t[47]),this._canvasManager._SetInitFieldOfView(t[26]),this._canvasManager._SetLimitedToWebGL1(t[48]));const r=t[43],n=(r&&await this._LoadExportToVideoData(r),this._InitScriptInterfaces(),this._addonManager.CreateSystemPlugin(),this._objectReferenceTable=self.C3_GetObjectRefTable(),t[2]);for(const l of n[1])this._addonManager.CreateBehavior(l);for(const c of n[0])this._addonManager.CreatePlugin(c);this._objectReferenceTable=self.C3_GetObjectRefTable(),this._LoadJsPropNameTable(),this._addonManager._InitAddonScriptInterfaces();for(const u of t[3]){const _=U.ObjectClass.Create(this,this._allObjectClasses.length,u);this._allObjectClasses.push(_),this._objectClassesByName.set(_.GetName().toLowerCase(),_),this._objectClassesBySid.set(_.GetSID(),_)}for(const d of t[4]){const p=this._allObjectClasses[d[0]];p._LoadFamily(d)}for(const f of t[27]){const m=f.map(e=>this._allObjectClasses[e]);this._allContainers.push(U.New(U.Container,this,m))}this._InitObjectsScriptInterface();for(const g of this._allObjectClasses)g._OnAfterCreate();for(const S of t[5])this._layoutManager.Create(S);const a=t[1];if(a){const y=this._layoutManager.GetLayoutByName(a);y&&this._layoutManager.SetFirstLayout(y)}for(const G of t[35])this._transitionManager.Create(G);for(const I of t[33])this._timelineManager.Create(I);for(const T of t[44])this._templateManager.Create(T);this._templateManager.HasTemplates()||(this._templateManager.Release(),this._templateManager=null);for(const C of t[49])this._flowchartManager.Create(C);this._flowchartManager.HasFlowcharts()||(this._flowchartManager.Release(),this._flowchartManager=null);for(const b of t[6])this._eventSheetManager.Create(b);this._eventSheetManager._PostInit(),this._InitGlobalVariableScriptInterface(),U.clearArray(this._objectReferenceTable),this.FlushPendingInstances();let o=\"any\",h=t[20];1===h?o=\"portrait\":2===h&&(o=\"landscape\"),this.PostComponentMessageToDOM(\"runtime\",\"set-target-orientation\",{targetOrientation:o})}async _LoadExportToVideoData(e){const t=e.format;\"image-sequence\"===t?this._exportToVideo=new self.C3ExportToImageSequence(this,e):\"image-sequence-gif\"===t?this._exportToVideo=new self.C3ExportToGIF(this,e):\"webm\"===t?this._exportToVideo=new self.C3ExportToWebMVideo(this,e):\"mp4\"===t&&(this._exportToVideo=new self.C3ExportToMP4Video(this,e)),this._framerateMode=\"unlimited-frame\",this._canvasManager.SetFullscreenMode(\"off\"),this._devicePixelRatio=1,self.devicePixelRatio=1,await this.PostComponentMessageToDOMAsync(\"runtime\",\"set-exporting-to-video\",{message:this._exportToVideo.GetExportingMessageForPercent(0),duration:this._exportToVideo.GetDuration()})}GetLoaderStyle(){return this._loaderStyle}IsExportToVideo(){return null!==this._exportToVideo}GetExportVideoDuration(){return this._exportToVideo.GetDuration()}GetExportVideoFramerate(){return this._exportToVideo.GetFramerate()}_InitExportToVideo(){return this._exportToVideo.Init({width:this._canvasManager.GetDeviceWidth(),height:this._canvasManager.GetDeviceHeight()})}_ExportToVideoAddFrame(){const e=this._tickCount/this.GetExportVideoFramerate();return this._exportToVideo.AddFrame(this._canvasManager.GetMainCanvas(),e)}_ExportToVideoAddKeyframe(){this._exportToVideo&&this._exportToVideo.AddKeyframe()}_OnOfflineAudioRenderCompleted(e){this._exportToVideo.OnOfflineAudioRenderCompleted(e)}_ExportToVideoFinish(){return this._exportToVideo.Finish()}IsFBInstantAvailable(){return this._isFBInstantAvailable}IsLoading(){return this._isLoading}AddLoadPromise(e){this._additionalLoadPromises.push(e)}SetUsingCreatePromises(e){this._isUsingCreatePromises=!!e}AddCreatePromise(e){this._isUsingCreatePromises&&this._additionalCreatePromises.push(e)}GetCreatePromises(){return this._additionalCreatePromises}_GetNextFamilyIndex(){return this._familyCount++}GetFamilyCount(){return this._familyCount}_AddEffectList(e){this._allEffectLists.add(e)}_RemoveEffectList(e){this._allEffectLists.delete(e)}_GetAllEffectLists(){return this._allEffectLists}async _InitialiseCanvas(e){this._canvasManager&&(await this._canvasManager.CreateCanvas(e),this._canvasManager.InitLoadingScreen(this._loaderStyle))}async _MaybeLoadOpusDecoder(){const r=this._assetManager;if(!r.IsAudioFormatSupported(\"audio/webm; codecs=opus\")){let e=null,t=r.GetScriptSubfolder(),s=t+\"opus.wasm.js\",i=t+\"opus.wasm.wasm\";try{e=this.IsiOSCordova()&&r.IsFileProtocol()?await r.CordovaFetchLocalFileAsArrayBuffer(i):await r.FetchArrayBuffer(i)}catch(e){return void console.info(\"Failed to fetch Opus decoder WASM; assuming project has no Opus audio.\",e)}this.AddJobWorkerBuffer(e,\"opus-decoder-wasm\"),await this.AddJobWorkerScripts([s])}}async _WasmDecodeWebMOpus(e){const t=await this.AddJob(\"OpusDecode\",{arrayBuffer:e},[e]);return t}async Start(){this._hasStarted=!0,this._startTime=Date.now();let t=null,e=new Promise(e=>t=e);if(this._usesLoaderLayout){for(const r of this._allObjectClasses)r.IsFamily()||r.IsOnLoaderLayout()||!r.IsWorldType()||r.OnCreate();(async()=>{await this._assetManager.WaitForAllToLoad(),await e,this._isLoading=!1,this._OnLoadFinished()})()}else this._isLoading=!1;this._assetManager.SetInitialLoadFinished(),this.IsDebug()&&j.RuntimeInit(a);for(const n of this._layoutManager.GetAllLayouts())n._CreateGlobalNonWorlds();this.IsExportToVideo()&&await this._InitExportToVideo();const s=this._layoutManager.GetFirstLayout(),i=(await s._Load(null,this.GetRenderer()),await s._StartRunning(!0),this._fpsLastTime=performance.now(),t(),this._usesLoaderLayout||this._OnLoadFinished(),await this.PostComponentMessageToDOMAsync(\"runtime\",\"before-start-ticking\"));i.isSuspended&&!this.IsExportToVideo()?(this._suspendCount++,this._isPageVisibilitySuspended=!0):this.Tick()}_OnLoadFinished(){this.Trigger(U.Plugins.System.Cnds.OnLoadFinished,null,null),this.PostComponentMessageToDOM(\"runtime\",\"register-sw\")}GetObjectReference(e){e=Math.floor(e);const t=this._objectReferenceTable;if(e<0||e>=t.length)throw new Error(\"invalid object reference\");return t[e]}_LoadJsPropNameTable(){for(const e of self.C3_JsPropNameTable){const t=U.first(Object.keys(e));this._jsPropNameTable.push(t)}}GetJsPropName(e){e=Math.floor(e);const t=this._jsPropNameTable;if(e<0||e>=t.length)throw new Error(\"invalid prop reference\");return t[e]}HasDOM(){return this._hasDom}IsHeadless(){return this._isHeadless}IsInWorker(){return this._isInWorker}GetRuntimeBaseURL(){return this._runtimeBaseUrl}GetPreviewURL(){return this._previewUrl}GetEventSheetManager(){return this._eventSheetManager}GetEventStack(){return this._eventSheetManager.GetEventStack()}GetCurrentEventStackFrame(){return this._eventSheetManager.GetCurrentEventStackFrame()}GetCurrentEvent(){return this._eventSheetManager.GetCurrentEvent()}GetCurrentCondition(){return this._eventSheetManager.GetCurrentCondition()}IsCurrentConditionFirst(){return 0===this.GetCurrentEventStackFrame().GetConditionIndex()}GetCurrentAction(){return this._eventSheetManager.GetCurrentAction()}GetAddonManager(){return this._addonManager}GetSystemPlugin(){return this._addonManager.GetSystemPlugin()}GetObjectClassByIndex(e){if((e=Math.floor(e))<0||e>=this._allObjectClasses.length)throw new RangeError(\"invalid index\");return this._allObjectClasses[e]}GetObjectClassByName(e){return this._objectClassesByName.get(e.toLowerCase())||null}GetObjectClassBySID(e){return this._objectClassesBySid.get(e)||null}GetSingleGlobalObjectClassByCtor(e){const t=U.AddonManager.GetPluginByConstructorFunction(e);return t?t.GetSingleGlobalObjectClass():null}GetAllObjectClasses(){return this._allObjectClasses}*allInstances(){for(const e of this._allObjectClasses)e.IsFamily()||(yield*e.instances())}Dispatcher(){return this._dispatcher}UserScriptDispatcher(){return this._userScriptDispatcher}DispatchUserScriptEvent(e){e.runtime=this.GetIRuntime();const t=this.IsDebug()&&!this._eventSheetManager.IsInEventEngine();t&&j.StartMeasuringScriptTime(),this._userScriptDispatcher.dispatchEvent(e),t&&j.AddScriptTime()}DispatchUserScriptEventAsyncWait(e){return e.runtime=this.GetIRuntime(),this._userScriptDispatcher.dispatchEventAndWaitAsync(e)}GetOriginalViewportWidth(){return this._originalViewportWidth}GetOriginalViewportHeight(){return this._originalViewportHeight}SetOriginalViewportSize(e,t){if(this._originalViewportWidth!==e||this._originalViewportHeight!==t){this._originalViewportWidth=e,this._originalViewportHeight=t;const s=this.GetLayoutManager();s.SetAllLayerProjectionChanged(),s.SetAllLayerMVChanged()}}GetViewportWidth(){return this._viewportWidth}GetViewportHeight(){return this._viewportHeight}SetViewportSize(e,t){if(this._viewportWidth!==e||this._viewportHeight!==t){this._viewportWidth=e,this._viewportHeight=t;const s=this.GetLayoutManager();s.SetAllLayerProjectionChanged(),s.SetAllLayerMVChanged()}}_SetDevicePixelRatio(e){this.IsExportToVideo()||(this._devicePixelRatio=e)}GetDevicePixelRatio(){return this._devicePixelRatio}GetParallaxXOrigin(){return this._parallaxXorigin}GetParallaxYOrigin(){return this._parallaxYorigin}GetCanvasManager(){return this._canvasManager}GetDrawWidth(){return this._canvasManager?this._canvasManager.GetDrawWidth():this._viewportWidth}GetDrawHeight(){return this._canvasManager?this._canvasManager.GetDrawHeight():this._viewportHeight}GetRenderScale(){return this._canvasManager?this._canvasManager.GetRenderScale():1}GetDisplayScale(){return this._canvasManager?this._canvasManager.GetDisplayScale():1}GetEffectLayerScaleParam(){return this._canvasManager?this._canvasManager.GetEffectLayerScaleParam():1}GetEffectDevicePixelRatioParam(){return this._canvasManager?this._canvasManager.GetEffectDevicePixelRatioParam():1}GetCanvasClientX(){return this._canvasManager?this._canvasManager.GetCanvasClientX():0}GetCanvasClientY(){return this._canvasManager?this._canvasManager.GetCanvasClientY():0}GetCanvasCssWidth(){return this._canvasManager?this._canvasManager.GetCssWidth():0}GetCanvasCssHeight(){return this._canvasManager?this._canvasManager.GetCssHeight():0}GetFullscreenMode(){return this._canvasManager?this._canvasManager.GetFullscreenMode():\"off\"}GetAdditionalRenderTarget(e){return this._canvasManager?this._canvasManager.GetAdditionalRenderTarget(e):null}ReleaseAdditionalRenderTarget(e){this._canvasManager&&this._canvasManager.ReleaseAdditionalRenderTarget(e)}UsesAnyBackgroundBlending(){return this._usesAnyBackgroundBlending}UsesAnyCrossSampling(){return this._usesAnyCrossSampling}UsesAnyDepthSampling(){return this._usesAnyDepthSampling}GetGPUUtilisation(){return this._canvasManager?this._canvasManager.GetGPUUtilisation():NaN}IsLinearSampling(){return\"nearest\"!==this.GetSampling()}GetFramerateMode(){return this._framerateMode}_SetFramerateMode(e){this._framerateMode!==e&&(this._framerateMode=e,-1!==this._rafId||-1!==this._ruafId)&&(this._CancelAnimationFrame(),this._RequestAnimationFrame())}GetSampling(){return this._sampling}UsesLoaderLayout(){return this._usesLoaderLayout}GetLoadingLogoAsset(){return this._loadingLogoAsset}ReleaseLoadingLogoAsset(){this._loadingLogoAsset&&(this._loadingLogoAsset.ReleaseTexture(),this._loadingLogoAsset.Release(),this._loadingLogoAsset=null)}GetLayoutManager(){return this._layoutManager}GetMainRunningLayout(){return this._layoutManager.GetMainRunningLayout()}GetTimelineManager(){return this._timelineManager}GetTransitionManager(){return this._transitionManager}GetTemplateManager(){return this._templateManager}GetFlowchartManager(){return this._flowchartManager}GetAssetManager(){return this._assetManager}LoadImage(e){return this._assetManager.LoadImage(e)}CreateInstance(e,t,s,i,r,n){if(n&&this._templateManager){if(e instanceof U.ObjectClass&&e.IsFamily()){const o=e.GetFamilyMembers(),h=Math.floor(this.Random()*o.length);return this.CreateInstance(o[h],t,s,i,r,n)}const a=this._templateManager.GetTemplateData(e,n);if(a){const l=this.CreateInstanceFromData(a,t,!1,s,i,!1,r,void 0,r);return this._templateManager.MapInstanceToTemplateName(l,n),l}}return this.CreateInstanceFromData(e,t,!1,s,i,!1,r,void 0,r)}CreateInstanceFromData(e,t,s,i,r,n,a,o,h){let l=null,c=null;if(e instanceof U.ObjectClass){if((c=e).IsFamily()){const G=c.GetFamilyMembers(),I=Math.floor(this.Random()*G.length);c=G[I]}l=c.GetDefaultInstanceData()}else l=e,c=this.GetObjectClassByIndex(l[1]);const u=c.GetPlugin().IsWorldType();if(this._isLoading&&u&&!c.IsOnLoaderLayout())return null;const _=t;u||(t=null);let d;d=s&&!n&&l&&!this._instancesByUid.has(l[2])?l[2]:this._nextUid++;const p=l?l[0]:null,f=U.New(U.Instance,{runtime:this,objectType:c,layer:t,worldData:p,instVarData:l?l[3]:null,uid:d,tags:l?l[6]:null});this._instancesByUid.set(d,f);let m=null,g=(u&&(m=f.GetWorldInfo(),void 0!==i&&void 0!==r&&(m.SetX(i),m.SetY(r)),c._SetAnyCollisionCellChanged(!0)),t&&(h||t._AddInstance(f,!0),t.GetLayout().MaybeLoadTexturesFor(c)),this._objectCount++,!0);if(o){const T=o.GetObjectClass();if(T.IsInContainer()&&c.IsInContainer()){const C=c.GetContainer(),b=T.GetContainer();C===b&&(g=!1)}}if(c.IsInContainer()&&!s&&!n&&g){const w=new Set;for(const x of c.GetContainer().objectTypes())if(x!==c){const v=this._MaybeGetChildInstanceForObjectTypeData(x,m,w);if(v){const P=this.CreateInstanceFromData(v,_,!1,m?m.GetX():i,m?m.GetY():r,!0,!1,void 0,h);f._AddSibling(P)}else{const k=this.CreateInstanceFromData(x,_,!1,m?m.GetX():i,m?m.GetY():r,!0,!1,void 0,h);f._AddSibling(k)}}for(const R of f.siblings()){R._AddSibling(f);for(const A of f.siblings())R!==A&&R._AddSibling(A)}}if(u&&!s&&a&&this._CreateChildInstancesFromData(f,p,m,t,i,r,h),c.IsInContainer()&&!s&&!n&&a)for(const M of f.siblings()){const D=M.GetWorldInfo();if(D){const N=M.GetPlugin(),E=M.GetObjectClass().GetDefaultInstanceData()[0];N.IsWorldType()?this._CreateChildInstancesFromData(M,E,D,t,D.GetX(),D.GetY(),h):this._CreateChildInstancesFromData(M,E,D,t,void 0,void 0,h)}}if(!n&&a){void 0===i&&(i=p[0]),void 0===r&&(r=p[1]);const F=m.GetTopParent(),W=i-m.GetX()+F.GetX(),V=r-m.GetY()+F.GetY();F.SetXY(W,V)}c._SetIIDsStale();const O=l?U.cloneArray(l[5]):null,L=l?l[4].map(e=>U.cloneArray(e)):null,S=u&&p&&p[13];if(S&&f._SetHasTilemap(),f._CreateSdkInstance(O,L),S){const B=p[13];f.GetSdkInstance().LoadTilemapData(B[2],B[0],B[1])}this._instancesPendingCreate.push(f),this._hasPendingInstances=!0,this.IsDebug()&&j.InstanceCreated(f);const y=this._eventObjects.instancecreate;return y.instance=f,this._dispatcher.dispatchEvent(y),f}_GetInstanceData(e){const t=e[0],s=e[1],i=e[2],r=e[6];if(r)return r;const n=this._layoutManager.GetLayoutBySID(t),a=n.GetLayer(s);return a.GetInitialInstanceData(i)}_MaybeGetChildInstanceForObjectTypeData(e,t,s){const i=t?.GetSceneGraphChildrenExportData()??[];for(const r of i){const n=this._GetInstanceData(r),a=!!r[4],o=this.GetObjectClassByIndex(n[1]);if(!s.has(n)&&e===o&&a)return s.add(n),n}}_CreateChildInstancesFromData(h,e,t,l,c,u,_){const s=t.GetSceneGraphZIndexExportData(),i=t.GetSceneGraphChildrenExportData();if(h.GetWorldInfo().SetSceneGraphZIndex(s),i){void 0===c&&(c=e[0]),void 0===u&&(u=e[1]);const d=new Set,p=e[0],f=e[1];for(const m of i){let e=m[0],t=m[1],s=m[2],i=m[3],r=!!m[4],n=m[5],a=m[6],o;if(a)o=a;else{const G=this._layoutManager.GetLayoutBySID(e),I=G.GetLayer(t);o=I.GetInitialInstanceData(s)}const g=this.GetObjectClassByIndex(o[1]),S=h.HasSibling(g),y=d.has(g);if(S&&!y&&r){const T=h.GetSibling(g),C=(T.GetWorldInfo().Init(o[0]),c+o[0][0]-p),b=u+o[0][1]-f;T.GetWorldInfo().SetXY(C,b),T.GetWorldInfo().SetSceneGraphZIndex(n),h.AddChild(T,{transformX:!!(i>>0&1),transformY:!!(i>>1&1),transformWidth:!!(i>>2&1),transformHeight:!!(i>>3&1),transformAngle:!!(i>>4&1),destroyWithParent:!!(i>>5&1),transformZElevation:!!(i>>6&1),transformOpacity:!!(i>>7&1),transformVisibility:!!(i>>8&1)}),d.add(g)}else{const w=c+o[0][0]-p,x=u+o[0][1]-f,v=this.CreateInstanceFromData(o,l,!1,w,x,!1,!0,h,_);v.GetWorldInfo().SetSceneGraphZIndex(n),h.AddChild(v,{transformX:!!(i>>0&1),transformY:!!(i>>1&1),transformWidth:!!(i>>2&1),transformHeight:!!(i>>3&1),transformAngle:!!(i>>4&1),destroyWithParent:!!(i>>5&1),transformZElevation:!!(i>>6&1),transformOpacity:!!(i>>7&1),transformVisibility:!!(i>>8&1)})}}}}DestroyInstance(s){if(!this._instancesPendingRelease.has(s)){let e=s.GetObjectClass(),t=this._instancesPendingDestroy.get(e);if(t){if(t.has(s))return;t.add(s)}else(t=new Set).add(s),this._instancesPendingDestroy.set(e,t);if(this.IsDebug()&&j.InstanceDestroyed(s),s._MarkDestroyed(),this._hasPendingInstances=!0,s.IsInContainer())for(const i of s.siblings())this.DestroyInstance(i);for(const r of s.children())r.GetDestroyWithParent()&&this.DestroyInstance(r);if(!this._layoutManager.IsEndingLayout()&&!this._isLoadingState){const n=this.GetEventSheetManager();n.BlockFlushingInstances(!0),s._TriggerOnDestroyed(),n.BlockFlushingInstances(!1)}s._FireDestroyedScriptEvents(this._layoutManager.IsEndingLayout())}}FlushPendingInstances(){this._hasPendingInstances&&(this._isFlushingPendingInstances=!0,this._FlushInstancesPendingCreate(),this._FlushInstancesPendingDestroy(),this._isFlushingPendingInstances=!1,this._hasPendingInstances=!1,this.UpdateRender())}_FlushInstancesPendingCreate(){for(const e of this._instancesPendingCreate){const t=e.GetObjectClass();t._AddInstance(e);for(const s of t.GetFamilies())s._AddInstance(e),s._SetIIDsStale()}U.clearArray(this._instancesPendingCreate)}_FlushInstancesPendingDestroy(){this._dispatcher.SetDelayRemoveEventsEnabled(!0);for(const[e,t]of this._instancesPendingDestroy.entries())this._FlushInstancesPendingDestroyForObjectClass(e,t),t.clear();this._instancesPendingDestroy.clear(),this._dispatcher.SetDelayRemoveEventsEnabled(!1)}_FlushInstancesPendingDestroyForObjectClass(e,t){for(const s of t){const i=this._eventObjects.instancedestroy,r=(i.instance=s,this._dispatcher.dispatchEvent(i),this._instancesByUid.delete(s.GetUID()),this._instanceTimes.delete(s),s.GetWorldInfo());r&&(r._RemoveFromCollisionCells(),r._RemoveFromRenderCells(),r._MarkDestroyed()),this._instancesPendingRelease.add(s),this._objectCount--}U.arrayRemoveAllInSet(e.GetInstances(),t),e._SetIIDsStale(),this._instancesPendingReleaseAffectedObjectClasses.add(e);for(const n of e.GetFamilies())U.arrayRemoveAllInSet(n.GetInstances(),t),n._SetIIDsStale(),this._instancesPendingReleaseAffectedObjectClasses.add(n);if(e.GetPlugin().IsWorldType()){const a=new Set([...t].map(e=>e.GetWorldInfo().GetLayer()));for(const o of a)o._RemoveAllInstancesInSet(t)}}_GetInstancesPendingCreate(){return this._instancesPendingCreate}*instancesPendingCreateForObjectClass(e){for(const t of this._GetInstancesPendingCreate())e.IsFamily()?t.GetObjectClass().BelongsToFamily(e)&&(yield t):t.GetObjectClass()===e&&(yield t)}_GetNewUID(){return this._nextUid++}_MapInstanceByUID(e,t){this._instancesByUid.set(e,t)}_SetAutoSuspendEnabled(e){this._isAutoSuspendEnabled!==(e=!!e)&&(this._isAutoSuspendEnabled=!!e,this._isAutoSuspendEnabled)&&this._isPageVisibilitySuspended&&(this.SetSuspended(!1),this._isPageVisibilitySuspended=!1)}_IsAutoSuspendEnabled(){return this._isAutoSuspendEnabled}_OnRendererContextLost(){this._dispatcher.dispatchEvent(U.New(U.Event,\"renderercontextlost\")),this.SetSuspended(!0);for(const t of this._allObjectClasses)!t.IsFamily()&&t.HasLoadedTextures()&&t.ReleaseTextures();const e=this.GetMainRunningLayout();e&&e._OnRendererContextLost(),U.ImageInfo.OnRendererContextLost(),U.ImageAsset.OnRendererContextLost()}async _OnRendererContextRestored(){await this.GetMainRunningLayout()._Load(null,this.GetRenderer()),this._dispatcher.dispatchEvent(U.New(U.Event,\"renderercontextrestored\")),this.SetSuspended(!1),this.UpdateRender()}_OnVisibilityChange(e){if(this._isAutoSuspendEnabled){const t=e.hidden;this.SetSuspended(t),(this._isPageVisibilitySuspended=t)||this.UpdateRender()}}_OnWindowBlur(e){this.IsPreview()&&this._pauseOnBlur&&!U.Platform.IsMobile&&!e.data.parentHasFocus&&(this.SetSuspended(!0),this._isPausedOnBlur=!0)}_OnWindowFocus(){this._isPausedOnBlur&&(this.SetSuspended(!1),this._isPausedOnBlur=!1)}_RequestAnimationFrame(){const e=this._tickCallbacks;\"vsync\"===this._framerateMode?-1===this._rafId&&(this._rafId=self.requestAnimationFrame(e.normal)):\"unlimited-tick\"===this._framerateMode?(-1===this._ruafId&&(this._ruafId=U.RequestUnlimitedAnimationFrame(e.tickOnly)),-1===this._rafId&&(this._rafId=self.requestAnimationFrame(e.renderOnly))):-1===this._ruafId&&(this._ruafId=U.RequestUnlimitedAnimationFrame(e.normal))}_CancelAnimationFrame(){-1!==this._rafId&&(self.cancelAnimationFrame(this._rafId),this._rafId=-1),-1!==this._ruafId&&(U.CancelUnlimitedAnimationFrame(this._ruafId),this._ruafId=-1)}IsSuspended(){return 0<this._suspendCount}SetSuspended(e){if(!this.IsExportToVideo()){const t=this.IsSuspended(),s=(this._suspendCount+=e?1:-1,this._suspendCount<0&&(this._suspendCount=0),this.IsSuspended());if(!t&&s)console.log(\"[Construct] Suspending\"),this._CancelAnimationFrame(),this._dispatcher.dispatchEvent(U.New(U.Event,\"suspend\")),this.Trigger(U.Plugins.System.Cnds.OnSuspend,null,null);else if(t&&!s){console.log(\"[Construct] Resuming\");const i=performance.now();this._lastTickTime=i,this._fpsLastTime=i,this._fpsFrameCount=0,this._fps=0,this._tpsTickCount=0,this._tps=0,this._mainThreadTime=0,this._mainThreadTimeCounter=0,this._dispatcher.dispatchEvent(U.New(U.Event,\"resume\")),this.Trigger(U.Plugins.System.Cnds.OnResume,null,null),this.HitBreakpoint()||this.Tick(i)}}}_AddBehInstToTick(e){this._behInstsToTick.Add(e)}_AddBehInstToPostTick(e){this._behInstsToPostTick.Add(e)}_AddBehInstToTick2(e){this._behInstsToTick2.Add(e)}_RemoveBehInstToTick(e){this._behInstsToTick.Remove(e)}_RemoveBehInstToPostTick(e){this._behInstsToPostTick.Remove(e)}_RemoveBehInstToTick2(e){this._behInstsToTick2.Remove(e)}_BehaviorTick(){const e=globalThis.ISDKBehaviorInstanceBase;this._behInstsToTick.SetQueueingEnabled(!0);for(const t of this._behInstsToTick)t instanceof e?t._tick():t.Tick();this._behInstsToTick.SetQueueingEnabled(!1)}_BehaviorPostTick(){const e=globalThis.ISDKBehaviorInstanceBase;this._behInstsToPostTick.SetQueueingEnabled(!0);for(const t of this._behInstsToPostTick)t instanceof e?t._postTick():t.PostTick();this._behInstsToPostTick.SetQueueingEnabled(!1)}_BehaviorTick2(){const e=globalThis.ISDKBehaviorInstanceBase;this._behInstsToTick2.SetQueueingEnabled(!0);for(const t of this._behInstsToTick2)t instanceof e?t._tick2():t.Tick2();this._behInstsToTick2.SetQueueingEnabled(!1)}*_DebugBehaviorTick(){const t=globalThis.ISDKBehaviorInstanceBase;this._behInstsToTick.SetQueueingEnabled(!0);for(const s of this._behInstsToTick){let e;e=s instanceof t?s._tick():s.Tick(),U.IsIterator(e)&&(yield*e)}this._behInstsToTick.SetQueueingEnabled(!1)}*_DebugBehaviorPostTick(){const t=globalThis.ISDKBehaviorInstanceBase;this._behInstsToPostTick.SetQueueingEnabled(!0);for(const s of this._behInstsToPostTick){let e;e=s instanceof t?s._postTick():s.PostTick(),U.IsIterator(e)&&(yield*e)}this._behInstsToPostTick.SetQueueingEnabled(!1)}*_DebugBehaviorTick2(){const t=globalThis.ISDKBehaviorInstanceBase;this._behInstsToTick2.SetQueueingEnabled(!0);for(const s of this._behInstsToTick2){let e;e=s instanceof t?s._tick2():s.Tick2(),U.IsIterator(e)&&(yield*e)}this._behInstsToTick2.SetQueueingEnabled(!1)}async Tick(h,e,t){this._hasStartedTicking=!0;const l=\"background-wake\"===t,c=\"background-wake\"!==t&&\"skip-render\"!==t,u=this.GetLayoutManager(),_=this.GetCanvasManager();if(this._hasStarted&&(!this.IsSuspended()||e||l)){let e=performance.now(),t=(this._isInTick=!0,this._MeasureDt(h||0),this._tpsTickCount++,this._ReleasePendingInstances(),this.Step_BeforePreTick()),s=(this.IsDebugging()&&await t,this._dispatcher.dispatchEventAndWait_AsyncOptional(this._eventObjects.pretick)),i=(s instanceof Promise&&await s,this.Step_AfterPreTick()),r=(this.IsDebugging()&&await i,this._NeedsHandleSaveOrLoad()&&await this._HandleSaveOrLoad(),u.IsPendingChangeMainLayout()&&await this._MaybeChangeLayout(),this.Step_RunEventsEtc()),n=(this.IsDebugging()&&await r,u.GetMainRunningLayout()),a=n._GetPendingSetHTMLLayerCount(),o=!1;if(-1!==a&&(n._ResetPendingHTMLLayerCount(),_.GetHTMLLayerCount()!==a)){const d=this.GetCanvasManager().SetHTMLLayerCount(a);this.IsInWorker()&&(o=!0,await d)}this.PostComponentMessageToDOM(\"canvas\",\"update-html-layer-dom-state\",{layersDomState:n._GetRootLayers().filter(e=>e.IsHTMLElementsLayer()).map(e=>e._GetHTMLLayerDOMState())}),c&&this.Render(),o&&this.PostComponentMessageToDOM(\"canvas\",\"cleanup-html-layers\"),this.IsExportToVideo()&&(await this._ExportToVideoAddFrame(),this.GetGameTime()>=this.GetExportVideoDuration())?this._ExportToVideoFinish():(this.IsSuspended()||l||this._RequestAnimationFrame(),this._tickCount++,this._tickCountNoSave++,this._isInTick=!1,this._mainThreadTimeCounter+=performance.now()-e)}}async Step_BeforePreTick(){const e=this._eventSheetManager,t=this.IsDebug();this.FlushPendingInstances(),e.BlockFlushingInstances(!0),this.PushCurrentLayout(this.GetMainRunningLayout()),t&&j.StartMeasuringTime(),this.IsDebugging()?await e.DebugRunScheduledWaits():e.RunScheduledWaits(),t&&j.AddEventsTime(),this.PopCurrentLayout(),e.BlockFlushingInstances(!1),this.FlushPendingInstances(),e.BlockFlushingInstances(!0)}async Step_AfterPreTick(){const e=this.IsDebug(),t=this.IsDebugging(),s=this._dispatcher,i=this._eventObjects,r=this._userScriptEventObjects;e&&j.StartMeasuringTime(),t?await this.DebugIterateAndBreak(this._DebugBehaviorTick()):this._BehaviorTick(),t?await this.DebugIterateAndBreak(this._DebugBehaviorPostTick()):this._BehaviorPostTick(),e&&j.AddBehaviorTickTime(),e&&j.StartMeasuringTime(),t?await this.DebugFireGeneratorEventAndBreak(i.tick):s.dispatchEvent(i.tick),e&&j.AddPluginTickTime(),this._eventSheetManager.BlockFlushingInstances(!1),this.DispatchUserScriptEvent(r.tick)}async Step_RunEventsEtc(){const e=this._eventSheetManager,t=this._dispatcher,s=this._eventObjects,i=this.IsDebug(),r=this.IsDebugging();i&&j.StartMeasuringTime(),r?await e.DebugRunEvents(this._layoutManager):e.RunEvents(this._layoutManager),i&&j.AddEventsTime(),this._collisionEngine.ClearRegisteredCollisions(),this._ReleasePendingInstances(),this._isLayoutFirstTick=!1,e.BlockFlushingInstances(!0),i&&j.StartMeasuringTime(),r?await this.DebugIterateAndBreak(this._DebugBehaviorTick2()):this._BehaviorTick2(),i&&j.AddBehaviorTickTime(),i&&j.StartMeasuringTime(),r?await this.DebugFireGeneratorEventAndBreak(s.tick2):t.dispatchEvent(s.tick2),i&&j.AddPluginTickTime(),e.BlockFlushingInstances(!1),r&&await e.RunQueuedDebugTriggersAsync()}_ReleasePendingInstances(){if(0!==this._instancesPendingRelease.size){const e=this._dispatcher;e.SetDelayRemoveEventsEnabled(!0);for(const t of this._instancesPendingReleaseAffectedObjectClasses)t.GetSolStack().RemoveInstances(this._instancesPendingRelease);this._instancesPendingReleaseAffectedObjectClasses.clear(),this._eventSheetManager._OnInstancesReleased(this._instancesPendingRelease);for(const s of this._instancesPendingRelease)s.Release();this._instancesPendingRelease.clear(),e.SetDelayRemoveEventsEnabled(!1)}}async _MaybeChangeLayout(){let e=this.GetLayoutManager(),t=0;for(;e.IsPendingChangeMainLayout()&&t++<10;)await this._DoChangeLayout(e.GetPendingChangeMainLayout())}_MeasureDt(e){let t=0;if(this.IsExportToVideo())t=1/this.GetExportVideoFramerate(),this._dtRaw=t,this._dt1=t;else if(0!==this._lastTickTime){const s=Math.max(e-this._lastTickTime,0);.5<(t=s/1e3)&&(t=0),this._dtRaw=t,this._dt1=U.clamp(t,this._minDt,this._maxDt)}this._lastTickTime=e,this._dt=this._dt1*this._timeScale,this._gameTime.Add(this._dt),this._gameTimeRaw.Add(t*this._timeScale),this._wallTime.Add(this._dt1);for(const[i,r]of this._instanceTimes)r.Add(this._dt1*i.GetTimeScale());this._canvasManager&&this._canvasManager._UpdateTick(),1e3<=e-this._fpsLastTime&&(this._fpsLastTime+=1e3,1e3<=e-this._fpsLastTime&&(this._fpsLastTime=e),this._fps=this._fpsFrameCount,this._fpsFrameCount=0,this._tps=this._tpsTickCount,this._tpsTickCount=0,this._mainThreadTime=Math.min(this._mainThreadTimeCounter/1e3,1),this._mainThreadTimeCounter=0,this._canvasManager&&this._canvasManager._Update1sFrameRange(),this._collisionEngine._Update1sStats(),this.IsDebug())&&j.Update1sPerfStats()}_SetTrackingInstanceTime(e,t){if(t){if(!this._instanceTimes.has(e)){const s=U.New(U.KahanSum);s.Copy(this._gameTime),this._instanceTimes.set(e,s)}}else this._instanceTimes.delete(e)}_GetInstanceGameTime(e){const t=this._instanceTimes.get(e);return t?t.Get():this.GetGameTime()}async _DoChangeLayout(e){const t=this._dispatcher,s=this.GetLayoutManager(),i=s.GetMainRunningLayout();await i._StopRunning(),i._Unload(e,this.GetRenderer()),i===e&&this._eventSheetManager.ClearAllScheduledWaits(),this._collisionEngine.ClearRegisteredCollisions(),this._ReleasePendingInstances(),t.dispatchEvent(this._eventObjects.beforelayoutchange),U.Asyncify.SetHighThroughputMode(!0),await e._Load(i,this.GetRenderer()),U.Asyncify.SetHighThroughputMode(!1),await e._StartRunning(!1),t.dispatchEvent(this._eventObjects.layoutchange),this.UpdateRender(),this._isLayoutFirstTick=!0,this.FlushPendingInstances(),this._ExportToVideoAddKeyframe()}UpdateRender(){this._needRender=!0}GetWebGLRenderer(){return this._canvasManager?this._canvasManager.GetWebGLRenderer():null}GetWebGPURenderer(){return this._canvasManager?this._canvasManager.GetWebGPURenderer():null}GetRenderer(){return this._canvasManager?this._canvasManager.GetRenderer():null}Render(){const s=this._canvasManager;if(s&&!s.IsRendererContextLost()){const i=this.GetRenderer(),e=i.SupportsGPUProfiling(),r=e&&i.IsWebGL(),n=e&&i.IsWebGPU();if(r&&i.CheckForQueryResults(),this._needRender||this.IsExportToVideo()){const a=this._layoutManager.GetMainRunningLayout(),o=(this._fpsFrameCount++,i.Start(),this.IsDebug());o&&j.StartMeasuringTime(),this._needRender=!1;let e=null,t=(r&&(e=s.GetGPUFrameTimingsBuffer().AddTimeElapsedQuery(),i.StartQuery(e)),null);n&&(t=i.StartFrameTiming(2*(1+a.GetLayerCount())),i.StartMeasuringRenderPassTime(0,1)),this.Uses3DFeatures()&&\"low\"===s.GetCurrentFullscreenScalingQuality()?i.SetFixedSizeDepthBuffer(s.GetDrawWidth(),s.GetDrawHeight()):i.SetAutoSizeDepthBuffer(),this._Render(this.GetRenderer(),a),e&&i.EndQuery(e),n&&(i.StopMeasuringRenderPassTime(),this._canvasManager._AddWebGPUFrameTiming(t)),i.Finish(),o&&(j.AddDrawCallsTime(),j.UpdateInspectHighlight()),s&&s._MaybeTakeSnapshot()}else i.IncrementFrameNumber()}}_NeedsHTMLLayerCompositing(e){return\"low\"===this.GetCanvasManager().GetCurrentFullscreenScalingQuality()||e.IsWebGL()&&(this.UsesAnyBackgroundBlending()||this.Uses3DFeatures())}_Render(t,s){t.SetTextureFillMode(),t.SetAlphaBlend(),t.SetColorRgba(1,1,1,1),t.SetRenderTarget(null),t.SetTexture(null),t.SetDepthEnabled(this.Uses3DFeatures()),this._NeedsHTMLLayerCompositing(t)&&s._MaybeStartDrawToOwnTexture(t);const i=s.GetHTMLLayerCount();for(let e=1;e<i;++e)s.DrawForHTMLLayerIndex(t,e),t.IsWebGPU()&&t.Restart();this._NeedsHTMLLayerCompositing(t)||s._MaybeStartDrawToOwnTexture(t),s.DrawMain(t)}Trigger(e,t,s){if(!this._hasStarted)return!1;let i=!this._isInTick&&!this._eventSheetManager.IsInTrigger(),r=0;i&&(r=performance.now());const n=this.IsDebug(),a=(n&&this.SetDebuggingEnabled(!1),this._eventSheetManager._Trigger(this._layoutManager,e,t,s));if(i){const o=performance.now()-r;this._mainThreadTimeCounter+=o,n&&j.AddTriggersTime(o)}return n&&this.SetDebuggingEnabled(!0),a}DebugTrigger(e,t,s){if(!this.IsDebugging())return this.Trigger(e,t,s);if(this.HitBreakpoint())throw new Error(\"called DebugTrigger() while stopped on breakpoint\");if(this._isInTick||this._eventSheetManager.IsInTrigger())return this._eventSheetManager._DebugTrigger(this._layoutManager,e,t,s);throw new Error(\"called DebugTrigger() outside of event code - use TriggerAsync() instead\")}async TriggerAsync(e,t,s){if(!this.IsDebugging())return this.Trigger(e,t,s);if(!this._hasStarted)return!1;if(this.HitBreakpoint())return this._eventSheetManager.QueueDebugTrigger(e,t,s);if(!this.GetMainRunningLayout())return this._eventSheetManager.QueueTrigger(e,t,s);let i=performance.now(),r=this._eventSheetManager._DebugTrigger(this._layoutManager,e,t,s),n=r.next();for(;!n.done;)await this.DebugBreak(n.value),n=r.next();return this.IsSuspended()||this._eventSheetManager.IsInTrigger()||(await this._eventSheetManager.RunQueuedDebugTriggersAsync(),this._hasStartedTicking&&!this._isInTick&&this._RequestAnimationFrame()),this._mainThreadTimeCounter+=performance.now()-i,n.value}FastTrigger(e,t,s){const i=this.IsDebug(),r=(i&&this.SetDebuggingEnabled(!1),this._eventSheetManager._FastTrigger(this._layoutManager,e,t,s));return i&&this.SetDebuggingEnabled(!0),r}DebugFastTrigger(e,t,s){return this._eventSheetManager._DebugFastTrigger(this._layoutManager,e,t,s)}ScheduleTriggers(e){return this._scheduleTriggersThrottle.Add(e)}PushCurrentLayout(e){this._currentLayoutStack.push(e)}PopCurrentLayout(){if(!this._currentLayoutStack.length)throw new Error(\"layout stack empty\");this._currentLayoutStack.pop()}GetCurrentLayout(){return this._currentLayoutStack.length?this._currentLayoutStack.at(-1):this.GetMainRunningLayout()}GetDt(e){return e&&-1!==e.GetTimeScale()?this._dt1*e.GetTimeScale():this._dt}_GetDtFast(){return this._dt}GetDt1(){return this._dt1}GetDtRaw(){return this._dtRaw}GetTimeScale(){return this._timeScale}SetTimeScale(e){(isNaN(e)||e<0)&&(e=0),this._timeScale=e}SetMinDt(e){this._minDt=Math.max(e,0)}GetMinDt(){return this._minDt}SetMaxDt(e){this._maxDt=Math.max(e,0)}GetMaxDt(){return this._maxDt}GetFramesPerSecond(){return this._fps}GetTicksPerSecond(){return this._tps}GetMainThreadTime(){return this._mainThreadTime}GetStartTime(){return this._startTime}GetGameTime(){return this._gameTime.Get()}GetGameTimeRaw(){return this._gameTimeRaw.Get()}GetWallTime(){return this._wallTime.Get()}GetTickCount(){return this._tickCount}GetTickCountNoSave(){return this._tickCountNoSave}GetObjectCount(){return this._objectCount}GetProjectName(){return this._projectName}GetProjectVersion(){return this._projectVersion}GetProjectUniqueId(){return this._projectUniqueId}GetAppId(){return this._appId}GetInstanceByUID(e){if(this._isLoadingState)throw new Error(\"cannot call while loading state - wait until afterload event\");return this._instancesByUid.get(e)||null}_RefreshUidMap(){this._instancesByUid.clear();for(const e of this._allObjectClasses)if(!e.IsFamily())for(const t of e.GetInstances())this._instancesByUid.set(t.GetUID(),t)}IsPreview(){return\"preview\"===this._exportType}IsDebug(){return this._isDebug}GetExportType(){return this._exportType}IsNWjs(){return\"nwjs\"===this.GetExportType()||this._isNWjs}IsCordova(){return\"cordova\"===this._exportType}IsAndroidWebView(){return\"Android\"===U.Platform.OS&&(\"cordova\"===this._exportType||\"playable-ad-single-file\"===this._exportType||\"playable-ad-zip\"===this._exportType||\"instant-games\"===this._exportType)}IsiOSCordova(){return this._isiOSCordova}IsiOSWebView(){return this._isiOSWebView}IsWindowsWebView2(){return this._isWindowsWebView2}IsAnyWebView2Wrapper(){return this._isAnyWebView2Wrapper}GetCollisionEngine(){return this._collisionEngine}GetSolidBehavior(){return this._addonManager.GetSolidBehavior()}GetJumpthruBehavior(){return this._addonManager.GetJumpthruBehavior()}Uses3DFeatures(){return this._uses3dFeatures}GetZScaleFactor(){return this.GetRenderer().GetZAxisScaleFactor(this.GetViewportHeight())}GetDefaultCameraZ(e){return this.GetRenderer().GetDefaultCameraZ(e||this.GetViewportHeight())}IsLayoutFirstTick(){return this._isLayoutFirstTick}SetPixelRoundingEnabled(e){this._isPixelRoundingEnabled!==(e=!!e)&&(this._isPixelRoundingEnabled=e,this.GetLayoutManager().SetAllLayerMVChanged(),this.UpdateRender())}IsPixelRoundingEnabled(){return this._isPixelRoundingEnabled}GetTextIconSet(e){if(!this._iconChangeHandlers.has(e)){const s=()=>this.DeleteTextIconSet(e);this._iconChangeHandlers.set(e,s),e.Dispatcher().addEventListener(\"animationframeimagechange\",s)}const t=this._textIconManager.GetIconSet(e);return t.HasLoaded()||t.LoadContent().then(()=>this.UpdateRender()),t}DeleteTextIconSet(e){this._textIconManager.DeleteIconSet(e)}_GetTextIconSetMeta(e){const t=[];for(const s of e.GetAnimations())for(const i of s.GetFrames()){const r=i.GetImageInfo();t.push({source:i,width:r.GetWidth(),height:r.GetHeight(),tag:i.GetTag()})}return{icons:t}}async _GetTextIconSetContent(e){const t=U.New(U.PromiseThrottle),s=[],r=new Map;for(const a of e.GetAnimations())for(const o of a.GetFrames()){const h=o.GetImageInfo().GetImageAsset();r.has(h)||(r.set(h,null),s.push(t.Add(async()=>{const e=await h.LoadToDrawable();r.set(h,e)})))}await Promise.all(s);const i=[];for(const l of e.GetAnimations())for(const c of l.GetFrames())i.push(t.Add(async()=>{const e=c.GetImageInfo(),t=r.get(e.GetImageAsset()),s=await e.ExtractImageToCanvas(t),i=await createImageBitmap(s);return{drawable:i}}));const n=await Promise.all(i);for(const u of r.values())u instanceof ImageBitmap&&u.close&&u.close();return{icons:n}}SaveToSlot(e){this._saveToSlotName=e,this._saveToJsonString=!1}SaveToJsonString(){this._saveToSlotName=\"\",this._saveToJsonString=!0}LoadFromSlot(e){this._loadFromSlotName=e}LoadFromJsonString(e){this._loadFromJson=e}GetLastSaveJsonString(){return this._lastSaveJson}_NeedsHandleSaveOrLoad(){return!!(this._saveToSlotName||this._saveToJsonString||this._loadFromSlotName||null!==this._loadFromJson)}async _HandleSaveOrLoad(){if(this._saveToSlotName&&(this.FlushPendingInstances(),await this._DoSaveToSlot(this._saveToSlotName),this._ClearSaveOrLoad()),this._loadFromSlotName&&(await this._DoLoadFromSlot(this._loadFromSlotName),this._ClearSaveOrLoad(),this.IsDebug())&&j.StepIfPausedInDebugger(),this._saveToJsonString){const e=await this._SaveToJsonString();this._lastSaveJson=e,await this.TriggerAsync(U.Plugins.System.Cnds.OnSaveComplete,null),this._lastSaveJson=\"\",this._ClearSaveOrLoad()}if(null!==this._loadFromJson){this.FlushPendingInstances();try{await this._DoLoadFromJsonString(this._loadFromJson),this._lastSaveJson=this._loadFromJson,await this.TriggerAsync(U.Plugins.System.Cnds.OnLoadComplete,null),this._lastSaveJson=\"\"}catch(e){console.error(\"[Construct] Failed to load state from JSON string: \",e),await this.TriggerAsync(U.Plugins.System.Cnds.OnLoadFailed,null)}this._ClearSaveOrLoad()}}_ClearSaveOrLoad(){this._saveToSlotName=\"\",this._saveToJsonString=!1,this._loadFromSlotName=\"\",this._loadFromJson=null}_GetProjectStorage(){return this._projectStorage||(this._projectStorage=localforage.createInstance({name:\"c3-localstorage-\"+this.GetProjectUniqueId(),description:this.GetProjectName()})),this._projectStorage}_GetSavegamesStorage(){return this._savegamesStorage||(this._savegamesStorage=localforage.createInstance({name:\"c3-savegames-\"+this.GetProjectUniqueId(),description:this.GetProjectName()})),this._savegamesStorage}async _DoSaveToSlot(e){const t=await this._SaveToJsonString();try{await this._GetSavegamesStorage().setItem(e,t),console.log(\"[Construct] Saved state to storage (\"+t.length+\" chars)\"),this._lastSaveJson=t,await this.TriggerAsync(U.Plugins.System.Cnds.OnSaveComplete,null),this._lastSaveJson=\"\"}catch(e){console.error(\"[Construct] Failed to save state to storage: \",e),await this.TriggerAsync(U.Plugins.System.Cnds.OnSaveFailed,null)}}async _DoLoadFromSlot(e){try{const t=await this._GetSavegamesStorage().getItem(e);if(!t)throw new Error(\"empty slot\");console.log(\"[Construct] Loaded state from storage (\"+t.length+\" chars)\"),await this._DoLoadFromJsonString(t),this._lastSaveJson=t,await this.TriggerAsync(U.Plugins.System.Cnds.OnLoadComplete,null),this._lastSaveJson=\"\"}catch(e){console.error(\"[Construct] Failed to load state from storage: \",e),await this.TriggerAsync(U.Plugins.System.Cnds.OnLoadFailed,null)}}async _SaveToJsonString(){const e={c3save:!0,version:1,rt:{time:this.GetGameTime(),timeRaw:this.GetGameTimeRaw(),walltime:this.GetWallTime(),timescale:this.GetTimeScale(),tickcount:this.GetTickCount(),next_uid:this._nextUid,running_layout:this.GetMainRunningLayout().GetSID(),start_time_offset:Date.now()-this._startTime},types:{},layouts:{},events:this._eventSheetManager._SaveToJson(),timelines:this._timelineManager._SaveToJson(),user_script_data:null};for(const s of this._allObjectClasses)s.IsFamily()||s.HasNoSaveBehavior()||(e.types[s.GetSID().toString()]=s._SaveToJson());for(const i of this._layoutManager.GetAllLayouts())e.layouts[i.GetSID().toString()]=i._SaveToJson();const t=this._CreateUserScriptEvent(\"save\");return t.saveData=null,await this.DispatchUserScriptEventAsyncWait(t),e.user_script_data=t.saveData,JSON.stringify(e)}IsLoadingState(){return this._isLoadingState}async _DoLoadFromJsonString(e){const t=this.GetLayoutManager(),s=JSON.parse(e);if(s.c2save)throw new Error(\"C2 saves are incompatible with C3 runtime\");if(!s.c3save)throw new Error(\"not valid C3 save data\");if(1<s.version)throw new Error(\"C3 save data from future version\");this.ClearIntancesNeedingAfterLoad(),this._dispatcher.dispatchEvent(U.New(U.Event,\"beforeload\"));for(const h of this.allInstances()){const l=h.GetObjectClass();l.HasNoSaveBehavior()||h._OnBeforeLoad()}let i=s.rt,r=(this._gameTime.Set(i.time),i.hasOwnProperty(\"timeRaw\")&&this._gameTimeRaw.Set(i.timeRaw),this._wallTime.Set(i.walltime),this._timeScale=i.timescale,this._tickCount=i.tickcount,this._startTime=Date.now()-i.start_time_offset,i.running_layout),n=!(this._isLoadingState=!0);if(r!==this.GetMainRunningLayout().GetSID()){const c=t.GetLayoutBySID(r);if(!c)return;await this._DoChangeLayout(c),n=!0}for(const[u,_]of Object.entries(s.layouts)){const d=parseInt(u,10),p=t.GetLayoutBySID(d);p&&p._LoadFromJson(_)}const a=new Set;for(const[f,m]of Object.entries(s.types)){const g=parseInt(f,10),S=this.GetObjectClassBySID(g);!S||S.IsFamily()||S.HasNoSaveBehavior()||S._LoadFromJson(m,a)}for(const y of this._layoutManager.GetAllLayouts())for(const G of y.allLayers())G._LoadFromJsonAfterInstances();if(this.FlushPendingInstances(),this._RefreshUidMap(),this._isLoadingState=!1,n){for(const I of this.allInstances())I.SetupInitialSceneGraphConnections();for(const[T,C]of Object.entries(s.types)){const b=parseInt(T,10),w=this.GetObjectClassBySID(b);!w||w.IsFamily()||w.HasNoSaveBehavior()||w._SetupSceneGraphConnectionsOnChangeOfLayout(C)}}this._nextUid=i.next_uid,this._eventSheetManager._LoadFromJson(s.events);for(const x of this._allObjectClasses)if(!x.IsFamily()&&x.IsInContainer())for(const v of x.GetInstances()){const P=v.GetIID();for(const R of x.GetContainer().objectTypes())if(R!==x){const A=R.GetInstances();if(P<0||P>=A.length)throw new Error(\"missing sibling instance\");v._AddSibling(A[P])}}this._timelineManager._LoadFromJson(s.timelines),t.SetAllLayerProjectionChanged(),t.SetAllLayerMVChanged();for(const M of a)M._OnCreatedForLoadingSavegame();this.DoAfterLoad(),this._dispatcher.dispatchEvent(U.New(U.Event,\"afterload\")),this.DispatchUserScriptEvent(this._CreateUserScriptEvent(\"afterload\"));for(const[D,E]of Object.entries(s.types)){const F=parseInt(D,10),B=this.GetObjectClassBySID(F);B&&B._ClearLoadInstancesJson()}const o=this._CreateUserScriptEvent(\"load\");o.saveData=s.user_script_data,await this.DispatchUserScriptEventAsyncWait(o),this.UpdateRender()}SortOnTmpHierarchyPosition(e,t){return e.GetWorldInfo().GetTmpHierarchyPosition()-t.GetWorldInfo().GetTmpHierarchyPosition()}AddInstanceNeedingAfterLoad(e,t){e.GetWorldInfo()&&!this._instancesNeedingAfterLoadMap.has(e)&&(this._instancesNeedingAfterLoadMap.set(e,t),this._instancesNeedingAfterLoadArray.push(e))}ClearIntancesNeedingAfterLoad(){this._instancesNeedingAfterLoadMap=new WeakMap,U.clearArray(this._instancesNeedingAfterLoadArray)}DoAfterLoad(e=\"full\",t=null){this._instancesNeedingAfterLoadArray.sort(this.SortOnTmpHierarchyPosition);for(const s of this._instancesNeedingAfterLoadArray)s._OnAfterLoad(this._instancesNeedingAfterLoadMap.get(s),e,t);for(const i of this._instancesNeedingAfterLoadArray)i._OnAfterLoad2(this._instancesNeedingAfterLoadMap.get(i),e,t);this.ClearIntancesNeedingAfterLoad()}async AddJobWorkerScripts(e){const t=await Promise.all(e.map(async e=>{const t=this.IsCordova()&&this._assetManager.IsFileProtocol();if(t||\"playable-ad-single-file\"===this.GetExportType()){const s=await this._assetManager.FetchBlob(e);return URL.createObjectURL(s)}return new URL(e,location.href).toString()}));this._jobScheduler.ImportScriptsToJobWorkers(t)}AddJobWorkerBlob(e,t){this._jobScheduler.SendBlobToJobWorkers(e,t)}AddJobWorkerBuffer(e,t){this._jobScheduler.SendBufferToJobWorkers(e,t)}AddJob(e,t,s,i){return this._jobScheduler.AddJob(e,t,s,null,null,i)}BroadcastJob(e,t,s,i){return this._jobScheduler.BroadcastJob(e,t,s,i)}GetMaxNumJobWorkers(){return this._jobScheduler.GetMaxNumWorkers()}InvokeDownload(e,t){this.PostComponentMessageToDOM(\"runtime\",\"invoke-download\",{url:e,filename:t})}async RasterSvgImage(e,t,s,i,r,n){if(i=i||t,r=r||s,this.IsInWorker()){const a=await this.PostComponentMessageToDOMAsync(\"runtime\",\"raster-svg-image\",{blob:e,imageWidth:t,imageHeight:s,surfaceWidth:i,surfaceHeight:r,imageBitmapOpts:n});return a.imageBitmap}{const o=await self.C3_RasterSvgImageBlob(e,t,s,i,r);return n?self.createImageBitmap(o,n):o}}async GetSvgImageSize(e){return this.IsInWorker()?this.PostComponentMessageToDOMAsync(\"runtime\",\"get-svg-image-size\",{blob:e}):self.C3_GetSvgImageSize(e)}RequestDeviceOrientationEvent(){this._didRequestDeviceOrientationEvent||(this._didRequestDeviceOrientationEvent=!0,this.PostComponentMessageToDOM(\"runtime\",\"enable-device-orientation\"))}RequestDeviceMotionEvent(){this._didRequestDeviceMotionEvent||(this._didRequestDeviceMotionEvent=!0,this.PostComponentMessageToDOM(\"runtime\",\"enable-device-motion\"))}Random(){return this._randomNumberCallback()}SetRandomNumberGeneratorCallback(e){this._randomNumberCallback=e}_GetRemotePreviewStatusInfo(){const e=this.GetRenderer();return{fps:this.GetFramesPerSecond(),tps:this.GetTicksPerSecond(),cpu:this.GetMainThreadTime(),gpu:this.GetGPUUtilisation(),layout:this.GetMainRunningLayout()?this.GetMainRunningLayout().GetName():\"\",renderer:e.IsWebGL()?e.GetUnmaskedRenderer():e.GetAdapterInfoString()}}HitBreakpoint(){return!!this.IsDebug()&&j.HitBreakpoint()}DebugBreak(e){return this.IsDebugging()?j.DebugBreak(e):Promise.resolve()}DebugBreakNext(){return!!this.IsDebugging()&&j.BreakNext()}SetDebugBreakpointsEnabled(e){this._breakpointsEnabled=!!e,this._UpdateDebuggingFlag()}AreDebugBreakpointsEnabled(){return this._breakpointsEnabled}IsDebugging(){return this._isDebugging}SetDebuggingEnabled(e){e?this._debuggingDisabled--:this._debuggingDisabled++,this._UpdateDebuggingFlag()}_UpdateDebuggingFlag(){this._isDebugging=this.IsDebug()&&this._breakpointsEnabled&&0===this._debuggingDisabled}IsCPUProfiling(){return this.IsDebug()&&j.IsCPUProfiling()}IsGPUProfiling(){return this.IsDebug()&&this.GetRenderer().SupportsGPUProfiling()&&j.IsGPUProfiling()}async DebugIterateAndBreak(e){if(e)for(const t of e)await this.DebugBreak(t)}DebugFireGeneratorEventAndBreak(e){return this.DebugIterateAndBreak(this._dispatcher.dispatchGeneratorEvent(e))}_InvokeFunctionFromJS(e){return this._eventSheetManager._InvokeFunctionFromJS(e.name,e.params)}_GetHTMLLayerWrapElement(e){if(this.IsInWorker())throw new Error(\"not supported in worker mode\");return self.c3_runtimeInterface._GetHTMLWrapElement(e)}GetIRuntime(){return this._iRuntime}_CreateUserScriptEvent(e){const t=U.New(U.Event,e,!1);return t.runtime=this._iRuntime,t}_InitScriptInterfaces(){this._iRuntime=new self.IRuntime(this),this._userScriptEventObjects={tick:this._CreateUserScriptEvent(\"tick\")}}_InitObjectsScriptInterface(){const e={};for(const t of this._allObjectClasses)e[t.GetJsPropName()]={value:t.GetIObjectClass(),enumerable:!0,writable:!1};this._iRuntime._InitObjects(e)}_InitGlobalVariableScriptInterface(){const e={};for(const t of this.GetEventSheetManager().GetAllGlobalVariables())e[t.GetJsPropName()]=t._GetScriptInterfaceDescriptor();this._iRuntime._InitGlobalVars(e)}_GetCommonScriptInterfaces(){return this._commonScriptInterfaces}_MapScriptInterface(e,t){this._interfaceMap.set(e,t)}_UnwrapScriptInterface(e){return this._interfaceMap.get(e)}_UnwrapIObjectClass(e){if(!(e instanceof self.IObjectClass))throw new TypeError(\"expected IObjectClass\");const t=this._UnwrapScriptInterface(e);if(t&&t instanceof U.ObjectClass)return t;throw new Error(\"invalid IObjectClass\")}_UnwrapIInstance(e){if(!(e instanceof self.IInstance))throw new TypeError(\"expected IInstance\");const t=this._UnwrapScriptInterface(e);if(t&&t instanceof U.Instance)return t;throw new Error(\"invalid IInstance\")}_UnwrapIWorldInstance(e){if(!(e instanceof self.IWorldInstance))throw new TypeError(\"expected IWorldInstance\");const t=this._UnwrapScriptInterface(e);if(t&&t instanceof U.Instance)return t;throw new Error(\"invalid IInstance\")}},self.C3_CreateRuntime=U.Runtime.Create,self.C3_InitRuntime=(e,t)=>e.Init(t)}{const Fh=self.C3;Fh.JobSchedulerRuntime=class extends Fh.DefendedBase{constructor(e,t){super(),this._runtime=e,this._jobPromises=new Map,this._nextJobId=0,this._inputPort=t.inputPort,t.outputPort.onmessage=e=>this._OnJobWorkerMessage(e),this._maxNumWorkers=t.maxNumWorkers,this._jobWorkerCount=1,this._isCreatingWorker=!1,this._hadErrorCreatingWorker=!1}async Init(){}GetMaxNumWorkers(){return this._maxNumWorkers}ImportScriptsToJobWorkers(e){this._inputPort.postMessage({type:\"_import_scripts\",scripts:e})}SendBlobToJobWorkers(e,t){this._inputPort.postMessage({type:\"_send_blob\",blob:e,id:t})}SendBufferToJobWorkers(e,t){this._inputPort.postMessage({type:\"_send_buffer\",buffer:e,id:t},[e])}AddJob(e,t,s,i,r,n){if(s=s||[],\"number\"==typeof n&&(n=Math.floor(n))<=0)throw new Error(\"invalid maxWorkerNum\");const a=this._nextJobId++,o={type:e,isBroadcast:!1,maxWorkerNum:n,jobId:a,params:t,transferables:s},h=new Promise((e,t)=>{this._jobPromises.set(a,{resolve:e,progress:i,reject:t,cancelled:!1,maxWorkerNum:n})});return r&&r.SetAction(()=>this._CancelJob(a)),this._inputPort.postMessage(o,s),this._MaybeCreateExtraWorker(),h}BroadcastJob(e,t,s,i){if(s=s||[],\"number\"==typeof i&&(i=Math.floor(i))<=0)throw new Error(\"invalid maxWorkerNum\");const r=this._nextJobId++,n={type:e,isBroadcast:!0,maxWorkerNum:i,jobId:r,params:t,transferables:s};this._inputPort.postMessage(n,s)}_CancelJob(e){const t=this._jobPromises.get(e);t&&(t.cancelled=!0,t.resolve=null,t.progress=null,t.reject=null,this._inputPort.postMessage({type:\"_cancel\",jobId:e}))}_OnJobWorkerMessage(e){const t=e.data,s=t.type,i=t.jobId;switch(s){case\"result\":this._OnJobResult(i,t.result);break;case\"progress\":this._OnJobProgress(i,t.progress);break;case\"error\":this._OnJobError(i,t.error);break;case\"ready\":this._OnJobWorkerReady();break;default:throw new Error(`unknown message from worker '${s}'`)}}_OnJobResult(e,t){const s=this._jobPromises.get(e);if(!s)throw new Error(\"invalid job ID\");s.cancelled||s.resolve(t),this._jobPromises.delete(e)}_OnJobProgress(e,t){const s=this._jobPromises.get(e);if(!s)throw new Error(\"invalid job ID\");!s.cancelled&&s.progress&&s.progress(t)}_OnJobError(e,t){const s=this._jobPromises.get(e);if(!s)throw new Error(\"invalid job ID\");s.cancelled||s.reject(t),this._jobPromises.delete(e)}_OnJobWorkerReady(){this._isCreatingWorker&&(this._isCreatingWorker=!1,this._jobWorkerCount++,this._jobWorkerCount<this._maxNumWorkers?this._MaybeCreateExtraWorker():this._inputPort.postMessage({type:\"_no_more_workers\"}))}_GetWorkerCountNeededForPendingJobs(){let e=0,t=[...this._jobPromises.values()].sort((e,t)=>{const s=e.maxWorkerNum||1/0,i=t.maxWorkerNum||1/0;return s-i});for(const s of t){const i=s.maxWorkerNum||1/0;e<i&&e++}return e}async _MaybeCreateExtraWorker(){if(!(this._jobWorkerCount>=this._maxNumWorkers||this._isCreatingWorker||this._hadErrorCreatingWorker||this._GetWorkerCountNeededForPendingJobs()<=this._jobWorkerCount))try{this._isCreatingWorker=!0;const e=await this._runtime.PostComponentMessageToDOMAsync(\"runtime\",\"create-job-worker\");e.outputPort.onmessage=e=>this._OnJobWorkerMessage(e)}catch(e){this._hadErrorCreatingWorker=!0,this._isCreatingWorker=!1,console.error(`[Construct] Failed to create job worker; stopping creating any more (created ${this._jobWorkerCount} so far)`,e)}}}}self.C3_Shaders={};{let y=function(e,t){const s=e[1],i=t[1];if(\"number\"==typeof s&&\"number\"==typeof i)return s-i;{const r=\"\"+s,n=\"\"+i;return r<n?-1:n<r?1:0}},G=(y,self.C3),s=null,i=\"\",r=\"\",n=[],a=\"\",o=\"\",h=\"\",I=G.New(G.ArrayStack);G.Plugins.System=class extends G.SDKPluginBase{constructor(e){super(e),this._loopStack=this._runtime.GetEventSheetManager().GetLoopStack(),this._eventStack=this._runtime.GetEventSheetManager().GetEventStack(),this._imagesLoadingTotal=0,this._imagesLoadingComplete=0,this._functionMaps=new Map}Release(){super.Release()}UpdateRender(){this._runtime.UpdateRender()}Trigger(e){this._runtime.Trigger(e,null,null)}GetRegex(e,t){return s&&e===i&&t===r||(s=new RegExp(e,t),i=e,r=t),s.lastIndex=0,s}GetRegexMatches(e,t,s){if(e!==a||t!==o||s!==h){const i=this.GetRegex(t,s);n=e.match(i),a=e,o=t,h=s}return n}async _LoadTexturesForObjectClasses(e,t){if(t.length){this._imagesLoadingTotal+=t.length;const s=[];for(const i of t)s.push(e.MaybeLoadTexturesFor(i));await G.PromiseAllWithProgress(s,()=>{this._imagesLoadingComplete++}),this._imagesLoadingComplete++,this._imagesLoadingComplete===this._imagesLoadingTotal&&(this._imagesLoadingComplete=0,this._imagesLoadingTotal=0,this._runtime.Trigger(G.Plugins.System.Cnds.OnImageLoadingComplete,null,null))}}_UnloadTexturesForObjectClasses(e,t){for(const s of t)0===s.GetInstanceCount()&&e.MaybeUnloadTexturesFor(s)}_GetForEachStack(){return I}_Repeat(t){const s=this._runtime.GetEventSheetManager(),e=s.GetEventStack(),i=e.GetCurrentStackFrame(),r=i.GetCurrentEvent(),n=r.GetSolModifiers(),a=i.IsSolModifierAfterCnds(),o=e.Push(r),h=s.GetLoopStack(),l=h.Push();if(l.SetEnd(t),a)for(let e=0;e<t&&!l.IsStopped();++e)s.PushCopySol(n),l.SetIndex(e),r.Retrigger(i,o),s.PopSol(n);else for(let e=0;e<t&&!l.IsStopped();++e)l.SetIndex(e),r.Retrigger(i,o);return e.Pop(),h.Pop(),!1}*_DebugRepeat(t){const s=this._runtime.GetEventSheetManager(),e=s.GetEventStack(),i=e.GetCurrentStackFrame(),r=i.GetCurrentEvent(),n=r.GetSolModifiers(),a=i.IsSolModifierAfterCnds(),o=e.Push(r),h=s.GetLoopStack(),l=h.Push();if(l.SetEnd(t),a)for(let e=0;e<t&&!l.IsStopped();++e)s.PushCopySol(n),l.SetIndex(e),yield*r.DebugRetrigger(i,o),s.PopSol(n);else for(let e=0;e<t&&!l.IsStopped();++e)l.SetIndex(e),yield*r.DebugRetrigger(i,o);return e.Pop(),h.Pop(),!1}_While(){const t=this._runtime.GetEventSheetManager(),e=t.GetEventStack(),s=e.GetCurrentStackFrame(),i=s.GetCurrentEvent(),r=i.GetSolModifiers(),n=s.IsSolModifierAfterCnds(),a=e.Push(i),o=t.GetLoopStack(),h=o.Push();if(n)for(let e=0;!h.IsStopped();++e)t.PushCopySol(r),h.SetIndex(e),i.Retrigger(s,a)||h.Stop(),t.PopSol(r);else for(let e=0;!h.IsStopped();++e)h.SetIndex(e),i.Retrigger(s,a)||h.Stop();return e.Pop(),o.Pop(),!1}*_DebugWhile(){const t=this._runtime.GetEventSheetManager(),e=t.GetEventStack(),s=e.GetCurrentStackFrame(),i=s.GetCurrentEvent(),r=i.GetSolModifiers(),n=s.IsSolModifierAfterCnds(),a=e.Push(i),o=t.GetLoopStack(),h=o.Push();if(n)for(let e=0;!h.IsStopped();++e){t.PushCopySol(r),h.SetIndex(e);const l=yield*i.DebugRetrigger(s,a);l||h.Stop(),t.PopSol(r)}else for(let e=0;!h.IsStopped();++e){h.SetIndex(e);const c=yield*i.DebugRetrigger(s,a);c||h.Stop()}return e.Pop(),o.Pop(),!1}_For(e,t,s){const i=this._runtime.GetEventSheetManager(),r=i.GetEventStack(),n=r.GetCurrentStackFrame(),a=n.GetCurrentEvent(),o=a.GetSolModifiers(),h=n.IsSolModifierAfterCnds(),l=r.Push(a),c=i.GetLoopStack(),u=c.Push();if(u.SetName(e),u.SetEnd(s),s<t)if(h)for(let e=t;e>=s&&!u.IsStopped();--e)i.PushCopySol(o),u.SetIndex(e),a.Retrigger(n,l),i.PopSol(o);else for(let e=t;e>=s&&!u.IsStopped();--e)u.SetIndex(e),a.Retrigger(n,l);else if(h)for(let e=t;e<=s&&!u.IsStopped();++e)i.PushCopySol(o),u.SetIndex(e),a.Retrigger(n,l),i.PopSol(o);else for(let e=t;e<=s&&!u.IsStopped();++e)u.SetIndex(e),a.Retrigger(n,l);return r.Pop(),c.Pop(),!1}*_DebugFor(e,t,s){const i=this._runtime.GetEventSheetManager(),r=i.GetEventStack(),n=r.GetCurrentStackFrame(),a=n.GetCurrentEvent(),o=a.GetSolModifiers(),h=n.IsSolModifierAfterCnds(),l=r.Push(a),c=i.GetLoopStack(),u=c.Push();if(u.SetName(e),u.SetEnd(s),s<t)if(h)for(let e=t;e>=s&&!u.IsStopped();--e)i.PushCopySol(o),u.SetIndex(e),yield*a.DebugRetrigger(n,l),i.PopSol(o);else for(let e=t;e>=s&&!u.IsStopped();--e)u.SetIndex(e),yield*a.DebugRetrigger(n,l);else if(h)for(let e=t;e<=s&&!u.IsStopped();++e)i.PushCopySol(o),u.SetIndex(e),yield*a.DebugRetrigger(n,l),i.PopSol(o);else for(let e=t;e<=s&&!u.IsStopped();++e)u.SetIndex(e),yield*a.DebugRetrigger(n,l);return r.Pop(),c.Pop(),!1}_ForEach(s){const e=s.GetCurrentSol(),t=e.GetInstances();if(0!==t.length){const i=this._runtime.GetEventSheetManager(),r=i.GetEventStack(),n=r.GetCurrentStackFrame(),a=n.GetCurrentEvent(),o=a.GetSolModifiers(),h=n.IsSolModifierAfterCnds(),l=r.Push(a),c=i.GetLoopStack(),u=c.Push(),_=s.IsInContainer(),d=I.Push();if(G.shallowAssignArray(d,t),u.SetEnd(d.length),h)for(let e=0,t=d.length;e<t&&!u.IsStopped();++e){i.PushCopySol(o);const p=d[e];s.GetCurrentSol().SetSinglePicked(p),_&&p.SetSiblingsSinglePicked(),u.SetIndex(e),a.Retrigger(n,l),i.PopSol(o)}else{e._SetSelectAll(!1);const f=e._GetOwnInstances();G.clearArray(f),f.push(null);for(let e=0,t=d.length;e<t&&!u.IsStopped();++e){const m=d[e];f[0]=m,_&&m.SetSiblingsSinglePicked(),u.SetIndex(e),a.Retrigger(n,l)}}r.Pop(),c.Pop(),G.clearArray(d),I.Pop()}return!1}*_DebugForEach(s){const e=s.GetCurrentSol(),t=e.GetInstances();if(0!==t.length){const i=this._runtime.GetEventSheetManager(),r=i.GetEventStack(),n=r.GetCurrentStackFrame(),a=n.GetCurrentEvent(),o=a.GetSolModifiers(),h=n.IsSolModifierAfterCnds(),l=r.Push(a),c=i.GetLoopStack(),u=c.Push(),_=s.IsInContainer(),d=I.Push();if(G.shallowAssignArray(d,t),u.SetEnd(d.length),h)for(let e=0,t=d.length;e<t&&!u.IsStopped();++e){i.PushCopySol(o);const p=d[e];s.GetCurrentSol().SetSinglePicked(p),_&&p.SetSiblingsSinglePicked(),u.SetIndex(e),yield*a.DebugRetrigger(n,l),i.PopSol(o)}else{e._SetSelectAll(!1);const f=e._GetOwnInstances();G.clearArray(f),f.push(null);for(let e=0,t=d.length;e<t&&!u.IsStopped();++e){const m=d[e];f[0]=m,_&&m.SetSiblingsSinglePicked(),u.SetIndex(e),yield*a.DebugRetrigger(n,l)}}r.Pop(),c.Pop(),G.clearArray(d),I.Pop()}return!1}_ForEachOrdered(s,e){const t=s.GetCurrentSol(),i=t.GetInstances();if(0!==i.length){const r=this._runtime.GetEventSheetManager(),n=r.GetEventStack(),a=r.GetCurrentCondition(),o=n.GetCurrentStackFrame(),h=o.GetCurrentEvent(),l=h.GetSolModifiers(),c=o.IsSolModifierAfterCnds(),u=n.Push(h),_=r.GetLoopStack(),d=_.Push(),p=s.IsInContainer(),f=I.Push();G.clearArray(f),d.SetEnd(i.length);for(let e=0,t=i.length;e<t;++e)f.push([i[e],a.ReevaluateParameter(1,e)]);if(f.sort(y),1===e&&f.reverse(),c)for(let e=0,t=f.length;e<t&&!d.IsStopped();++e){r.PushCopySol(l);const m=f[e][0];s.GetCurrentSol().SetSinglePicked(m),p&&m.SetSiblingsSinglePicked(),d.SetIndex(e),h.Retrigger(o,u),r.PopSol(l)}else{t._SetSelectAll(!1);const g=t._GetOwnInstances();G.clearArray(g),g.push(null);for(let e=0,t=f.length;e<t&&!d.IsStopped();++e){const S=f[e][0];g[0]=S,p&&S.SetSiblingsSinglePicked(),d.SetIndex(e),h.Retrigger(o,u)}}n.Pop(),_.Pop(),G.clearArray(f),I.Pop()}return!1}*_DebugForEachOrdered(s,e){const t=s.GetCurrentSol(),i=t.GetInstances();if(0!==i.length){const r=this._runtime.GetEventSheetManager(),n=r.GetEventStack(),a=r.GetCurrentCondition(),o=n.GetCurrentStackFrame(),h=o.GetCurrentEvent(),l=h.GetSolModifiers(),c=o.IsSolModifierAfterCnds(),u=n.Push(h),_=r.GetLoopStack(),d=_.Push(),p=s.IsInContainer(),f=I.Push();G.clearArray(f),d.SetEnd(i.length);for(let e=0,t=i.length;e<t;++e)f.push([i[e],a.ReevaluateParameter(1,e)]);if(f.sort(y),1===e&&f.reverse(),c)for(let e=0,t=f.length;e<t&&!d.IsStopped();++e){r.PushCopySol(l);const m=f[e][0];s.GetCurrentSol().SetSinglePicked(m),p&&m.SetSiblingsSinglePicked(),d.SetIndex(e),yield*h.DebugRetrigger(o,u),r.PopSol(l)}else{t._SetSelectAll(!1);const g=t._GetOwnInstances();G.clearArray(g),g.push(null);for(let e=0,t=f.length;e<t&&!d.IsStopped();++e){const S=f[e][0];g[0]=S,p&&S.SetSiblingsSinglePicked(),d.SetIndex(e),yield*h.DebugRetrigger(o,u)}}n.Pop(),_.Pop(),G.clearArray(f),I.Pop()}return!1}_GetFunctionMap(e,t){let s=this._functionMaps.get(e);if(!s){if(!t)return null;s={defaultFunc:null,strMap:new Map},this._functionMaps.set(e,s)}return s}_DoCallMappedFunction(e,t,s,i,r){t.GetEventBlock().RunAsMappedFunctionCall(s,t.IsCopyPicked()),i&&e.PopSol(r)}*_DebugDoCallMappedFunction(e,t,s,i,r){yield*t.GetEventBlock().DebugRunAsMappedFunctionCall(s,t.IsCopyPicked()),i&&e.PopSol(r)}}}{const Bh=self.C3;Bh.Plugins.System.Type=class extends Bh.DefendedBase{constructor(e){super(),this._objectClass=e,this._runtime=e.GetRuntime(),this._plugin=e.GetPlugin()}OnCreate(){}Release(){this._objectClass=null,this._runtime=null,this._plugin=null}}}{const Oh=self.C3;Oh.Plugins.System.Instance=class extends Oh.DefendedBase{constructor(e,t){super(),this._inst=e,this._objectClass=this._inst.GetObjectClass(),this._sdkType=this._objectClass.GetSdkType(),this._runtime=this._inst.GetRuntime()}Release(){this._inst=null,this._objectClass=null,this._sdkType=null,this._runtime=null}}}{const v=self.C3,Lh=[];v.Plugins.System.Cnds={EveryTick(){return!0},OnLayoutStart(){return!0},OnLayoutEnd(){return!0},OnSuspend(){return!0},OnResume(){return!0},IsSuspended(){return this._runtime.IsSuspended()},Else(){const e=this._runtime.GetCurrentEventStackFrame();return!e.GetElseBranchRan()&&!e.GetLastEventTrue()},TriggerOnce(){let e=this._runtime.GetCurrentCondition(),t=e.GetSavedDataMap(),s=t.get(\"TriggerOnce_lastTick\");void 0===s&&(s=-1,t.set(\"TriggerOnce_lastTick\",-1));const i=this._runtime.GetTickCount();return t.set(\"TriggerOnce_lastTick\",i),this._runtime.IsLayoutFirstTick()||s!==i-1},Every(e){const t=this._runtime.GetCurrentCondition(),s=t.GetSavedDataMap(),i=s.get(\"Every_lastTime\")||0,r=this._runtime.GetGameTime(),n=(s.has(\"Every_seconds\")||s.set(\"Every_seconds\",e),s.get(\"Every_seconds\"));return i+n<=r?(s.set(\"Every_lastTime\",i+n),r>=s.get(\"Every_lastTime\")+.04&&s.set(\"Every_lastTime\",r),s.set(\"Every_seconds\",e),!0):(r<i-.1&&s.set(\"Every_lastTime\",r),!1)},IsGroupActive(e){const t=this._runtime.GetEventSheetManager().GetEventGroupByName(e);return t&&t.IsGroupActive()},IsPreview(){return this._runtime.IsPreview()},IsMobile(){return v.Platform.IsMobile},OnLoadFinished(){return!0},OnCanvasSnapshot(){return!0},EffectsSupported(){return!0},OnSaveComplete(){return!0},OnSaveFailed(){return!0},OnLoadComplete(){return!0},OnLoadFailed(){return!0},ObjectUIDExists(e){return!!this._runtime.GetInstanceByUID(e)},IsOnPlatform(e){switch(e){case 0:return\"browser\"===v.Platform.Context;case 1:return\"iOS\"===v.Platform.OS;case 2:return\"Android\"===v.Platform.OS;case 8:return\"cordova\"===v.Platform.Context;case 9:return\"scirra-arcade\"===this._runtime.GetExportType();case 10:return\"nwjs\"===v.Platform.Context;case 13:return\"windows-uwp\"===this._runtime.GetExportType();default:return!1}},RegexTest(e,t,s){const i=this.GetRegex(t,s);return i.test(e)},Compare(e,t,s){return v.compare(e,t,s)},CompareBetween(e,t,s){return t<=e&&e<=s},CompareVar(e,t,s){return v.compare(e.GetValue(),t,s)},CompareBoolVar(e){return!!e.GetValue()},CompareTime(e,t){const s=this._runtime.GetGameTime();if(0!==e)return v.compare(s,e,t);{const i=this._runtime.GetCurrentCondition(),r=i.GetSavedDataMap();return!r.get(\"CompareTime_executed\")&&t<=s&&(r.set(\"CompareTime_executed\",!0),!0)}},IsNaN(e){return isNaN(e)},AngleWithin(e,t,s){return v.angleDiff(v.toRadians(e),v.toRadians(s))<=v.toRadians(t)},IsClockwiseFrom(e,t){return v.angleClockwise(v.toRadians(e),v.toRadians(t))},IsBetweenAngles(e,t,s){let i=v.toRadians(e),r=v.toRadians(t),n=v.toRadians(s),a=!v.angleClockwise(n,r);return a?!(!v.angleClockwise(i,r)&&v.angleClockwise(i,n)):v.angleClockwise(i,r)&&!v.angleClockwise(i,n)},IsValueType(e,t){return\"number\"==typeof e?0===t:1===t},EvaluateExpression(e){return!!e},OnSignal(e){return e.toLowerCase()===this._runtime.GetEventSheetManager().GetCurrentSignalTag()},PickByComparison(e,s,i,r){if(!e)return!1;let t=this._GetForEachStack(),n=t.Push(),a=e.GetCurrentSol(),o=(v.shallowAssignArray(n,a.GetInstances()),a.IsSelectAll()&&v.clearArray(a._GetOwnElseInstances()),this._runtime.GetCurrentCondition()),h=0;for(let e=0,t=n.length;e<t;++e){const c=n[e];n[h]=c,s=o.ReevaluateParameter(1,e),r=o.ReevaluateParameter(3,e),v.compare(s,i,r)?++h:a._PushElseInstance(c)}v.truncateArray(n,h),a.SetArrayPicked(n);const l=!!n.length;return v.clearArray(n),t.Pop(),e.ApplySolToContainer(),l},PickByEvaluate(e,t){if(!e)return!1;let s=this._GetForEachStack(),i=s.Push(),r=e.GetCurrentSol(),n=(v.shallowAssignArray(i,r.GetInstances()),r.IsSelectAll()&&v.clearArray(r._GetOwnElseInstances()),this._runtime.GetCurrentCondition()),a=0;for(let e=0,t=i.length;e<t;++e){const h=i[e];i[a]=h,n.ReevaluateParameter(1,e)?++a:r._PushElseInstance(h)}v.truncateArray(i,a),r.SetArrayPicked(i);const o=!!i.length;return v.clearArray(i),s.Pop(),e.ApplySolToContainer(),o},PickByHighestLowestValue(e,s,i){if(!e)return!1;const t=e.GetCurrentSol(),r=t.GetInstances();if(0===r.length)return!1;let n=this._runtime.GetCurrentCondition(),a=null,o=0;for(let e=0,t=r.length;e<t;++e){const h=r[e];i=n.ReevaluateParameter(2,e),(null===a||0===s&&i<o||1===s&&i>o)&&(o=i,a=h)}return t.PickOne(a),e.ApplySolToContainer(),!0},PickNth(e,t){if(!e)return!1;const s=e.GetCurrentSol(),i=s.GetInstances();if((t=Math.floor(t))>=i.length)return!1;const r=i[t];return s.PickOne(r),e.ApplySolToContainer(),!0},PickRandom(e){if(!e)return!1;const t=e.GetCurrentSol(),s=t.GetInstances(),i=Math.floor(this._runtime.Random()*s.length);if(i>=s.length)return!1;const r=s[i];return t.PickOne(r),e.ApplySolToContainer(),!0},PickAll(e){if(!e)return!1;if(!e.GetInstanceCount())return!1;const t=e.GetCurrentSol();return t._SetSelectAll(!0),e.ApplySolToContainer(),!0},PickOverlappingPoint(e,s,i){if(!e)return!1;const r=e.GetCurrentSol(),t=r.GetInstances(),n=this._runtime.GetCurrentEvent(),a=n.IsOrBlock(),o=this._runtime.GetCurrentCondition().IsInverted();r.IsSelectAll()?(v.shallowAssignArray(Lh,t),r.ClearArrays(),r._SetSelectAll(!1)):a?(v.shallowAssignArray(Lh,r._GetOwnElseInstances()),v.clearArray(r._GetOwnElseInstances())):(v.shallowAssignArray(Lh,r._GetOwnInstances()),v.clearArray(r._GetOwnInstances()));for(let e=0,t=Lh.length;e<t;++e){const h=Lh[e];v.xor(h.GetWorldInfo().ContainsPoint(s,i),o)?r._PushInstance(h):r._PushElseInstance(h)}return e.ApplySolToContainer(),v.xor(!!r._GetOwnInstances().length,o)},PickLastCreated(t){if(!t)return!1;let s=t.IsFamily(),i=null,r=this._runtime._GetInstancesPendingCreate();for(let e=r.length-1;0<=e;--e){const n=r[e];if(s){if(n.GetObjectClass().BelongsToFamily(t)){i=n;break}}else if(n.GetObjectClass()===t){i=n;break}}if(!i){const a=t.GetInstances();a.length&&(i=a.at(-1))}if(!i)return!1;const e=t.GetCurrentSol();return e.PickOne(i),t.ApplySolToContainer(),!0},Repeat(e){return this._runtime.IsDebugging()?this._DebugRepeat(e):this._Repeat(e)},While(){return this._runtime.IsDebugging()?this._DebugWhile():this._While()},For(e,t,s){return this._runtime.IsDebugging()?this._DebugFor(e,t,s):this._For(e,t,s)},ForEach(e){return this._runtime.IsDebugging()?this._DebugForEach(e):this._ForEach(e)},ForEachOrdered(e,t,s){return this._runtime.IsDebugging()?this._DebugForEachOrdered(e,s):this._ForEachOrdered(e,s)},LayerVisible(e){return!!e&&e.IsVisible()},LayerInteractive(e){return!!e&&e.IsSelfAndParentsInteractive()},LayerIsHTML(e){return!!e&&e.IsHTMLElementsLayer()},LayerEmpty(e){return!!e&&!e.GetInstanceCount()},LayerCmpOpacity(e,t,s){return!!e&&v.compare(100*e.GetOpacity(),t,s)},LayerNameExists(e){const t=this._runtime.GetMainRunningLayout();return!!t&&t.HasLayerByName(e)},OnImageLoadingComplete(){return!0},IsLoadingImages(){return 0<this._imagesLoadingTotal},TemplateExists(e,t){const s=this._runtime.GetTemplateManager();return!!s&&!!t&&!!s.GetTemplateData(e,t)}}}{let f=function(e,t){const s=e[0],i=t[0],r=s-i;if(0!=r)return r;const n=e[1],a=t[1];return n-a},m=function(e,t){return e[1]-t[1]};f,m;const kh=self.C3,Nh=[],Wh=[],Vh=kh.New(kh.Rect),Uh=kh.New(kh.Color),jh=[];kh.Plugins.System.Acts={SetVar(e,t){e.SetValue(t)},AddVar(e,t){e.IsNumber()&&\"number\"!=typeof t&&(t=parseFloat(t)),e.SetValue(e.GetValue()+t)},SubVar(e,t){e.IsNumber()&&e.SetValue(e.GetValue()-t)},SetBoolVar(e,t){e.SetValue(!!t)},ToggleBoolVar(e){e.SetValue(!e.GetValue())},ResetEventVar(e){e.SetValue(e.GetInitialValue())},ResetGlobals(e){this._runtime.GetEventSheetManager().ResetAllGlobalsToInitialValue(e)},CreateObject(e,t,s,i,r,n){if(e&&t){const a=this._runtime.CreateInstance(e,t,s,i,r,n);if(a){r&&t.SortAndAddInstancesByZIndex(a);const o=this._runtime.GetEventSheetManager(),h=(o.BlockFlushingInstances(!0),a._TriggerOnCreatedOnSelfAndRelated(),o.BlockFlushingInstances(!1),new Map);a.CollectInstancesToPick(h,e,r);for(const[l,c]of h)l.GetCurrentSol().SetSetPicked(c)}}},CreateObjectByName(e,t,s,i,r,n){if(e&&t){const a=this._runtime.GetObjectClassByName(e);a&&kh.Plugins.System.Acts.CreateObject.call(this,a,t,s,i,r,n)}},RecreateInitialObjects(r,n,a,o,h,e,l,c,u,_,d){if(r){let t=this._runtime.GetCurrentLayout(),s=t;if(e){const p=this._runtime.GetLayoutManager().GetLayoutByName(e);if(!p)return;s=p}let i=null;if(!(\"number\"!=typeof l||0<=l)||(i=s.GetLayer(l))){let e=null;if(!(\"number\"!=typeof c||0<=c)||(e=t.GetLayer(c))){Vh.set(n,a,o,h);const f=s.RecreateInitialObjects(r,Vh,i,e,u,_,d);r.GetCurrentSol().SetArrayPicked(f),r.ApplySolToContainer()}}}},StopLoop(){const e=this._loopStack;e.IsInLoop()&&e.GetCurrent().Stop()},SetGroupActive(e,t){const s=this._runtime.GetEventSheetManager().GetEventGroupByName(e);s&&(0===t?s.SetGroupActive(!1):1===t?s.SetGroupActive(!0):s.SetGroupActive(!s.IsGroupActive()))},SetTimescale(e){this._runtime.SetTimeScale(e)},SetObjectTimescale(e,t){if(t<0&&(t=0),e){const s=e.GetCurrentSol(),i=s.GetInstances();for(const r of i)r.SetTimeScale(t)}},RestoreObjectTimescale(e){if(e){const t=e.GetCurrentSol(),s=t.GetInstances();for(const i of s)i.RestoreTimeScale()}},Wait(e){if(!(e<0))return this._runtime.GetEventSheetManager().AddScheduledWait().InitTimer(e),!0},WaitForSignal(e){return this._runtime.GetEventSheetManager().AddScheduledWait().InitSignal(e),!0},WaitForPreviousActions(){const e=this._runtime.GetEventSheetManager();return e.AddScheduledWait().InitPromise(e.GetPromiseForAllAsyncActions()),!0},Signal(e){this._runtime.GetEventSheetManager().Signal(e)},async SnapshotCanvas(e,t,s,i,r,n){const a=this._runtime.GetCanvasManager();a&&(this.UpdateRender(),await a.SnapshotCanvas(0===e?\"image/png\":\"image/jpeg\",t/100,s,i,r,n),await this._runtime.TriggerAsync(kh.Plugins.System.Cnds.OnCanvasSnapshot,null))},SetCanvasSize(e,t){if(!(e<=0||t<=0)){this._runtime.SetViewportSize(e,t),this._runtime.GetCurrentLayout().BoundScrolling();const s=this._runtime.GetCanvasManager();s&&(\"off\"!==s.GetCurrentFullscreenMode()&&this._runtime.SetOriginalViewportSize(e,t),s.SetSize(s.GetLastWidth(),s.GetLastHeight(),!0),this._runtime.UpdateRender())}},SetFullscreenQuality(e){const t=this._runtime.GetCanvasManager();t&&\"off\"!==t.GetCurrentFullscreenMode()&&(t.SetFullscreenScalingQuality(0!==e?\"high\":\"low\"),t.SetSize(t.GetLastWidth(),t.GetLastHeight(),!0))},SaveState(e){this._runtime.SaveToSlot(e)},SaveStateJSON(){this._runtime.SaveToJsonString()},LoadState(e){this._runtime.LoadFromSlot(e)},LoadStateJSON(e){this._runtime.LoadFromJsonString(e)},SetHalfFramerateMode(e){},ResetPersisted(){for(const e of this._runtime.GetLayoutManager().GetAllLayouts())e.ResetPersistData()},SetPixelRounding(e){this._runtime.SetPixelRoundingEnabled(0!==e)},SetFramerateMinMax(e,t){this._runtime.SetMaxDt(1/e),this._runtime.SetMinDt(1/t)},SetDeltaTimeMinMax(e,t){this._runtime.SetMinDt(e),this._runtime.SetMaxDt(t)},SetFramerateMode(e){this._runtime._SetFramerateMode([\"vsync\",\"unlimited-tick\",\"unlimited-frame\"][e])},SortZOrderByInstVar(e,s){if(e){const t=e.GetCurrentSol(),i=t.GetInstances(),r=Nh,n=Wh,a=this._runtime.GetCurrentLayout(),o=e.IsFamily(),h=e.GetFamilyIndex();for(let e=0,t=i.length;e<t;++e){const l=i[e],c=l.GetWorldInfo();if(c){let e;e=o?l.GetInstanceVariableValue(s+l.GetObjectClass().GetFamilyInstanceVariableOffset(h)):l.GetInstanceVariableValue(s),r.push([c.GetLayer().GetIndex(),c.GetZIndex()]),n.push([l,e])}}if(r.length){r.sort(f),n.sort(m);let s=!1;for(let e=0,t=r.length;e<t;++e){const u=n[e][0],_=a.GetLayerByIndex(r[e][0]),d=r[e][1],p=_._GetInstances();p[d]!==u&&((p[d]=u).GetWorldInfo()._SetLayer(_,!0),_.SetZIndicesChanged(u),s=!0)}s&&this._runtime.UpdateRender(),kh.clearArray(Nh),kh.clearArray(Wh)}}},SetCollisionCellSize(e,t){e=Math.floor(e),t=Math.floor(t),e<=0||t<=0||!Number.isFinite(e)||!Number.isFinite(t)||this._runtime.GetCollisionEngine().SetCollisionCellSize(e,t)},GoToLayout(e){if(!this._runtime.IsLoading()){const t=this._runtime.GetLayoutManager();t.IsPendingChangeMainLayout()||t.ChangeMainLayout(e)}},GoToLayoutByName(e){if(!this._runtime.IsLoading()){const t=this._runtime.GetLayoutManager();if(!t.IsPendingChangeMainLayout()){const s=t.GetLayoutByName(e);s&&t.ChangeMainLayout(s)}}},NextPrevLayout(e){if(!this._runtime.IsLoading()){const t=this._runtime.GetLayoutManager();if(!t.IsPendingChangeMainLayout()){const s=t.GetAllLayouts(),i=s.indexOf(t.GetMainRunningLayout());if((!e||0!==i)&&(e||i!==s.length-1)){const r=s[i+(e?-1:1)];t.ChangeMainLayout(r)}}}},RestartLayout(){if(!this._runtime.IsLoading()){const e=this._runtime.GetLayoutManager();e.IsPendingChangeMainLayout()||(e.ChangeMainLayout(e.GetMainRunningLayout()),this._runtime.GetEventSheetManager().ResetAllGroupsInitialActivation())}},SetLayerVisible(e,t){e&&e.SetVisible(t)},SetLayerInteractive(e,t){e&&e.SetInteractive(t)},SetLayerHTML(e,t){e&&e.SetIsHTMLElementsLayer(t)},SetLayerOpacity(e,t){e&&e.SetOpacity(t/100)},SetLayerScale(e,t){e&&e.SetOwnScale(t)},SetLayerScaleRate(e,t){e&&e.SetScaleRate(t)},SetLayerAngle(e,t){e&&e.SetAngle(kh.toRadians(+t))},SetLayerScroll(e,t,s){e&&(e.SetOwnScrollPositionEnabled(!0),e.SetScrollX(t),e.SetScrollY(s))},RestoreLayerScroll(e){e&&e.SetOwnScrollPositionEnabled(!1)},SetLayerParallax(e,t,s){e&&e.SetParallax(t/100,s/100)},SetLayerZElevation(e,t){e&&e.SetZElevation(+t)},SetLayerBackground(e,t){if(e){Uh.setFromRgbValue(t),Uh.clamp();const s=e.GetBackgroundColor();s.equalsIgnoringAlpha(Uh)||(s.copyRgb(Uh),this.UpdateRender())}},SetLayerTransparent(e,t){e&&e.SetTransparent(t)},SetLayerBlendMode(e,t){e&&e.SetBlendMode(t)},SetLayerEffectEnabled(e,t,s){if(e){const i=e.GetEffectList(),r=i.GetEffectTypeByName(s);if(r){const n=1===t;r.IsActive()!==n&&(r.SetActive(n),e.UpdateActiveEffects(),this._runtime.UpdateRender())}}},SetLayerEffectParam(e,t,s,i){if(e){const r=e.GetEffectList(),n=r.GetEffectTypeByName(t);if(n){s=Math.floor(s);const a=n.GetShaderProgram().GetParameterType(s);if(a){\"color\"===a?(Uh.setFromRgbValue(i),i=Uh):\"percent\"===a&&(i/=100);const o=r.SetEffectParameter(n.GetIndex(),s,i);o&&n.IsActive()&&this._runtime.UpdateRender()}}}},SetLayerForceOwnTexture(e,t){e&&e.SetForceOwnTexture(t)},SetLayoutScale(e){this._runtime.GetCurrentLayout().SetScale(+e)},SetLayoutAngle(e){this._runtime.GetCurrentLayout().SetAngle(kh.toRadians(+e))},SetLayoutEffectEnabled(e,t){const s=this._runtime.GetCurrentLayout(),i=s.GetEffectList(),r=i.GetEffectTypeByName(t);if(r){const n=1===e;r.IsActive()!==n&&(r.SetActive(n),s.UpdateActiveEffects(),this._runtime.UpdateRender())}},SetLayoutEffectParam(e,t,s){const i=this._runtime.GetCurrentLayout(),r=i.GetEffectList(),n=r.GetEffectTypeByName(e);if(n){t=Math.floor(t);const a=n.GetShaderProgram().GetParameterType(t);if(a){\"color\"===a?(Uh.setFromRgbValue(s),s=Uh):\"percent\"===a&&(s/=100);const o=r.SetEffectParameter(n.GetIndex(),t,s);o&&n.IsActive()&&this._runtime.UpdateRender()}}},SetLayoutVanishingPoint(e,t){const s=this._runtime.GetCurrentLayout();s.SetVanishingPointXY(e/100,t/100)},SetLayoutProjection(e){const t=this._runtime.GetCurrentLayout();0===e?t.SetPerspectiveProjection():t.SetOrthographicProjection()},ScrollX(e){const t=this._runtime.GetCurrentLayout();t.SetScrollX(e)},ScrollY(e){const t=this._runtime.GetCurrentLayout();t.SetScrollY(e)},Scroll(e,t){const s=this._runtime.GetCurrentLayout();s.SetScrollX(e),s.SetScrollY(t)},ScrollToObject(e){if(e){const t=e.GetFirstPicked();if(t){const s=t.GetWorldInfo();if(s){const i=this._runtime.GetCurrentLayout();i.SetScrollX(s.GetX()),i.SetScrollY(s.GetY())}}}},AddLayer(e,t,s){const i=this._runtime.GetCurrentLayout();try{i.AddLayer(e,t,s)}catch(e){console.warn(\"[Construct] Cannot add layer: \",e)}},MoveLayer(e,t,s){if(e){const i=this._runtime.GetCurrentLayout();try{i.MoveLayer(e,t,s)}catch(e){console.warn(\"[Construct] Cannot move layer: \",e)}}},RemoveLayer(e){if(e){const t=this._runtime.GetCurrentLayout();t.RemoveLayer(e)}},RemoveAllDynamicLayers(){this._runtime.GetCurrentLayout().RemoveAllDynamicLayers()},async LoadObjectTextures(e){const t=this._runtime.GetMainRunningLayout();if(t&&e&&!this._runtime.IsLoading()){const s=e.IsFamily()?e.GetFamilyMembers():[e];await this._LoadTexturesForObjectClasses(t,s)}},async LoadObjectTexturesByName(e){await kh.Plugins.System.Acts.LoadObjectTextures.call(this,this._runtime.GetObjectClassByName(e))},UnloadObjectTextures(e){const t=this._runtime.GetMainRunningLayout();if(t&&e){const s=e.IsFamily()?e.GetFamilyMembers():[e];this._UnloadTexturesForObjectClasses(t,s)}},UnloadObjectTexturesByName(e){kh.Plugins.System.Acts.UnloadObjectTextures.call(this,this._runtime.GetObjectClassByName(e))},UnloadUnusedTextures(){const e=this._runtime.GetMainRunningLayout();if(e){const t=e._GetTextureLoadedObjectTypes();this._UnloadTexturesForObjectClasses(e,t)}},async LoadLayoutTextures(e){const t=this._runtime.GetMainRunningLayout();e&&t&&!this._runtime.IsLoading()&&await this._LoadTexturesForObjectClasses(t,e._GetInitialObjectClasses())},async LoadLayoutTexturesByName(e){const t=this._runtime.GetMainRunningLayout(),s=this._runtime.GetLayoutManager().GetLayoutByName(e);s&&t&&!this._runtime.IsLoading()&&await this._LoadTexturesForObjectClasses(t,s._GetInitialObjectClasses())},SetFunctionReturnValue(e){const t=this._eventStack.GetCurrentExpFuncStackFrame();if(t)switch(t.GetFunctionReturnType()){case 1:\"number\"==typeof e&&t.SetFunctionReturnValue(e);break;case 2:\"string\"==typeof e&&t.SetFunctionReturnValue(e);break;case 3:t.SetFunctionReturnValue(e)}},MapFunction(e,t,s){const i=this._GetFunctionMap(e.toLowerCase(),!0),r=i.strMap,n=t.toLowerCase(),a=(r.has(n)&&console.warn(`[Construct] Function map '${e}' string '${t}' already in map; overwriting entry`),kh.first(r.values())||i.defaultFunc);if(a){const o=0!==a.GetReturnType(),h=0!==s.GetReturnType();if(o!=h)return void console.error(`[Construct] Function map '${e}' string '${t}' function return type not compatible with other functions in the map; entry ignored`)}r.set(n,s)},MapFunctionDefault(e,t){const s=this._GetFunctionMap(e.toLowerCase(),!0),i=(s.defaultFunc&&console.warn(`[Construct] Function map '${e}' already has a default; overwriting entry`),kh.first(s.strMap.values())||s.defaultFunc);if(i){const r=0!==i.GetReturnType(),n=0!==t.GetReturnType();if(r!=n)return void console.error(`[Construct] Function map '${e}' default: function return type not compatible with other functions in the map; entry ignored`)}s.defaultFunc=t},CallMappedFunction(e,t,s){const i=this._runtime,r=i.IsDebugging()?jh:null,n=(s=Math.floor(s),this._GetFunctionMap(e.toLowerCase(),!1));if(!n)return console.warn(`[Construct] Call mapped function: map name '${e}' not found; call ignored`),r;let a=n.strMap.get(t.toLowerCase());if(!a){if(!n.defaultFunc)return console.warn(`[Construct] Call mapped function: no function associated with map '${e}' string '${t}'; call ignored (consider setting a default)`),r;a=n.defaultFunc,s=0}if(!a.IsEnabled())return r;if(0!==a.GetReturnType())return console.warn(`[Construct] Call mapped function: map '${e}' string '${t}' has a return type so cannot be called`),r;const o=i.GetEventSheetManager(),h=o.GetCurrentEvent(),l=h.GetSolModifiersIncludingParents(),c=0<l.length,u=(c&&(a.IsCopyPicked()?o.PushCopySol(l):o.PushCleanSol(l)),[]),_=o.FindFirstFunctionBlockParent(h);if(_){const p=_.GetFunctionParameters();for(let e=s,t=p.length;e<t;++e)u.push(p[e].GetValue())}const d=a.GetFunctionParameters();for(let e=u.length,t=d.length;e<t;++e)u.push(d[e].GetInitialValue());return i.IsDebugging()?this._DebugDoCallMappedFunction(o,a,u,c,l):this._DoCallMappedFunction(o,a,u,c,l)}}}{const P=self.C3;P.Plugins.System.Exps={int:function(e){return\"string\"==typeof e&&(e=parseInt(e,10),isNaN(e))&&(e=0),Math.floor(e)},float:function(e){return\"string\"==typeof e&&(e=parseFloat(e),isNaN(e))?0:e},str(e){return e.toString()},len(e){return\"string\"==typeof e?e.length:0},random(e,t){return void 0===t?this._runtime.Random()*e:this._runtime.Random()*(t-e)+e},choose(...e){const t=Math.floor(this._runtime.Random()*e.length);return e[t]},chooseindex(e,...t){return\"number\"!=typeof e&&(e=0),t[e=P.clamp(Math.floor(e),0,t.length-1)]},pi(){return Math.PI},infinity(){return 1/0},sqrt(e){return Math.sqrt(e)},abs(e){return Math.abs(e)},round(e){return Math.round(e)},roundtodp(e,t){t=Math.max(Math.floor(t),0);const s=Math.pow(10,t);return Math.round((e+Number.EPSILON)*s)/s},floor(e){return Math.floor(e)},ceil(e){return Math.ceil(e)},sign(e){return Math.sign(e)},sin(e){return Math.sin(P.toRadians(e))},cos(e){return Math.cos(P.toRadians(e))},tan(e){return Math.tan(P.toRadians(e))},asin(e){return P.toDegrees(Math.asin(e))},acos(e){return P.toDegrees(Math.acos(e))},atan(e){return P.toDegrees(Math.atan(e))},exp(e){return Math.exp(e)},ln(e){return Math.log(e)},log10(e){return Math.log10(e)},max(...s){let i=s[0];\"number\"!=typeof i&&(i=0);for(let t=1,e=s.length;t<e;++t){let e=s[t];\"number\"==typeof e&&i<e&&(i=e)}return i},min(...s){let i=s[0];\"number\"!=typeof i&&(i=0);for(let t=1,e=s.length;t<e;++t){let e=s[t];\"number\"==typeof e&&i>e&&(i=e)}return i},clamp(e,t,s){return P.clamp(e,t,s)},distance(e,t,s,i){return P.distanceTo(e,t,s,i)},angle(e,t,s,i){return P.toDegrees(P.angleTo(e,t,s,i))},lerp(e,t,s){return P.lerp(e,t,s)},unlerp(e,t,s){return P.unlerp(e,t,s)},qarp(e,t,s,i){return P.qarp(e,t,s,i)},cubic(e,t,s,i,r){return P.cubic(e,t,s,i,r)},cosp(e,t,s){return P.cosp(e,t,s)},anglediff(e,t){return P.toDegrees(P.angleDiff(P.toRadians(e),P.toRadians(t)))},anglelerp(e,t,s){return P.toDegrees(P.angleLerp(P.toRadians(e),P.toRadians(t),s))},anglerotate(e,t,s){return P.toDegrees(P.angleRotate(P.toRadians(e),P.toRadians(t),P.toRadians(s)))},setbit(e,t,s){return(e|=0)&~(1<<(t|=0))|(s=0!==s?1:0)<<t},togglebit(e,t){return(e|=0)^1<<(0|t)},getbit(e,t){return(e|=0)&1<<(0|t)?1:0},newline(){return\"\\n\"},uppercase(e){return\"string\"==typeof e?e.toUpperCase():\"\"},lowercase(e){return\"string\"==typeof e?e.toLowerCase():\"\"},left(e,t){return\"string\"==typeof e?e.substr(0,t):\"\"},mid(e,t,s){return\"string\"!=typeof e?\"\":s<0?e.substr(t):e.substr(t,s)},right(e,t){return\"string\"==typeof e?e.substr(Math.max(e.length-t,0)):\"\"},trim(e){return\"string\"==typeof e?e.trim():\"\"},tokenat(e,t,s){if(\"string\"!=typeof e||\"string\"!=typeof s)return\"\";let i=e.split(s);return(t=Math.floor(t))<0||t>=i.length?\"\":i[t]},tokencount(e,t){return\"string\"==typeof e&&\"string\"==typeof t&&e.length?e.split(t).length:0},find(e,t){return\"string\"==typeof e&&\"string\"==typeof t?e.search(new RegExp(P.EscapeRegex(t),\"i\")):-1},findcase(e,t){return\"string\"==typeof e&&\"string\"==typeof t?e.search(new RegExp(P.EscapeRegex(t),\"\")):-1},replace(e,t,s){return\"string\"==typeof e&&\"string\"==typeof t&&\"string\"==typeof s?e.replace(new RegExp(P.EscapeRegex(t),\"gi\"),s):\"string\"==typeof e?e:\"\"},stringsub(e,...s){let i=e;for(let e=0,t=s.length;e<t;++e)i=i.replaceAll(`{${e}}`,s[e].toString());return i},regexsearch(e,t,s){const i=this.GetRegex(t,s);return e?e.search(i):-1},regexreplace(e,t,s,i){const r=this.GetRegex(t,s);return e?e.replace(r,i):\"\"},regexmatchcount(e,t,s){const i=this.GetRegexMatches(e.toString(),t,s);return i?i.length:0},regexmatchat(e,t,s,i){i=Math.floor(i);const r=this.GetRegexMatches(e.toString(),t,s);return!r||i<0||i>=r.length?\"\":r[i]},zeropad(e,t){let s=e<0?\"-\":\"\",i=t-(e=e<0?-e:e).toString().length;return(s+=\"0\".repeat(Math.max(i,0)))+e.toString()},urlencode(e){return encodeURIComponent(e)},urldecode(e){return decodeURIComponent(e)},dt(){return this._runtime._GetDtFast()},timescale(){return this._runtime.GetTimeScale()},wallclocktime(){return(Date.now()-this._runtime.GetStartTime())/1e3},unixtime(){return Date.now()},time(){return this._runtime.GetGameTime()},tickcount(){return this._runtime.GetTickCount()},objectcount(){return this._runtime.GetObjectCount()},fps(){return this._runtime.GetFramesPerSecond()},cpuutilisation(){return this._runtime.GetMainThreadTime()},gpuutilisation(){return this._runtime.GetGPUUtilisation()},windowwidth(){return this._runtime.GetCanvasManager().GetDeviceWidth()},windowheight(){return this._runtime.GetCanvasManager().GetDeviceHeight()},originalwindowwidth(){return this._runtime.GetOriginalViewportWidth()},originalwindowheight(){return this._runtime.GetOriginalViewportHeight()},originalviewportwidth(){return this._runtime.GetOriginalViewportWidth()},originalviewportheight(){return this._runtime.GetOriginalViewportHeight()},scrollx(){return this._runtime.GetCurrentLayout().GetScrollX()},scrolly(){return this._runtime.GetCurrentLayout().GetScrollY()},layoutname(){return this._runtime.GetCurrentLayout().GetName()},layoutscale(){return this._runtime.GetCurrentLayout().GetScale()},layoutangle(){return P.toDegrees(this._runtime.GetCurrentLayout().GetAngle())},layoutwidth(){return this._runtime.GetCurrentLayout().GetWidth()},layoutheight(){return this._runtime.GetCurrentLayout().GetHeight()},vanishingpointx(){return 100*this._runtime.GetCurrentLayout().GetVanishingPointX()},vanishingpointy(){return 100*this._runtime.GetCurrentLayout().GetVanishingPointY()},viewportleft(e){const t=this._runtime.GetCurrentLayout().GetLayer(e);return t?t.GetViewport3D().getLeft():0},viewporttop(e){const t=this._runtime.GetCurrentLayout().GetLayer(e);return t?t.GetViewport3D().getTop():0},viewportright(e){const t=this._runtime.GetCurrentLayout().GetLayer(e);return t?t.GetViewport3D().getRight():0},viewportbottom(e){const t=this._runtime.GetCurrentLayout().GetLayer(e);return t?t.GetViewport3D().getBottom():0},viewportwidth(e){const t=this._runtime.GetCurrentLayout().GetLayer(e);return t?t.GetViewport3D().width():0},viewportheight(e){const t=this._runtime.GetCurrentLayout().GetLayer(e);return t?t.GetViewport3D().height():0},viewportmidx(e){const t=this._runtime.GetCurrentLayout().GetLayer(e);if(t){const s=t.GetViewport3D();return(s.getLeft()+s.getRight())/2}return 0},viewportmidy(e){const t=this._runtime.GetCurrentLayout().GetLayer(e);if(t){const s=t.GetViewport3D();return(s.getTop()+s.getBottom())/2}return 0},canvastolayerx(e,t,s){const i=this._runtime.GetCurrentLayout().GetLayer(e);return i?i.CanvasCssToLayer(t,s)[0]:0},canvastolayery(e,t,s){const i=this._runtime.GetCurrentLayout().GetLayer(e);return i?i.CanvasCssToLayer(t,s)[1]:0},layertocanvasx(e,t,s){const i=this._runtime.GetCurrentLayout().GetLayer(e);return i?i.LayerToCanvasCss(t,s)[0]:0},layertocanvasy(e,t,s){const i=this._runtime.GetCurrentLayout().GetLayer(e);return i?i.LayerToCanvasCss(t,s)[1]:0},layertolayerx(e,t,s,i){const r=this._runtime.GetCurrentLayout(),n=r.GetLayer(e),a=r.GetLayer(t);if(!n||!a||n===a)return s;const[o,h]=n.LayerToCanvasCss(s,i);return a.CanvasCssToLayer(o,h)[0]},layertolayery(e,t,s,i){const r=this._runtime.GetCurrentLayout(),n=r.GetLayer(e),a=r.GetLayer(t);if(!n||!a||n===a)return i;const[o,h]=n.LayerToCanvasCss(s,i);return a.CanvasCssToLayer(o,h)[1]},layerscale(e){const t=this._runtime.GetCurrentLayout().GetLayer(e);return t?t.GetOwnScale():0},layerangle(e){const t=this._runtime.GetCurrentLayout().GetLayer(e);return t?P.toDegrees(t.GetOwnAngle()):0},layeropacity(e){const t=this._runtime.GetCurrentLayout().GetLayer(e);return t?100*t.GetOpacity():0},layerscalerate(e){const t=this._runtime.GetCurrentLayout().GetLayer(e);return t?t.GetScaleRate():0},layerscrollx(e){const t=this._runtime.GetCurrentLayout().GetLayer(e);return t?t.GetScrollX():0},layerscrolly(e){const t=this._runtime.GetCurrentLayout().GetLayer(e);return t?t.GetScrollY():0},layerparallaxx(e){const t=this._runtime.GetCurrentLayout().GetLayer(e);return t?100*t.GetParallaxX():0},layerparallaxy(e){const t=this._runtime.GetCurrentLayout().GetLayer(e);return t?100*t.GetParallaxY():0},layerzelevation(e){const t=this._runtime.GetCurrentLayout().GetLayer(e);return t?t.GetZElevation():0},layerindex(e){const t=this._runtime.GetCurrentLayout().GetLayer(e);return t?t.GetIndex():-1},canvassnapshot(){const e=this._runtime.GetCanvasManager();return e?e.GetCanvasSnapshotUrl():\"\"},loopindex(e){const t=this._loopStack;if(!t.IsInLoop())return 0;if(e){const s=t.FindByName(e);return s?s.GetIndex():0}return t.GetCurrent().GetIndex()},savestatejson(){return this._runtime.GetLastSaveJsonString()},callmapped(e,t,...s){const i=this._GetFunctionMap(e.toLowerCase(),!1);if(!i)return console.warn(`[Construct] Call mapped function: map name '${e}' not found; returning 0`),0;let r=i.strMap.get(t.toLowerCase());if(!r){if(!i.defaultFunc)return console.warn(`[Construct] Call mapped function: no function associated with map '${e}' string '${t}'; returning 0 (consider setting a default)`),0;r=i.defaultFunc}const n=r.GetReturnType(),a=r.GetDefaultReturnValue();if(0===n)return console.warn(`[Construct] Call mapped function: map '${e}' string '${t}' has no return type so cannot be called from an expression; returning 0`),0;if(!r.IsEnabled())return a;const o=this._runtime,h=o.GetEventSheetManager(),l=h.GetCurrentEvent(),c=l.GetSolModifiersIncludingParents(),u=0<c.length,_=(u&&(r.IsCopyPicked()?h.PushCopySol(c):h.PushCleanSol(c)),r.GetFunctionParameters());for(let e=s.length,t=_.length;e<t;++e)s.push(_[e].GetInitialValue());const d=r.GetEventBlock(),p=d.RunAsExpressionFunctionCall(d.GetSolModifiersIncludingParents(),r.IsCopyPicked(),n,a,...s);return u&&h.PopSol(c),p},loadingprogress(){return this._runtime.GetAssetManager().GetLoadProgress()},imageloadingprogress(){return 0===this._imagesLoadingTotal?1:this._imagesLoadingComplete/this._imagesLoadingTotal},renderer(){return this._runtime.GetWebGPURenderer()?\"webgpu\":\"webgl\"},rendererdetail(){return this._runtime.GetWebGPURenderer()?this._runtime.GetWebGPURenderer().GetAdapterInfoString():this._runtime.GetWebGLRenderer().GetUnmaskedRenderer()},imagememoryusage(){let e=this._runtime.GetRenderer().GetEstimatedTextureMemoryUsage();return Math.round(100*e/1048576)/100},rgb(e,t,s){return P.PackRGB(e,t,s)},rgbex(e,t,s){return P.PackRGBEx(e/100,t/100,s/100)},rgba(e,t,s,i){return P.PackRGBAEx(e/100,t/100,s/100,i/100)},rgbex255(e,t,s){return P.PackRGBEx(e/255,t/255,s/255)},rgba255(e,t,s,i){return P.PackRGBAEx(e/255,t/255,s/255,i/255)},projectname(){return this._runtime.GetProjectName()},projectversion(){return this._runtime.GetProjectVersion()},currenteventsheetname(){return this._runtime.GetCurrentEvent().GetEventSheet().GetName()},currenteventnumber(){return this._runtime.GetCurrentEvent().GetDisplayNumber()}}}{const Hh=self.C3;Hh.Plugins.TiledBg=class extends Hh.SDKPluginBase{constructor(e){super(e)}Release(){super.Release()}}}{let s=function(e){switch(e){case 0:return\"clamp-to-edge\";case 1:return\"repeat\";case 2:return\"mirror-repeat\"}return\"repeat\"};s;const Xh=self.C3;Xh.Plugins.TiledBg.Type=class extends Xh.SDKTypeBase{constructor(e,t){super(e),this._wrapX=\"repeat\",this._wrapY=\"repeat\",t&&(this._wrapX=s(t[0]),this._wrapY=s(t[1]))}Release(){super.Release()}OnCreate(){this.GetImageInfo().LoadAsset(this._runtime)}LoadTextures(e){return this.GetImageInfo().LoadStaticTexture(e,{sampling:this._runtime.GetSampling(),wrapX:this._wrapX,wrapY:this._wrapY})}ReleaseTextures(){this.GetImageInfo().ReleaseTexture()}GetWrapModeX(){return this._wrapX}GetWrapModeY(){return this._wrapY}}}{const zh=self.C3,Yh=self.C3X,qh=zh.New(zh.Rect),Kh=zh.New(zh.Quad),Jh=zh.New(zh.Rect),Zh=zh.New(zh.Quad),R=(zh.Plugins.TiledBg.Instance=class extends zh.SDKWorldInstanceBase{constructor(e,t){super(e),this._imageOffsetX=0,this._imageOffsetY=0,this._imageScaleX=1,this._imageScaleY=1,this._imageAngle=0,this._enableTileRandomization=!1,this._tileXRandom=0,this._tileYRandom=0,this._tileAngleRandom=0,this._tileBlendMarginX=0,this._tileBlendMarginY=0,this._ownImageInfo=null,t&&(this.GetWorldInfo().SetVisible(!!t[0]),this._imageOffsetX=t[4],this._imageOffsetY=t[5],this._imageScaleX=t[6],this._imageScaleY=t[7],this._imageAngle=zh.toRadians(t[8]),this._enableTileRandomization=!!t[9],this._tileXRandom=t[10],this._tileYRandom=t[11],this._tileAngleRandom=t[12],this._tileBlendMarginX=t[13],this._tileBlendMarginY=t[14])}Release(){this._ReleaseOwnImage(),super.Release()}_ReleaseOwnImage(){this._ownImageInfo&&(this._ownImageInfo.Release(),this._ownImageInfo=null)}CalculateTextureCoordsFor3DFace(e,t,s){const i=this.GetCurrentImageInfo(),r=i.GetWidth(),n=i.GetHeight(),a=this._imageOffsetX/r,o=this._imageOffsetY/n,h=this._imageAngle;Jh.set(0,0,e/(r*this._imageScaleX),t/(n*this._imageScaleY)),Jh.offset(-a,-o),0===h?s.setFromRect(Jh):s.setFromRotatedRect(Jh,-h)}SetTilingShaderProgram(e,t=!0){if(this._enableTileRandomization){const s=this.GetCurrentImageInfo();e.SetTileRandomizationMode(),e.SetTileRandomizationInfo(s.GetWidth()*this._imageScaleX,s.GetHeight()*this._imageScaleY,this._tileXRandom,this._tileYRandom,this._tileAngleRandom,this._tileBlendMarginX,this._tileBlendMarginY)}else t&&e.SetTextureFillMode()}Draw(e){const t=this.GetCurrentImageInfo(),s=t.GetTexture();if(null!==s){this.SetTilingShaderProgram(e),e.SetTexture(s);const i=t.GetWidth(),r=t.GetHeight(),n=this._imageOffsetX/i,a=this._imageOffsetY/r,o=this.GetWorldInfo();Jh.set(0,0,o.GetWidth()/(i*this._imageScaleX),o.GetHeight()/(r*this._imageScaleY)),Jh.offset(-n,-a),o.HasMesh()?this._DrawMesh(o,e):this._DrawStandard(o,e)}}_DrawStandard(e,t){let s=e.GetBoundingQuad();this._runtime.IsPixelRoundingEnabled()&&(s=e.PixelRoundQuad(s)),0===this._imageAngle?t.Quad3(s,Jh):(Zh.setFromRotatedRect(Jh,-this._imageAngle),t.Quad4(s,Zh))}_DrawMesh(s,e){const i=s.GetTransformedMesh();if(s.IsMeshChanged()){s.CalculateBbox(qh,Kh,!1);let e=Kh,t=(this._runtime.IsPixelRoundingEnabled()&&(e=s.PixelRoundQuad(e)),Jh);0!==this._imageAngle&&(Zh.setFromRotatedRect(Jh,-this._imageAngle),t=Zh),i.CalculateTransformedMesh(s.GetSourceMesh(),e,t),s.SetMeshChanged(!1)}i.Draw(e)}GetCurrentImageInfo(){return this._ownImageInfo||this._objectClass.GetImageInfo()}IsOriginalSizeKnown(){return!0}GetTexture(){return this.GetCurrentImageInfo().GetTexture()}_SetMeshChanged(){this.GetWorldInfo().SetMeshChanged(!0)}_SetImageOffsetX(e){this._imageOffsetX!==e&&(this._imageOffsetX=e,this._runtime.UpdateRender(),this._SetMeshChanged())}_GetImageOffsetX(){return this._imageOffsetX}_SetImageOffsetY(e){this._imageOffsetY!==e&&(this._imageOffsetY=e,this._runtime.UpdateRender(),this._SetMeshChanged())}_GetImageOffsetY(){return this._imageOffsetY}_SetImageScaleX(e){this._imageScaleX!==e&&(this._imageScaleX=e,this._runtime.UpdateRender(),this._SetMeshChanged())}_GetImageScaleX(){return this._imageScaleX}_SetImageScaleY(e){this._imageScaleY!==e&&(this._imageScaleY=e,this._runtime.UpdateRender(),this._SetMeshChanged())}_GetImageScaleY(){return this._imageScaleY}_SetImageAngle(e){this._imageAngle!==e&&(this._imageAngle=e,this._runtime.UpdateRender(),this._SetMeshChanged())}_GetImageAngle(){return this._imageAngle}_SetTileRandomizationEnabled(e){this._enableTileRandomization!==(e=!!e)&&(this._enableTileRandomization=e,this._runtime.UpdateRender())}_IsTileRandomizationEnabled(){return this._enableTileRandomization}_SetTileXRandom(e){this._tileXRandom!==e&&(this._tileXRandom=e,this._IsTileRandomizationEnabled())&&this._runtime.UpdateRender()}_GetTileXRandom(){return this._tileXRandom}_SetTileYRandom(e){this._tileYRandom!==e&&(this._tileYRandom=e,this._IsTileRandomizationEnabled())&&this._runtime.UpdateRender()}_GetTileYRandom(){return this._tileYRandom}_SetTileAngleRandom(e){this._tileAngleRandom!==e&&(this._tileAngleRandom=e,this._IsTileRandomizationEnabled())&&this._runtime.UpdateRender()}_GetTileAngleRandom(){return this._tileAngleRandom}_SetTileBlendMarginX(e){this._tileBlendMarginX!==e&&(this._tileBlendMarginX=e,this._IsTileRandomizationEnabled())&&this._runtime.UpdateRender()}_GetTileBlendMarginX(){return this._tileBlendMarginX}_SetTileBlendMarginY(e){this._tileBlendMarginY!==e&&(this._tileBlendMarginY=e,this._IsTileRandomizationEnabled())&&this._runtime.UpdateRender()}_GetTileBlendMarginY(){return this._tileBlendMarginY}SaveToJson(){const e={};return 0!==this._imageOffsetX&&(e.iox=this._imageOffsetX),0!==this._imageOffsetY&&(e.ioy=this._imageOffsetY),1!==this._imageScaleX&&(e.isx=this._imageScaleX),1!==this._imageScaleY&&(e.isy=this._imageScaleY),0!==this._imageAngle&&(e.ia=this._imageAngle),this._enableTileRandomization&&(e.tr=!0),1!==this._tileXRandom&&(e.trx=this._tileXRandom),1!==this._tileYRandom&&(e.try=this._tileYRandom),1!==this._tileAngleRandom&&(e.tra=this._tileAngleRandom),.1!==this._tileBlendMarginX&&(e.trbmx=this._tileBlendMarginX),.1!==this._tileBlendMarginY&&(e.trbmy=this._tileBlendMarginY),e}LoadFromJson(e){this._imageOffsetX=e.iox||0,this._imageOffsetY=e.ioy||0,this._imageScaleX=e.hasOwnProperty(\"isx\")?e.isx:1,this._imageScaleY=e.hasOwnProperty(\"isy\")?e.isy:1,this._imageAngle=e.ia||0,this._enableTileRandomization=!!e.tr,this._tileXRandom=e.hasOwnProperty(\"trx\")?e.trx:1,this._tileYRandom=e.hasOwnProperty(\"try\")?e.try:1,this._tileAngleRandom=e.hasOwnProperty(\"tra\")?e.tra:1,this._tileBlendMarginX=e.hasOwnProperty(\"trbmx\")?e.trbmx:.1,this._tileBlendMarginY=e.hasOwnProperty(\"trbmy\")?e.trbmy:.1}GetDebuggerProperties(){const e=\"plugins.tiledbg.properties\";return[{title:e+\".image-transform.name\",properties:[{name:e+\".image-offset-x.name\",value:this._GetImageOffsetX(),onedit:e=>this._SetImageOffsetX(e)},{name:e+\".image-offset-y.name\",value:this._GetImageOffsetY(),onedit:e=>this._SetImageOffsetY(e)},{name:e+\".image-scale-x.name\",value:100*this._GetImageScaleX(),onedit:e=>this._SetImageScaleX(e/100)},{name:e+\".image-scale-y.name\",value:100*this._GetImageScaleY(),onedit:e=>this._SetImageScaleY(e/100)},{name:e+\".image-angle.name\",value:zh.toDegrees(this._GetImageAngle()),onedit:e=>this._SetImageAngle(zh.toRadians(e))}]},{title:e+\".tile-randomization.name\",properties:[{name:e+\".enable-tile-randomization.name\",value:this._IsTileRandomizationEnabled(),onedit:e=>this._SetTileRandomizationEnabled(e)},{name:e+\".x-random.name\",value:100*this._GetTileXRandom(),onedit:e=>this._SetTileXRandom(e/100)},{name:e+\".y-random.name\",value:100*this._GetTileYRandom(),onedit:e=>this._SetTileYRandom(e/100)},{name:e+\".angle-random.name\",value:100*this._GetTileAngleRandom(),onedit:e=>this._SetTileAngleRandom(e/100)},{name:e+\".blend-margin-x.name\",value:100*this._GetTileBlendMarginX(),onedit:e=>this._SetTileBlendMarginX(e/100)},{name:e+\".blend-margin-y.name\",value:100*this._GetTileBlendMarginY(),onedit:e=>this._SetTileBlendMarginY(e/100)}]}]}GetPropertyValueByIndex(e){switch(e){case 4:return this._GetImageOffsetX();case 5:return this._GetImageOffsetY();case 6:return this._GetImageScaleX();case 7:return this._GetImageScaleY();case 8:return this._GetImageAngle();case 9:return this._IsTileRandomizationEnabled();case 10:return this._GetTileXRandom();case 11:return this._GetTileYRandom();case 12:return this._GetTileAngleRandom();case 13:return this._GetTileBlendMarginX();case 14:return this._GetTileBlendMarginY()}}SetPropertyValueByIndex(e,t){switch(e){case 4:this._SetImageOffsetX(t);break;case 5:this._SetImageOffsetY(t);break;case 6:this._SetImageScaleX(t);break;case 7:this._SetImageScaleY(t);break;case 8:this._SetImageAngle(t);break;case 9:this._SetTileRandomizationEnabled(!!t);break;case 10:this._SetTileXRandom(t);break;case 11:this._SetTileYRandom(t);break;case 12:this._SetTileAngleRandom(t);break;case 13:this._SetTileBlendMarginX(t);break;case 14:this._SetTileBlendMarginY(t)}}GetScriptInterfaceClass(){return self.ITiledBackgroundInstance}},new WeakMap);self.ITiledBackgroundInstance=class extends self.IWorldInstance{constructor(){super(),R.set(this,self.IInstance._GetInitInst().GetSdkInstance())}set imageOffsetX(e){Yh.RequireFiniteNumber(e),R.get(this)._SetImageOffsetX(e)}get imageOffsetX(){return R.get(this)._GetImageOffsetX()}set imageOffsetY(e){Yh.RequireFiniteNumber(e),R.get(this)._SetImageOffsetY(e)}get imageOffsetY(){return R.get(this)._GetImageOffsetY()}setImageOffset(e,t){Yh.RequireFiniteNumber(e),Yh.RequireFiniteNumber(t);const s=R.get(this);s._SetImageOffsetX(e),s._SetImageOffsetY(t)}getImageOffset(){const e=R.get(this);return[e._GetImageOffsetX(),e._GetImageOffsetY()]}set imageScaleX(e){Yh.RequireFiniteNumber(e),R.get(this)._SetImageScaleX(e)}get imageScaleX(){return R.get(this)._GetImageScaleX()}set imageScaleY(e){Yh.RequireFiniteNumber(e),R.get(this)._SetImageScaleY(e)}get imageScaleY(){return R.get(this)._GetImageScaleY()}setImageScale(e,t){Yh.RequireFiniteNumber(e),Yh.RequireFiniteNumber(t);const s=R.get(this);s._SetImageScaleX(e),s._SetImageScaleY(t)}getImageScale(){const e=R.get(this);return[e._GetImageScaleX(),e._GetImageScaleY()]}set imageAngle(e){Yh.RequireFiniteNumber(e),R.get(this)._SetImageAngle(e)}get imageAngle(){return R.get(this)._GetImageAngle()}set imageAngleDegrees(e){Yh.RequireFiniteNumber(e),R.get(this)._SetImageAngle(zh.toRadians(e))}get imageAngleDegrees(){return zh.toDegrees(R.get(this)._GetImageAngle())}get imageWidth(){return R.get(this).GetCurrentImageInfo().GetWidth()}get imageHeight(){return R.get(this).GetCurrentImageInfo().GetHeight()}getImageSize(){const e=R.get(this).GetCurrentImageInfo();return[e.GetWidth(),e.GetHeight()]}set enableTileRandomization(e){R.get(this)._SetTileRandomizationEnabled(!!e)}get enableTileRandomization(){return R.get(this)._IsTileRandomizationEnabled()}set tileXRandom(e){Yh.RequireFiniteNumber(e),R.get(this)._SetTileXRandom(e)}get tileXRandom(){return R.get(this)._GetTileXRandom()}set tileYRandom(e){Yh.RequireFiniteNumber(e),R.get(this)._SetTileYRandom(e)}get tileYRandom(){return R.get(this)._GetTileYRandom()}setTileRandom(e,t){Yh.RequireFiniteNumber(e),Yh.RequireFiniteNumber(t);const s=R.get(this);s._SetTileXRandom(e),s._SetTileYRandom(t)}getTileRandom(){const e=R.get(this);return[e._GetTileXRandom(),e._GetTileYRandom()]}set tileAngleRandom(e){Yh.RequireFiniteNumber(e),R.get(this)._SetTileAngleRandom(e)}get tileAngleRandom(){return R.get(this)._GetTileAngleRandom()}set tileBlendMarginX(e){Yh.RequireFiniteNumber(e),R.get(this)._SetTileBlendMarginX(e)}get tileBlendMarginX(){return R.get(this)._GetTileBlendMarginX()}set tileBlendMarginY(e){Yh.RequireFiniteNumber(e),R.get(this)._SetTileBlendMarginY(e)}get tileBlendMarginY(){return R.get(this)._GetTileBlendMarginY()}setTileBlendMargin(e,t){Yh.RequireFiniteNumber(e),Yh.RequireFiniteNumber(t);const s=R.get(this);s._SetTileBlendMarginX(e),s._SetTileBlendMarginY(t)}getTileBlendMargin(){const e=R.get(this);return[e._GetTileBlendMarginX(),e._GetTileBlendMarginY()]}async replaceImage(e){Yh.RequireInstanceOf(e,Blob);const t=R.get(this),s=t.GetRuntime(),i=zh.New(zh.ImageInfo);i.LoadDynamicBlobAsset(s,e),await i.LoadStaticTexture(s.GetRenderer(),{sampling:s.GetSampling(),wrapX:t.GetSdkType().GetWrapModeX(),wrapY:t.GetSdkType().GetWrapModeY()}),t.WasReleased()?i.Release():(t._ReleaseOwnImage(),t._ownImageInfo=i,s.UpdateRender())}}}{const Qh=self.C3;Qh.Plugins.TiledBg.Cnds={OnURLLoaded(){return!0},OnURLFailed(){return!0},IsTileRandomizationEnabled(){return this._IsTileRandomizationEnabled()}}}{const $h=self.C3;$h.Plugins.TiledBg.Acts={SetImageOffsetX(e){this._SetImageOffsetX(e)},SetImageOffsetY(e){this._SetImageOffsetY(e)},SetImageScaleX(e){this._SetImageScaleX(e/100)},SetImageScaleY(e){this._SetImageScaleY(e/100)},SetImageAngle(e){this._SetImageAngle($h.toRadians(e))},SetTileRandomizationEnabled(e){this._SetTileRandomizationEnabled(e)},SetTilePosRandom(e,t){this._SetTileXRandom(e/100),this._SetTileYRandom(t/100)},SetTileAngleRandom(e){this._SetTileAngleRandom(e/100)},SetTileBlendMargin(e,t){this._SetTileBlendMarginX(e/100),this._SetTileBlendMarginY(t/100)},SetEffect(e){this.GetWorldInfo().SetBlendMode(e),this._runtime.UpdateRender()},async LoadURL(e,t){if(!this._ownImageInfo||this._ownImageInfo.GetURL()!==e){const s=this._runtime,i=$h.New($h.ImageInfo);try{if(await i.LoadDynamicAsset(s,e),!i.IsLoaded())throw new Error(\"image failed to load\");if(this.WasReleased())return i.Release(),null;const r=await i.LoadStaticTexture(s.GetRenderer(),{sampling:s.GetSampling(),wrapX:this.GetSdkType().GetWrapModeX(),wrapY:this.GetSdkType().GetWrapModeY()});if(!r)return}catch(e){return console.error(\"Load image from URL failed: \",e),void(this.WasReleased()||this.Trigger($h.Plugins.TiledBg.Cnds.OnURLFailed))}this.WasReleased()?i.Release():(this._ReleaseOwnImage(),this._ownImageInfo=i,s.UpdateRender(),await this.TriggerAsync($h.Plugins.TiledBg.Cnds.OnURLLoaded))}}}}{const el=self.C3;el.Plugins.TiledBg.Exps={ImageWidth(){return this.GetCurrentImageInfo().GetWidth()},ImageHeight(){return this.GetCurrentImageInfo().GetHeight()},ImageOffsetX(){return this._imageOffsetX},ImageOffsetY(){return this._imageOffsetY},ImageScaleX(){return 100*this._imageScaleX},ImageScaleY(){return 100*this._imageScaleY},ImageAngle(){return el.toDegrees(this._imageAngle)},TileXRandom(){return 100*this._GetTileXRandom()},TileYRandom(){return 100*this._GetTileYRandom()},TileAngleRandom(){return 100*this._GetTileAngleRandom()},TileBlendMarginX(){return 100*this._GetTileBlendMarginX()},TileBlendMarginY(){return 100*this._GetTileBlendMarginY()}}}{const tl=self.C3;tl.Plugins.Text=class extends tl.SDKPluginBase{constructor(e){super(e)}Release(){super.Release()}}}{const sl=self.C3;sl.Plugins.Text.Type=class extends sl.SDKTypeBase{constructor(e){super(e)}Release(){super.Release()}OnCreate(){}LoadTextures(e){}ReleaseTextures(){}}}{const il=self.C3,rl=self.C3X,nl=[0,0,0],al=[\"left\",\"center\",\"right\"],ol=[\"top\",\"center\",\"bottom\"],hl=[\"ltr\",\"rtl\"],ll=[\"word\",\"cjk\",\"character\"],cl=new il.Rect,ul=new il.Quad,_l=new il.Color,dl=il.New(il.Vector2),pl=new Map([[\"b\",\"strong\"],[\"i\",\"em\"],[\"s\",\"s\"],[\"u\",\"u\"],[\"iconoffsety\",null]]),A=(il.Plugins.Text.Instance=class extends il.SDKWorldInstanceBase{constructor(e,t){if(super(e),this._text=\"\",this._enableBBcode=!0,this._faceName=\"Arial\",this._ptSize=12,this._lineHeightOffset=0,this._isBold=!1,this._isItalic=!1,this._color=il.New(il.Color),this._horizontalAlign=0,this._verticalAlign=0,this._wrapMode=\"word\",this._textDirection=0,this._resolutionMode=\"auto\",this._fixedScaleFactor=1,this._iconObjectClass=null,this._htmlString=\"\",this._isHtmlStringUpToDate=!1,this._readAloud=!1,this._screenReaderText=null,this._typewriterStartTime=-1,this._typewriterEndTime=-1,this._typewriterLength=0,this._rendererText=il.New(il.Gfx.RendererText,this._runtime.GetRenderer(),{timeout:5}),this._rendererText.ontextureupdate=()=>this._runtime.UpdateRender(),this._animationframeimagechange_handler=()=>this._OnIconObjectClassImageChanged(),this._pendingUpdateIconSet=!1,t){this._text=t[0],this._enableBBcode=!!t[1],this._faceName=t[2],this._ptSize=t[3],this._lineHeightOffset=t[4],this._isBold=!!t[5],this._isItalic=!!t[6],this._horizontalAlign=t[8],this._verticalAlign=t[9],this._wrapMode=ll[t[10]],this._textDirection=t[11],this._SetIconObjectClass(this._runtime.GetObjectClassBySID(t[12]));const s=t[7];this._color.setRgb(s[0],s[1],s[2]),this.GetWorldInfo().SetVisible(t[13]),this._readAloud=!!t[15]}this._UpdateTextSettings(),this._UpdateScreenReaderText()}Release(){this._SetIconObjectClass(null),this._CancelTypewriter(),this._screenReaderText&&(this._screenReaderText.Release(),this._screenReaderText=null),this._rendererText.Release(),this._rendererText=null,super.Release()}_UpdateTextSettings(){const e=this._rendererText;e.SetText(this._text),e.SetBBCodeEnabled(this._enableBBcode),this._rendererText.IsBBCodeEnabled()&&this._iconObjectClass?this._rendererText.SetIconSet(this.GetRuntime().GetTextIconSet(this._iconObjectClass)):this._rendererText.SetIconSet(null),e.SetIconSmoothing(\"nearest\"!==this._runtime.GetSampling()),e.SetFontName(this._faceName),e.SetLineHeight(this._lineHeightOffset),e.SetBold(this._isBold),e.SetItalic(this._isItalic),e.SetColor(this._color),e.SetHorizontalAlignment(al[this._horizontalAlign]),e.SetVerticalAlignment(ol[this._verticalAlign]),e.SetWordWrapMode(this._wrapMode),e.SetTextDirection(hl[this._textDirection])}_UpdateTextSize(){let e=this.GetWorldInfo(),t=(this._rendererText.SetFontSize(this._ptSize),this._rendererText.SetFontSizeScale(e.GetSceneGraphScale()),e.GetLayer()),s;\"auto\"===this._resolutionMode?s=t.GetResolutionScaleFactorToZ(e.GetTotalZElevation()):\"fixed\"===this._resolutionMode&&(s=this._fixedScaleFactor),e.HasMesh()&&s!==this._rendererText.GetZoom()&&e.SetMeshChanged(!0),this._rendererText.SetSize(e.GetWidth(),e.GetHeight(),s)}_SetIconObjectClass(e){e&&(e.IsFamily()||e.GetPlugin().constructor!==il.Plugins.Sprite)||e!==this._iconObjectClass&&(this._iconObjectClass&&this._iconObjectClass.Dispatcher().removeEventListener(\"animationframeimagechange\",this._animationframeimagechange_handler),this._iconObjectClass=e,this._iconObjectClass&&this._iconObjectClass.Dispatcher().addEventListener(\"animationframeimagechange\",this._animationframeimagechange_handler),this._UpdateTextSettings(),this._isHtmlStringUpToDate=!1,this._runtime.UpdateRender())}_OnIconObjectClassImageChanged(){this._runtime.DeleteTextIconSet(this._iconObjectClass),this._runtime.UpdateRender(),this._pendingUpdateIconSet=!0}_UpdateScreenReaderText(){if(this._readAloud){let e=this._text;this._enableBBcode&&(e=il.BBString.StripAnyTags(e)),this._screenReaderText?this._screenReaderText.SetText(e):this._screenReaderText=il.New(il.ScreenReaderText,this._runtime,e)}else this._screenReaderText&&(this._screenReaderText.Release(),this._screenReaderText=null)}Draw(e){const t=this.GetWorldInfo(),s=(this._UpdateTextSize(),this._pendingUpdateIconSet&&(this._pendingUpdateIconSet=!1,this._rendererText.IsBBCodeEnabled())&&this._iconObjectClass&&this._rendererText.SetIconSet(this.GetRuntime().GetTextIconSet(this._iconObjectClass)),this._rendererText.GetTexture());if(s){const i=t.GetLayer();if(0===t.GetAngle()&&0===i.GetAngle()&&0===t.GetTotalZElevation()&&!t.HasMesh()&&i.RendersIn2DMode()){const r=t.GetBoundingQuad(),[n,a]=i.LayerToDrawSurface(r.getTlx(),r.getTly()),[o,h]=i.LayerToDrawSurface(r.getBrx(),r.getBry()),l=n-Math.round(n),c=a-Math.round(a),[u,_]=(cl.set(n,a,o,h),cl.offset(-l,-c),ul.setFromRect(cl),e.GetRenderTargetSize(e.GetRenderTarget()));this._runtime.GetCanvasManager().SetDeviceTransform(e,u,_),e.SetTexture(s),e.Quad3(ul,this._rendererText.GetTexRect()),i._SetTransform(e)}else e.SetTexture(s),t.HasMesh()?this._DrawMesh(t,e):this._DrawStandard(t,e)}}_DrawStandard(e,t){let s=e.GetBoundingQuad();this._runtime.IsPixelRoundingEnabled()&&(s=this._PixelRoundQuad(s)),t.Quad3(s,this._rendererText.GetTexRect())}_DrawMesh(t,e){const s=t.GetTransformedMesh();if(t.IsMeshChanged()){t.CalculateBbox(cl,ul,!1);let e=ul;this._runtime.IsPixelRoundingEnabled()&&(e=this._PixelRoundQuad(e)),s.CalculateTransformedMesh(t.GetSourceMesh(),e,this._rendererText.GetTexRect()),t.SetMeshChanged(!1)}s.Draw(e)}_PixelRoundQuad(e){const t=e.getTlx()-Math.round(e.getTlx()),s=e.getTly()-Math.round(e.getTly());return 0==t&&0==s?e:(ul.copy(e),ul.offset(-t,-s),ul)}GetCurrentSurfaceSize(){const e=this._rendererText.GetTexture();return e?[e.GetWidth(),e.GetHeight()]:[100,100]}GetCurrentTexRect(){return this._rendererText.GetTexRect()}IsCurrentTexRotated(){return!1}SaveToJson(){const e={t:this._text,c:this._color.toJSON(),fn:this._faceName,ps:this._ptSize};return this._enableBBcode&&(e.bbc=this._enableBBcode),0!==this._horizontalAlign&&(e.ha=this._horizontalAlign),0!==this._verticalAlign&&(e.va=this._verticalAlign),\"word\"!==this._wrapMode&&(e.wr=this._wrapMode),0!==this._lineHeightOffset&&(e.lho=this._lineHeightOffset),this._isBold&&(e.b=this._isBold),this._isItalic&&(e.i=this._isItalic),-1!==this._typewriterEndTime&&(e.tw={st:this._typewriterStartTime,en:this._typewriterEndTime,l:this._typewriterLength}),this._iconObjectClass&&(e.ioc=this._iconObjectClass.GetSID()),\"fixed\"===this._resolutionMode&&(e.fs=this._fixedScaleFactor),e}LoadFromJson(e){if(this._CancelTypewriter(),this._text=e.t,this._color.setFromJSON(e.c),this._faceName=e.fn,this._ptSize=e.ps,this._enableBBcode=!!e.hasOwnProperty(\"bbc\")&&e.bbc,this._horizontalAlign=e.hasOwnProperty(\"ha\")?e.ha:0,this._verticalAlign=e.hasOwnProperty(\"va\")?e.va:0,e.hasOwnProperty(\"wr\")){const t=e.wr;this._wrapMode=\"boolean\"==typeof t?t?\"word\":\"character\":t}else this._wrapMode=\"word\";if(this._lineHeightOffset=e.hasOwnProperty(\"lho\")?e.lho:0,this._isBold=!!e.hasOwnProperty(\"b\")&&e.b,this._isItalic=!!e.hasOwnProperty(\"i\")&&e.i,e.hasOwnProperty(\"tw\")){const s=e.tw;this._typewriterStartTime=s.st,this._typewriterEndTime=s.en,this._typewriterLength=s.l}if(e.hasOwnProperty(\"ioc\")){const i=this.GetRuntime().GetObjectClassBySID(e.ioc);i&&this._SetIconObjectClass(i)}else this._SetIconObjectClass(null);e.hasOwnProperty(\"fs\")?(this._resolutionMode=\"fixed\",this._fixedScaleFactor=e.fs):this._resolutionMode=\"auto\",this._UpdateTextSettings(),this._UpdateScreenReaderText(),this._isHtmlStringUpToDate=!1,-1!==this._typewriterEndTime&&this._StartTicking()}GetPropertyValueByIndex(e){switch(e){case 0:return this.GetText();case 1:return this._enableBBcode;case 2:return this._GetFontFace();case 3:return this._GetFontSize();case 4:return this._GetLineHeight();case 5:return this._IsBold();case 6:return this._IsItalic();case 7:return nl[0]=this._color.getR(),nl[1]=this._color.getG(),nl[2]=this._color.getB(),nl;case 8:return this._GetHAlign();case 9:return this._GetVAlign();case 10:return this._GetWrapMode();case 15:return this._IsReadAloud()}}SetPropertyValueByIndex(e,t){switch(e){case 0:this._SetText(t);break;case 1:this._enableBBcode!==!!t&&(this._enableBBcode=!!t,this._UpdateTextSettings());break;case 2:this._SetFontFace(t);break;case 3:this._SetFontSize(t);break;case 4:this._SetLineHeight(t);break;case 5:this._SetBold(t);break;case 6:this._SetItalic(t);break;case 7:const s=this._color,i=t;s.getR()===i[0]&&s.getG()===i[1]&&s.getB()===i[2]||(this._color.setRgb(i[0],i[1],i[2]),this._UpdateTextSettings());break;case 8:this._SetHAlign(t);break;case 9:this._SetVAlign(t);break;case 10:this._SetWrapMode(t)}}SetPropertyColorOffsetValueByIndex(e,t,s,i){0===t&&0===s&&0===i||7===e&&(this._color.addRgb(t,s,i),this._UpdateTextSettings())}_SetText(e){this._text!==e&&(this._text=e,this._rendererText.SetText(e),this._UpdateScreenReaderText(),this._isHtmlStringUpToDate=!1,this._runtime.UpdateRender())}GetText(){return this._text}_StartTypewriter(e,t){this._UpdateTextSize(),this._SetText(e),this._typewriterStartTime=this._runtime.GetWallTime(),this._typewriterEndTime=this._typewriterStartTime+t/this.GetInstance().GetActiveTimeScale(),this._typewriterLength=this._rendererText.GetLengthInGraphemes(),this._rendererText.SetDrawMaxCharacterCount(0),this._StartTicking()}_CancelTypewriter(){this._typewriterStartTime=-1,this._typewriterEndTime=-1,this._typewriterLength=0,this._rendererText.SetDrawMaxCharacterCount(-1),this._StopTicking()}_FinishTypewriter(){-1!==this._typewriterEndTime&&(this._CancelTypewriter(),this.Trigger(il.Plugins.Text.Cnds.OnTypewriterTextFinished),this._runtime.UpdateRender())}_SetFontFace(e){this._faceName!==e&&(this._faceName=e,this._rendererText.SetFontName(e),this._runtime.UpdateRender())}_GetFontFace(){return this._faceName}_SetBold(e){this._isBold!==(e=!!e)&&(this._isBold=e,this._rendererText.SetBold(e),this._runtime.UpdateRender())}_IsBold(){return this._isBold}_SetItalic(e){this._isItalic!==(e=!!e)&&(this._isItalic=e,this._rendererText.SetItalic(e),this._runtime.UpdateRender())}_IsItalic(){return this._isItalic}_SetFontSize(e){this._ptSize!==e&&(this._ptSize=e,this._runtime.UpdateRender())}_GetFontSize(){return this._ptSize}_SetFontColor(e){this._color.equalsIgnoringAlpha(e)||(this._color.copyRgb(e),this._rendererText.SetColor(this._color),this._runtime.UpdateRender())}_GetFontColor(){return this._color}_SetLineHeight(e){this._lineHeightOffset!==e&&(this._lineHeightOffset=e,this._UpdateTextSettings(),this._runtime.UpdateRender())}_GetLineHeight(){return this._lineHeightOffset}_SetHAlign(e){this._horizontalAlign!==e&&(this._horizontalAlign=e,this._UpdateTextSettings(),this._runtime.UpdateRender())}_GetHAlign(){return this._horizontalAlign}_SetVAlign(e){this._verticalAlign!==e&&(this._verticalAlign=e,this._UpdateTextSettings(),this._runtime.UpdateRender())}_GetVAlign(){return this._verticalAlign}_SetWrapModeByIndex(e){this._SetWrapMode(ll[e])}_SetWrapMode(e){this._wrapMode!==e&&(this._wrapMode=e,this._UpdateTextSettings(),this._runtime.UpdateRender())}_GetWrapMode(){return this._wrapMode}_SetTextDirection(e){this._textDirection!==e&&(this._textDirection=e,this._UpdateTextSettings(),this._runtime.UpdateRender())}_GetTextDirection(){return this._textDirection}_SetReadAloud(e){this._readAloud=!!e,this._UpdateScreenReaderText()}_IsReadAloud(){return this._readAloud}_SetResolutionMode(e){this._resolutionMode!==e&&(this._resolutionMode=e,this._runtime.UpdateRender())}_GetResolutionMode(){return this._resolutionMode}_SetFixedScaleFactor(e){this._fixedScaleFactor!==e&&(this._fixedScaleFactor=e,\"fixed\"===this._resolutionMode)&&this._runtime.UpdateRender()}_GetFixedScaleFactor(){return this._fixedScaleFactor}_GetTextWidth(){return this._UpdateTextSize(),this._rendererText.GetTextWidth()}_GetTextHeight(){return this._UpdateTextSize(),this._rendererText.GetTextHeight()}_GetTagAtPosition(e,t){this._UpdateTextSize();const s=this.GetWorldInfo(),i=(dl.set(e-s.GetX(),t-s.GetY()),dl.rotate(-s.GetAngle()),dl.offset(s.GetWidth()*s.GetOriginX(),s.GetHeight()*s.GetOriginY()),dl.divide(s.GetWidth(),s.GetHeight()),dl.scale(this._rendererText.GetWidth(),this._rendererText.GetHeight()),this._rendererText.HitTestFragment(dl.getX(),dl.getY()));if(i){const r=i.GetStyleTag(\"tag\");if(r)return r.param}return\"\"}_HasTagAtPosition(e,t,s){const i=this._GetTagAtPosition(t,s);return i&&il.equalsNoCase(e,i)}_GetTagPosition(e,t){this._UpdateTextSize(),t=Math.floor(t);const s=this._rendererText.FindFragmentWithTag(e,t);if(!s)return null;const i=this.GetWorldInfo(),r=this._rendererText.GetDrawScale(),n=s.GetPosX(),a=s.GetPosY()-(s.GetHeight()-s.GetFontBoundingBoxDescent())*r,o=s.GetWidth()*r/this._rendererText.GetWidth()*i.GetWidth(),h=s.GetHeight()*r/this._rendererText.GetHeight()*i.GetHeight();return dl.set(n,a),dl.divide(this._rendererText.GetWidth(),this._rendererText.GetHeight()),dl.scale(i.GetWidth(),i.GetHeight()),dl.offset(-i.GetWidth()*i.GetOriginX(),-i.GetHeight()*i.GetOriginY()),dl.rotate(i.GetAngle()),dl.offset(i.GetX(),i.GetY()),{x:dl.getX(),y:dl.getY(),width:o,height:h}}_GetTagCount(e){return this._UpdateTextSize(),this._rendererText.CountFragmentsWithTag(e)}_GetHTMLCloseTag(e){let t=pl.get(e);return null===t?\"\":`</${t||\"span\"||\"span\"}>`}_GetHTMLOpenTag(e,t){let s=pl.get(e);if(null===s)return\"\";switch(s=s||\"span\",e){case\"color\":return`<${s} style=\"color: ${t}\">`;case\"font\":return`<${s} style=\"font-family: '${t}'\">`;case\"opacity\":return`<${s} style=\"opacity: ${t}%\">`;case\"size\":return`<${s} style=\"font-size: ${t}pt\">`;case\"background\":return`<${s} style=\"background-color: ${t}\">`;case\"hide\":return`<${s} style=\"visibility: hidden\">`;case\"class\":return`<${s} class=\"${t}\">`;case\"tag\":return`<${s} data-tag=\"${t}\">`;default:return`<${s}>`}}async _UpdateHTMLString(){if(!this._isHtmlStringUpToDate){let e=new il.BBString(this._text,{noEscape:!0}).toFragmentList(),t=new Map,r='<span class=\"c3-text\"',s=[],n=(s.push(`font-family: '${this._GetFontFace()}';`),this._IsBold()&&s.push(\"font-weight: bold;\"),this._IsItalic()&&s.push(\"font-style: italic;\"),\"character\"===this._GetWrapMode()&&s.push(\"word-break: break-all;\"),r+=` style=\"${s.join(\" \")}\">`,this._iconObjectClass?this.GetRuntime().GetTextIconSet(this._iconObjectClass):null);if(this._iconObjectClass){const o=il.New(il.PromiseThrottle),h=[],l=new Map;for(const u of e)if(u.IsIcon()){const _=u.GetTextIcon(n);if(_){const d=_.GetSource(),p=d.GetImageInfo().GetImageAsset();l.has(p)||(l.set(p,null),h.push(o.Add(async()=>{const e=await p.LoadToDrawable();l.set(p,e)})))}}await Promise.all(h);const c=[];for(const f of e)if(f.IsIcon()){const m=f.GetTextIcon(n);if(m){const g=m.GetSource(),S=g.GetImageInfo().GetImageAsset();c.push(o.Add(async()=>{const e=await g.GetImageInfo().ExtractImageToBlobURL(l.get(S));t.set(m,e)}))}}await Promise.all(c);for(const y of l.values())y instanceof ImageBitmap&&y.close&&y.close()}const a=new Map;for(const G of e){let i=G.GetStyleMap(),e=[...a.keys()];e.reverse();for(const I of e)i.has(I)&&i.get(I)===a.get(I)||(a.delete(I),r+=this._GetHTMLCloseTag(I));for(const[T,C]of i)a.has(T)||(a.set(T,C),r+=this._GetHTMLOpenTag(T,C));if(G.IsText()&&(r+=il.ReplaceAll(il.EscapeHTML(G.GetCharacterArray().join(\"\")),\"\\n\",\"<br>\")),G.IsIcon()&&n){const b=G.GetTextIcon(n);if(b){const w=t.get(b);if(w){let e=[],t=\"0.2em\",s=i.get(\"iconoffsety\");if(s){let e=s.trim();t=e.endsWith(\"%\")?parseFloat(e)/100+\"em\":e+\"px\"}e.push(\"top: \"+t),\"nearest\"===this._runtime.GetSampling()&&e.push(\"image-rendering: pixelated\"),r+=`<img class=\"c3-text-icon\" data-icon=\"${G.GetIconParameter()}\" width=\"${b.GetWidth()}\" height=\"${b.GetHeight()}\" style=\"${e.join(\";\")}\" src=\"${w}\">`}}}}const i=[...a.keys()];i.reverse();for(const x of i)r+=this._GetHTMLCloseTag(x);r+=\"</span>\",this._htmlString=r,this._isHtmlStringUpToDate=!0}return this._htmlString}Tick(){const t=this._runtime.GetWallTime();if(t>=this._typewriterEndTime)this._CancelTypewriter(),this.Trigger(il.Plugins.Text.Cnds.OnTypewriterTextFinished),this._runtime.UpdateRender();else{let e=il.relerp(this._typewriterStartTime,this._typewriterEndTime,t,0,this._typewriterLength);(e=Math.floor(e))!==this._rendererText.GetDrawMaxCharacterCount()&&(this._rendererText.SetDrawMaxCharacterCount(e),this._runtime.UpdateRender())}}GetDebuggerProperties(){const e=\"plugins.text\";return[{title:e+\".name\",properties:[{name:e+\".properties.text.name\",value:this.GetText(),onedit:e=>this._SetText(e)},{name:e+\".properties.font.name\",value:this._GetFontFace(),onedit:e=>this._SetFontFace(e)},{name:e+\".properties.size.name\",value:this._GetFontSize(),onedit:e=>this._SetFontSize(e)},{name:e+\".properties.line-height.name\",value:this._GetLineHeight(),onedit:e=>this._SetLineHeight(e)},{name:e+\".properties.bold.name\",value:this._IsBold(),onedit:e=>this._SetBold(e)},{name:e+\".properties.italic.name\",value:this._IsItalic(),onedit:e=>this._SetItalic(e)}]}]}GetScriptInterfaceClass(){return self.ITextInstance}},new WeakMap),fl=new Map([[\"left\",0],[\"center\",1],[\"right\",2]]),ml=new Map([[\"top\",0],[\"center\",1],[\"bottom\",2]]),gl=[\"ltr\",\"rtl\"];new Set([\"auto\",\"fixed\"]);self.ITextInstance=class extends self.IWorldInstance{constructor(){super(),A.set(this,self.IInstance._GetInitInst().GetSdkInstance())}get text(){return A.get(this).GetText()}set text(e){rl.RequireString(e);const t=A.get(this);t._CancelTypewriter(),t._SetText(e)}typewriterText(e,t){rl.RequireString(e),rl.RequireFiniteNumber(t);const s=A.get(this);s._CancelTypewriter(),s._StartTypewriter(e,t)}typewriterFinish(){A.get(this)._FinishTypewriter()}set fontFace(e){rl.RequireString(e),A.get(this)._SetFontFace(e)}get fontFace(){return A.get(this)._GetFontFace()}set isBold(e){A.get(this)._SetBold(e)}get isBold(){return A.get(this)._IsBold()}set isItalic(e){A.get(this)._SetItalic(e)}get isItalic(){return A.get(this)._IsItalic()}set sizePt(e){rl.RequireFiniteNumber(e),A.get(this)._SetFontSize(e)}get sizePt(){return A.get(this)._GetFontSize()}set fontColor(e){if(rl.RequireArray(e),e.length<3)throw new Error(\"expected 3 elements\");_l.setRgb(e[0],e[1],e[2]),A.get(this)._SetFontColor(_l)}get fontColor(){const e=A.get(this)._GetFontColor();return[e.getR(),e.getG(),e.getB()]}set lineHeight(e){rl.RequireFiniteNumber(e),A.get(this)._SetLineHeight(e)}get lineHeight(){return A.get(this)._GetLineHeight()}set horizontalAlign(e){rl.RequireString(e);const t=fl.get(e);if(void 0===t)throw new Error(\"invalid mode\");A.get(this)._SetHAlign(t)}get horizontalAlign(){return al[A.get(this)._GetHAlign()]}set verticalAlign(e){rl.RequireString(e);const t=ml.get(e);if(void 0===t)throw new Error(\"invalid mode\");A.get(this)._SetVAlign(t)}get verticalAlign(){return ol[A.get(this)._GetVAlign()]}set wordWrapMode(e){if(!ll.includes(e))throw new Error(\"invalid mode\");A.get(this)._SetWrapMode(e)}get wordWrapMode(){return A.get(this)._GetWrapMode()}set textDirection(e){rl.RequireString(e);const t=gl.indexOf(e);if(-1===t)throw new Error(\"invalid text direction\");A.get(this)._SetTextDirection(t)}get textDirection(){return gl[A.get(this)._GetTextDirection()]}set readAloud(e){A.get(this)._SetReadAloud(!!e)}get readAloud(){return A.get(this)._IsReadAloud()}setFixedResolutionMode(e){rl.RequireFiniteNumber(e);const t=A.get(this);t._SetResolutionMode(\"fixed\"),t._SetFixedScaleFactor(e)}setAutoResolutionMode(){A.get(this)._SetResolutionMode(\"auto\")}get textWidth(){return A.get(this)._GetTextWidth()}get textHeight(){return A.get(this)._GetTextHeight()}getTextSize(){const e=A.get(this);return[e._GetTextWidth(),e._GetTextHeight()]}hasTagAtPosition(e,t,s){return rl.RequireString(e),rl.RequireFiniteNumber(t),rl.RequireFiniteNumber(s),A.get(this)._HasTagAtPosition(e,t,s)}getTagAtPosition(e,t){return rl.RequireFiniteNumber(e),rl.RequireFiniteNumber(t),A.get(this)._GetTagAtPosition(e,t)}getTagPositionAndSize(e,t=0){return rl.RequireString(e),rl.RequireFiniteNumber(t),A.get(this)._GetTagPosition(e,t)}getTagCount(e){return rl.RequireString(e),A.get(this)._GetTagCount(e)}changeIconSet(e){const t=A.get(this),s=t.GetRuntime()._UnwrapIObjectClass(e);t._SetIconObjectClass(s)}getAsHtmlString(){return A.get(this)._UpdateHTMLString()}}}{const Sl=self.C3;Sl.Plugins.Text.Cnds={CompareText(e,t){return t?this._text===e:Sl.equalsNoCase(this._text,e)},IsRunningTypewriterText(){return-1!==this._typewriterEndTime},OnTypewriterTextFinished(){return!0},HasTagAtPosition(e,t,s){return this._HasTagAtPosition(e,t,s)}}}{const yl=self.C3,Gl=yl.New(yl.Color);yl.Plugins.Text.Acts={SetText(e){this._CancelTypewriter(),\"number\"==typeof e&&e<1e9&&(e=Math.round(1e10*e)/1e10),this._SetText(e.toString())},AppendText(e){this._CancelTypewriter(),(e=(e=\"number\"==typeof e&&e<1e9?Math.round(1e10*e)/1e10:e).toString())&&this._SetText(this._text+e)},TypewriterText(e,t){this._CancelTypewriter(),\"number\"==typeof e&&e<1e9&&(e=Math.round(1e10*e)/1e10),this._StartTypewriter(e.toString(),t)},SetFontFace(e,t){let s=!1,i=!1;switch(t){case 1:s=!0;break;case 2:i=!0;break;case 3:s=!0,i=!0}e===this._faceName&&s===this._isBold&&i===this._isItalic||(this._SetFontFace(e),this._SetBold(s),this._SetItalic(i))},SetFontSize(e){this._SetFontSize(e)},SetFontColor(e){Gl.setFromRgbValue(e),Gl.clamp(),this._SetFontColor(Gl)},SetWebFont(e,t){console.warn(\"[Text] 'Set web font' action is deprecated and no longer has any effect\")},SetEffect(e){this.GetWorldInfo().SetBlendMode(e),this._runtime.UpdateRender()},TypewriterFinish(){this._FinishTypewriter()},SetLineHeight(e){this._SetLineHeight(e)},SetHAlign(e){this._SetHAlign(e)},SetVAlign(e){this._SetVAlign(e)},SetWrapping(e){this._SetWrapModeByIndex(e)},SetTextDirection(e){this._SetTextDirection(e)},ChangeIconSet(e){this._SetIconObjectClass(e)},UpdateHTML(){return this._UpdateHTMLString()},SetReadAloud(e){this._SetReadAloud(e)},SetResolutionMode(e,t){this._SetResolutionMode([\"auto\",\"fixed\"][e]),this._SetFixedScaleFactor(t)}}}{const Il=self.C3;Il.Plugins.Text.Exps={Text(){return this._text},PlainText(){return this._enableBBcode?Il.BBString.StripAnyTags(this._text):this._text},FaceName(){return this._faceName},FaceSize(){return this._ptSize},TextWidth(){return this._GetTextWidth()},TextHeight(){return this._GetTextHeight()},LineHeight(){return this._lineHeightOffset},TagAtPosition(e,t){return this._GetTagAtPosition(e,t)},TagCount(e){return this._GetTagCount(e)},TagX(e,t){const s=this._GetTagPosition(e,t);return s?s.x:0},TagY(e,t){const s=this._GetTagPosition(e,t);return s?s.y:0},TagWidth(e,t){const s=this._GetTagPosition(e,t);return s?s.width:0},TagHeight(e,t){const s=this._GetTagPosition(e,t);return s?s.height:0},AsHTML(){return this._htmlString}}}{const Tl=self.C3;Tl.Plugins.Sprite=class extends Tl.SDKPluginBase{constructor(e){super(e)}Release(){super.Release()}}}{const Cl=self.C3,bl=self.C3X,wl=[],xl=(Cl.Plugins.Sprite.Type=class extends Cl.SDKTypeBase{constructor(e){super(e),this._animations=e.GetAnimations()}Release(){Cl.clearArray(this._animations),super.Release()}OnCreate(){for(const e of this._animations)e.LoadAllAssets(this._runtime)}LoadTextures(t){const s={sampling:this._runtime.GetSampling()};return Promise.all(this._animations.map(e=>e.LoadAllTextures(t,s)))}ReleaseTextures(){for(const e of this._animations)e.ReleaseAllTextures()}OnDynamicTextureLoadComplete(){this._UpdateAllCurrentTexture()}_UpdateAllCurrentTexture(){for(const e of this._objectClass.instancesIncludingPendingCreate())e.GetSdkInstance()._UpdateCurrentTexture()}FinishCondition(e){Cl.Plugins.Sprite.FinishCollisionCondition(this,e)}BeforeRunAction(e){wl.push({objectClass:null,createHierarchy:!1,instances:[]})}_SpawnPickInstance(e,t,s){const i=wl.at(-1);i.objectClass=e,i.createHierarchy=s,i.instances.push(t)}AfterRunAction(e){const t=wl.pop(),s=t.objectClass,i=t.createHierarchy;if(s){const r=new Map;for(const n of t.instances)n.CollectInstancesToPick(r,s,i);for(const[a,o]of r)a.GetCurrentSol().SetSetPicked(o)}}_AddAnimation(e){const t=this.GetObjectClass().AddAnimation(e),s=this.GetRuntime(),i=t.GetFrameAt(0);return i.GetImageInfo().LoadStaticTexture(s.GetRenderer(),{sampling:s.GetSampling()}).then(()=>this._UpdateAllCurrentTexture()),t}_RemoveAnimation(e){for(const t of this._objectClass.instancesIncludingPendingCreate())t.GetSdkInstance()._OnAnimationRemoved(e);this.GetObjectClass().RemoveAnimation(e)}_AddAnimationFrame(e,t){const s=this._objectClass.GetAnimationByName(e);if(!s)throw new Error(`cannot find animation name '${e}'`);let i=s.FrameTagOrIndexToIndex(t);i<0&&(i+=s.GetFrameCount()+1);const r=Cl.AnimationFrameInfo.CreateDynamic(this.GetRuntime()),n=(s.InsertFrameAt(r,i),this.GetRuntime());r.GetImageInfo().LoadStaticTexture(n.GetRenderer(),{sampling:n.GetSampling()}).then(()=>this._UpdateAllCurrentTexture());for(const a of this._objectClass.instancesIncludingPendingCreate())a.GetSdkInstance()._OnAnimationFramesChanged();return r}_RemoveAnimationFrame(e,t){const s=this._objectClass.GetAnimationByName(e);if(!s)throw new Error(`cannot find animation name '${e}'`);if(1===s.GetFrameCount())throw new Error(`cannot remove last frame from animation '${e}'`);let i=s.FrameTagOrIndexToIndex(t);i<0&&(i+=s.GetFrameCount()),s.RemoveFrameAt(i);for(const r of this._objectClass.instancesIncludingPendingCreate())r.GetSdkInstance()._OnAnimationFramesChanged()}GetScriptInterfaceClass(){return self.ISpriteObjectType}},new WeakMap);self.ISpriteObjectType=class extends self.IObjectClass{constructor(e){super(e),xl.set(this,e.GetSdkType())}getAnimation(e){bl.RequireString(e);const t=xl.get(this).GetObjectClass().GetAnimationByName(e);return t?t.GetIAnimation():null}getAllAnimations(){return xl.get(this).GetObjectClass().GetAllAnimations().map(e=>e.GetIAnimation())}addAnimation(e){return bl.RequireString(e),xl.get(this)._AddAnimation(e).GetIAnimation()}removeAnimation(e){bl.RequireString(e),xl.get(this)._RemoveAnimation(e)}addAnimationFrame(e,t){if(bl.RequireString(e),\"number\"!=typeof t&&\"string\"!=typeof t)throw new TypeError(\"invalid insert location\");return xl.get(this)._AddAnimationFrame(e,t).GetIAnimationFrame()}removeAnimationFrame(e,t){if(bl.RequireString(e),\"number\"!=typeof t&&\"string\"!=typeof t)throw new TypeError(\"invalid insert location\");xl.get(this)._RemoveAnimationFrame(e,t)}}}{const M=self.C3,vl=self.C3X,Pl=M.New(M.Rect),Rl=M.New(M.Quad),Al=M.New(M.Vector2),D=(M.Plugins.Sprite.Instance=class extends M.SDKWorldInstanceBase{constructor(e,t){super(e);let s=!0,i=\"\",r=0,n=!0;t&&(s=!!t[0],i=t[1],r=t[2],n=t[3]),this._currentAnimation=this._objectClass.GetAnimationByName(i)||this._objectClass.GetAnimations()[0],this._currentFrameIndex=M.clamp(r,0,this._currentAnimation.GetFrameCount()-1),this._currentAnimationFrame=this._currentAnimation.GetFrameAt(this._currentFrameIndex);const a=this._currentAnimationFrame.GetImageInfo(),o=(this._currentTexture=a.GetTexture(),this._currentRcTex=a.GetTexRect(),this._currentQuadTex=a.GetTexQuad(),this.HandleRendererContextLoss(),e.SetFlag(2,!0),e.SetFlag(1,0<=this._currentAnimation.GetSpeed()),this._currentAnimationSpeed=Math.abs(this._currentAnimation.GetSpeed()),this._currentAnimationRepeatTo=this._currentAnimation.GetRepeatTo(),this._animationTimer=M.New(M.KahanSum),this._frameStartTime=0,this._animationRepeats=0,this._animTriggerName=\"\",this._changeAnimFrameIndex=-1,this._changeAnimationName=\"\",this._changeAnimationFrom=0,this.GetWorldInfo());this._bquadRef=o.GetBoundingQuad(),o.SetVisible(s),o.SetCollisionEnabled(n),o.SetOriginX(this._currentAnimationFrame.GetOriginX()),o.SetOriginY(this._currentAnimationFrame.GetOriginY()),o.SetSourceCollisionPoly(this._currentAnimationFrame.GetCollisionPoly()),o.SetBboxChanged(),1===this._objectClass.GetAnimationCount()&&1===this._objectClass.GetAnimations()[0].GetFrameCount()||0===this._currentAnimationSpeed||this._StartTicking()}Release(){this._currentAnimation=null,this._currentAnimationFrame=null,this._currentTexture=null,this._animationTimer=null,super.Release()}GetCurrentImageInfo(){return this._currentAnimationFrame.GetImageInfo()}IsOriginalSizeKnown(){return!0}OnRendererContextLost(){this._currentTexture=null}OnRendererContextRestored(){this._UpdateCurrentTexture()}Draw(e){const t=this._currentTexture;if(null!==t){e.SetTexture(t);const s=this.GetWorldInfo();s.HasMesh()?this._DrawMesh(s,e):this._DrawStandard(s,e)}}_DrawStandard(e,t){let s=this._bquadRef;this._runtime.IsPixelRoundingEnabled()&&(s=e.PixelRoundQuad(s)),t.Quad4(s,this._currentQuadTex)}_DrawMesh(t,e){const s=t.GetTransformedMesh();if(t.IsMeshChanged()){t.CalculateBbox(Pl,Rl,!1);let e=Rl;this._runtime.IsPixelRoundingEnabled()&&(e=t.PixelRoundQuad(e)),s.CalculateTransformedMesh(t.GetSourceMesh(),e,this._currentQuadTex),t.SetMeshChanged(!1)}s.Draw(e)}GetAnimationTime(){return this._animationTimer.Get()}IsAnimationPlaying(){return this._inst.GetFlag(2)}SetAnimationPlaying(e){this._inst.SetFlag(2,e)}IsPlayingForwards(){return this._inst.GetFlag(1)}SetPlayingForwards(e){this._inst.SetFlag(1,e)}IsInAnimationTrigger(){return this._inst.GetFlag(4)}SetInAnimationTrigger(e){this._inst.SetFlag(4,e)}Tick(){this._changeAnimationName&&this._DoChangeAnimation(),0<=this._changeAnimFrameIndex&&this._DoChangeAnimFrame();const e=this._currentAnimationSpeed;if(this.IsAnimationPlaying()&&0!==e){const t=this._runtime.GetDt(this._inst),s=(this._animationTimer.Add(t),this.GetAnimationTime()),i=this._currentAnimationFrame,r=i.GetDuration()/e;if(!(s<this._frameStartTime+r)){const n=this._currentAnimation,a=this._currentAnimationRepeatTo,o=n.GetFrameCount(),h=n.GetRepeatCount(),l=n.IsLooping(),c=n.IsPingPong(),u=(this.IsPlayingForwards()?this._currentFrameIndex++:this._currentFrameIndex--,this._frameStartTime+=r,this._currentFrameIndex>=o&&(c?(this.SetPlayingForwards(!1),this._currentFrameIndex=o-2):!l&&(this._animationRepeats++,this._animationRepeats>=h)?this._FinishAnimation(!1):this._currentFrameIndex=a),this._currentFrameIndex<0&&(c?(this._currentFrameIndex=1,this.SetPlayingForwards(!0),l||(this._animationRepeats++,this._animationRepeats>=h&&this._FinishAnimation(!0))):!l&&(this._animationRepeats++,this._animationRepeats>=h)?this._FinishAnimation(!0):this._currentFrameIndex=a),this._currentFrameIndex=M.clamp(this._currentFrameIndex,0,o-1),n.GetFrameAt(this._currentFrameIndex));s>this._frameStartTime+u.GetDuration()/e&&(this._frameStartTime=s),this._OnFrameChanged(i,u)}}else this._StopTicking()}_FinishAnimation(e){this._currentFrameIndex=e?0:this._currentAnimation.GetFrameCount()-1,this.SetAnimationPlaying(!1),this._animTriggerName=this._currentAnimation.GetName(),this.SetInAnimationTrigger(!0),this.DispatchScriptEvent(\"animationend\",!1,{animationName:this._animTriggerName}),this.Trigger(M.Plugins.Sprite.Cnds.OnAnyAnimFinished),this.Trigger(M.Plugins.Sprite.Cnds.OnAnimFinished),this.SetInAnimationTrigger(!1),this._animationRepeats=0}_OnFrameChanged(s,i,e){if(s!==i){const t=this.GetWorldInfo(),r=s.GetImageInfo(),n=i.GetImageInfo(),a=r.GetWidth(),o=r.GetHeight(),h=n.GetWidth(),l=n.GetHeight(),c=(e&&e.onFrameChange?e.onFrameChange(t,a,o,h,l):(a!==h&&t.SetWidth(t.GetWidth()*(h/a)),o!==l&&t.SetHeight(t.GetHeight()*(l/o))),t.SetOriginX(i.GetOriginX()),t.SetOriginY(i.GetOriginY()),t.SetSourceCollisionPoly(i.GetCollisionPoly()),t.SetBboxChanged(),this._currentAnimationFrame=i,this._currentTexture=n.GetTexture(),this._currentRcTex=n.GetTexRect(),this._currentQuadTex=n.GetTexQuad(),this.GetInstance().GetBehaviorInstances());for(let e=0,t=c.length;e<t;++e)c[e].OnSpriteFrameChanged(s,i);this.DispatchScriptEvent(\"framechange\",!1,{animationName:this._currentAnimation.GetName(),animationFrame:this._currentFrameIndex}),this.Trigger(M.Plugins.Sprite.Cnds.OnFrameChanged),this._runtime.UpdateRender()}}_StartAnim(e){this.SetAnimationPlaying(!0),this._frameStartTime=this.GetAnimationTime(),1===e&&0!==this._currentFrameIndex&&(this._changeAnimFrameIndex=0,this.IsInAnimationTrigger()||this._DoChangeAnimFrame()),this._StartTicking()}_SetAnim(e,t,s){this._changeAnimationName=e,this._changeAnimationFrom=t,this._StartTicking(),!s&&this.IsInAnimationTrigger()||this._DoChangeAnimation()}_GetCurrentAnimation(){return this._currentAnimation}_GetCurrentAnimationName(){return this._changeAnimationName||this._currentAnimation.GetName()}_OnAnimationRemoved(e){M.equalsNoCase(e,this._GetCurrentAnimationName())&&this._SetAnim(this._objectClass.GetFirstAnimation().GetName(),1,!0)}_SetAnimFrame(e){if(\"string\"==typeof e)if(String(Number(e))===e)e=Number(e);else{const t=this._objectClass.GetAnimationByName(this._GetCurrentAnimationName());if(!t)return;if(-1===(e=t.GetFrameIndexByTag(e)))return}isFinite(e)&&(this._changeAnimFrameIndex=e,this.IsInAnimationTrigger()||this._DoChangeAnimFrame())}_OnAnimationFramesChanged(){if(!this._changeAnimationName&&-1===this._changeAnimFrameIndex){const e=this._currentAnimationFrame,t=this._currentAnimation.GetFrameAt(M.clamp(this._currentFrameIndex,0,this._currentAnimation.GetFrameCount()-1));e!==t&&this._OnFrameChanged(e,t),1<this._currentAnimation.GetFrameCount()&&0<this._currentAnimationSpeed&&this._StartTicking()}}_GetAnimFrame(){return this._currentFrameIndex}_GetAnimFrameTag(){return this._currentAnimationFrame.GetTag()}_SetAnimSpeed(e){this._currentAnimationSpeed=Math.abs(e),this.SetPlayingForwards(0<=e),0<this._currentAnimationSpeed&&this._StartTicking()}_GetAnimSpeed(){return this.IsPlayingForwards()?this._currentAnimationSpeed:-this._currentAnimationSpeed}_SetAnimRepeatToFrame(e){\"string\"==typeof e&&-1===(e=this._currentAnimation.GetFrameIndexByTag(e))||(e=M.clamp(Math.floor(e),0,this._currentAnimation.GetFrameCount()-1),this._currentAnimationRepeatTo=e)}_GetAnimRepeatToFrame(){return this._currentAnimationRepeatTo}_DoChangeAnimation(e){const t=this._currentAnimationFrame,s=this._objectClass.GetAnimationByName(this._changeAnimationName);if(this._changeAnimationName=\"\",s&&(s!==this._currentAnimation||!this.IsAnimationPlaying())){this._currentAnimation=s,this.SetPlayingForwards(0<=s.GetSpeed()),this._currentAnimationSpeed=Math.abs(s.GetSpeed()),this._currentAnimationRepeatTo=s.GetRepeatTo(),this._currentFrameIndex=M.clamp(this._currentFrameIndex,0,this._currentAnimation.GetFrameCount()-1),1===this._changeAnimationFrom&&(this._currentFrameIndex=0),this.SetAnimationPlaying(!0),this._frameStartTime=this.GetAnimationTime();const i=this._currentAnimation.GetFrameAt(this._currentFrameIndex);this._OnFrameChanged(t,i,e)}}_DoChangeAnimFrame(e){const t=this._currentAnimationFrame,s=this._currentFrameIndex;if(this._currentFrameIndex=M.clamp(Math.floor(this._changeAnimFrameIndex),0,this._currentAnimation.GetFrameCount()-1),this._changeAnimFrameIndex=-1,e||s!==this._currentFrameIndex){const i=this._currentAnimation.GetFrameAt(this._currentFrameIndex);this._OnFrameChanged(t,i),this._frameStartTime=this.GetAnimationTime()}}_UpdateCurrentTexture(){const e=this._currentAnimationFrame.GetImageInfo();this._currentTexture=e.GetTexture(),this._currentRcTex=e.GetTexRect(),this._currentQuadTex=e.GetTexQuad(),this.GetWorldInfo().SetMeshChanged(!0)}GetTexture(){return this._currentTexture}GetTexRect(){return this._currentRcTex}GetTexQuad(){return this._currentQuadTex}GetImagePointCount(){return this._currentAnimationFrame.GetImagePointCount()}GetImagePoint(e){let t=this._currentAnimationFrame,s=this.GetWorldInfo(),i=null;if(\"string\"==typeof e)i=t.GetImagePointByName(e);else{if(\"number\"!=typeof e)throw new TypeError(\"expected string or number\");i=t.GetImagePointByIndex(e-1)}let r=s.GetTotalZElevation();if(!i)return[s.GetX(),s.GetY(),r];if(Al.copy(i.GetVec2()),s.HasMesh()){const[n,a,o]=s.GetSourceMesh().TransformPoint(Al.getX(),Al.getY());Al.set(n,a),r+=o}return Al.offset(-t.GetOriginX(),-t.GetOriginY()),Al.scale(s.GetWidth(),s.GetHeight()),Al.rotate(s.GetAngle()),Al.offset(s.GetX(),s.GetY()),[Al.getX(),Al.getY(),r]}GetCollisionPolyPointCount(){return this.GetWorldInfo().GetTransformedCollisionPoly().pointCount()}GetCollisionPolyPoint(e){e=Math.floor(e);const t=this.GetWorldInfo(),s=t.GetTransformedCollisionPoly(),i=s.pointCount();if((e=e===i?0:e)<0||i<=e)return[0,0];const r=s.pointsArr();return[r[2*e+0]+t.GetX(),r[2*e+1]+t.GetY()]}GetDebuggerProperties(){const t=M.Plugins.Sprite.Acts,e=\"plugins.sprite.debugger.animation-properties\";return[{title:e+\".title\",properties:[{name:e+\".current-animation\",value:this._currentAnimation.GetName(),onedit:e=>this.CallAction(t.SetAnim,e,0)},{name:e+\".current-frame\",value:this._currentFrameIndex,onedit:e=>this.CallAction(t.SetAnimFrame,e)},{name:e+\".is-playing\",value:this.IsAnimationPlaying(),onedit:e=>e?this.CallAction(t.StartAnim,0):this.CallAction(t.StopAnim)},{name:e+\".speed\",value:this._currentAnimationSpeed,onedit:e=>this.CallAction(t.SetAnimSpeed,e)},{name:e+\".repeats\",value:this._animationRepeats,onedit:e=>this._animationRepeats=e}]}]}SaveToJson(){const e={a:this._currentAnimation.GetSID()},t=(0!==this._frameStartTime&&(e.fs=this._frameStartTime),this.GetAnimationTime()),s=(0!==t&&(e.at=t),0!==this._currentFrameIndex&&(e.f=this._currentFrameIndex),0!==this._currentAnimationSpeed&&(e.cas=this._currentAnimationSpeed),1!==this._animationRepeats&&(e.ar=this._animationRepeats),0!==this._currentAnimationRepeatTo&&(e.rt=this._currentAnimationRepeatTo),this.IsAnimationPlaying()||(e.ap=this.IsAnimationPlaying()),this.IsPlayingForwards()||(e.af=this.IsPlayingForwards()),this.GetWorldInfo());return s.IsCollisionEnabled()&&(e.ce=s.IsCollisionEnabled()),e}LoadFromJson(e){const t=this.GetObjectClass().GetAnimationBySID(e.a),s=(t&&(this._currentAnimation=t),this._frameStartTime=e.hasOwnProperty(\"fs\")?e.fs:0,this._animationTimer.Set(e.hasOwnProperty(\"at\")?e.at:0),e.hasOwnProperty(\"f\")?e.f:0),i=(this._currentFrameIndex=M.clamp(s,0,this._currentAnimation.GetFrameCount()-1),this._currentAnimationSpeed=e.hasOwnProperty(\"cas\")?e.cas:0,this._animationRepeats=e.hasOwnProperty(\"ar\")?e.ar:1,e.hasOwnProperty(\"rt\")?e.rt:0),r=(this._currentAnimationRepeatTo=M.clamp(i,0,this._currentAnimation.GetFrameCount()-1),this.SetAnimationPlaying(!e.hasOwnProperty(\"ap\")||!!e.ap),this.SetPlayingForwards(!e.hasOwnProperty(\"af\")||!!e.af),this._currentAnimation.GetFrameAt(this._currentFrameIndex)),n=(this._currentAnimationFrame=r,this._UpdateCurrentTexture(),this.GetWorldInfo());n.SetOriginX(r.GetOriginX()),n.SetOriginY(r.GetOriginY()),n.SetSourceCollisionPoly(r.GetCollisionPoly()),n.SetCollisionEnabled(!!e.ce),this.IsAnimationPlaying()&&this._StartTicking()}GetPropertyValueByIndex(e){const t=this.GetWorldInfo();switch(e){case 3:return t.IsCollisionEnabled();case 2:return M.clamp(this._currentFrameIndex,0,this._currentAnimation.GetFrameCount()-1);case 1:return this._currentAnimation.GetName()}}SetPropertyValueByIndex(e,t,s){const i=this.GetWorldInfo();switch(e){case 3:i.SetCollisionEnabled(!!t);break;case 2:{this.SetAnimationPlaying(!1);const r=this._currentAnimation.GetFrameCount()-1,n=t=M.clamp(t,0,r),a=this._currentAnimation.GetFrameAt(this._currentFrameIndex),o=this._currentAnimation.GetFrameAt(n);this._OnFrameChanged(a,o,s),this._currentFrameIndex=M.clamp(n,0,r);break}case 1:{this._changeAnimationName=t,this._DoChangeAnimation(s);const h=this._currentAnimation.GetFrameCount();1<h&&0<this._currentAnimation.GetSpeed()?this._StartTicking():this._StopTicking();break}}}GetScriptInterfaceClass(){return self.ISpriteInstance}},new WeakMap),Ml=new Map([[\"current-frame\",0],[\"beginning\",1]]);self.ISpriteInstance=class extends self.IWorldInstance{constructor(){super(),D.set(this,self.IInstance._GetInitInst().GetSdkInstance())}getImagePointCount(){return D.get(this).GetImagePointCount()}getImagePointX(e){return this.getImagePoint(e)[0]}getImagePointY(e){return this.getImagePoint(e)[1]}getImagePointZ(e){return this.getImagePoint(e)[2]}getImagePoint(e){if(\"string\"!=typeof e&&\"number\"!=typeof e)throw new TypeError(\"expected string or number\");return D.get(this).GetImagePoint(e)}getPolyPointCount(){return D.get(this).GetCollisionPolyPointCount()}getPolyPointX(e){return vl.RequireFiniteNumber(e),D.get(this).GetCollisionPolyPoint(e)[0]}getPolyPointY(e){return vl.RequireFiniteNumber(e),D.get(this).GetCollisionPolyPoint(e)[1]}getPolyPoint(e){return vl.RequireFiniteNumber(e),D.get(this).GetCollisionPolyPoint(e)}stopAnimation(){D.get(this).SetAnimationPlaying(!1)}startAnimation(e=\"current-frame\"){vl.RequireString(e);const t=Ml.get(e);if(void 0===t)throw new Error(\"invalid mode\");D.get(this)._StartAnim(t)}setAnimation(e,t=\"beginning\"){vl.RequireString(e),vl.RequireString(t);const s=Ml.get(t);if(void 0===s)throw new Error(\"invalid mode\");const i=D.get(this);if(!i.GetObjectClass().GetAnimationByName(e))throw new Error(`animation name \"${e}\" does not exist`);i._SetAnim(e,s)}getAnimation(e){vl.RequireString(e);const t=D.get(this).GetObjectClass().GetAnimationByName(e);return t?t.GetIAnimation():null}get animation(){return D.get(this)._GetCurrentAnimation().GetIAnimation()}get animationName(){return D.get(this)._GetCurrentAnimationName()}set animationFrame(e){vl.RequireFiniteNumber(e),D.get(this)._SetAnimFrame(e)}get animationFrame(){return D.get(this)._GetAnimFrame()}set animationFrameTag(e){vl.RequireString(e),D.get(this)._SetAnimFrame(e)}get animationFrameTag(){return D.get(this)._GetAnimFrameTag()}set animationSpeed(e){vl.RequireFiniteNumber(e),D.get(this)._SetAnimSpeed(e)}get animationSpeed(){return D.get(this)._GetAnimSpeed()}set animationRepeatToFrame(e){vl.RequireFiniteNumber(e),D.get(this)._SetAnimRepeatToFrame(e)}get animationRepeatToFrame(){return D.get(this)._GetAnimRepeatToFrame()}get imageWidth(){return D.get(this).GetCurrentImageInfo().GetWidth()}get imageHeight(){return D.get(this).GetCurrentImageInfo().GetHeight()}getImageSize(){const e=D.get(this).GetCurrentImageInfo();return[e.GetWidth(),e.GetHeight()]}async replaceCurrentAnimationFrame(e){vl.RequireInstanceOf(e,Blob);const t=D.get(this),s=t.GetRuntime(),i=t.GetCurrentImageInfo(),r=M.New(M.ImageInfo);if(r.LoadDynamicBlobAsset(s,e),await r.LoadStaticTexture(s.GetRenderer(),{sampling:s.GetSampling()}),t.WasReleased())r.Release();else{i.ReplaceWith(r);const n=t.GetSdkType();n._UpdateAllCurrentTexture(),n.GetObjectClass().Dispatcher().dispatchEvent(new M.Event(\"animationframeimagechange\")),s.UpdateRender()}}setSolidCollisionFilter(e,t){vl.RequireString(t),D.get(this).GetWorldInfo().SetSolidCollisionFilter(!!e,t)}}}{const Dl=self.C3;Dl.Plugins.Sprite.Cnds={IsAnimPlaying(e){return Dl.equalsNoCase(this._GetCurrentAnimationName(),e)},CompareFrame(e,t){return Dl.compare(this._currentFrameIndex,e,t)},CompareFrameTag(e,t){if(\"string\"!=typeof t)return!1;const s=this._currentAnimationFrame.GetTag();return Dl.compare(s.toLowerCase(),e,t.toLowerCase())},CompareAnimSpeed(e,t){return Dl.compare(this._GetAnimSpeed(),e,t)},OnAnimFinished(e){return Dl.equalsNoCase(this._animTriggerName,e)},OnAnyAnimFinished(){return!0},OnFrameChanged(){return!0},IsMirrored(){return this.GetWorldInfo().GetWidth()<0},IsFlipped(){return this.GetWorldInfo().GetHeight()<0},OnURLLoaded(){return!0},OnURLFailed(){return!0},IsCollisionEnabled(){return this.GetWorldInfo().IsCollisionEnabled()}}}{const El=self.C3;El.Plugins.Sprite.Acts={Spawn(e,t,s,i,r){if(e&&t){const[n,a]=this.GetImagePoint(s),o=this._runtime.CreateInstance(e,t,n,a,i,r);if(o){if(i&&t.SortAndAddInstancesByZIndex(o),e.GetPlugin().IsRotatable()){const l=o.GetWorldInfo();l.SetAngle(this.GetWorldInfo().GetAngle()),l.SetBboxChanged()}const h=this._runtime.GetEventSheetManager();h.BlockFlushingInstances(!0),o._TriggerOnCreatedOnSelfAndRelated(),h.BlockFlushingInstances(!1),e!==this._runtime.GetCurrentAction().GetObjectClass()&&this._sdkType._SpawnPickInstance(e,o,i)}}},StopAnim(){this.SetAnimationPlaying(!1)},StartAnim(e){this._StartAnim(e)},SetAnim(e,t){this._SetAnim(e,t)},SetAnimFrame(e){this._SetAnimFrame(e)},SetAnimSpeed(e){this._SetAnimSpeed(e)},SetAnimRepeatToFrame(e){this._SetAnimRepeatToFrame(e)},AddRemoveAnimation(t,e){try{0===t?this.GetSdkType()._AddAnimation(e):this.GetSdkType()._RemoveAnimation(e)}catch(e){console.error(`[Construct] Error ${0===t?\"adding\":\"removing\"} animation: `,e)}},AddRemoveAnimationFrame(t,e,s){try{0===t?this.GetSdkType()._AddAnimationFrame(e,s):this.GetSdkType()._RemoveAnimationFrame(e,s)}catch(e){console.error(`[Construct] Error ${0===t?\"adding\":\"removing\"} animation frame: `,e)}},SetMirrored(e){const t=this.GetWorldInfo(),s=t.GetWidth(),i=Math.abs(s)*(0===e?-1:1);s!==i&&(t.SetWidth(i),t.SetBboxChanged())},SetFlipped(e){const t=this.GetWorldInfo(),s=t.GetHeight(),i=Math.abs(s)*(0===e?-1:1);s!==i&&(t.SetHeight(i),t.SetBboxChanged())},SetScale(e){const t=this._currentAnimationFrame,s=t.GetImageInfo(),i=this.GetWorldInfo(),r=i.GetWidth()<0?-1:1,n=i.GetHeight()<0?-1:1,a=s.GetWidth()*e*r,o=s.GetHeight()*e*n;i.GetWidth()===a&&i.GetHeight()===o||(i.SetSize(a,o),i.SetBboxChanged())},async LoadURL(e,t,s){const i=this._currentAnimationFrame,r=i.GetImageInfo(),n=this.GetWorldInfo(),a=this._runtime,o=this._sdkType;if(r.GetURL()===e)0===t&&(n.SetSize(r.GetWidth(),r.GetHeight()),n.SetBboxChanged()),this.Trigger(El.Plugins.Sprite.Cnds.OnURLLoaded);else{const h=El.New(El.ImageInfo);try{if(await h.LoadDynamicAsset(a,e),!h.IsLoaded())throw new Error(\"image failed to load\");if(this.WasReleased())return void h.Release();await h.LoadStaticTexture(a.GetRenderer(),{sampling:a.GetSampling()})}catch(e){return console.error(\"Load image from URL failed: \",e),void(this.WasReleased()||this.Trigger(El.Plugins.Sprite.Cnds.OnURLFailed))}this.WasReleased()?h.Release():(r.ReplaceWith(h),o._UpdateAllCurrentTexture(),o.GetObjectClass().Dispatcher().dispatchEvent(new El.Event(\"animationframeimagechange\")),a.UpdateRender(),0===t&&(n.SetSize(r.GetWidth(),r.GetHeight()),n.SetBboxChanged()),await this.TriggerAsync(El.Plugins.Sprite.Cnds.OnURLLoaded))}},SetCollisions(e){this.GetWorldInfo().SetCollisionEnabled(e)},SetSolidCollisionFilter(e,t){this.GetWorldInfo().SetSolidCollisionFilter(0===e,t)},SetEffect(e){this.GetWorldInfo().SetBlendMode(e),this._runtime.UpdateRender()}}}{const Fl=self.C3;Fl.Plugins.Sprite.Exps={AnimationFrame(){return this._GetAnimFrame()},AnimationFrameTag(){return this._GetAnimFrameTag()},AnimationFrameCount(){return this._currentAnimation.GetFrameCount()},AnimationName(){return this._currentAnimation.GetName()},AnimationSpeed(){return this._GetAnimSpeed()},OriginalAnimationSpeed(){return this._currentAnimation.GetSpeed()},ImagePointX(e){return this.GetImagePoint(e)[0]},ImagePointY(e){return this.GetImagePoint(e)[1]},ImagePointZ(e){return this.GetImagePoint(e)[2]},ImagePointCount(){return this.GetImagePointCount()},ImageWidth(){return this.GetCurrentImageInfo().GetWidth()},ImageHeight(){return this.GetCurrentImageInfo().GetHeight()},PolyPointXAt(e){return this.GetCollisionPolyPoint(e)[0]},PolyPointYAt(e){return this.GetCollisionPolyPoint(e)[1]},PolyPointCount(){return this.GetCollisionPolyPointCount()}}}{const Bl=self.C3;Bl.Plugins.Touch=class extends Bl.SDKPluginBase{constructor(e){super(e)}Release(){super.Release()}}}{let s=function(){return t.GetSingleGlobalInstance().GetSdkInstance()};s;const Ol=self.C3,Ll=self.C3X;Ol.Plugins.Touch.Type=class extends Ol.SDKTypeBase{constructor(e){super(e)}Release(){super.Release()}OnCreate(){}GetScriptInterfaceClass(){return self.ITouchObjectType}};let t=null;self.ITouchObjectType=class extends self.IObjectClass{constructor(e){super(e),(t=e).GetRuntime()._GetCommonScriptInterfaces().touch=this}requestPermission(e){Ll.RequireString(e);const t=s();if(\"orientation\"===e)return t._RequestPermission(0);if(\"motion\"===e)return t._RequestPermission(1);throw new Error(\"invalid type\")}}}{const E=self.C3;E.Plugins.Touch.Instance=class extends E.SDKInstanceBase{constructor(e,t){super(e,\"touch\"),this._touches=new Map,this._useMouseInput=!1,this._isMouseDown=!1,this._orientCompassHeading=0,this._orientAlpha=0,this._orientBeta=0,this._orientGamma=0,this._accX=0,this._accY=0,this._accZ=0,this._accWithGX=0,this._accWithGY=0,this._accWithGZ=0,this._triggerIndex=0,this._triggerId=0,this._triggerPermission=0,this._curTouchX=0,this._curTouchY=0,this._getTouchIndex=0,this._triggerType=0,this._permissionPromises=[],t&&(this._useMouseInput=t[0]),this.AddDOMMessageHandler(\"permission-result\",e=>this._OnPermissionResult(e));const s=this.GetRuntime().Dispatcher();this._disposables=new E.CompositeDisposable(E.Disposable.From(s,\"pointerdown\",e=>this._OnPointerDown(e.data)),E.Disposable.From(s,\"pointermove\",e=>this._OnPointerMove(e.data)),E.Disposable.From(s,\"pointerup\",e=>this._OnPointerUp(e.data,!1)),E.Disposable.From(s,\"pointercancel\",e=>this._OnPointerUp(e.data,!0)),E.Disposable.From(s,\"deviceorientation\",e=>this._OnDeviceOrientation(e.data)),E.Disposable.From(s,\"deviceorientationabsolute\",e=>this._OnDeviceOrientationAbsolute(e.data)),E.Disposable.From(s,\"devicemotion\",e=>this._OnDeviceMotion(e.data)),E.Disposable.From(s,\"tick2\",e=>this._OnTick2()))}Release(){this._touches.clear(),super.Release()}_OnPointerDown(e){if(\"mouse\"===e.pointerType){if(!this._useMouseInput)return;this._isMouseDown=!0}const t=e.pointerId;if(!this._touches.has(t)){const s=e.pageX-this._runtime.GetCanvasClientX(),i=e.pageY-this._runtime.GetCanvasClientY(),r=performance.now(),n=this._touches.size,a=(this._triggerIndex=n,this._triggerId=t,E.New(E.Plugins.Touch.TouchInfo));a.Init(r,s,i,t,n),this._touches.set(t,a),this.Trigger(E.Plugins.Touch.Cnds.OnNthTouchStart),this.Trigger(E.Plugins.Touch.Cnds.OnTouchStart),this._curTouchX=s,this._curTouchY=i,this._triggerType=0,this.Trigger(E.Plugins.Touch.Cnds.OnTouchObject)}}_OnPointerMove(e){if(\"mouse\"!==e.pointerType||this._isMouseDown){const t=this._touches.get(e.pointerId);if(t){const s=performance.now();if(!(s-t.GetTime()<2)){const i=e.pageX-this._runtime.GetCanvasClientX(),r=e.pageY-this._runtime.GetCanvasClientY();t.Update(s,i,r,e.width,e.height,e.pressure)}}}}_OnPointerUp(e,t){if(\"mouse\"===e.pointerType){if(!this._isMouseDown)return;this._isMouseDown=!1}const s=performance.now(),i=e.pointerId,r=this._touches.get(i);if(r){if(this._triggerIndex=r.GetStartIndex(),this._triggerId=r.GetId(),!t){const n=e.pageX-this._runtime.GetCanvasClientX(),a=e.pageY-this._runtime.GetCanvasClientY();this._curTouchX=n,this._curTouchY=a,this._triggerType=1,this.Trigger(E.Plugins.Touch.Cnds.OnTouchObject)}if(this.Trigger(E.Plugins.Touch.Cnds.OnNthTouchEnd),this.Trigger(E.Plugins.Touch.Cnds.OnTouchEnd),!t){const o=r.ShouldTriggerTap(s);\"single-tap\"===o?(this.Trigger(E.Plugins.Touch.Cnds.OnTapGesture),this._curTouchX=r.GetX(),this._curTouchY=r.GetY(),this.Trigger(E.Plugins.Touch.Cnds.OnTapGestureObject)):\"double-tap\"===o&&(this.Trigger(E.Plugins.Touch.Cnds.OnDoubleTapGesture),this._curTouchX=r.GetX(),this._curTouchY=r.GetY(),this.Trigger(E.Plugins.Touch.Cnds.OnDoubleTapGestureObject))}r.Release(),this._touches.delete(i)}}_RequestPermission(s){return this._PostToDOMMaybeSync(\"request-permission\",{type:s}),new Promise((e,t)=>{this._permissionPromises.push({type:s,resolve:e,reject:t})})}_OnPermissionResult(e){const t=e.result,s=e.type,i=(this._triggerPermission=s,this._permissionPromises.filter(e=>e.type===s));for(const r of i)r.resolve(t?\"granted\":\"denied\");this._permissionPromises=this._permissionPromises.filter(e=>e.type!==s),t?(this.Trigger(E.Plugins.Touch.Cnds.OnPermissionGranted),0===s?this._runtime.RequestDeviceOrientationEvent():this._runtime.RequestDeviceMotionEvent()):this.Trigger(E.Plugins.Touch.Cnds.OnPermissionDenied)}_OnDeviceOrientation(e){\"number\"==typeof e.webkitCompassHeading?this._orientCompassHeading=e.webkitCompassHeading:e.absolute&&(this._orientCompassHeading=e.alpha),this._orientAlpha=e.alpha,this._orientBeta=e.beta,this._orientGamma=e.gamma}_OnDeviceOrientationAbsolute(e){this._orientCompassHeading=e.alpha}_OnDeviceMotion(e){const t=e.acceleration,s=(t&&(this._accX=t.x,this._accY=t.y,this._accZ=t.z),e.accelerationIncludingGravity);s&&(this._accWithGX=s.x,this._accWithGY=s.y,this._accWithGZ=s.z)}_OnTick2(){let e=performance.now(),t=0;for(const s of this._touches.values())s.GetTime()<=e-50&&s._SetLastTime(e),s.ShouldTriggerHold(e)&&(this._triggerIndex=s.GetStartIndex(),this._triggerId=s.GetId(),this._getTouchIndex=t,this.Trigger(E.Plugins.Touch.Cnds.OnHoldGesture),this._curTouchX=s.GetX(),this._curTouchY=s.GetY(),this.Trigger(E.Plugins.Touch.Cnds.OnHoldGestureObject),this._getTouchIndex=0),++t}_GetTouchByIndex(e){e=Math.floor(e);for(const t of this._touches.values()){if(0===e)return t;--e}return null}_IsClientPosOnCanvas(e,t){return 0<=e&&0<=t&&e<this._runtime.GetCanvasCssWidth()&&t<this._runtime.GetCanvasCssHeight()}GetDebuggerProperties(){return[{title:\"plugins.touch.debugger.touches\",properties:[...this._touches.values()].map(e=>({name:\"$\"+e.GetId(),value:e.GetX()+\", \"+e.GetY()}))}]}}}{const kl=self.C3;kl.Plugins.Touch.Cnds={OnTouchStart(){return!0},OnTouchEnd(){return!0},IsInTouch(){return 0<this._touches.size},OnTouchObject(e,t){return!!e&&t===this._triggerType&&!!this._IsClientPosOnCanvas(this._curTouchX,this._curTouchY)&&this._runtime.GetCollisionEngine().TestAndSelectCanvasPointOverlap(e,[[this._curTouchX,this._curTouchY]],!1)},IsTouchingObject(e){if(!e)return!1;const t=this._runtime.GetCurrentCondition(),s=t.IsInverted(),i=[...this._touches.values()].filter(e=>this._IsClientPosOnCanvas(e.GetX(),e.GetY())).map(e=>[e.GetX(),e.GetY()]);return kl.xor(this._runtime.GetCollisionEngine().TestAndSelectCanvasPointOverlap(e,i,s),s)},CompareTouchSpeed(e,t,s){const i=this._GetTouchByIndex(e);return!!i&&kl.compare(i.GetSpeed(),t,s)},OrientationSupported(){return!0},MotionSupported(){return!0},CompareOrientation(e,t,s){this._runtime.RequestDeviceOrientationEvent();let i;return i=0===e?this._orientAlpha:1===e?this._orientBeta:this._orientGamma,kl.compare(i,t,s)},CompareAcceleration(e,t,s){this._runtime.RequestDeviceMotionEvent();let i;return i=0===e?this._accWithGX:1===e?this._accWithGY:2===e?this._accWithGZ:3===e?this._accX:4===e?this._accY:this._accZ,kl.compare(i,t,s)},OnNthTouchStart(e){return(e=Math.floor(e))===this._triggerIndex},OnNthTouchEnd(e){return(e=Math.floor(e))===this._triggerIndex},HasNthTouch(e){return e=Math.floor(e),this._touches.size>=e+1},OnHoldGesture(){return!0},OnTapGesture(){return!0},OnDoubleTapGesture(){return!0},OnHoldGestureObject(e){return!!e&&!!this._IsClientPosOnCanvas(this._curTouchX,this._curTouchY)&&this._runtime.GetCollisionEngine().TestAndSelectCanvasPointOverlap(e,[[this._curTouchX,this._curTouchY]],!1)},OnTapGestureObject(e){return!!e&&!!this._IsClientPosOnCanvas(this._curTouchX,this._curTouchY)&&this._runtime.GetCollisionEngine().TestAndSelectCanvasPointOverlap(e,[[this._curTouchX,this._curTouchY]],!1)},OnDoubleTapGestureObject(e){return!!e&&!!this._IsClientPosOnCanvas(this._curTouchX,this._curTouchY)&&this._runtime.GetCollisionEngine().TestAndSelectCanvasPointOverlap(e,[[this._curTouchX,this._curTouchY]],!1)},OnPermissionGranted(e){return this._triggerPermission===e},OnPermissionDenied(e){return this._triggerPermission===e}}}{const Nl=self.C3;Nl.Plugins.Touch.Acts={RequestPermission(e){this._RequestPermission(e)}}}{const Wl=self.C3;Wl.Plugins.Touch.Exps={TouchCount(){return this._touches.size},X(e){const t=this._GetTouchByIndex(this._getTouchIndex);return t?t.GetPositionForLayer(this._runtime.GetCurrentLayout(),e,!0):0},Y(e){const t=this._GetTouchByIndex(this._getTouchIndex);return t?t.GetPositionForLayer(this._runtime.GetCurrentLayout(),e,!1):0},XAt(e,t){const s=this._GetTouchByIndex(e);return s?s.GetPositionForLayer(this._runtime.GetCurrentLayout(),t,!0):0},YAt(e,t){const s=this._GetTouchByIndex(e);return s?s.GetPositionForLayer(this._runtime.GetCurrentLayout(),t,!1):0},XForID(e,t){const s=this._touches.get(e);return s?s.GetPositionForLayer(this._runtime.GetCurrentLayout(),t,!0):0},YForID(e,t){const s=this._touches.get(e);return s?s.GetPositionForLayer(this._runtime.GetCurrentLayout(),t,!1):0},AbsoluteX(){const e=this._GetTouchByIndex(0);return e?e.GetX():0},AbsoluteY(){const e=this._GetTouchByIndex(0);return e?e.GetY():0},AbsoluteXAt(e){const t=this._GetTouchByIndex(e);return t?t.GetX():0},AbsoluteYAt(e){const t=this._GetTouchByIndex(e);return t?t.GetY():0},AbsoluteXForID(e){const t=this._touches.get(e);return t?t.GetX():0},AbsoluteYForID(e){const t=this._touches.get(e);return t?t.GetY():0},SpeedAt(e){const t=this._GetTouchByIndex(e);return t?t.GetSpeed():0},SpeedForID(e){const t=this._touches.get(e);return t?t.GetSpeed():0},AngleAt(e){const t=this._GetTouchByIndex(e);return t?Wl.toDegrees(t.GetAngle()):0},AngleForID(e){const t=this._touches.get(e);return t?Wl.toDegrees(t.GetAngle()):0},CompassHeading(){return this._runtime.RequestDeviceOrientationEvent(),this._orientCompassHeading},Alpha(){return this._runtime.RequestDeviceOrientationEvent(),this._orientAlpha},Beta(){return this._runtime.RequestDeviceOrientationEvent(),this._orientBeta},Gamma(){return this._runtime.RequestDeviceOrientationEvent(),this._orientGamma},AccelerationXWithG(){return this._runtime.RequestDeviceMotionEvent(),this._accWithGX},AccelerationYWithG(){return this._runtime.RequestDeviceMotionEvent(),this._accWithGY},AccelerationZWithG(){return this._runtime.RequestDeviceMotionEvent(),this._accWithGZ},AccelerationX(){return this._runtime.RequestDeviceMotionEvent(),this._accX},AccelerationY(){return this._runtime.RequestDeviceMotionEvent(),this._accY},AccelerationZ(){return this._runtime.RequestDeviceMotionEvent(),this._accZ},TouchIndex(){return this._triggerIndex},TouchID(){return this._triggerId},WidthForID(e){const t=this._touches.get(e);return t?t.GetWidth():0},HeightForID(e){const t=this._touches.get(e);return t?t.GetHeight():0},PressureForID(e){const t=this._touches.get(e);return t?t.GetPressure():0}}}{let a=self.C3,t=-1e3,s=-1e3,i=-1e4;a.Plugins.Touch.TouchInfo=class extends a.DefendedBase{constructor(){super(),this._pointerId=0,this._startIndex=0,this._startTime=0,this._time=0,this._lastTime=0,this._startX=0,this._startY=0,this._x=0,this._y=0,this._lastX=0,this._lastY=0,this._width=0,this._height=0,this._pressure=0,this._hasTriggeredHold=!1,this._isTooFarForHold=!1}Release(){}Init(e,t,s,i,r){this._pointerId=i,this._startIndex=r,this._time=e,this._lastTime=e,this._startTime=e,this._startX=t,this._startY=s,this._x=t,this._y=s,this._lastX=t,this._lastY=s}Update(e,t,s,i,r,n){this._lastTime=this._time,this._time=e,this._lastX=this._x,this._lastY=this._y,this._x=t,this._y=s,this._width=i,this._height=r,this._pressure=n,!this._isTooFarForHold&&15<=a.distanceTo(this._startX,this._startY,this._x,this._y)&&(this._isTooFarForHold=!0)}GetId(){return this._pointerId}GetStartIndex(){return this._startIndex}GetTime(){return this._time}_SetLastTime(e){this._lastTime=e}GetX(){return this._x}GetY(){return this._y}GetSpeed(){const e=a.distanceTo(this._x,this._y,this._lastX,this._lastY),t=(this._time-this._lastTime)/1e3;return 0<t?e/t:0}GetAngle(){return a.angleTo(this._lastX,this._lastY,this._x,this._y)}GetWidth(){return this._width}GetHeight(){return this._height}GetPressure(){return this._pressure}ShouldTriggerHold(e){return!this._hasTriggeredHold&&500<=e-this._startTime&&!this._isTooFarForHold&&a.distanceTo(this._startX,this._startY,this._x,this._y)<15&&(this._hasTriggeredHold=!0)}ShouldTriggerTap(e){return!this._hasTriggeredHold&&e-this._startTime<=333&&!this._isTooFarForHold&&a.distanceTo(this._startX,this._startY,this._x,this._y)<15?e-i<=666&&a.distanceTo(t,s,this._x,this._y)<25?(t=-1e3,s=-1e3,i=-1e4,\"double-tap\"):(t=this._x,s=this._y,i=e,\"single-tap\"):\"\"}GetPositionForLayer(e,t,s){if(void 0===t){const i=e.GetLayerByIndex(0);return i.CanvasCssToLayer_DefaultTransform(this._x,this._y)[s?0:1]}{const r=e.GetLayer(t);return r?r.CanvasCssToLayer(this._x,this._y)[s?0:1]:0}}}}{const Vl=self.C3;Vl.Plugins.Mouse=class extends Vl.SDKPluginBase{constructor(e){super(e)}Release(){super.Release()}}}{let r=function(){return t.GetSingleGlobalInstance().GetSdkInstance()};r;const Ul=self.C3,jl=self.C3X;Ul.Plugins.Mouse.Type=class extends Ul.SDKTypeBase{constructor(e){super(e)}Release(){super.Release()}OnCreate(){}GetScriptInterfaceClass(){return self.IMouseObjectType}};let t=null;self.IMouseObjectType=class extends self.IObjectClass{constructor(e){super(e),(t=e).GetRuntime()._GetCommonScriptInterfaces().mouse=this}getMouseX(e){return r().GetMousePositionForLayer(e)[0]}getMouseY(e){return r().GetMousePositionForLayer(e)[1]}getMousePosition(e){return r().GetMousePositionForLayer(e)}isMouseButtonDown(e){return r().IsMouseButtonDown(e)}setCursorStyle(e){jl.RequireString(e),r().SetCursorStyle(e)}setCursorObjectClass(e){const t=r(),s=t.GetRuntime(),i=s._UnwrapIObjectClass(e);t.SetCursorObjectClass(i)}}}{let a=self.C3,o=null;a.Plugins.Mouse.Instance=class extends a.SDKInstanceBase{constructor(e,t){super(e,\"mouse\"),this._buttonMap=[!1,!1,!1,!1,!1],this._mouseXcanvas=0,this._mouseYcanvas=0,this._triggerButton=0,this._triggerType=0,this._triggerDir=0,this._wheelDeltaX=0,this._wheelDeltaY=0,this._wheelDeltaZ=0,this._hasPointerLock=!1,this._movementX=0,this._movementY=0,this.AddDOMMessageHandlers([[\"pointer-lock-change\",e=>this._OnPointerLockChange(e)],[\"pointer-lock-error\",e=>this._OnPointerLockError(e)]]);const s=this.GetRuntime().Dispatcher();this._disposables=new a.CompositeDisposable(a.Disposable.From(s,\"pointermove\",e=>this._OnPointerMove(e.data)),a.Disposable.From(s,\"pointerdown\",e=>this._OnPointerDown(e.data)),a.Disposable.From(s,\"pointerup\",e=>this._OnPointerUp(e.data)),a.Disposable.From(s,\"dblclick\",e=>this._OnDoubleClick(e.data)),a.Disposable.From(s,\"wheel\",e=>this._OnMouseWheel(e.data)),a.Disposable.From(s,\"window-blur\",()=>this._OnWindowBlur()))}Release(){super.Release()}_OnPointerDown(e){\"mouse\"===e.pointerType&&(this._mouseXcanvas=e.pageX-this._runtime.GetCanvasClientX(),this._mouseYcanvas=e.pageY-this._runtime.GetCanvasClientY(),this._CheckButtonChanges(e.lastButtons,e.buttons))}_OnPointerMove(e){this._movementX=e.movementX,this._movementY=e.movementY,this.Trigger(a.Plugins.Mouse.Cnds.OnMovement),this._movementX=0,this._movementY=0,\"mouse\"===e.pointerType&&(this._mouseXcanvas=e.pageX-this._runtime.GetCanvasClientX(),this._mouseYcanvas=e.pageY-this._runtime.GetCanvasClientY(),this._CheckButtonChanges(e.lastButtons,e.buttons))}_OnPointerUp(e){\"mouse\"===e.pointerType&&this._CheckButtonChanges(e.lastButtons,e.buttons)}_CheckButtonChanges(e,t){this._CheckButtonChange(e,t,1,0),this._CheckButtonChange(e,t,4,1),this._CheckButtonChange(e,t,2,2),this._CheckButtonChange(e,t,8,3),this._CheckButtonChange(e,t,16,4)}_CheckButtonChange(e,t,s,i){!(e&s)&&t&s?this._OnMouseDown(i):e&s&&!(t&s)&&this._OnMouseUp(i)}_OnMouseDown(e){this._buttonMap[e]=!0,this.Trigger(a.Plugins.Mouse.Cnds.OnAnyClick),this._triggerButton=e,this._triggerType=0,this.Trigger(a.Plugins.Mouse.Cnds.OnClick),this.Trigger(a.Plugins.Mouse.Cnds.OnObjectClicked)}_OnMouseUp(e){this._buttonMap[e]&&(this._buttonMap[e]=!1,this._triggerButton=e,this.Trigger(a.Plugins.Mouse.Cnds.OnRelease))}_OnDoubleClick(e){this._triggerButton=e.button,this._triggerType=1,this.Trigger(a.Plugins.Mouse.Cnds.OnClick),this.Trigger(a.Plugins.Mouse.Cnds.OnObjectClicked)}_OnMouseWheel(e){this._triggerDir=e.deltaY<0?1:0,this._wheelDeltaX=e.deltaX,this._wheelDeltaY=e.deltaY,this._wheelDeltaZ=e.deltaZ,this.Trigger(a.Plugins.Mouse.Cnds.OnWheel)}_OnWindowBlur(){for(let e=0,t=this._buttonMap.length;e<t;++e){if(!this._buttonMap[e])return;this._buttonMap[e]=!1,this._triggerButton=e,this.Trigger(a.Plugins.Mouse.Cnds.OnRelease)}}GetMousePositionForLayer(e){const t=this._runtime.GetMainRunningLayout(),s=this._mouseXcanvas,i=this._mouseYcanvas;if(void 0===e){const r=t.GetLayerByIndex(0);return r.CanvasCssToLayer_DefaultTransform(s,i)}{const n=t.GetLayer(e);return n?n.CanvasCssToLayer(s,i):[0,0]}}IsMouseButtonDown(e){return e=Math.floor(e),!!this._buttonMap[e]}_IsMouseOverCanvas(){return 0<=this._mouseXcanvas&&0<=this._mouseYcanvas&&this._mouseXcanvas<this._runtime.GetCanvasCssWidth()&&this._mouseYcanvas<this._runtime.GetCanvasCssHeight()}SetCursorStyle(e){o!==e&&(o=e,this.PostToDOM(\"cursor\",e))}async SetCursorObjectClass(e){if(!a.Platform.IsMobile&&e){const t=e.GetFirstPicked();if(t){const s=t.GetWorldInfo(),i=t.GetCurrentImageInfo();if(s&&i&&o!==i){const r=await(o=i).ExtractImageToBlobURL(),n=`url(${r}) ${Math.round(s.GetOriginX()*i.GetWidth())} ${Math.round(s.GetOriginY()*i.GetHeight())}, auto`;this.PostToDOM(\"cursor\",n)}}}}_OnPointerLockChange(e){this._UpdatePointerLockState(e[\"has-pointer-lock\"])}_OnPointerLockError(e){this._UpdatePointerLockState(e[\"has-pointer-lock\"]),this.Trigger(a.Plugins.Mouse.Cnds.OnPointerLockError)}_UpdatePointerLockState(e){this._hasPointerLock!==e&&(this._hasPointerLock=e,this._hasPointerLock?this.Trigger(a.Plugins.Mouse.Cnds.OnPointerLocked):this.Trigger(a.Plugins.Mouse.Cnds.OnPointerUnlocked))}GetDebuggerProperties(){const e=\"plugins.mouse\";return[{title:e+\".name\",properties:[{name:e+\".debugger.absolute-position\",value:this._mouseXcanvas+\",\"+this._mouseYcanvas},{name:e+\".debugger.left-button\",value:this._buttonMap[0]},{name:e+\".debugger.middle-button\",value:this._buttonMap[1]},{name:e+\".debugger.right-button\",value:this._buttonMap[2]},{name:e+\".debugger.button-4\",value:this._buttonMap[3]},{name:e+\".debugger.button-5\",value:this._buttonMap[4]}]},{title:e+\".debugger.position-on-each-layer\",properties:this._runtime.GetMainRunningLayout().GetLayers().map(e=>({name:\"$\"+e.GetName(),value:e.CanvasCssToLayer(this._mouseXcanvas,this._mouseYcanvas).join(\", \")}))}]}}}{const Hl=self.C3;Hl.Plugins.Mouse.Cnds={OnClick(e,t){return this._triggerButton===e&&this._triggerType===t},OnAnyClick(){return!0},IsButtonDown(e){return this._buttonMap[e]},OnRelease(e){return this._triggerButton===e},IsOverObject(e){const t=this._runtime.GetCurrentCondition(),s=t.IsInverted(),i=[];return this._IsMouseOverCanvas()&&i.push([this._mouseXcanvas,this._mouseYcanvas]),Hl.xor(this._runtime.GetCollisionEngine().TestAndSelectCanvasPointOverlap(e,i,s),s)},OnObjectClicked(e,t,s){if(e!==this._triggerButton||t!==this._triggerType)return!1;if(!this._IsMouseOverCanvas())return!1;const i=this._mouseXcanvas,r=this._mouseYcanvas;return this._runtime.GetCollisionEngine().TestAndSelectCanvasPointOverlap(s,[[i,r]],!1)},OnWheel(e){return 2===e||this._triggerDir===e},OnPointerLocked(){return!0},OnPointerUnlocked(){return!0},OnPointerLockError(){return!0},HasPointerLock(){return this._hasPointerLock},OnMovement(){return!0}}}{const Xl=self.C3,zl=[\"auto\",\"pointer\",\"text\",\"crosshair\",\"move\",\"help\",\"wait\",\"none\"];Xl.Plugins.Mouse.Acts={SetCursor(e){this.SetCursorStyle(zl[e])},SetCursorSprite(e){this.SetCursorObjectClass(e)},RequestPointerLock(e){this._PostToDOMMaybeSync(\"request-pointer-lock\",{unadjustedMovement:e})},ReleasePointerLock(){this.PostToDOM(\"release-pointer-lock\")}}}{const Yl=self.C3;Yl.Plugins.Mouse.Exps={X(e){return this.GetMousePositionForLayer(e)[0]},Y(e){return this.GetMousePositionForLayer(e)[1]},AbsoluteX(){return this._mouseXcanvas},AbsoluteY(){return this._mouseYcanvas},MovementX(){return this._movementX},MovementY(){return this._movementY},WheelDeltaX(){return this._wheelDeltaX},WheelDeltaY(){return this._wheelDeltaY},WheelDeltaZ(){return this._wheelDeltaZ}}}{const ql=self.C3;ql.Plugins.Keyboard=class extends ql.SDKPluginBase{constructor(e){super(e)}Release(){super.Release()}}}{let s=function(){return t.GetSingleGlobalInstance().GetSdkInstance()};s;const Kl=self.C3;Kl.Plugins.Keyboard.Type=class extends Kl.SDKTypeBase{constructor(e){super(e)}Release(){super.Release()}OnCreate(){}GetScriptInterfaceClass(){return self.IKeyboardObjectType}};let t=null;self.IKeyboardObjectType=class extends self.IObjectClass{constructor(e){super(e),(t=e).GetRuntime()._GetCommonScriptInterfaces().keyboard=this}isKeyDown(e){const t=s();if(\"string\"==typeof e)return t.IsKeyDown(e);if(\"number\"==typeof e)return t.IsKeyCodeDown(e);throw new TypeError(\"expected string or number\")}}}{const Jl=self.C3;Jl.Plugins.Keyboard.Instance=class extends Jl.SDKInstanceBase{constructor(e,t){super(e),this._keysDownByString=new Set,this._keysDownByWhich=new Set,this._triggerWhich=0,this._triggerString=\"\",this._triggerTypedKey=\"\";const s=this.GetRuntime().Dispatcher();this._disposables=new Jl.CompositeDisposable(Jl.Disposable.From(s,\"keydown\",e=>this._OnKeyDown(e.data)),Jl.Disposable.From(s,\"keyup\",e=>this._OnKeyUp(e.data)),Jl.Disposable.From(s,\"window-blur\",()=>this._OnWindowOrKeyboardBlur()),Jl.Disposable.From(s,\"keyboard-blur\",()=>this._OnWindowOrKeyboardBlur()))}Release(){super.Release()}_OnKeyDown(e){const t=e.which,s=e.code||t.toString(),i=e.key;this._keysDownByString.has(s)||(this._keysDownByString.add(s),this._keysDownByWhich.add(t),this._triggerString=s,this._triggerWhich=t,this._triggerTypedKey=i,this.Trigger(Jl.Plugins.Keyboard.Cnds.OnAnyKey),this.Trigger(Jl.Plugins.Keyboard.Cnds.OnKey),this.Trigger(Jl.Plugins.Keyboard.Cnds.OnLeftRightKeyPressed),this.Trigger(Jl.Plugins.Keyboard.Cnds.OnKeyCode))}_OnKeyUp(e){const t=e.which,s=e.code||t.toString(),i=e.key;this._keysDownByString.delete(s),this._keysDownByWhich.delete(t),this._triggerString=s,this._triggerWhich=t,this._triggerTypedKey=i,this.Trigger(Jl.Plugins.Keyboard.Cnds.OnAnyKeyReleased),this.Trigger(Jl.Plugins.Keyboard.Cnds.OnKeyReleased),this.Trigger(Jl.Plugins.Keyboard.Cnds.OnLeftRightKeyReleased),this.Trigger(Jl.Plugins.Keyboard.Cnds.OnKeyCodeReleased)}_OnWindowOrKeyboardBlur(){for(const e of this._keysDownByWhich)this._keysDownByWhich.delete(e),this._triggerWhich=e,this.Trigger(Jl.Plugins.Keyboard.Cnds.OnAnyKeyReleased),this.Trigger(Jl.Plugins.Keyboard.Cnds.OnKeyReleased),this.Trigger(Jl.Plugins.Keyboard.Cnds.OnKeyCodeReleased);this._keysDownByString.clear()}IsKeyDown(e){return this._keysDownByString.has(e)}IsKeyCodeDown(e){return this._keysDownByWhich.has(e)}SaveToJson(){return{tk:this._triggerWhich,tkk:this._triggerTypedKey}}LoadFromJson(e){this._triggerWhich=e.tk,e.hasOwnProperty(\"tkk\")&&(this._triggerTypedKey=e.tkk)}GetDebuggerProperties(){const e=\"plugins.keyboard\";return[{title:e+\".name\",properties:[{name:e+\".debugger.last-key-code\",value:this._triggerWhich},{name:e+\".debugger.last-key-string\",value:Jl.Plugins.Keyboard.Exps.StringFromKeyCode(this._triggerWhich)},{name:e+\".debugger.last-typed-key\",value:this._triggerTypedKey}]}]}}}{const Zl=self.C3,Ql=[\"ShiftLeft\",\"ShiftRight\",\"ControlLeft\",\"ControlRight\",\"AltLeft\",\"AltRight\",\"MetaLeft\",\"MetaRight\"];Zl.Plugins.Keyboard.Cnds={IsKeyDown(e){return this._keysDownByWhich.has(e)},OnKey(e){return this._triggerWhich===e},OnAnyKey(){return!0},OnAnyKeyReleased(){return!0},OnKeyReleased(e){return this._triggerWhich===e},IsKeyCodeDown(e){return e=Math.floor(e),this._keysDownByWhich.has(e)},OnKeyCode(e){return this._triggerWhich===e},OnKeyCodeReleased(e){return this._triggerWhich===e},OnLeftRightKeyPressed(e){const t=Ql[e];return this._triggerString===t},OnLeftRightKeyReleased(e){const t=Ql[e];return this._triggerString===t},IsLeftRightKeyDown(e){const t=Ql[e];return this._keysDownByString.has(t)}}}{const $l=self.C3;$l.Plugins.Keyboard.Acts={}}{let t=function(e){switch(e=Math.floor(e)){case 8:return\"backspace\";case 9:return\"tab\";case 13:return\"enter\";case 16:return\"shift\";case 17:return\"control\";case 18:return\"alt\";case 19:return\"pause\";case 20:return\"capslock\";case 27:return\"esc\";case 33:return\"pageup\";case 34:return\"pagedown\";case 35:return\"end\";case 36:return\"home\";case 37:return\"←\";case 38:return\"↑\";case 39:return\"→\";case 40:return\"↓\";case 45:return\"insert\";case 46:return\"del\";case 91:return\"left window key\";case 92:return\"right window key\";case 93:return\"select\";case 96:return\"numpad 0\";case 97:return\"numpad 1\";case 98:return\"numpad 2\";case 99:return\"numpad 3\";case 100:return\"numpad 4\";case 101:return\"numpad 5\";case 102:return\"numpad 6\";case 103:return\"numpad 7\";case 104:return\"numpad 8\";case 105:return\"numpad 9\";case 106:return\"numpad *\";case 107:return\"numpad +\";case 109:return\"numpad -\";case 110:return\"numpad .\";case 111:return\"numpad /\";case 112:return\"F1\";case 113:return\"F2\";case 114:return\"F3\";case 115:return\"F4\";case 116:return\"F5\";case 117:return\"F6\";case 118:return\"F7\";case 119:return\"F8\";case 120:return\"F9\";case 121:return\"F10\";case 122:return\"F11\";case 123:return\"F12\";case 144:return\"numlock\";case 145:return\"scroll lock\";case 186:return\";\";case 187:return\"=\";case 188:return\",\";case 189:return\"-\";case 190:return\".\";case 191:return\"/\";case 192:return\"'\";case 219:return\"[\";case 220:return\"\\\\\";case 221:return\"]\";case 222:return\"#\";case 223:return\"`\";default:return String.fromCharCode(e)}};t;const ec=self.C3;ec.Plugins.Keyboard.Exps={LastKeyCode(){return this._triggerWhich},StringFromKeyCode(e){return t(e)},TypedKey(){return this._triggerTypedKey}}}{const tc=self.C3;tc.Behaviors.Tween=class extends tc.SDKBehaviorBase{constructor(e){super(e)}Release(){super.Release()}}}{const sc=self.C3;sc.Behaviors.Tween.Type=class extends sc.SDKBehaviorTypeBase{constructor(e){super(e)}Release(){super.Release()}OnCreate(){}}}{const ic=self.C3,rc=ic.Behaviors.Tween;rc.Instance=class extends ic.SDKBehaviorInstanceBase{constructor(e,t){super(e),this._allowMultiple=!1,this._enabled=!0,t&&(this._allowMultiple=!1,this._enabled=!!t[0]),this._activeTweens=new Map,this._disabledTweens=[],this._waitingForReleaseTweens=new Map,this._finishingTween=null,this._activeTweensJson=null,this._disabledTweensJson=null,this._waitingForReleaseTweensJson=null,this._finishingTweenName=\"\",this._triggerTweens=[],this._afterLoad=e=>this._OnAfterLoad(),this.GetRuntime().Dispatcher().addEventListener(\"afterload\",this._afterLoad)}Release(){this.GetRuntime().Dispatcher().removeEventListener(\"afterload\",this._afterLoad),this._afterLoad=null,this._finishingTween&&(this.ReleaseAndCompleteTween(this._finishingTween),this._finishingTween=null),this.ReleaseAndCompleteTweens(),this._tweens=null,this.ClearDisabledList(),this._disabledTweens=null,this._ReleaseWaitingTweens(),this._waitingForReleaseTweens=null,this._triggerTweens=null,super.Release()}PushTriggerTween(e){this._triggerTweens.push(e)}PopTriggerTween(){this._triggerTweens.pop()}GetTriggerTween(){return this._triggerTweens[this._triggerTweens.length-1]}SetEnabled(e){this._enabled=!!e,e?this._waitingForReleaseTweens&&this._waitingForReleaseTweens.size&&this._StartTicking2():this._StopTicking2();for(const t of this.AllTweens())e?this.IsInDisabledList(t)&&t.Resume():((t.IsPlaying()||t.IsScheduled())&&this.AddToDisabledList(t),t.Stop());e&&this.ClearDisabledList()}IsEnabled(){return this._enabled}AddToDisabledList(e){this._disabledTweens.push(e)}IsInDisabledList(e){return this._disabledTweens.includes(e)}ClearDisabledList(){ic.clearArray(this._disabledTweens)}GetFinishingTween(){return this._finishingTween}IsInstanceValid(){const e=this.GetObjectInstance();return!!e&&!e.IsDestroyed()}GetTween(e,t,s=!1){const i=t?this.PropertyTweens(t,s):this.AllTweens(s);if(i&&i.length)for(const r of i)if(r.HasTags(e))return r}CheckTweensWithTags(e,t){for(const s of this._activeTweens.values())for(const i of s)if(!i.IsReleased()&&i.HasTags(e)&&t(i))return!0;for(const r of this._waitingForReleaseTweens.values())for(const n of r)if(!n.IsReleased()&&n.HasTags(e)&&t(n))return!0;return!1}CheckTweens(e){for(const t of this._activeTweens.values())for(const s of t)if(!s.IsReleased()&&e(s))return!0;for(const i of this._waitingForReleaseTweens.values())for(const r of i)if(!r.IsReleased()&&e(r))return!0;return!1}GetTweenIncludingWaitingForRelease(e,t){return this.GetTween(e,t,!0)}*GetTweens(e,t,s=!1){const i=t?this.PropertyTweens(t,s):this.AllTweens(s);if(i&&i.length)for(const r of i)r.HasTags(e)&&(yield r)}*GetTweensIncludingWaitingForRelease(e,t){yield*this.GetTweens(e,t,!0)}PropertyTweens(s,e){if(e){let e=this._activeTweens.get(s),t=this._waitingForReleaseTweens.get(s);return(e=e||[]).concat(t||[]).filter(e=>e).filter(e=>!e.IsReleased())}{let e=this._activeTweens.get(s);return(e=e||[]).filter(e=>e).filter(e=>!e.IsReleased())}}AllTweens(e){if(e){const t=[...this._activeTweens.values()].flat(),s=[...this._waitingForReleaseTweens.values()].flat();return t.concat(s).filter(e=>e).filter(e=>!e.IsReleased())}{const i=[...this._activeTweens.values()].flat();return i.filter(e=>e).filter(e=>!e.IsReleased())}}AllTweensIncludingWaitingForRelease(){return this.AllTweens(!0)}SaveToJson(e=0){return{s:!1,e:!!this._enabled,at:this._SaveActiveTweensToJson(),dt:this._SaveDisabledTweensToJson(),wt:this._SaveWaitingForReleaseTweensToJson(),ft:this._SaveFinishingTweenToJson()}}LoadFromJson(e,t=\"full\"){e&&(this._activeTweensJson=e.at,this._disabledTweensJson=e.dt,this._waitingForReleaseTweensJson=e.wt,this._finishingTweenName=e.ft,this._allowMultiple=!1,this._enabled=!!e.e,\"state\"===t)&&this._OnAfterLoad()}_OnAfterLoad(){const e=this.GetRuntime().GetTimelineManager();if(this._PopulateTweenMap(this._activeTweensJson,this._activeTweens,e),this._disabledTweensJson){ic.clearArray(this._disabledTweens);for(const t of this._disabledTweensJson)this._PopulateTweenArray(this._disabledTweens,t,e)}this._PopulateTweenMap(this._waitingForReleaseTweensJson,this._waitingForReleaseTweens,e),this._finishingTween=this._GetTween(this._finishingTweenName,e),this._enabled?this._waitingForReleaseTweens&&this._waitingForReleaseTweens.size&&this._StartTicking2():this._StopTicking2()}_PopulateTweenMap(t,s,i){if(t)for(const r in t){let e=s.get(r);e?ic.clearArray(e):e=[];const n=t[r];for(const a of n){const o=this._PopulateTweenArray(e,a.name,i);if(o)this._LoadTweenFromJson(a.name,a,i);else{const h=ic.TweenState.Build({runtime:this.GetRuntime(),json:a});ic.TweenState.SetInstanceUID(h,this.GetObjectInstance().GetUID()),h.AddCompletedCallback(e=>this._FinishTriggers(e)),i.AddScheduledTimeline(h),this._PopulateTweenArray(e,h,i)}}s.set(r,e)}}_GetTween(e,t){return t.GetScheduledOrPlayingTimelineByName(e)}_PopulateTweenArray(e,t,s){if(\"string\"!=typeof t)return!!e.push(t);{const i=this._GetTween(t,s);if(i)return!!e.push(i)}return!1}_LoadTweenFromJson(e,t,s){if(\"string\"==typeof e){const i=this._GetTween(e,s);i&&(i._LoadFromJson(t),ic.TweenState.SetInstanceUID(i,this.GetObjectInstance().GetUID()))}else e._LoadFromJson(t),ic.TweenState.SetInstanceUID(e,this.GetObjectInstance().GetUID())}_SaveActiveTweensToJson(){const e={};for(const[t,s]of this._activeTweens)e[t]=s.filter(e=>!e.IsReleased()).map(e=>e._SaveToJson());return e}_SaveDisabledTweensToJson(){return this._disabledTweens.filter(e=>!e.IsReleased()).map(e=>e.GetName())}_SaveWaitingForReleaseTweensToJson(){const e={};for(const[t,s]of this._waitingForReleaseTweens)e[t]=s.map(e=>e._SaveToJson());return e}_SaveFinishingTweenToJson(){return this._finishingTween?this._finishingTween.GetName():\"\"}Tick2(){this._ReleaseWaitingTweens()}CreateTween(e){const t=rc.Config.GetPropertyTracksConfig(e.property,e.startValue,e.endValue,e.ease,e.resultMode,this.GetObjectInstance()),s=rc.Maps.GetPropertyFromIndex(e.property),i=(rc.Maps.IsValueId(s)||this.ReleaseTweens(e.property),ic.TweenState.Build({runtime:this.GetRuntime(),id:s,tags:e.tags,time:e.time,instance:this.GetObjectInstance(),releaseOnComplete:!!e.releaseOnComplete,loop:!!e.loop,pingPong:!!e.pingPong,repeatCount:e.repeatCount,initialValueMode:e.initialValueMode,propertyTracksConfig:t}));return i.AddCompletedCallback(e=>this._FinishTriggers(e)),this._AddTween(i,e.property),i}_MaybeRemoveFromActiveTweenMap(e){const t=e.GetId();if(this._activeTweens.has(t)){const s=this._activeTweens.get(t);if(s){const i=s.indexOf(e);-1!==i&&s.splice(i,1)}}}ReleaseTween(e,t=!1){this._MaybeRemoveFromActiveTweenMap(e),e.IsReleased()||this._IsInWaitingList(e)||(e.Stop(t),this._AddToWaitingList(e))}ReleaseTweens(e,t=!1){if(ic.IsFiniteNumber(e)){const s=rc.Maps.GetPropertyFromIndex(e);if(this._activeTweens.has(s)){const i=this._activeTweens.get(s),r=this.GetFinishingTween();for(const n of i)n===r||n.IsReleased()||this._IsInWaitingList(n)||(n.Stop(t),n.Release());ic.clearArray(i)}}else{const a=this.GetFinishingTween();for(const o of this.AllTweens())o===a||o.IsReleased()||this._IsInWaitingList(o)||(o.Stop(t),o.Release());for(const h of this._activeTweens.keys())ic.clearArray(this._activeTweens.get(h)),this._activeTweens.delete(h);this._activeTweens.clear()}}ReleaseAndCompleteTween(e){this.ReleaseTween(e,!0)}ReleaseAndCompleteTweens(){this.ReleaseTweens(NaN,!0)}GetPropertyValueByIndex(e){if(0===e)return this._enabled}SetPropertyValueByIndex(e,t){0===e&&(this._enabled=!!t)}_GetBehaviorType(e){const t=e.GetInstance(),s=t.GetBehaviorInstances();for(const i of s){const r=i.GetBehaviorType();if(r.GetInstanceSdkCtor()===this.constructor)return r}}Trigger(e,t,s,i){return this._runtime?super.Trigger(e):t.Trigger(e,s,i)}_FinishTriggers(e){this._finishingTween=e,rc.Cnds.SetFinishingTween(e);let t,s;if(this.GetRuntime())t=this._inst,s=this._runtime,this.Trigger(rc.Cnds.OnTweensFinished),this.Trigger(rc.Cnds.OnAnyTweensFinished),this.ReleaseTween(e);else{if(!(t=e.GetInstance()))return;if(t&&t.IsDestroyed())return;s=t.GetRuntime();const i=this._GetBehaviorType(e);this.Trigger(rc.Cnds.OnTweensFinished,s,t,i),this.Trigger(rc.Cnds.OnAnyTweensFinished,s,t,i),e.Stop()}this._finishingTween=null,rc.Cnds.SetFinishingTween(null),e.GetDestroyInstanceOnComplete()&&s.DestroyInstance(t)}_AddTween(e,t){const s=rc.Maps.GetPropertyFromIndex(t),i=(this._activeTweens.has(s)||this._activeTweens.set(s,[]),this._activeTweens.get(s));i.push(e)}_AddToWaitingList(e){const t=e.GetId();this._waitingForReleaseTweens.has(t)||this._waitingForReleaseTweens.set(t,[]),this._waitingForReleaseTweens.get(t).push(e),this.IsTicking2()||this._StartTicking2()}_IsInWaitingList(e){const t=e.GetId();return!!this._waitingForReleaseTweens.has(t)&&this._waitingForReleaseTweens.get(t).includes(e)}_ReleaseWaitingTweens(){if(this._waitingForReleaseTweens.size){for(const e of this._waitingForReleaseTweens.values()){for(const t of e)t.IsReleased()||t.Release();ic.clearArray(e)}this._waitingForReleaseTweens.clear(),this.IsTicking2()&&this._StopTicking2()}}GetDebuggerProperties(){return[{title:\"$\"+this.GetBehaviorType().GetName(),properties:[{name:\"behaviors.tween.properties.enabled.name\",value:this.IsEnabled(),onedit:e=>this.SetEnabled(e)}]}]}GetScriptInterfaceClass(){return self.ITweenBehaviorInstance}}}{let s=self.C3,t=null;s.Behaviors.Tween.Cnds={OnAnyTweenLoop(){return!0},OnTweensLoop(e){const t=this.GetTriggerTween();return!!t&&t.HasTags(e)},OnAnyTweenPingPong(e){const t=this.GetTriggerTween();return!!t&&(t.GetPingPongState()===e||2===e)},OnTweensPingPong(e,t){const s=this.GetTriggerTween();return!!s&&(s.GetPingPongState()===t||2===t)&&s.HasTags(e)},SetFinishingTween(e){t=e},OnTweensFinished(e){return t.HasTags(e)},OnAnyTweensFinished(){return!0},IsPlaying(e){return this.CheckTweensWithTags(e,s.TweenState.IsPlaying)},IsAnyPlaying(){return this.CheckTweens(s.TweenState.IsPlaying)},IsPaused(e){return this.CheckTweensWithTags(e,s.TweenState.IsPaused)},IsAnyPaused(){return this.CheckTweens(s.TweenState.IsPaused)},IsPingPong(e,t){return 0===t?this.CheckTweensWithTags(e,s.TweenState.IsPing):1===t&&this.CheckTweensWithTags(e,s.TweenState.IsPong)},IsAnyPingPong(e){return 0===e?this.CheckTweens(s.TweenState.IsPing):1===e&&this.CheckTweens(s.TweenState.IsPong)}}}{const nc=self.C3,ac=self.Ease,oc=nc.Behaviors.Tween;oc.Acts={SetEnabled(e){this.SetEnabled(!!e)},async TweenOneProperty(...e){if(this.IsEnabled()&&this.IsInstanceValid()){const t=this.CreateTween(oc.TweenArguments.OneProperty(this,...e));t.Play()&&await t.GetPlayPromise()}},async TweenTwoProperties(...e){if(this.IsEnabled()&&this.IsInstanceValid()){const t=this.CreateTween(oc.TweenArguments.TwoProperties(this,...e));t.Play()&&await t.GetPlayPromise()}},async TweenValue(...e){if(this.IsEnabled()&&this.IsInstanceValid()){const t=this.CreateTween(oc.TweenArguments.ValueProperty(this,...e));t.Play()&&await t.GetPlayPromise()}},PauseTweens(e){if(this.IsEnabled()&&this.IsInstanceValid())for(const t of this.GetTweens(e))t.Stop()},PauseAllTweens(){if(this.IsEnabled()&&this.IsInstanceValid())for(const e of this.AllTweens())e.Stop()},ResumeTweens(e){if(this.IsEnabled()&&this.IsInstanceValid())for(const t of this.GetTweens(e))t.Resume()},ResumeAllTweens(){if(this.IsEnabled()&&this.IsInstanceValid())for(const e of this.AllTweens())e.Resume()},StopTweens(e){if(this.IsEnabled()&&this.IsInstanceValid())for(const t of this.GetTweens(e))this.ReleaseTween(t)},StopAllTweens(){if(this.IsEnabled()&&this.IsInstanceValid())for(const e of this.AllTweens())this.ReleaseTween(e)},SetOnePropertyTweensEndValue(e,t,s){if(this.IsEnabled()&&this.IsInstanceValid()){const i=nc.Behaviors.Tween.Maps.GetSinglePropertyFromIndex(t);for(const r of this.GetTweens(e))r.BeforeSetEndValues([i]),r.SetEndValue(s,i)}},SetTwoPropertiesTweensEndValue(e,t,s,i){if(this.IsEnabled()&&this.IsInstanceValid()){const r=nc.Behaviors.Tween.Maps.GetRealProperties(t);for(const n of this.GetTweens(e))n.BeforeSetEndValues(r),n.SetEndValue(s,r[0]),n.SetEndValue(i,r[1])}},SetValuePropertyTweensStartValue(e,t){if(this.IsEnabled()&&this.IsInstanceValid())for(const s of this.GetTweens(e,\"value\"))s.SetStartValue(t,\"value\")},SetValuePropertyTweensEndValue(e,t){if(this.IsEnabled()&&this.IsInstanceValid())for(const s of this.GetTweens(e,\"value\"))s.BeforeSetEndValues([\"value\"]),s.SetEndValue(t,\"value\")},SetTweensEase(e,t){if(this.IsEnabled()&&this.IsInstanceValid()){const s=ac.GetEaseFromIndex(t);for(const i of this.GetTweens(e))i.SetEase(s)}},SetAllTweensEase(e){if(this.IsEnabled()&&this.IsInstanceValid()){const t=ac.GetEaseFromIndex(e);for(const s of this.AllTweens())s.SetEase(t)}},SetTweensTime(e,t){if(this.IsEnabled()&&this.IsInstanceValid())for(const s of this.GetTweens(e))s.SetTime(t)},SetAllTweensTime(e){if(this.IsEnabled()&&this.IsInstanceValid())for(const t of this.AllTweens())t.SetTime(e)},SetTweensPlaybackRate(e,t){if(this.IsEnabled()&&this.IsInstanceValid())for(const s of this.GetTweens(e))s.SetPlaybackRate(t)},SetAllTweensPlaybackRate(e){if(this.IsEnabled()&&this.IsInstanceValid())for(const t of this.AllTweens())t.SetPlaybackRate(e)},SetTweensDestroyOnComplete(e,t){if(this.IsEnabled()&&this.IsInstanceValid())for(const s of this.GetTweens(e))s.SetDestroyInstanceOnComplete(!!t)},SetAllTweensDestroyOnComplete(e){if(this.IsEnabled()&&this.IsInstanceValid())for(const t of this.AllTweens())t.SetDestroyInstanceOnComplete(!!e)}}}{const hc=self.C3;hc.Behaviors.Tween.Exps={Time(e){const t=this.GetTweenIncludingWaitingForRelease(e);return t?t.GetTime():0},Progress(e){const t=this.GetTweenIncludingWaitingForRelease(e);return t?t.GetTime()/t.GetTotalTime():0},PlaybackRate(e){const t=this.GetTweenIncludingWaitingForRelease(e);return t?t.GetPlaybackRate():0},Value(e){const t=this.GetTweenIncludingWaitingForRelease(e,\"value\");return t?t.GetPropertyTrack(\"value\").GetSourceAdapterValue():0},Tags(){let e=this.GetFinishingTween();return(e=e||this.GetTriggerTween())?e.GetStringTags():\"\"}}}{const lc=self.C3,cc=self.Ease,uc=[\"position\",\"size\",\"scale\"],_c=[\"offsetX\",\"offsetY\",\"offsetWidth\",\"offsetHeight\",\"offsetAngle\",\"offsetOpacity\",\"offsetColor\",\"offsetZElevation\",\"offsetScaleX\",\"offsetScaleY\"],dc=[\"value\"],pc=[].concat(uc).concat(_c).concat(dc),fc={position:[\"offsetX\",\"offsetY\"],size:[\"offsetWidth\",\"offsetHeight\"],scale:[\"offsetScaleX\",\"offsetScaleY\"]},mc=Object.assign({},pc.reduce((e,t)=>Object.assign({},e,{[t]:[t]}),{}),fc);lc.Behaviors.Tween.Maps=class{constructor(){}static GetEases(){return[...cc.GetRuntimeEaseNames()]}static GetEaseFromIndex(e){return[...cc.GetRuntimeEaseNames()][e]}static GetPropertyFromIndex(e){return pc[e]}static GetPropertyIndexFromName(e){return pc.indexOf(e)}static GetPairPropertyFromIndex(e){return uc[e]}static GetSinglePropertyFromIndex(e){return _c[e]}static GetValuePropertyFromIndex(e){return dc[e]}static GetPairProperties(e){return fc[e]}static GetRealProperties(e){return lc.IsString(e)?mc[e]:mc[pc[e]]}static IsPairId(e){return!!fc[e]}static IsColorId(e){return\"offsetColor\"===e}static IsAngleId(e){return\"offsetAngle\"===e}static IsOpacityId(e){return\"offsetOpacity\"===e}static IsValueId(e){return\"value\"===e}}}{const gc=self.C3,Sc=gc.Behaviors.Tween,yc=new Map;Sc.Config=class{constructor(){}static GetPropertyTracksConfig(e,t,s,i,r,n){0===yc.size&&this._CreateConfigObjects();let a=Sc.PropertyTypes.Pick(e),o=yc.get(a);return gc.IsFiniteNumber(e)&&(e=Sc.Maps.GetPropertyFromIndex(e)),this._GetConfig(o,e,t,s,i,r,n)}static TransformValue(e,t){const s=gc.Behaviors.Tween.GetPropertyTracksConfig(e);return s.valueGetter(t)}static _CreateConfigObjects(){const e=Sc.PropertyTypes,t=Sc.ValueGetters;this._AddConfigObject(e.PAIR,this._GetPairConfig,t._GetPropertyValue),this._AddConfigObject(e.COLOR,this._GetColorConfig,t._GetColorPropertyValue),this._AddConfigObject(e.ANGLE,this._GetAngleConfig,t._GetPropertyAngleValue),this._AddConfigObject(e.VALUE,this._GetValueConfig,t._GetPropertyValue),this._AddConfigObject(e.OTHER,this._GetCommonConfig,t._GetPropertyValue)}static _AddConfigObject(e,t,s){yc.set(e,this._CreateConfigObject(e,t,s))}static _CreateConfigObject(e,t,s){return{name:e,configFunc:t,valueGetter:s}}static _GetConfig(e,t,s,i,r,n,a){return e.configFunc(t,e.valueGetter(s),e.valueGetter(i),r,n,a)}static _GetPairConfig(e,s,i,r,n,t){const a=Sc.Maps.GetPairProperties(e);return a.map((e,t)=>({sourceId:\"world-instance\",property:e,type:\"float\",valueType:\"numeric\",startValue:s[t],endValue:i[t],ease:Sc.Maps.GetEaseFromIndex(r),resultMode:n}))}static _GetColorConfig(e,t,s,i,r,n){return gc.Plugins.Text&&n.GetPlugin()instanceof gc.Plugins.Text?{sourceId:\"plugin\",sourceArgs:[7],property:\"color\",type:\"color\",valueType:\"color\",startValue:t,endValue:s,ease:Sc.Maps.GetEaseFromIndex(i),resultMode:r}:{sourceId:\"world-instance\",property:e,type:\"color\",valueType:\"color\",startValue:t,endValue:s,ease:Sc.Maps.GetEaseFromIndex(i),resultMode:r}}static _GetAngleConfig(e,t,s,i,r,n){return{sourceId:\"world-instance\",property:e,type:\"angle\",valueType:\"angle\",startValue:t,endValue:s,ease:Sc.Maps.GetEaseFromIndex(i),resultMode:r}}static _GetCommonConfig(e,t,s,i,r,n){return{sourceId:\"world-instance\",property:e,type:\"float\",valueType:\"numeric\",startValue:t,endValue:s,ease:Sc.Maps.GetEaseFromIndex(i),resultMode:r}}static _GetValueConfig(e,t,s,i,r,n){return{sourceId:\"value\",property:e,type:\"float\",valueType:\"numeric\",startValue:t,endValue:s,ease:Sc.Maps.GetEaseFromIndex(i),resultMode:r}}}}{const Gc=self.C3,Ic=Gc.Behaviors.Tween,Tc={resultMode:\"absolute\"},Cc=Object.assign({},Tc,{tags:\"\",property:\"\",time:0,ease:0,releaseOnComplete:0,loop:!1,pingPong:!1,repeatCount:1}),bc=Object.assign({},Cc,{initialValueMode:\"current-state\",startValue:0,endValue:0}),wc=Object.assign({},Cc,{initialValueMode:\"current-state\",startValue:[0,0],endValue:[0,0]}),xc=Object.assign({},Cc,{initialValueMode:\"current-state\",startValue:[0,0,0],endValue:[0,0,0]}),vc=Object.assign({},bc,{initialValueMode:\"start-value\"});Ic.TweenArguments=class{constructor(){}static _SetCommonProperties(e,t,s,i,r,n,a,o){e.tags=t,e.time=s,e.ease=i,e.releaseOnComplete=r,e.loop=n,e.pingPong=a,e.repeatCount=o}static OneProperty(e,t,s,i,r,n,a,o,h,l){const c=\"string\"==typeof s?s:Ic.Maps.GetSinglePropertyFromIndex(s),u=Ic.Maps.IsColorId(c)?xc:bc;return this._SetCommonProperties(u,t,r,n,a,o,h,l),Ic.Maps.IsColorId(c)?(xc.endValue[0]=Gc.GetRValue(i),xc.endValue[1]=Gc.GetGValue(i),xc.endValue[2]=Gc.GetBValue(i),xc.property=Ic.Maps.GetPropertyIndexFromName(c)):Ic.Maps.IsOpacityId(c)?bc.endValue=i/100:bc.endValue=i,u.property=Ic.Maps.GetPropertyIndexFromName(c),u}static TwoProperties(e,t,s,i,r,n,a,o,h,l,c){this._SetCommonProperties(wc,t,n,a,o,h,l,c);const u=\"string\"==typeof s?s:Ic.Maps.GetPairPropertyFromIndex(s);return wc.endValue[0]=i,wc.endValue[1]=r,wc.property=Ic.Maps.GetPropertyIndexFromName(u),wc}static ValueProperty(e,t,s,i,r,n,a,o,h,l){return this._SetCommonProperties(vc,t,r,n,a,o,h,l),vc.startValue=s,vc.endValue=i,vc.property=Ic.Maps.GetPropertyIndexFromName(\"value\"),vc}}}{const Pc=self.C3,Rc=Pc.Behaviors.Tween,Ac=[];Rc.PropertyTypes=class{constructor(){}static Pick(e){if(0===Ac.length){const t=Ac;t.push({checkFunc:Rc.Maps.IsPairId,result:this.PAIR}),t.push({checkFunc:Rc.Maps.IsColorId,result:this.COLOR}),t.push({checkFunc:Rc.Maps.IsAngleId,result:this.ANGLE}),t.push({checkFunc:Rc.Maps.IsValueId,result:this.VALUE}),t.push({checkFunc:()=>!0,result:this.OTHER})}Pc.IsFiniteNumber(e)&&(e=Pc.Behaviors.Tween.Maps.GetPropertyFromIndex(e));for(const s of Ac)if(s.checkFunc(e))return s.result}static get PAIR(){return\"pair\"}static get COLOR(){return\"color\"}static get ANGLE(){return\"angle\"}static get VALUE(){return\"value\"}static get OTHER(){return\"other\"}}}{const Mc=self.C3,Dc=Mc.Behaviors.Tween;Dc.ValueGetters=class{constructor(){}static _GetPropertyAngleValue(e){const t=Mc.toRadians(parseFloat(e));return Mc.clampAngle(t)}static _GetColorPropertyValue(e){return e.slice(0)}static _GetPropertyValue(e){return e}}}{let l=function(e){Fc.RequireString(e);let t=Oc.ToInternal(e),s;if(-1===(s=t?Oc.GetIndexForEase(t,null):Oc.GetIndexForEase(e,null)))throw new Error(`invalid ease name '${e}'`);return s},c=function(e,t=!1){if(!(t&&null==e||\"string\"==typeof e||Array.isArray(e)))throw new Error(\"invalid tags\")};l,c;const Ec=self.C3,Fc=self.C3X,Bc=self.IBehaviorInstance,Oc=self.Ease,Lc=Ec.Behaviors.Tween,kc=new WeakMap,Nc=new Map([[\"x\",{name:\"offsetX\",type:\"one\"}],[\"y\",{name:\"offsetY\",type:\"one\"}],[\"width\",{name:\"offsetWidth\",type:\"one\"}],[\"height\",{name:\"offsetHeight\",type:\"one\"}],[\"angle\",{name:\"offsetAngle\",type:\"one\"}],[\"opacity\",{name:\"offsetOpacity\",type:\"one\"}],[\"color\",{name:\"offsetColor\",type:\"color\"}],[\"z-elevation\",{name:\"offsetZElevation\",type:\"one\"}],[\"x-scale\",{name:\"offsetScaleX\",type:\"one\"}],[\"y-scale\",{name:\"offsetScaleY\",type:\"one\"}],[\"position\",{name:\"position\",type:\"two\"}],[\"size\",{name:\"size\",type:\"two\"}],[\"scale\",{name:\"scale\",type:\"two\"}],[\"value\",{name:\"value\",type:\"value\"}]]),Wc={tags:\"\",destroyOnComplete:!1,loop:!1,pingPong:!1,repeatCount:1,startValue:0},Vc={easeToIndexFunc:l};self.ITweenBehaviorInstance=class extends Bc{constructor(){super(),kc.set(this,Bc._GetInitInst().GetSdkInstance())}startTween(e,t,s,i,r){const n=kc.get(this);if(!n.IsEnabled()||!n.IsInstanceValid())return null;const a=Nc.get(e);if(!a)throw new Error(\"invalid tween property\");\"one\"===a.type||\"value\"===a.type?Fc.RequireNumber(t):(Fc.RequireArray(t),\"two\"===a.type?(Fc.RequireNumber(t[0]),Fc.RequireNumber(t[1])):\"color\"===a.type&&(Fc.RequireNumber(t[0]),Fc.RequireNumber(t[1]),Fc.RequireNumber(t[2]))),\"angle\"===e?t=Ec.toDegrees(t):\"opacity\"===e?t*=100:\"color\"===e&&(t=Ec.PackRGBEx(t[0],t[1],t[2]));const o=l(i);Fc.RequireFiniteNumber(s),r=Object.assign({},Wc,r),\"value\"===a.type&&Fc.RequireNumber(r.startValue),c(r.tags,!0);let h;if(\"one\"===a.type||\"color\"===a.type?h=n.CreateTween(Lc.TweenArguments.OneProperty(n,r.tags,a.name,t,s,o,!!r.destroyOnComplete,!!r.loop,!!r.pingPong,r.repeatCount)):\"two\"===a.type?h=n.CreateTween(Lc.TweenArguments.TwoProperties(n,r.tags,a.name,t[0],t[1],s,o,!!r.destroyOnComplete,!!r.loop,!!r.pingPong,r.repeatCount)):\"value\"===a.type&&(h=n.CreateTween(Lc.TweenArguments.ValueProperty(n,r.tags,r.startValue,t,s,o,!!r.destroyOnComplete,!!r.loop,!!r.pingPong,r.repeatCount))),h.Play())return h.GetITweenState(n,Vc);throw new Error(\"failed to start tween\")}*allTweens(){const e=kc.get(this);for(const t of e.AllTweens())yield t.GetITweenState(e,Vc)}*tweensByTags(e){c(e);const t=kc.get(this);for(const s of t.GetTweens(e))yield s.GetITweenState(t,Vc)}get isEnabled(){return kc.get(this).IsEnabled()}set isEnabled(e){kc.get(this).SetEnabled(e)}}}{let e=function(e,t){return\"number\"==typeof e&&\"number\"==typeof t};e,0;self.C3_ExpressionFuncs=[e=>{const t=e._GetNode(0).GetBoundMethod();return()=>\"SlotGen - ver \"+t()},()=>\"Slotgen Bet Option\",()=>\"BetOption\",e=>{const t=e._GetNode(0).GetVar();return()=>t.GetValue()},e=>{const t=e._GetNode(0);return()=>t.ExpObject()},()=>680,()=>1,e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1).GetVar();return()=>t(s.GetValue(),\",\")+2},()=>113,e=>{const t=e._GetNode(0).GetVar(),s=e._GetNode(1).GetBoundMethod();return()=>t.GetValue()+70*(s()-1)},()=>\"\",e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1).GetVar(),i=e._GetNode(2).GetBoundMethod();return()=>t(s.GetValue(),i()-1,\",\")},e=>{const t=e._GetNode(0).GetBoundMethod();return()=>t()},()=>0,()=>\"-\",e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1).GetVar();return()=>t(s.GetValue(),\",\")+1},e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1);return()=>t(s.ExpObject())},()=>302,()=>470,()=>642,e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1).GetBoundMethod(),i=e._GetNode(2).GetBoundMethod(),r=e._GetNode(3).GetVar(),n=e._GetNode(4).GetBoundMethod(),a=e._GetNode(5).GetBoundMethod(),o=e._GetNode(6).GetVar(),h=e._GetNode(7).GetBoundMethod(),l=e._GetNode(8).GetBoundMethod(),c=e._GetNode(9).GetVar();return()=>t(s(i(r.GetValue(),0,\",\")),n(a(o.GetValue(),1,\",\")),h(l(c.GetValue(),2,\",\")))},()=>.1,e=>{const t=e._GetNode(0).GetVar(),s=e._GetNode(1).GetVar();return()=>\"null\"===t.GetValue()?\"\":s.GetValue()},()=>\"0\",()=>\"1\",e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1).GetVar();return()=>t(s.GetValue(),0,\",\")},e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1).GetVar(),i=e._GetNode(2).GetBoundMethod(),r=e._GetNode(3).GetVar();return()=>t(s.GetValue(),i(r.GetValue(),\",\")-1,\",\")},e=>{const t=e._GetNode(0).GetVar(),s=e._GetNode(1);return()=>t.GetValue()-s.ExpObject()},()=>\"moveY\",e=>{const t=e._GetNode(0),s=e._GetNode(1).GetVar();return()=>t.ExpObject()+s.GetValue()},()=>.2,e=>{const t=e._GetNode(0).GetBoundMethod();return()=>t(\"BetOption\")},()=>\"BO_betsize_txt\",e=>{const t=e._GetNode(0).GetVar(),s=e._GetNode(1).GetVar();return()=>t.GetValue()+s.GetValue()},()=>\"tweenY\",e=>{const t=e._GetNode(0),s=e._GetNode(1).GetVar();return()=>t.ExpObject()-s.GetValue()},()=>\"BO_betlevel_txt\",()=>\"BO_line_txt\",()=>\"BO_betamount_txt\",()=>\"tweenYB\",e=>{const t=e._GetNode(0).GetVar(),s=e._GetNode(1).GetVar();return()=>t.GetValue()-s.GetValue()},e=>{const t=e._GetNode(0),s=e._GetNode(1).GetBoundMethod(),i=e._GetNode(2);return()=>t.ExpObject()+(s()-i.ExpInstVar())},()=>\"close\",()=>.5,()=>\"open\",()=>2692,()=>80,()=>20]}var e=self.C3;self.C3_GetObjectRefTable=function(){return[e.Plugins.TiledBg,e.Plugins.Text,e.Plugins.Sprite,e.Behaviors.Tween,e.Plugins.Touch,e.Plugins.Mouse,e.Plugins.Keyboard,e.Plugins.System.Cnds.OnLayoutStart,e.Plugins.Text.Acts.SetText,e.Plugins.System.Exps.projectversion,e.Plugins.System.Cnds.IsGroupActive,e.Behaviors.Tween.Cnds.IsAnyPlaying,e.Plugins.System.Acts.SetLayerScroll,e.Plugins.Sprite.Exps.Y,e.ScriptsInEvents.Main_Event4_Act1,e.ScriptsInEvents.Main_Event4_Act2,e.ScriptsInEvents.Main_Event4_Act3,e.ScriptsInEvents.Main_Event4_Act4,e.ScriptsInEvents.Main_Event4_Act5,e.ScriptsInEvents.Main_Event4_Act7,e.Plugins.System.Acts.WaitForPreviousActions,e.Plugins.System.Acts.Wait,e.ScriptsInEvents.Main_Event4_Act11,e.Plugins.Sprite.Acts.SetInstanceVar,e.Plugins.System.Cnds.Repeat,e.Plugins.System.Exps.tokencount,e.Plugins.System.Acts.CreateObject,e.Plugins.System.Exps.loopindex,e.Plugins.Text.Acts.ZMoveToObject,e.Plugins.System.Exps.tokenat,e.Plugins.Text.Acts.SetInstanceVar,e.Plugins.Text.Acts.SetVisible,e.Plugins.Text.Exps.X,e.Plugins.Text.Exps.Y,e.Plugins.Text.Acts.AddChild,e.Plugins.System.Cnds.Compare,e.Plugins.Text.Cnds.CompareText,e.Plugins.System.Acts.SetVar,e.Plugins.System.Exps.float,e.Plugins.Text.Exps.Text,e.ScriptsInEvents.Main_Event9_Act2,e.Plugins.Sprite.Acts.SetDefaultColor,e.Plugins.System.Exps.rgbex255,e.Plugins.Text.Acts.SetFontColor,e.ScriptsInEvents.Main_Event19_Act2,e.Plugins.System.Cnds.CompareBoolVar,e.Plugins.System.Acts.SetBoolVar,e.ScriptsInEvents.Main_Event21_Act15,e.ScriptsInEvents.Main_Event21_Act16,e.ScriptsInEvents.Main_Event21_Act17,e.Plugins.System.Cnds.TriggerOnce,e.Plugins.Text.Acts.Destroy,e.Plugins.System.Cnds.CompareVar,e.ScriptsInEvents.Main_Event23_Act1,e.ScriptsInEvents.Main_Event24_Act1,e.ScriptsInEvents.Main_Event25_Act2,e.ScriptsInEvents.Main_Event26_Act3,e.Behaviors.Tween.Acts.TweenOneProperty,e.Plugins.Touch.Cnds.OnTouchObject,e.Plugins.Touch.Cnds.IsTouchingObject,e.Plugins.Touch.Exps.Y,e.Plugins.Text.Exps.ObjectTypeName,e.Plugins.Mouse.Cnds.OnWheel,e.Plugins.Text.Cnds.PickDistance,e.Plugins.Mouse.Exps.X,e.Plugins.Mouse.Exps.Y,e.Plugins.Text.Cnds.CompareInstanceVar,e.Plugins.Text.Cnds.CompareY,e.Plugins.Touch.Cnds.OnTapGestureObject,e.ScriptsInEvents.Main_Event95_Act1,e.ScriptsInEvents.Main_Event97_Act2,e.Plugins.Sprite.Cnds.CompareInstanceVar,e.Plugins.Touch.Cnds.OnTouchEnd,e.Behaviors.Tween.Cnds.OnTweensFinished,e.Plugins.Text.Acts.SetY,e.Plugins.Text.Cnds.PickInstVarHiLow,e.ScriptsInEvents.Main_Event169_Act2,e.ScriptsInEvents.Main_Event171_Act4,e.ScriptsInEvents.Main_Event178_Act2,e.ScriptsInEvents.Main_Event182_Act1,e.ScriptsInEvents.Main_Event183_Act1,e.ScriptsInEvents.Main_Event184_Act2,e.ScriptsInEvents.Main_Event186_Act1,e.ScriptsInEvents.Main_Event187_Act1,e.ScriptsInEvents.Main_Event188_Act2]},self.C3_JsPropNameTable=[{BO_bet_bg:0},{id:0},{BO_betamount_txt:0},{BO_betlevel_txt:0},{BO_betsize_txt:0},{BO_confirm_btn:0},{BO_line_txt:0},{lastY:0},{Changed:0},{betAmountCombine:0},{BO_close_btn:0},{BO_Fade_bg:0},{BO_Info_txt:0},{BO_mask_bg:0},{BO_Maxbet_btn:0},{BO_color_txt:0},{BO_betamount_txt2:0},{BO_betsize_txt2:0},{Tween:0},{BO_bet_bg2:0},{debug:0},{Touch:0},{Mouse:0},{BO_Credit_txt:0},{InfoPanel:0},{BO_bet_txt:0},{BO_Win_txt:0},{versiontxt:0},{Sprite:0},{BOtouch:0},{Sprite2:0},{Keyboard:0},{BO_txt:0},{BObtn:0},{BO_Bet_Size_List:0},{BO_Bet_Level_List:0},{BO_Line_List:0},{BO_Bet_Size:0},{BO_Bet_Level:0},{BO_Bet_Line:0},{BO_Bet_Amount:0},{BO_Bet_Amount_combine:0},{BO_ytxt:0},{BO_spacetxt:0},{BO_currency_decimal:0},{BO_currency_thousand:0},{BO_currency_prefix:0},{BO_currency_suffix:0},{number:0},{BOnextBet:0},{BO_color1:0},{BO_minbet:0},{BO_maxbet:0},{DecimalOutput:0},{scrollX1:0},{BO_BetSize2:0},{BO_BetLevel2:0},{BO_Line2:0},{BO_BetAmount2:0},{BO_Credit2:0},{BO_BetAmount12:0},{BO_Winamount2:0},{BO_BetSizeList2:0},{BO_BetLevelList2:0},{BO_BetLineList2:0},{BO_color2:0},{BO_currency_decimal2:0},{BO_currency_thousand2:0},{BO_currency_prefix2:0},{BO_currency_suffix2:0},{BO_minbet2:0},{BO_maxbet2:0},{BO_Reduct:0},{minBet:0},{maxBet:0},{BO_betsize_txt_Y:0},{BO_betlevel_txt_Y:0},{BO_line_txt_Y:0},{BO_betamount_txt_Y:0},{BO_BetSize:0},{BO_BetLevel:0},{BO_Line:0},{BO_BetAmount:0},{br1:0},{timeT:0},{tweenY:0},{activeOB:0},{BO_BETAMOUNT:0},{selectedTxt:0},{CallCalculator:0},{BO_Edit_Num:0},{br:0},{BO_Bet_Size1:0},{BO_Bet_Level1:0},{BO_Bet_Line1:0},{BO_Bet_Amount1:0},{BO_Bet_Credit1:0},{BO_Bet_Amount2:0},{BO_Win_Amount1:0},{BO_betsize:0},{BO_betlevel:0},{BO_line:0},{BO_betamount:0},{BOsent:0},{BO_Style:0}],self.InstanceType={BO_bet_bg:class extends self.ITiledBackgroundInstance{},BO_betamount_txt:class extends self.ITextInstance{},BO_betlevel_txt:class extends self.ITextInstance{},BO_betsize_txt:class extends self.ITextInstance{},BO_confirm_btn:class extends self.ISpriteInstance{},BO_line_txt:class extends self.ITextInstance{},BO_close_btn:class extends self.ISpriteInstance{},BO_Fade_bg:class extends self.ISpriteInstance{},BO_Info_txt:class extends self.ITextInstance{},BO_mask_bg:class extends self.ISpriteInstance{},BO_Maxbet_btn:class extends self.ISpriteInstance{},BO_color_txt:class extends self.ITextInstance{},BO_betamount_txt2:class extends self.ITextInstance{},BO_betsize_txt2:class extends self.ITextInstance{},BO_bet_bg2:class extends self.ITiledBackgroundInstance{},debug:class extends self.ITextInstance{},Touch:class extends self.IInstance{},Mouse:class extends self.IInstance{},BO_Credit_txt:class extends self.ITextInstance{},InfoPanel:class extends self.ISpriteInstance{},BO_bet_txt:class extends self.ITextInstance{},BO_Win_txt:class extends self.ITextInstance{},versiontxt:class extends self.ITextInstance{},Sprite:class extends self.ISpriteInstance{},BOtouch:class extends self.ITiledBackgroundInstance{},Sprite2:class extends self.ISpriteInstance{},Keyboard:class extends self.IInstance{},BO_txt:class extends self.ITextInstance{},BObtn:class extends self.ISpriteInstance{}},self.C3.ScriptsInEvents={async Main_Event4_Act1(s,e){document.addEventListener(\"Setup_Bet_Option\",function(e){const t=e.detail;s.callFunction(\"Setup_Bet_Option\",t.BO_BetSize,t.BO_BetLevel,t.BO_Line,t.BO_BetAmount,t.BO_Credit,t.BO_BetAmount1,t.BO_Winamount,t.BO_BetSizeList,t.BO_BetLevelList,t.BO_BetLineList,t.BO_color,t.BO_currency_decimal,t.BO_currency_thousand,t.BO_currency_prefix,t.BO_currency_suffix,t.BO_minbet,t.BO_maxbet,t.BO_Reduct)})},async Main_Event4_Act2(t,e){document.addEventListener(\"maxBetFormCilent\",function(e){e.detail;t.callFunction(\"maxBetFormCilent\",\"\")})},async Main_Event4_Act3(s,e){document.addEventListener(\"BOScrollBack\",function(e){const t=e.detail;s.callFunction(\"BOScrollBack\",t.BO_BetSize,t.BO_BetLevel,t.BO_Line,t.BO_BetAmount,t.BO_Credit,t.BO_BetAmount1,t.BO_Winamount)})},async Main_Event4_Act4(s,e){document.addEventListener(\"addBO\",function(e){const t=e.detail;s.callFunction(\"addBO\",t.BO_BetAmount,t.BO_Style)})},async Main_Event4_Act5(s,e){document.addEventListener(\"subBO\",function(e){const t=e.detail;s.callFunction(\"subBO\",t.BO_BetAmount,t.BO_Style)})},async Main_Event4_Act7(e,t){document.addEventListener(\"fullscreen\",function(){document.fullscreenElement?document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen():document.documentElement.requestFullscreen?document.documentElement.requestFullscreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullscreen?document.documentElement.webkitRequestFullscreen():document.documentElement.msRequestFullscreen&&document.documentElement.msRequestFullscreen()})},async Main_Event4_Act11(e,t){var s;s=new CustomEvent(\"StartBO\",{detail:{data1:\"\"}}),document.dispatchEvent(s)},async Main_Event9_Act2(e,t){t.DecimalOutput=((e,t,s,i,r)=>{let n=(.1<=Math.abs(e)?e.toFixed(2):parseFloat(e.toPrecision(12))).toString().split(\".\"),a=n[0],o=n[1],h=a.replace(/\\B(?=(\\d{3})+(?!\\d))/g,s),l=h+t+o;return(i||\"\")+l+(r||\"\")})(t.number,t.BO_currency_decimal,t.BO_currency_thousand,t.BO_currency_prefix,t.BO_currency_suffix)},async Main_Event19_Act2(e,t){t.DecimalOutput=((e,t,s,i,r)=>{let n=(.1<=Math.abs(e)?e.toFixed(2):parseFloat(e.toPrecision(12))).toString().split(\".\"),a=n[0],o=n[1],h=a.replace(/\\B(?=(\\d{3})+(?!\\d))/g,s),l=h+t+o;return(i||\"\")+l+(r||\"\")})(t.number,t.BO_currency_decimal,t.BO_currency_thousand,t.BO_currency_prefix,t.BO_currency_suffix)},async Main_Event21_Act15(e,t){let s=t.BO_Bet_Size_List,i=s.split(\",\").map(e=>parseFloat(e)).join(\",\");t.BO_Bet_Size_List=i},async Main_Event21_Act16(e,t){let s=t.BO_Bet_Level_List,i=s.split(\",\").map(e=>parseFloat(e)).join(\",\");t.BO_Bet_Level_List=i},async Main_Event21_Act17(e,t){let s=t.BO_Line_List,i=s.split(\",\").map(e=>parseFloat(e)).join(\",\");t.BO_Line_List=i},async Main_Event23_Act1(e,t){let n=t.BO_Bet_Size_List.split(\",\").map(Number),a=t.BO_Bet_Level_List.split(\",\").map(Number),o=t.BO_Line_List.split(\",\").map(Number),h=t.BO_minbet,l=t.BO_maxbet;{let i=!1,r=!1;for(;!i;){i=!0;for(let s of n){for(let t of a){for(let e of o)if(s*t*e<h){const c=Math.min(...n),u=Math.min(...a),_=Math.min(...o);c<=u&&c<=_&&1<n.length?n.shift():u<=c&&u<=_&&1<a.length?a.shift():1<o.length&&o.shift(),i=!1;break}if(!i)break}if(!i)break}}for(;!r;){r=!0;for(let s of n){for(let t of a){for(let e of o)if(s*t*e>l){const d=Math.max(...n),p=Math.max(...a),f=Math.max(...o);p<=f&&d<=f&&1<o.length?o.pop():d<=p&&1<a.length?a.pop():1<n.length&&n.pop(),r=!1;break}if(!r)break}if(!r)break}}}t.BO_Bet_Size_List=n.join(\",\"),t.BO_Bet_Level_List=a.join(\",\"),t.BO_Line_List=o.join(\",\")},async Main_Event24_Act1(e,t){let s=t.BO_Bet_Size_List,i=t.BO_Bet_Level_List,r=t.BO_Line_List,n=t.BO_minbet,a=t.BO_maxbet,o=((s,i,e,t,r)=>{let n=e.split(\",\").map(Number),a=t.split(\",\").map(Number),o=r.split(\",\").map(Number);function h(e){let t=[n,a,o].sort((e,t)=>t.length-e.length)[0];e?t.shift():t.pop()}for(;;){let{minProduct:e,maxProduct:t}=(()=>{let e=Math.min(...n)*Math.min(...a)*Math.min(...o),t=Math.max(...n)*Math.max(...a)*Math.max(...o);return{minProduct:e,maxProduct:t}})();if(e<s)h(!0);else{if(!(i<t))break;h(!1)}}return{BO_Bet_Size_List:n.join(\",\"),BO_Bet_Level_List:a.join(\",\"),BO_Line_List:o.join(\",\")}})(n,a,s,i,r);t.BO_Bet_Size_List=o.BO_Bet_Size_List,t.BO_Bet_Level_List=o.BO_Bet_Level_List,t.BO_Line_List=o.BO_Line_List},async Main_Event25_Act2(s,i){let e=i.BO_Bet_Size_List,t=i.BO_Bet_Level_List,r=i.BO_Line_List,n=e.split(\",\").map(Number),a=t.split(\",\").map(Number),o=r.split(\",\").map(Number),h=new Set,l=(n.forEach(i=>{a.forEach(s=>{o.forEach(e=>{let t=i*s*e;h.add(.1<=Math.abs(t)?Number(t.toFixed(2)):parseFloat(t.toPrecision(12)))})})}),Array.from(h).sort((e,t)=>e-t)),c=l.map(e=>e.toString()),u=c.join(\",\");setTimeout(()=>{i.BO_Bet_Amount_combine=u,s.callFunction(\"BO_Load_Variable\",\"\"),s.callFunction(\"SendMinMax\",\"\");const e={BOSizeList:i.BO_Bet_Size_List,BOBetLevelList:i.BO_Bet_Level_List,BOLineList:i.BO_Line_List,BOBetAmount:i.BO_Bet_Amount,BOBetAmountCombine:i.BO_Bet_Amount_combine,BOMMin:i.BO_minbet,BOMMax:i.BO_maxbet};var t=new CustomEvent(\"setupMinMax\",{detail:e});document.dispatchEvent(t)},0)},async Main_Event26_Act3(e,t){{const s={minBet:t.minBet,maxBet:t.maxBet};t=new CustomEvent(\"setMinMax\",{detail:s}),document.dispatchEvent(t)}},async Main_Event95_Act1(e,t){t.BO_BETAMOUNT=parseFloat(.1<=Math.abs(Number(t.BO_BetSize)*Number(t.BO_BetLevel)*Number(t.BO_Line))?(Number(t.BO_BetSize)*Number(t.BO_BetLevel)*Number(t.BO_Line)).toFixed(2):(Number(t.BO_BetSize)*Number(t.BO_BetLevel)*Number(t.BO_Line)).toPrecision(12))},async Main_Event97_Act2(e,t){let s=t.BO_Bet_Size_List,i=t.BO_Bet_Level_List,r=t.BO_Line_List,n=Number(t.selectedTxt),a=s.split(\",\").map(Number),o=i.split(\",\").map(Number),h=r.split(\",\").map(Number),l=null;a.forEach(i=>{o.forEach(s=>{h.forEach(e=>{let t=.1<=Math.abs(i*s*e)?Number((i*s*e).toFixed(2)):parseFloat((i*s*e).toPrecision(12));t===n&&(l={size:i,level:s,line:e})})})}),l?(t.BO_Bet_Size_Selected=l.size,t.BO_Bet_Level_Selected=l.level,t.BO_Line_Selected=l.line,e.callFunction(\"Scroll Bet Option\",l.size,l.level,l.line,n)):console.log(\"Không tìm thấy tổ hợp nào cho giá trị \"+n)},async Main_Event169_Act2(e,t){{const s={BO_BetSize:t.BO_BetSize,BO_BetLevel:t.BO_BetLevel,BO_Line:t.BO_Line,BO_BetAmount:t.BO_BetAmount};t=new CustomEvent(\"BOupdateVariable\",{detail:s}),document.dispatchEvent(t)}},async Main_Event171_Act4(e,t){var s;s=new CustomEvent(\"closeBO\",{detail:{data1:\"\"}}),document.dispatchEvent(s)},async Main_Event178_Act2(e,t){t.DecimalOutput=((e,t,s,i,r)=>{let n=(.1<=Math.abs(e)?e.toFixed(2):parseFloat(e.toPrecision(12))).toString().split(\".\"),a=n[0],o=n[1],h=a.replace(/\\B(?=(\\d{3})+(?!\\d))/g,s),l=h+t+o;return(i||\"\")+l+(r||\"\")})(Number(t.BO_betamount),t.BO_currency_decimal,t.BO_currency_thousand,t.BO_currency_prefix,t.BO_currency_suffix);{const s={BO_betsize:t.BO_betsize,BO_betlevel:t.BO_betlevel,BO_line:t.BO_line,BO_betamount:t.BO_betamount,DecimalOutput:t.DecimalOutput};t=new CustomEvent(\"confirmBO\",{detail:s}),document.dispatchEvent(t)}},async Main_Event182_Act1(e,t){const s=t.BO_Bet_Amount_combine;t.BOnextBet=((e,t)=>{const s=e.split(\",\").map(Number);s.sort((e,t)=>e-t);for(let e=0;e<s.length;e++)if(t<s[e])return s[e];return t})(s,Number(t.BO_BetAmount))},async Main_Event183_Act1(e,t){const s=t.BO_Bet_Amount_combine;t.BOnextBet=((e,t)=>{let s=e.split(\",\").map(Number),i=Math.ceil(s.length/12),r=[];for(let e=0;e<12;e++){const n=e*i,a=(e+1)*i;r.push(s.slice(n,a))}for(let e=0;e<r.length;e++){if(t===r[e][r[e].length-1])return e<r.length-1?r[e+1][r[e+1].length-1]:t;if(t>=r[e][0]&&t<r[e][r[e].length-1])return r[e][r[e].length-1]}return t<s[0]?r[0][r[0].length-1]:s[s.length-1]})(s,Number(t.BO_BetAmount))},async Main_Event184_Act2(s,i){let e=i.BO_Bet_Size_List,t=i.BO_Bet_Level_List,r=i.BO_Line_List,n=Number(i.BOnextBet),a=e.split(\",\").map(Number),o=t.split(\",\").map(Number),h=r.split(\",\").map(Number),l=null;if(a.forEach(i=>{o.forEach(s=>{h.forEach(e=>{let t=.1<=Math.abs(i*s*e)?Number((i*s*e).toFixed(2)):parseFloat((i*s*e).toPrecision(12));t===n&&(l={size:i,level:s,line:e})})})}),l){let e=function(e,t,s,i,r){let n=(.1<=Math.abs(e)?e.toFixed(2):parseFloat(e.toPrecision(12))).toString().split(\".\"),a=n[0],o=n[1],h=a.replace(/\\B(?=(\\d{3})+(?!\\d))/g,s),l=h+t+o;return(i||\"\")+l+(r||\"\")},t=function(){const e={BObetsize:l.size,BObetlevel:l.level,BOline:l.line,BObetamount:n,DecimalOutput:i.DecimalOutput};var t=new CustomEvent(\"upDateBO\",{detail:e});document.dispatchEvent(t)};i.BO_Bet_Size_Selected=l.size,i.BO_Bet_Level_Selected=l.level,i.BO_Line_Selected=l.line,s.callFunction(\"Scroll Bet Option\",l.size,l.level,l.line,n),i.DecimalOutput=e(n,i.BO_currency_decimal,i.BO_currency_thousand,i.BO_currency_prefix,i.BO_currency_suffix),t()}else console.log(\"Không tìm thấy tổ hợp nào cho giá trị \"+n)},async Main_Event186_Act1(e,t){const s=t.BO_Bet_Amount_combine;t.BOnextBet=((e,t)=>{const s=e.split(\",\").map(Number);s.sort((e,t)=>e-t);for(let e=s.length-1;0<=e;e--)if(t>s[e])return s[e];return t})(s,Number(t.BO_BetAmount))},async Main_Event187_Act1(e,t){const s=t.BO_Bet_Amount_combine;t.BOnextBet=((e,t)=>{let s=e.split(\",\").map(Number),i=Math.ceil(s.length/12),r=[];for(let e=0;e<12;e++){const n=e*i,a=Math.min((e+1)*i,s.length),o=s.slice(n,a);r.push(o)}for(let e=0;e<r.length;e++){const h=r[e],l=h[0],c=h[h.length-1];if(l<=t&&t<=c){if(0===e)return l;if(0<e){const u=r[e-1];return u[u.length-1]}}}return t})(s,Number(t.BO_BetAmount))},async Main_Event188_Act2(s,i){let e=i.BO_Bet_Size_List,t=i.BO_Bet_Level_List,r=i.BO_Line_List,n=Number(i.BOnextBet),a=e.split(\",\").map(Number),o=t.split(\",\").map(Number),h=r.split(\",\").map(Number),l=null;if(a.forEach(i=>{o.forEach(s=>{h.forEach(e=>{let t=.1<=Math.abs(i*s*e)?Number((i*s*e).toFixed(2)):parseFloat((i*s*e).toPrecision(12));t===n&&(l={size:i,level:s,line:e})})})}),l){let e=function(e,t,s,i,r){let n=(.1<=Math.abs(e)?e.toFixed(2):parseFloat(e.toPrecision(12))).toString().split(\".\"),a=n[0],o=n[1],h=a.replace(/\\B(?=(\\d{3})+(?!\\d))/g,s),l=h+t+o;return(i||\"\")+l+(r||\"\")},t=function(){const e={BObetsize:l.size,BObetlevel:l.level,BOline:l.line,BObetamount:n,DecimalOutput:i.DecimalOutput};var t=new CustomEvent(\"upDateBO\",{detail:e});document.dispatchEvent(t)};i.BO_Bet_Size_Selected=l.size,i.BO_Bet_Level_Selected=l.level,i.BO_Line_Selected=l.line,s.callFunction(\"Scroll Bet Option\",l.size,l.level,l.line,n),i.DecimalOutput=e(n,i.BO_currency_decimal,i.BO_currency_thousand,i.BO_currency_prefix,i.BO_currency_suffix),t()}else console.log(\"Không tìm thấy tổ hợp nào cho giá trị \"+n)}};"
	},
	"scripts/dispatchworker.js": {
		"type": "application/javascript",
		"str": "\"use strict\";self.inputPort=null,self.jobQueue=[],self.jobWorkers=[],self.sentBlobs=[],self.sentBuffers=[],self.importedScripts=[],self.lastBroadcasts=new Map;class JobWorker{constructor(e,s){this._port=e,this._number=s,this._isReady=!1,this._isBusy=!1,this._port.onmessage=e=>this._OnMessage(e.data)}ImportScripts(e){this._port.postMessage({\"type\":\"_import_scripts\",\"scripts\":e})}SendBlob(e,s){this._port.postMessage({\"type\":\"_send_blob\",\"blob\":e,\"id\":s})}SendBuffer(e,s){this._port.postMessage({\"type\":\"_send_buffer\",\"buffer\":e,\"id\":s})}SendJob(e){if(this._isBusy||!this._isReady)throw new Error(\"cannot take job\");this._isBusy=!0,this._port.postMessage(e,e[\"transferables\"])}_InitBroadcast(e){this._port.postMessage(e,e[\"transferables\"])}SendReady(){this._port.postMessage({\"type\":\"_ready\"})}IsReady(){return this._isReady}_OnReady(){this._isReady=!0,this.MaybeStartNextJob()}IsBusy(){return this._isBusy}GetNumber(){return this._number}_OnMessage(e){const s=e[\"type\"];switch(s){case\"ready\":return void this._OnReady();case\"done\":return void this._OnJobDone();default:return void console.error(\"unknown message from worker '\"+s+\"'\")}}_OnJobDone(){this._isBusy=!1,this.MaybeStartNextJob()}MaybeStartNextJob(){if(!this._isBusy&&this._isReady){const e=this._FindAvailableJob();if(-1!==e){const s=self.jobQueue[e],t=s[\"isBroadcast\"];(!t||(s[\"doneFlags\"][this._number]=!0,s[\"doneFlags\"].every(e=>e)))&&self.jobQueue.splice(e,1),this.SendJob(s)}}}_FindAvailableJob(){for(let e=0,s=self.jobQueue.length;e<s;++e){const t=self.jobQueue[e];if(!(\"number\"==typeof t[\"maxWorkerNum\"]&&this._number>=t[\"maxWorkerNum\"])&&(!t[\"isBroadcast\"]||this._number<t[\"doneFlags\"].length&&!t[\"doneFlags\"][this._number]))return e}return-1}}let number=0;function AddJobWorker(e){const s=new JobWorker(e,number++);self.jobWorkers.push(s);for(const[t,o]of self.sentBlobs)s.SendBlob(t,o);for(const[r,n]of self.sentBuffers)s.SendBuffer(r,n);for(const a of self.importedScripts)s.ImportScripts(a);for(const i of self.lastBroadcasts.values())s._InitBroadcast(i);s.SendReady()}function CancelJob(t){for(let e=0,s=self.jobQueue.length;e<s;++e)if(self.jobQueue[e].jobId===t)return void self.jobQueue.splice(e,1)}function OnInputPortMessage(e){const s=e.data,t=s[\"type\"];if(\"_cancel\"===t)CancelJob(s.jobId);else if(\"_import_scripts\"===t){const o=s[\"scripts\"];for(const r of self.jobWorkers)r.ImportScripts(o);void self.importedScripts.push(o)}else if(\"_send_blob\"===t){const n=s[\"blob\"],a=s[\"id\"];for(const i of self.jobWorkers)i.SendBlob(n,a);void self.sentBlobs.push([n,a])}else if(\"_send_buffer\"===t){const f=s[\"buffer\"],l=s[\"id\"];for(const u of self.jobWorkers)u.SendBuffer(f,l);void self.sentBuffers.push([f,l])}else if(\"_no_more_workers\"===t)self.sentBlobs.length=0,self.sentBuffers.length=0,self.importedScripts.length=0,self.lastBroadcasts.clear();else{if(self.jobQueue.push(s),s[\"isBroadcast\"]){const b=s[\"maxWorkerNum\"],d=self.jobWorkers.length,p=\"number\"==typeof b?Math.min(b,d):d,c=(s[\"doneFlags\"]=new Array(p).fill(!1),s[\"transferables\"]=[],s[\"params\"]&&s[\"params\"][\"broadcastKey\"]?s[\"params\"][\"broadcastKey\"]:s[\"type\"]);self.lastBroadcasts.delete(c),self.lastBroadcasts.set(c,s)}for(const _ of self.jobWorkers)_.MaybeStartNextJob()}}self.addEventListener(\"message\",e=>{const s=e.data,t=s[\"type\"];\"_init\"===t?(self.inputPort=s[\"in-port\"],self.inputPort.onmessage=OnInputPortMessage):\"_addJobWorker\"===t&&AddJobWorker(s[\"port\"])});"
	},
	"scripts/jobworker.js": {
		"type": "application/javascript",
		"str": "\"use strict\";function FlipImageData(e,t,s){const r=4*t,o=new Uint8Array(r),n=e.buffer;for(let e=0,t=Math.floor(s/2);e<t;++e){const a=s-e-1,l=new Uint8Array(n,e*r,r),f=new Uint8Array(n,a*r,r);o.set(l),l.set(f),f.set(o)}}function UnpremultiplyImageData(s){for(let e=0,t=s.length;e<t;e+=4){const r=s[e+3];if(255!==r){const o=255/r;s[e]*=o,s[e+1]*=o,s[e+2]*=o}}}function SendReady(){self.dispatchPort.postMessage({\"type\":\"ready\"}),self.outputPort.postMessage({\"type\":\"ready\"})}function SendError(e,t){e||self.outputPort.postMessage({\"type\":\"error\",\"jobId\":self.activeJobId,\"error\":t.toString()}),SendDone()}function SendResult(e,t){if(!e){const s=t.transferables||[];self.outputPort.postMessage({\"type\":\"result\",\"jobId\":self.activeJobId,\"result\":t.result},s)}SendDone()}function SendDone(){self.activeJobId=null,self.dispatchPort.postMessage({\"type\":\"done\"})}function SendProgress(e){self.outputPort.postMessage({\"type\":\"progress\",\"jobId\":self.activeJobId,\"progress\":e})}function OnDispatchWorkerMessage(t){const s=t.data,r=s[\"type\"];if(\"_import_scripts\"===r)importScripts(...s[\"scripts\"]);else if(\"_send_blob\"===r)self.sentBlobs.set(s[\"id\"],s[\"blob\"]);else if(\"_send_buffer\"===r)self.sentBuffers.set(s[\"id\"],s[\"buffer\"]);else if(\"_ready\"===r)SendReady();else{const o=s[\"jobId\"],n=s[\"isBroadcast\"],a=s[\"params\"];let e;if(self.activeJobId=o,self.JobHandlers.hasOwnProperty(r)){try{e=self.JobHandlers[r](a)}catch(t){return void SendError(n,\"Exception in job handler: \"+t)}e&&e.then?e.then(e=>SendResult(n,e)).catch(e=>SendError(n,\"Rejection in job handler: \"+e)):SendResult(n,e)}else console.error(`no handler for message type '${r}'`)}}self.dispatchPort=null,self.outputPort=null,self.workerNumber=-1,self.activeJobId=null,self.sentBlobs=new Map,self.sentBuffers=new Map,self.JobHandlers={},self.JobHandlers[\"ProcessImageData\"]=function(e){const t=e[\"buffer\"],s=new Uint8Array(t),r=e[\"width\"],o=e[\"height\"];return e[\"flipY\"]&&FlipImageData(s,r,o),e[\"unpremultiply\"]&&UnpremultiplyImageData(s),{result:t,transferables:[t]}},self.addEventListener(\"message\",e=>{const t=e.data,s=t[\"type\"];switch(s){case\"init\":return self.workerNumber=t[\"number\"],self.dispatchPort=t[\"dispatch-port\"],self.dispatchPort.onmessage=OnDispatchWorkerMessage,void(self.outputPort=t[\"output-port\"]);case\"terminate\":return void self.close();default:return void console.error(\"unknown message '\"+s+\"'\")}});"
	},
	"data.json": {
		"type": "application/json",
		"str": "{\"project\":[\"bet option module\",\"main\",[[[0,false,true,true,true,true,true,true,true,true,false,false,false,true,true,false,true,false,false,1],[1,false,true,true,true,true,true,true,true,false,false,false,false,true,true,false,true,false,false,1],[2,false,true,true,true,true,true,true,true,false,false,false,false,true,true,true,true,false,false,1],[4,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,1],[5,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,1],[6,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,1]],[[3,1]]],[[\"BO_bet_bg\",0,false,[],0,0,[\"images/bo_bet_bg-lsheet0.avif\",329,0,0,757,222,false],null,[],false,false,112189737254327,[],null,0,[1,0]],[\"BO_betamount_txt\",1,false,[[894928270319942,1,\"id\",1]],0,0,null,null,[],false,false,897864477390053,[],null,2,null],[\"BO_betlevel_txt\",1,false,[[894928270319942,1,\"id\",1]],0,0,null,null,[],false,false,314601512148439,[],null,3,null],[\"BO_betsize_txt\",1,false,[[894928270319942,1,\"id\",1]],0,0,null,null,[],false,false,576242775102945,[],null,4,null],[\"BO_confirm_btn\",2,false,[],0,0,null,[[\"Animation 1\",0,false,1,0,false,560072887381361,[[\"images/shared-0-lsheet0.avif\",1487,1,1,479,85,true,1,0.5,0.5,[],[],\"\"]]]],[],false,false,223316479679658,[],null,5,null],[\"BO_line_txt\",1,false,[[894928270319942,1,\"id\",1]],0,0,null,null,[],false,false,627196163497746,[],null,6,null],[\"BO_close_btn\",2,false,[[642089020568852,1,\"lastY\",7],[652842138069166,2,\"Changed\",8],[971691949893397,2,\"betAmountCombine\",9]],0,0,null,[[\"Animation 1\",0,false,1,0,false,287682782152840,[[\"images/shared-0-lsheet0.avif\",1487,88,385,75,75,false,1,0.5,0.5,[],[-0.35,-0.35,0,-0.48333333333333334,0.33333333333333337,-0.35,0.4666666666666667,0,0.33333333333333337,0.33333333333333337,0,0.4666666666666667,-0.35,0.33333333333333337,-0.48333333333333334,0],\"\"]]]],[],false,false,996655861255909,[],null,10,null],[\"BO_Fade_bg\",2,false,[],0,0,null,[[\"Animation 1\",0,false,1,0,false,227436280366644,[[\"images/shared-0-sheet0.webp\",67332,1,1,758,478,true,1,0.5,0.5,[],[],\"\"]]]],[],false,false,967240355369383,[],null,11,null],[\"BO_Info_txt\",1,false,[],0,0,null,null,[],false,false,134709989602740,[],null,12,null],[\"BO_mask_bg\",2,false,[],0,0,null,[[\"Animation 1\",0,false,1,0,false,886710902069652,[[\"images/shared-0-sheet0.webp\",67332,513,1,758,478,true,1,0.5,0.5,[],[],\"\"]]]],[],false,false,300711877597567,[],null,13,null],[\"BO_Maxbet_btn\",2,false,[],0,0,null,[[\"Animation 1\",0,false,1,0,false,722663420827884,[[\"images/shared-0-lsheet0.avif\",1487,129,1,224,94,true,1,0.5,0.5,[],[],\"\"]]]],[],false,false,882258585411970,[],null,14,null],[\"BO_color_txt\",1,false,[],0,0,null,null,[],false,false,689340413293919,[],null,15,null],[\"BO_betamount_txt2\",1,false,[[894928270319942,1,\"id\",1]],0,0,null,null,[],false,false,404801202031210,[],null,16,null],[\"BO_betsize_txt2\",1,false,[[894928270319942,1,\"id\",1]],0,0,null,null,[],false,false,268886972101599,[],null,17,null],[\"BO_bet_bg2\",0,false,[],1,0,[\"images/bo_bet_bg2-lsheet0.avif\",329,0,0,757,222,false],null,[[\"Tween\",3,904773282207091,18]],false,false,423488739209973,[],null,19,[1,0]],[\"debug\",1,false,[],0,0,null,null,[],false,false,821067749218125,[],null,20,null],[\"Touch\",4,false,[],0,0,null,null,[],false,false,802247233085376,[],null,21,null,[true]],[\"Mouse\",5,false,[],0,0,null,null,[],false,false,772224905702053,[],null,22,null,[]],[\"BO_Credit_txt\",1,false,[],0,0,null,null,[],false,false,758747261964839,[],null,23,null],[\"InfoPanel\",2,false,[],0,0,null,[[\"Animation 1\",0,false,1,0,false,547759113392991,[[\"images/shared-0-lsheet0.avif\",1487,193,257,246,59,true,1,0.5,0.5,[],[],\"\"],[\"images/shared-0-lsheet0.avif\",1487,193,257,246,59,true,1,0.5,0.5,[],[],\"\"],[\"images/shared-0-lsheet0.avif\",1487,193,257,246,59,true,1,0.5,0.5,[],[],\"\"]]]],[],false,false,465403495731733,[],null,24,null],[\"BO_bet_txt\",1,false,[],0,0,null,null,[],false,false,360317578426301,[],null,25,null],[\"BO_Win_txt\",1,false,[],0,0,null,null,[],false,false,142767062386549,[],null,26,null],[\"versiontxt\",1,false,[],1,0,null,null,[[\"Tween\",3,683998799413546,18]],false,false,932632874840742,[],null,27,null],[\"Sprite\",2,false,[],0,0,null,[[\"Animation 1\",0,false,1,0,false,991327847671789,[[\"images/shared-0-sheet1.webp\",1428,65,1,44,44,false,1,0.5,0.5,[],[],\"\"],[\"images/shared-0-sheet1.webp\",1428,65,65,44,44,false,1,0.5,0.5,[],[],\"\"],[\"images/shared-0-sheet1.webp\",1428,1,1,60,60,false,1,0.5,0.5,[],[],\"\"]]]],[],false,false,186033871935707,[],null,28,null],[\"BOtouch\",0,false,[],0,0,[\"images/botouch-sheet0.webp\",44,0,0,250,250,false],null,[],false,false,695600142663120,[],null,29,[1,1]],[\"Sprite2\",2,false,[],1,0,null,[[\"Animation 1\",0,false,1,0,false,524417759959019,[[\"images/shared-0-sheet1.webp\",1428,33,97,20,20,false,1,0.5,0.5,[],[],\"\"]]]],[[\"Tween\",3,661476111029550,18]],false,false,420859850662754,[],null,30,null],[\"Keyboard\",6,false,[],0,0,null,null,[],false,false,246212388269976,[],null,31,null,[]],[\"BO_txt\",1,true,[[894928270319942,1,\"id\",1]],1,0,null,null,[[\"Tween\",3,133264713106551,18]],false,false,321923444664856,[],null,32,null],[\"BObtn\",2,true,[],0,0,null,null,[],false,false,352982598181438,[],null,33,null]],[[27,2,1,3,5,12,13],[28,10,4,6]],[[\"main\",758,2692,false,false,0.5,0.5,\"main\",549640481751070,[[\"main\",0,831248269832837,true,[94,94,94],true,1,1,1,false,false,1,0,true,[[[-888,90,0,403,442,0,0,[1,1,1,1],0,0,0,0,[],null,null,null,[\"\",\"\"]],15,29,[],[],[\"aasdasdasd\",true,\"Arial\",50,0,false,false,[1,1,1],2,0,0,0,-1,true,0,false],\"\"]],[],0,true,false,false,[]],[\"BetOption\",1,633656699966678,true,[94,94,94],true,1,1,1,true,false,1,0,true,[[[0,1984,0,758,478,0,0,[1,1,1,1],0,0,0,0,[],null,null,null,[\"\",\"\"]],24,30,[],[],[true,0,1,1,0,0,1,1,0,false,1,1,1,0.1,0.1],\"\"],[[0,1874,0,758,820,0,0,[1,1,1,1],0,0,0,0,[],null,null,null,[\"\",\"\"]],0,4,[],[],[true,0,1,0,0,0,1,1,0,false,1,1,1,0.1,0.1],\"\"],[[379,2224,0,758,478,0,0,[0.8117647058823529,0.8117647058823529,0.8117647058823529,1],0.5,0.5,0,0,[],null,null,null,[\"\",\"\"]],9,25,[],[],[true,\"Animation 1\",0,true],\"\"],[[198,2253,0,64,44,0,0,[1,1,1,1],0,0,0,0,[],null,null,null,[\"\",\"\"]],8,12,[],[],[\"x\",true,\"ARIAL\",22,0,false,false,[0.6705882352941176,0.6705882352941176,0.6705882352941176],0,0,0,0,-1,true,0,false],\"\"],[[385,2253,0,64,44,0,0,[1,1,1,1],0,0,0,0,[],null,null,null,[\"\",\"\"]],8,13,[],[],[\"x\",true,\"ARIAL\",22,0,false,false,[0.6705882352941176,0.6705882352941176,0.6705882352941176],0,0,0,0,-1,true,0,false],\"\"],[[536,2253,0,64,44,0,0,[1,1,1,1],0,0,0,0,[],null,null,null,[\"\",\"\"]],8,14,[],[],[\"=\",true,\"ARIAL\",22,0,false,false,[0.6705882352941176,0.6705882352941176,0.6705882352941176],0,0,0,0,-1,true,0,false],\"\"],[[642,2253,0,200,70,0,0,[1,1,1,1],0.5,0,9,0,[],null,null,null,[\"\",\"\"]],1,22,[0],[[true]],[\"3.00\",true,\"Arial\",24,0,false,false,[1,0.7843137254901961,0.1411764705882353],1,0,0,0,-1,true,1,false],\"\"],[[643,2299,0,200,70,0,0,[1,1,1,1],0.5,0,9,0,[],null,null,null,[\"\",\"\"]],12,26,[0],[[true]],[\"3.00\",true,\"Arial\",24,0,false,false,[1,0.7843137254901961,0.1411764705882353],1,0,0,0,-1,true,1,false],\"\"],[[470,2253,0,200,70,0,0,[1,1,1,1],0.5,0,9,0,[],null,null,null,[\"\",\"\"]],5,15,[0],[[true]],[\"5\",true,\"Arial\",24,0,false,false,[1,1,1],1,0,0,0,-1,true,1,false],\"\"],[[302,2253,0,200,70,0,0,[1,1,1,1],0.5,0,9,0,[],null,null,null,[\"\",\"\"]],2,19,[0],[[true]],[\"2\",true,\"Arial\",24,0,false,false,[1,1,1],1,0,0,0,-1,true,1,false],\"\"],[[113,2253,0,200,70,0,0,[1,1,1,1],0.5,0,9,0,[],null,null,null,[\"\",\"\"]],3,21,[0],[[true]],[\"0.30\",true,\"Arial\",24,0,false,false,[1,1,1],1,0,0,0,-1,true,1,false],\"\"],[[0,1874,0,757,110,0,0,[1,1,1,1],0,0,0,0,[],null,null,null,[\"\",\"\"]],0,23,[],[],[true,0,1,0,0,0,1,1,0,false,1,1,1,0.1,0.1],\"\"],[[379,2223,0,758,478,0,0,[1,1,1,1],0.5,0.5,0,0,[],null,null,null,[\"\",\"\"]],7,24,[],[],[true,\"Animation 1\",0,true],\"\"],[[42,2028,0,160,60,0,0,[1,1,1,1],0,0,0,0,[],null,null,null,[\"\",\"\"]],8,8,[],[],[\"Bet Size\",true,\"ARIAL\",20,0,false,false,[1,1,1],1,0,0,0,-1,true,0,false],\"\"],[[216,2028,0,160,60,0,0,[1,1,1,1],0,0,0,0,[],null,null,null,[\"\",\"\"]],8,9,[],[],[\"Bet Level\",true,\"ARIAL\",20,0,false,false,[1,1,1],1,0,0,0,-1,true,0,false],\"\"],[[389,2028,0,160,60,0,0,[1,1,1,1],0,0,0,0,[],null,null,null,[\"\",\"\"]],8,10,[],[],[\"Lines\",true,\"ARIAL\",20,0,false,false,[1,1,1],1,0,0,0,-1,true,0,false],\"\"],[[568,2028,0,160,60,0,0,[1,1,1,1],0,0,0,0,[],null,[128,null,17],null,[\"\",\"\"]],11,20,[],[],[\"Bet Amount\",true,\"ARIAL\",20,0,false,false,[1,0.7843137254901961,0.1411764705882353],0,0,0,0,-1,true,0,false],\"\"],[[711,1929,0,75,75,0,0,[1,1,1,1],0.5,0.5,0,0,[],null,null,null,[\"\",\"\"]],6,7,[0,\"\",\"\"],[],[true,\"Animation 1\",0,true],\"\"],[[379,1931,0,758,90,0,0,[1,1,1,1],0.5,0.5,0,0,[],null,null,null,[\"\",\"\"]],8,6,[],[],[\"Bet Options\",true,\"ARIAL\",26,0,false,false,[1,1,1],1,1,0,0,-1,true,4,false],\"\"],[[0,2462,0,757,232,0,0,[1,1,1,1],0,0,0,0,[],null,null,null,[\"\",\"\"]],0,5,[],[],[true,0,1,0,0,0,1,1,0,false,1,1,1,0.1,0.1],\"\"],[[134,2549,0,224,94,0,0,[1,0.7843137254901961,0.1411764705882353,1],0.5,0.5,0,0,[],null,[127,null,21],null,[\"\",\"\"]],10,16,[],[],[true,\"Animation 1\",0,true],\"\"],[[498,2549,0,479,85,0,0,[1,0.7843137254901961,0.1411764705882353,1],0.5,0.5,0,0,[],null,[127,null,22],null,[\"\",\"\"]],4,18,[],[],[true,\"Animation 1\",0,true],\"\"],[[437,2529,0,190,60,0,0,[1,1,1,1],0,0,0,0,[],null,[128,null,23],null,[\"\",\"\"]],8,17,[],[],[\"Confirm\",true,\"ARIAL\",26,0,false,false,[1,1,1],0,0,0,0,-1,true,0,false],\"\"],[[73,2528,0,163,60,0,0,[1,1,1,1],0,0,0,0,[],null,[128,null,24],null,[\"\",\"\"]],11,3,[],[],[\"Max Bet\",true,\"ARIAL\",26,0,false,false,[1,0.7843137254901961,0.1411764705882353],0,0,0,0,-1,true,0,false],\"\"],[[118,2316,0,200,70,0,0,[1,1,1,1],0.5,0,9,0,[],null,null,null,[\"\",\"\"]],13,27,[0],[[true]],[\"0.30\",true,\"Arial\",24,0,false,false,[1,1,1],1,0,0,0,-1,true,1,false],\"\"],[[131,2646,0,246,59,0,0,[1,1,1,1],0.5,0.5,0,0,[],null,null,null,[\"\",\"\"]],19,31,[],[],[true,\"Animation 1\",0,true],\"\"],[[379,2646,0,246,59,0,0,[1,1,1,1],0.5,0.5,0,0,[],null,null,null,[\"\",\"\"]],19,32,[],[],[true,\"Animation 1\",1,true],\"\"],[[627,2646,0,246,59,0,0,[1,1,1,1],0.5,0.5,0,0,[],null,null,null,[\"\",\"\"]],19,33,[],[],[true,\"Animation 1\",2,true],\"\"],[[151,2652,0,190,40,0,0,[1,1,1,1],0.5,0.5,0,0,[],null,[127,null,29],null,[\"\",\"\"]],18,34,[],[],[\"฿5,000.00\",true,\"Arial\",20,0,false,false,[1,1,1],0,0,0,0,-1,true,4,false],\"\"],[[385,2652,0,190,40,0,0,[1,1,1,1],0.5,0.5,0,0,[],null,[127,null,30],null,[\"\",\"\"]],20,35,[],[],[\"฿5,000.00\",true,\"Arial\",20,0,false,false,[1,1,1],1,0,0,0,-1,true,4,false],\"\"],[[644,2652,0,190,40,0,0,[1,1,1,1],0.5,0.5,0,0,[],null,[127,null,31],null,[\"\",\"\"]],21,36,[],[],[\"฿5,000.00\",true,\"Arial\",20,0,false,false,[1,1,1],1,0,0,0,-1,true,4,false],\"\"],[[32,2648,0,22,22,0,0,[1,0.7843137254901961,0.1411764705882353,1],0.5,0.5,0,0,[],null,null,null,[\"\",\"\"]],23,38,[],[],[true,\"Animation 1\",0,true],\"\"],[[280,2648,0,25.000000000000004,25.000000000000004,0,0,[1,0.7843137254901961,0.1411764705882353,1],0.5,0.5,0,0,[],null,null,null,[\"\",\"\"]],23,39,[],[],[true,\"Animation 1\",1,true],\"\"],[[530,2648,0,40,40,0,0,[1,0.7843137254901961,0.1411764705882353,1],0.5,0.5,0,0,[],null,null,null,[\"\",\"\"]],23,40,[],[],[true,\"Animation 1\",2,true],\"\"],[[758,0,0,20,20,0,0,[1,1,1,1],0.5,0.5,0,0,[],null,null,null,[\"\",\"\"]],25,41,[],[[true]],[false,\"Animation 1\",0,true],\"\"],[[0,0,0,758,1874,0,0,[1,1,1,0],0,0,0,0,[],null,null,null,[\"\",\"\"]],14,43,[],[[true]],[true,0,1,0,0,0,1,1,0,false,1,1,1,0.1,0.1],\"\"],[[558,1346,0,200,30,0,0,[1,1,1,0.2],0,0,0,0,[],null,null,null,[\"\",\"\"]],22,37,[],[[true]],[\"Text\",true,\"Arial\",10,0,false,false,[1,1,1],2,0,0,0,-1,true,0,false],\"\"]],[],0,true,false,false,[]]],[],[]]],[[\"main\",[[0,0,false,null,483467817774427,1,[[-1,7,null,1,false,false,false,186149192522673,null]],[[22,8,null,726387465356307,0,null,[[7,[0,[4,9]]]]]]],[3,[true,\"Slotgen Bet Option\"],false,null,377722687873094,2,[[-1,10,null,0,false,false,false,0,false,[[1,[1]]]]],[],[[1,\"BO_Bet_Size_List\",1,\"0.2,2,20,100\",true,false,371373731486570,false,34],[1,\"BO_Bet_Level_List\",1,\"1,2,3,4,5,6,7,8,9,10\",true,false,219757034348558,false,35],[1,\"BO_Line_List\",1,\"25\",true,false,198210839952092,false,36],[1,\"BO_Bet_Size\",1,\"0\",true,false,832254520486565,false,37],[1,\"BO_Bet_Level\",1,\"0\",true,false,534613511407694,false,38],[1,\"BO_Bet_Line\",1,\"0\",true,false,627925097177680,false,39],[1,\"BO_Bet_Amount\",1,\"0\",true,false,698497735567615,false,40],[1,\"BO_Bet_Amount_combine\",1,\"\",true,false,642324951234995,false,41],[1,\"BO_ytxt\",0,2253,false,false,946831665396307,false,42],[1,\"BO_spacetxt\",0,70,false,false,385718310063291,false,43],[1,\"BO_currency_decimal\",1,\".\",true,false,159524818741644,false,44],[1,\"BO_currency_thousand\",1,\",\",true,false,939433529214858,false,45],[1,\"BO_currency_prefix\",1,\"฿\",true,false,666389786876882,false,46],[1,\"BO_currency_suffix\",1,\"\",true,false,487621348371088,false,47],[1,\"number\",0,0,true,false,524895581644187,false,48],[1,\"BOnextBet\",1,\"\",true,false,460857137858445,false,49],[1,\"BO_color1\",1,\"\",true,false,920627731603306,false,50],[1,\"BO_minbet\",1,\"\",true,false,755569096145214,false,51],[1,\"BO_maxbet\",1,\"\",true,false,290588386255325,false,52],[1,\"DecimalOutput\",1,\"\",false,false,437592147558708,false,53],[1,\"scrollX1\",0,0,false,false,242585148745723,false,54],[0,0,false,null,582812526152004,3,[[25,11,\"Tween\",0,false,false,false,182811853316680,null]],[[-1,12,null,338674046144620,0,null,[[5,[2]],[0,[3,[3,242585148745723]]],[0,[4,[1,25,13,false]]]]]]],[0,0,false,null,689660998348555,4,[[-1,7,null,1,false,false,false,438421067890103,null]],[[-3,14,[false,false,0]],[-3,15,[false,false,1]],[-3,16,[false,false,2]],[-3,17,[false,false,3]],[-3,18,[false,false,4]],[-3,19,[false,false,6]],[-1,12,null,207862211649330,0,null,[[5,[2]],[0,[3,[3,242585148745723]]],[0,[5]]]],[-1,20,null,256605145777428,4096,null],[-1,21,null,651083415280238,4096,null,[[0,[6]]]],[-3,22,[false,false,10]]]],[4,[\"BO_Load_Variable\",0,[],true,false,false],false,null,202853147816609,5,[],[[6,23,null,660227921771787,0,null,[[10,2],[7,[3,[3,642324951234995]]]]]],[[0,0,false,null,970928368883355,6,[[-1,24,null,0,true,false,false,488642465749092,null,[[0,[7,[4,25],[3,371373731486570]]]]]],[[-1,26,null,768316670147284,256,null,[[4,3],[5,[2]],[0,[8]],[0,[9,[3,946831665396307],[4,27]]],[16,false],[20,[10]]]],[3,28,null,744452366647843,0,null,[[3,0],[4,9]]],[3,8,null,812602143983962,0,null,[[7,[11,[4,29],[3,371373731486570],[4,27]]]]],[3,30,null,692520568568371,0,null,[[10,0],[7,[12,[4,27]]]]],[3,31,null,621023922872928,0,null,[[3,0]]],[-1,26,null,572781224171124,256,null,[[4,13],[5,[2]],[0,[4,[1,3,32,false]]],[0,[4,[1,3,33,false]]],[16,false],[20,[10]]]],[13,28,null,433557125280701,0,null,[[3,0],[4,9]]],[3,34,null,431597927786446,0,null,[[4,13],[16,true],[16,true],[16,true],[16,true],[16,true],[16,false],[16,true],[16,false],[16,false]]]],[[0,0,false,null,792898472994791,7,[[-1,35,null,0,false,false,false,999598376733969,null,[[7,[12,[4,27]]],[8,0],[7,[13]]]]],[[3,8,null,498692268288401,0,null,[[7,[14]]]],[13,8,null,806244063119068,0,null,[[7,[14]]]]]],[0,0,false,null,221759048553361,8,[[-1,35,null,0,false,false,false,380012286741937,null,[[7,[12,[4,27]]],[8,0],[7,[15,[4,25],[3,371373731486570]]]]]],[[3,8,null,283327993378066,0,null,[[7,[14]]]],[13,8,null,854319582768002,0,null,[[7,[14]]]]]],[0,0,false,null,205239192503468,9,[[3,36,null,0,false,true,false,721443434539680,null,[[1,[14]],[3,0]]]],[[-1,37,null,950757930760650,0,null,[[11,524895581644187],[7,[16,[4,38],[1,3,39,true]]]]],[-3,40,[false,false,1]],[13,8,null,902652922875157,0,null,[[7,[3,[3,437592147558708]]]]]]]]],[0,0,false,null,798661149663264,10,[[-1,24,null,0,true,false,false,382021898105644,null,[[0,[7,[4,25],[3,219757034348558]]]]]],[[-1,26,null,678049001746173,256,null,[[4,2],[5,[2]],[0,[17]],[0,[9,[3,946831665396307],[4,27]]],[16,false],[20,[10]]]],[2,28,null,578108772838279,0,null,[[3,0],[4,9]]],[2,8,null,577176002495393,0,null,[[7,[11,[4,29],[3,219757034348558],[4,27]]]]],[2,30,null,703321369241041,0,null,[[10,0],[7,[12,[4,27]]]]]],[[0,0,false,null,179405022427644,11,[[-1,35,null,0,false,false,false,132121512858655,null,[[7,[12,[4,27]]],[8,0],[7,[13]]]]],[[2,8,null,502185110359348,0,null,[[7,[14]]]]]],[0,0,false,null,567205675237525,12,[[-1,35,null,0,false,false,false,694820535984573,null,[[7,[12,[4,27]]],[8,0],[7,[15,[4,25],[3,219757034348558]]]]]],[[2,8,null,936690811886333,0,null,[[7,[14]]]]]]]],[0,0,false,null,111484987581289,13,[[-1,24,null,0,true,false,false,994388416890200,null,[[0,[7,[4,25],[3,198210839952092]]]]]],[[-1,26,null,935415863501486,256,null,[[4,5],[5,[2]],[0,[18]],[0,[9,[3,946831665396307],[4,27]]],[16,false],[20,[10]]]],[5,28,null,190702473491617,0,null,[[3,0],[4,9]]],[5,8,null,717374419563358,0,null,[[7,[11,[4,29],[3,198210839952092],[4,27]]]]],[5,30,null,995916105886254,0,null,[[10,0],[7,[12,[4,27]]]]]],[[0,0,false,null,425341723958450,14,[[-1,35,null,0,false,false,false,142167691537526,null,[[7,[12,[4,27]]],[8,0],[7,[13]]]]],[[5,8,null,281944314751954,0,null,[[7,[14]]]]]],[0,0,false,null,148189492587095,15,[[-1,35,null,0,false,false,false,839907699697976,null,[[7,[12,[4,27]]],[8,0],[7,[15,[4,25],[3,198210839952092]]]]]],[[5,8,null,821778154644002,0,null,[[7,[14]]]]]]]],[0,0,false,null,533887028308609,16,[[-1,24,null,0,true,false,false,822509039189083,null,[[0,[7,[4,25],[3,642324951234995]]]]]],[[-1,26,null,658169629180454,256,null,[[4,1],[5,[2]],[0,[19]],[0,[9,[3,946831665396307],[4,27]]],[16,false],[20,[10]]]],[23,41,null,867587346266846,0,null,[[0,[20,[4,42],[4,38],[4,29],[3,920627731603306],[4,38],[4,29],[3,920627731603306],[4,38],[4,29],[3,920627731603306]]]]],[1,43,null,944151242659904,0,null,[[0,[20,[4,42],[4,38],[4,29],[3,920627731603306],[4,38],[4,29],[3,920627731603306],[4,38],[4,29],[3,920627731603306]]]]],[1,28,null,771768555641610,0,null,[[3,0],[4,9]]],[1,8,null,581199493632541,0,null,[[7,[11,[4,29],[3,642324951234995],[4,27]]]]],[1,30,null,532591888389982,0,null,[[10,0],[7,[12,[4,27]]]]],[1,31,null,126671628171085,0,null,[[3,0]]],[-1,26,null,200164987898473,256,null,[[4,12],[5,[2]],[0,[4,[1,1,32,false]]],[0,[4,[1,1,33,false]]],[16,false],[20,[10]]]],[12,43,null,509801033278881,0,null,[[0,[20,[4,42],[4,38],[4,29],[3,920627731603306],[4,38],[4,29],[3,920627731603306],[4,38],[4,29],[3,920627731603306]]]]],[12,28,null,937142734967923,0,null,[[3,0],[4,9]]],[1,34,null,387335283999444,0,null,[[4,12],[16,true],[16,true],[16,true],[16,true],[16,true],[16,false],[16,true],[16,false],[16,false]]]],[[0,0,false,null,615789195241740,17,[[-1,35,null,0,false,false,false,447651632765859,null,[[7,[12,[4,27]]],[8,0],[7,[13]]]]],[[1,8,null,231548038625456,0,null,[[7,[14]]]],[12,8,null,402794345036546,0,null,[[7,[14]]]]]],[0,0,false,null,708891529798094,18,[[-1,35,null,0,false,false,false,169951997758840,null,[[7,[12,[4,27]]],[8,0],[7,[15,[4,25],[3,642324951234995]]]]]],[[1,8,null,465815488077489,0,null,[[7,[14]]]],[12,8,null,865144138400557,0,null,[[7,[14]]]]]],[0,0,false,null,933536108934355,19,[[1,36,null,0,false,true,false,507882689623332,null,[[1,[14]],[3,0]]]],[[-1,37,null,704889916435114,0,null,[[11,524895581644187],[7,[16,[4,38],[1,1,39,true]]]]],[-3,44,[false,false,1]],[12,8,null,154025339516038,0,null,[[7,[3,[3,437592147558708]]]]]]]]],[0,0,false,null,654428856962581,20,[],[[-1,20,null,811147710649316,4096,null],[-1,21,null,830509685982437,4096,null,[[0,[21]]]],[-2,\"Scroll Bet Option\",null,143700289733685,0,null,[[1,[3,[3,832254520486565]]],[1,[3,[3,534613511407694]]],[1,[3,[3,627925097177680]]],[1,[3,[3,698497735567615]]]]]]]]],[4,[\"Setup_Bet_Option\",0,[[1,\"BO_BetSize2\",1,\"\",false,false,948995835616637,false,55],[1,\"BO_BetLevel2\",1,\"\",false,false,927676677851056,false,56],[1,\"BO_Line2\",1,\"\",false,false,598241456983751,false,57],[1,\"BO_BetAmount2\",1,\"\",false,false,863492040833628,false,58],[1,\"BO_Credit2\",1,\"\",false,false,672342127016424,false,59],[1,\"BO_BetAmount12\",1,\"\",false,false,532677592234898,false,60],[1,\"BO_Winamount2\",1,\"\",false,false,726321959936735,false,61],[1,\"BO_BetSizeList2\",1,\"\",false,false,421289051545899,false,62],[1,\"BO_BetLevelList2\",1,\"\",false,false,316787063990992,false,63],[1,\"BO_BetLineList2\",1,\"\",false,false,560620820418060,false,64],[1,\"BO_color2\",1,\"\",false,false,813901552605576,false,65],[1,\"BO_currency_decimal2\",1,\"\",false,false,397698043836554,false,66],[1,\"BO_currency_thousand2\",1,\"\",false,false,823116542417950,false,67],[1,\"BO_currency_prefix2\",1,\"\",false,false,238194467216560,false,68],[1,\"BO_currency_suffix2\",1,\"\",false,false,354210383441893,false,69],[1,\"BO_minbet2\",1,\"\",false,false,866561295885636,false,70],[1,\"BO_maxbet2\",1,\"\",false,false,262540146511966,false,71],[1,\"BO_Reduct\",1,\"\",false,false,219434046626094,false,72]],true,false,false],false,null,323718222135071,21,[[-1,45,null,0,false,true,false,307295090644835,null,[[11,958449875396847]]]],[[-1,46,null,146687155708422,0,null,[[11,958449875396847],[3,1]]],[-1,37,null,596965434549396,0,null,[[11,920627731603306],[7,[3,[3,813901552605576]]]]],[1,43,null,730906780785206,0,null,[[0,[20,[4,42],[4,38],[4,29],[3,813901552605576],[4,38],[4,29],[3,813901552605576],[4,38],[4,29],[3,813901552605576]]]]],[11,43,null,555868698077524,0,null,[[0,[20,[4,42],[4,38],[4,29],[3,813901552605576],[4,38],[4,29],[3,813901552605576],[4,38],[4,29],[3,813901552605576]]]]],[4,41,null,791251230462071,0,null,[[0,[20,[4,42],[4,38],[4,29],[3,813901552605576],[4,38],[4,29],[3,813901552605576],[4,38],[4,29],[3,813901552605576]]]]],[10,41,null,317525172410096,0,null,[[0,[20,[4,42],[4,38],[4,29],[3,813901552605576],[4,38],[4,29],[3,813901552605576],[4,38],[4,29],[3,813901552605576]]]]],[-1,37,null,570236450349801,0,null,[[11,832254520486565],[7,[3,[3,948995835616637]]]]],[-1,37,null,433569891918534,0,null,[[11,534613511407694],[7,[3,[3,927676677851056]]]]],[-1,37,null,580178821735240,0,null,[[11,627925097177680],[7,[3,[3,598241456983751]]]]],[-1,37,null,147723224686740,0,null,[[11,698497735567615],[7,[3,[3,863492040833628]]]]],[-1,37,null,628150295725339,0,null,[[11,371373731486570],[7,[3,[3,421289051545899]]]]],[-1,37,null,823626605677482,0,null,[[11,219757034348558],[7,[3,[3,316787063990992]]]]],[-1,37,null,237218337226717,0,null,[[11,198210839952092],[7,[3,[3,560620820418060]]]]],[-1,20,null,936960779371252,4096,null],[-3,47,[false,false,14]],[-3,48,[false,false,15]],[-3,49,[false,false,16]],[-1,20,null,765650829224974,4096,null],[-1,37,null,746381719694309,0,null,[[11,159524818741644],[7,[3,[3,397698043836554]]]]],[-1,37,null,938395496985980,0,null,[[11,939433529214858],[7,[3,[3,823116542417950]]]]],[-1,37,null,920140719773145,0,null,[[11,666389786876882],[7,[22,[3,238194467216560],[3,238194467216560]]]]],[-1,37,null,289573537489141,0,null,[[11,487621348371088],[7,[22,[3,354210383441893],[3,354210383441893]]]]],[-1,37,null,845971006431869,0,null,[[11,755569096145214],[7,[3,[3,866561295885636]]]]],[-1,37,null,563783348129886,0,null,[[11,290588386255325],[7,[3,[3,262540146511966]]]]],[-2,\"Scroll Bet Option\",null,461150035622294,0,null,[[1,[3,[3,948995835616637]]],[1,[3,[3,927676677851056]]],[1,[3,[3,598241456983751]]],[1,[3,[3,863492040833628]]]]],[18,8,null,725565754878624,0,null,[[7,[3,[3,672342127016424]]]]],[20,8,null,251171614648280,0,null,[[7,[3,[3,532677592234898]]]]],[21,8,null,535335240522732,0,null,[[7,[3,[3,726321959936735]]]]],[-1,20,null,307657424118861,4096,null],[-1,46,null,118037646020511,0,null,[[11,958449875396847],[3,0]]]],[[0,0,false,null,830759559135667,22,[[-1,50,null,0,false,false,false,906487452761345,null]],[[3,51,null,458822483373907,0,null],[13,51,null,510250726305797,0,null],[2,51,null,254830029273394,0,null],[5,51,null,599844129509047,0,null],[1,51,null,206998494214062,0,null],[12,51,null,889264877980103,0,null]],[[0,0,false,null,782222290773557,23,[[-1,52,null,0,false,false,false,440901526013566,null,[[11,219434046626094],[8,0],[7,[23]]]]],[[-3,53,[false,false,0]]]],[0,0,false,null,421700840344569,24,[[-1,52,null,0,false,false,false,923083289043669,null,[[11,219434046626094],[8,0],[7,[24]]]]],[[-3,54,[false,false,0]]]],[0,0,false,null,647616556197878,25,[],[[-1,20,null,465356305274442,4096,null],[-3,55,[false,false,1]]]]]]]],[1,\"minBet\",1,\"\",true,false,333726271195090,false,73],[1,\"maxBet\",1,\"\",true,false,294818268793367,false,74],[4,[\"SendMinMax\",0,[],true,false,false],false,null,632395981047294,26,[],[[-1,37,null,357708006119003,0,null,[[11,333726271195090],[7,[25,[4,29],[3,642324951234995]]]]],[-1,37,null,119231047371990,0,null,[[11,294818268793367],[7,[26,[4,29],[3,642324951234995],[4,25],[3,642324951234995]]]]],[-3,56,[false,false,2]]]],[4,[\"Scroll Bet Option\",0,[[1,\"BO_BetSize\",1,\"\",false,false,933194522291880,false,79],[1,\"BO_BetLevel\",1,\"\",false,false,524587600182133,false,80],[1,\"BO_Line\",1,\"\",false,false,837658555188526,false,81],[1,\"BO_BetAmount\",1,\"\",false,false,594238518269290,false,82]],true,false,false],false,null,347387781488450,27,[],[],[[1,\"BO_betsize_txt_Y\",0,0,false,false,442662744362063,false,75],[0,0,false,null,559177256279369,28,[[3,36,null,0,false,false,false,366318187199258,null,[[1,[3,[3,933194522291880]]],[3,0]]]],[[-1,37,null,478851089758286,0,null,[[11,442662744362063],[7,[27,[3,946831665396307],[1,3,33,false]]]]]]],[0,0,false,null,129942826339420,29,[],[[3,57,\"Tween\",368399183622938,2048,null,[[1,[28]],[3,1],[0,[29,[1,3,33,false],[3,442662744362063]]],[0,[30]],[18,0],[3,0],[3,0],[3,0],[0,[6]]]]]],[1,\"BO_betlevel_txt_Y\",0,0,false,false,922187996869787,false,76],[0,0,false,null,771077751039847,30,[[2,36,null,0,false,false,false,677673070381650,null,[[1,[3,[3,524587600182133]]],[3,0]]]],[[-1,37,null,521514306003786,0,null,[[11,442662744362063],[7,[27,[3,946831665396307],[1,2,33,false]]]]]]],[0,0,false,null,577480598488507,31,[],[[2,57,\"Tween\",410841309247588,2048,null,[[1,[28]],[3,1],[0,[29,[1,2,33,false],[3,442662744362063]]],[0,[30]],[18,0],[3,0],[3,0],[3,0],[0,[6]]]]]],[1,\"BO_line_txt_Y\",0,0,false,false,241139892041719,false,77],[0,0,false,null,883759651035679,32,[[5,36,null,0,false,false,false,996086594909362,null,[[1,[3,[3,837658555188526]]],[3,0]]]],[[-1,37,null,961265050651020,0,null,[[11,442662744362063],[7,[27,[3,946831665396307],[1,5,33,false]]]]]]],[0,0,false,null,308555059430186,33,[],[[5,57,\"Tween\",809524501659766,2048,null,[[1,[28]],[3,1],[0,[29,[1,5,33,false],[3,442662744362063]]],[0,[30]],[18,0],[3,0],[3,0],[3,0],[0,[6]]]]]],[1,\"BO_betamount_txt_Y\",0,0,false,false,282304006167722,false,78],[0,0,false,null,680639027853606,34,[[1,36,null,0,false,false,false,232583492642712,null,[[1,[3,[3,594238518269290]]],[3,0]]]],[[-1,37,null,172586248340380,0,null,[[11,442662744362063],[7,[27,[3,946831665396307],[1,1,33,false]]]]]]],[0,0,false,null,251159846279440,35,[],[[1,57,\"Tween\",525762269752259,2048,null,[[1,[28]],[3,1],[0,[29,[1,1,33,false],[3,442662744362063]]],[0,[30]],[18,0],[3,0],[3,0],[3,0],[0,[6]]]]]]]],[0,0,false,null,170763985575569,36,[[16,58,null,1,false,false,false,693866386549535,null,[[4,27],[3,0]]],[27,36,null,0,false,true,false,753424985012535,null,[[1,[14]],[3,0]]],[-1,45,null,0,false,false,false,122000183074985,null,[[11,439393046181703]]],[16,59,null,0,false,true,false,594841524264818,null,[[4,28]]]],[[6,23,null,726390326062468,0,null,[[10,0],[7,[12,[1,16,60,false]]]]],[6,23,null,804981171154180,0,null,[[10,1],[7,[4,[1,27,61,true]]]]]]],[0,0,false,null,286339276172067,37,[[17,62,null,1,false,false,false,158925974392903,null,[[3,0]]]],[],[[0,0,false,null,609991846285086,38,[[27,63,null,0,false,false,true,686201073219103,null,[[3,0],[0,[31,[1,17,64,false]]],[0,[31,[1,17,65,false]]]]]],[],[[0,0,false,null,926754645452987,39,[[27,11,\"Tween\",0,false,true,false,117438291468818,null]],[[-2,\"OB_Mouse_Down\",null,455572214669577,0,null,[[1,[4,[1,27,61,true]]]]]]]]]]],[0,0,false,null,965977345222931,40,[[17,62,null,1,false,false,false,797065577113015,null,[[3,1]]]],[],[[0,0,false,null,614583786085710,41,[[27,63,null,0,false,false,true,398971666829865,null,[[3,0],[0,[31,[1,17,64,false]]],[0,[31,[1,17,65,false]]]]]],[],[[0,0,false,null,254257872770564,42,[[27,11,\"Tween\",0,false,true,false,967163421522045,null]],[[-2,\"OB_Mouse_Up\",null,522548969649064,0,null,[[1,[4,[1,27,61,true]]]]]]]]]]],[4,[\"OB_Mouse_Down\",0,[[1,\"id\",1,\"\",false,false,381953467890909,false,1]],true,false,false],false,null,408973790506285,43,[],[],[[1,\"br1\",2,false,false,false,849046562441652,false,83],[0,0,false,null,378853648924408,44,[[-1,52,null,0,false,false,false,100055589587278,null,[[11,381953467890909],[8,0],[7,[32]]]]],[],[[0,0,false,null,626611148239576,45,[[3,36,null,0,false,false,false,289097787962434,null,[[1,[14]],[3,0]]]],[],[[0,0,false,null,851413047152682,46,[[3,66,null,0,false,false,false,435861333331435,null,[[10,0],[8,4],[7,[13]]]]],[],[[0,0,false,null,682276702912039,47,[[3,67,null,0,false,false,false,859109232703124,null,[[8,3],[0,[33,[3,946831665396307],[3,385718310063291]]]]]],[[-1,46,null,991651811468069,0,null,[[11,849046562441652],[3,1]]]]]]]]],[0,0,false,null,130093510730355,48,[[-1,45,null,0,false,true,false,415361421442815,null,[[11,849046562441652]]]],[[3,57,\"Tween\",507721271925867,2048,null,[[1,[34]],[3,1],[0,[35,[1,3,33,false],[3,385718310063291]]],[0,[21]],[18,0],[3,0],[3,0],[3,0],[0,[6]]]]]]]],[0,0,false,null,274259897653366,49,[[-1,52,null,0,false,false,false,818488463414052,null,[[11,381953467890909],[8,0],[7,[36]]]]],[],[[0,0,false,null,281444179218164,50,[[2,36,null,0,false,false,false,141623641828581,null,[[1,[14]],[3,0]]]],[],[[0,0,false,null,902220899308876,51,[[2,66,null,0,false,false,false,909609831829236,null,[[10,0],[8,4],[7,[13]]]]],[],[[0,0,false,null,349693233409415,52,[[2,67,null,0,false,false,false,335667593714129,null,[[8,3],[0,[33,[3,946831665396307],[3,385718310063291]]]]]],[[-1,46,null,831065822991531,0,null,[[11,849046562441652],[3,1]]]]]]]]],[0,0,false,null,106642080023474,53,[[-1,45,null,0,false,true,false,654587488678027,null,[[11,849046562441652]]]],[[2,57,\"Tween\",102680137635586,2048,null,[[1,[34]],[3,1],[0,[35,[1,2,33,false],[3,385718310063291]]],[0,[21]],[18,0],[3,0],[3,0],[3,0],[0,[6]]]]]]]],[0,0,false,null,888309626405254,54,[[-1,52,null,0,false,false,false,256442130814630,null,[[11,381953467890909],[8,0],[7,[37]]]]],[],[[0,0,false,null,762999020005123,55,[[5,36,null,0,false,false,false,602120800353776,null,[[1,[14]],[3,0]]]],[],[[0,0,false,null,240157185150094,56,[[5,66,null,0,false,false,false,105131881851319,null,[[10,0],[8,4],[7,[13]]]]],[],[[0,0,false,null,420307249715968,57,[[5,67,null,0,false,false,false,320289819793208,null,[[8,3],[0,[33,[3,946831665396307],[3,385718310063291]]]]]],[[-1,46,null,992991198228239,0,null,[[11,849046562441652],[3,1]]]]]]]]],[0,0,false,null,228990617316250,58,[[-1,45,null,0,false,true,false,924759157244632,null,[[11,849046562441652]]]],[[5,57,\"Tween\",723392664151039,2048,null,[[1,[34]],[3,1],[0,[35,[1,5,33,false],[3,385718310063291]]],[0,[21]],[18,0],[3,0],[3,0],[3,0],[0,[6]]]]]]]],[0,0,false,null,474189273566604,59,[[-1,52,null,0,false,false,false,180854841130595,null,[[11,381953467890909],[8,0],[7,[38]]]]],[],[[0,0,false,null,585979234763370,60,[[1,36,null,0,false,false,false,782823367093322,null,[[1,[14]],[3,0]]]],[],[[0,0,false,null,340730511416797,61,[[1,66,null,0,false,false,false,796937197171694,null,[[10,0],[8,4],[7,[13]]]]],[],[[0,0,false,null,858951623236562,62,[[1,67,null,0,false,false,false,538180268702702,null,[[8,3],[0,[33,[3,946831665396307],[3,385718310063291]]]]]],[[-1,46,null,638458873986677,0,null,[[11,849046562441652],[3,1]]]]]]]]],[0,0,false,null,224984701526821,63,[[-1,45,null,0,false,true,false,872394151042048,null,[[11,849046562441652]]]],[[1,57,\"Tween\",899764578204795,2048,null,[[1,[39]],[3,1],[0,[35,[1,1,33,false],[3,385718310063291]]],[0,[21]],[18,0],[3,0],[3,0],[3,0],[0,[6]]]]]]]]]],[4,[\"OB_Mouse_Up\",0,[[1,\"id\",1,\"\",false,false,311451840466844,false,1]],true,false,false],false,null,795366518549502,64,[],[],[[1,\"br1\",2,false,false,false,180304319542116,false,83],[0,0,false,null,269709322909173,65,[[-1,52,null,0,false,false,false,806850657818710,null,[[11,311451840466844],[8,0],[7,[32]]]]],[],[[0,0,false,null,688835763211015,66,[[3,36,null,0,false,false,false,940673299284579,null,[[1,[14]],[3,0]]]],[],[[0,0,false,null,160794207562438,67,[[3,66,null,0,false,false,false,423417674377725,null,[[10,0],[8,0],[7,[13]]]]],[],[[0,0,false,null,993050934674921,68,[[3,67,null,0,false,false,false,610199706631330,null,[[8,5],[0,[40,[3,946831665396307],[3,385718310063291]]]]]],[[-1,46,null,636130918261521,0,null,[[11,180304319542116],[3,1]]]]]]]]],[0,0,false,null,749812020414667,69,[[-1,45,null,0,false,true,false,268203946120808,null,[[11,180304319542116]]]],[[3,57,\"Tween\",725217713436123,2048,null,[[1,[34]],[3,1],[0,[29,[1,3,33,false],[3,385718310063291]]],[0,[21]],[18,0],[3,0],[3,0],[3,0],[0,[6]]]]]]]],[0,0,false,null,174482693726241,70,[[-1,52,null,0,false,false,false,157756427917383,null,[[11,311451840466844],[8,0],[7,[36]]]]],[],[[0,0,false,null,546704314185099,71,[[2,36,null,0,false,false,false,570950343059850,null,[[1,[14]],[3,0]]]],[],[[0,0,false,null,869917495155018,72,[[2,66,null,0,false,false,false,930048486953645,null,[[10,0],[8,0],[7,[13]]]]],[],[[0,0,false,null,141797210239451,73,[[2,67,null,0,false,false,false,763910431710984,null,[[8,5],[0,[40,[3,946831665396307],[3,385718310063291]]]]]],[[-1,46,null,248767550054023,0,null,[[11,180304319542116],[3,1]]]]]]]]],[0,0,false,null,152433908024987,74,[[-1,45,null,0,false,true,false,684583201338515,null,[[11,180304319542116]]]],[[2,57,\"Tween\",305019220609768,2048,null,[[1,[34]],[3,1],[0,[29,[1,2,33,false],[3,385718310063291]]],[0,[21]],[18,0],[3,0],[3,0],[3,0],[0,[6]]]]]]]],[0,0,false,null,139766175052130,75,[[-1,52,null,0,false,false,false,801557982436688,null,[[11,311451840466844],[8,0],[7,[37]]]]],[],[[0,0,false,null,276790752429835,76,[[5,36,null,0,false,false,false,786465974105093,null,[[1,[14]],[3,0]]]],[],[[0,0,false,null,214031072943908,77,[[5,66,null,0,false,false,false,136107114870866,null,[[10,0],[8,0],[7,[13]]]]],[],[[0,0,false,null,987225004261972,78,[[5,67,null,0,false,false,false,567041324860833,null,[[8,5],[0,[40,[3,946831665396307],[3,385718310063291]]]]]],[[-1,46,null,453503219170371,0,null,[[11,180304319542116],[3,1]]]]]]]]],[0,0,false,null,737197532901906,79,[[-1,45,null,0,false,true,false,362399518923032,null,[[11,180304319542116]]]],[[5,57,\"Tween\",322860573017654,2048,null,[[1,[34]],[3,1],[0,[29,[1,5,33,false],[3,385718310063291]]],[0,[21]],[18,0],[3,0],[3,0],[3,0],[0,[6]]]]]]]],[0,0,false,null,150963277103499,80,[[-1,52,null,0,false,false,false,610762335315167,null,[[11,311451840466844],[8,0],[7,[38]]]]],[],[[0,0,false,null,748524119367766,81,[[1,36,null,0,false,false,false,775007270795865,null,[[1,[14]],[3,0]]]],[],[[0,0,false,null,374423691822209,82,[[1,66,null,0,false,false,false,524810769664987,null,[[10,0],[8,0],[7,[13]]]]],[],[[0,0,false,null,247848403648520,83,[[1,67,null,0,false,false,false,663142861707199,null,[[8,5],[0,[40,[3,946831665396307],[3,385718310063291]]]]]],[[-1,46,null,648869956759582,0,null,[[11,180304319542116],[3,1]]]]]]]]],[0,0,false,null,152011302335821,84,[[-1,45,null,0,false,true,false,869524987439065,null,[[11,180304319542116]]]],[[1,57,\"Tween\",705545603570916,2048,null,[[1,[39]],[3,1],[0,[29,[1,1,33,false],[3,385718310063291]]],[0,[21]],[18,0],[3,0],[3,0],[3,0],[0,[6]]]]]]]]]],[0,0,false,null,348814710920231,85,[[16,68,null,1,false,false,false,377516038731038,null,[[4,27]]],[27,36,null,0,false,true,false,317314368681279,null,[[1,[14]],[3,0]]],[16,59,null,0,false,false,false,165447515121592,null,[[4,24]]],[16,59,null,0,false,true,false,135481898505377,null,[[4,28]]]],[],[[1,\"timeT\",0,0.1,false,false,884349762600518,false,84],[1,\"tweenY\",0,0,false,false,443929251759116,false,85],[1,\"activeOB\",1,\"\",false,false,778636408666401,false,86],[0,0,false,null,646933289311464,86,[],[[-1,37,null,852876486311116,0,null,[[11,778636408666401],[7,[4,[1,27,61,true]]]]]]],[0,0,false,null,414822955488701,87,[[-1,52,null,0,false,false,false,695891018049075,null,[[11,778636408666401],[8,0],[7,[32]]]]],[[-1,37,null,668895916917763,0,null,[[11,443929251759116],[7,[27,[3,946831665396307],[1,27,33,false]]]]],[3,57,\"Tween\",894165510620798,2048,null,[[1,[34]],[3,1],[0,[29,[1,3,33,false],[3,443929251759116]]],[0,[3,[3,884349762600518]]],[18,15],[3,0],[3,0],[3,0],[0,[6]]]]]],[0,0,false,null,988033529767139,88,[[-1,52,null,0,false,false,false,945400771011794,null,[[11,778636408666401],[8,0],[7,[36]]]]],[[-1,37,null,655983816482591,0,null,[[11,443929251759116],[7,[27,[3,946831665396307],[1,27,33,false]]]]],[2,57,\"Tween\",174022590587849,2048,null,[[1,[34]],[3,1],[0,[29,[1,2,33,false],[3,443929251759116]]],[0,[3,[3,884349762600518]]],[18,15],[3,0],[3,0],[3,0],[0,[6]]]]]],[0,0,false,null,599415341152299,89,[[-1,52,null,0,false,false,false,733840344225954,null,[[11,778636408666401],[8,0],[7,[37]]]]],[[-1,37,null,126123060434449,0,null,[[11,443929251759116],[7,[27,[3,946831665396307],[1,27,33,false]]]]],[5,57,\"Tween\",614800566585245,2048,null,[[1,[34]],[3,1],[0,[29,[1,5,33,false],[3,443929251759116]]],[0,[3,[3,884349762600518]]],[18,15],[3,0],[3,0],[3,0],[0,[6]]]]]],[0,0,false,null,340389703096713,90,[[-1,52,null,0,false,false,false,710788411333291,null,[[11,778636408666401],[8,0],[7,[38]]]]],[[-1,37,null,357333333461519,0,null,[[11,443929251759116],[7,[27,[3,946831665396307],[1,27,33,false]]]]],[1,57,\"Tween\",180753912560638,2048,null,[[1,[39]],[3,1],[0,[29,[1,1,33,false],[3,443929251759116]]],[0,[3,[3,884349762600518]]],[18,15],[3,0],[3,0],[3,0],[0,[6]]]]]]]],[4,[\"OB_Three_Num\",0,[],true,false,false],false,null,141881276772690,91,[],[],[[1,\"BO_BetSize\",1,\"\",false,false,927544956228880,false,79],[1,\"BO_BetLevel\",1,\"\",false,false,764179735416506,false,80],[1,\"BO_Line\",1,\"\",false,false,339576700886673,false,81],[1,\"BO_BETAMOUNT\",1,\"\",false,false,237683374789458,false,87],[0,0,false,null,444524658275812,92,[[3,63,null,0,false,false,true,722775091469386,null,[[3,0],[0,[4,[1,3,32,false]]],[0,[3,[3,946831665396307]]]]]],[[-1,37,null,438176110717021,0,null,[[11,927544956228880],[7,[4,[1,3,39,true]]]]]]],[0,0,false,null,262532800280770,93,[[2,63,null,0,false,false,true,974078087720929,null,[[3,0],[0,[4,[1,2,32,false]]],[0,[3,[3,946831665396307]]]]]],[[-1,37,null,139117678627897,0,null,[[11,764179735416506],[7,[4,[1,2,39,true]]]]]]],[0,0,false,null,743158678529036,94,[[5,63,null,0,false,false,true,990439211285400,null,[[3,0],[0,[4,[1,5,32,false]]],[0,[3,[3,946831665396307]]]]]],[[-1,37,null,376803902953954,0,null,[[11,339576700886673],[7,[4,[1,5,39,true]]]]]]],[0,0,false,null,557495147056478,95,[],[[-3,69,[false,false,0]],[-2,\"Scroll Bet Option\",null,523785580864863,0,null,[[1,[3,[3,927544956228880]]],[1,[3,[3,764179735416506]]],[1,[3,[3,339576700886673]]],[1,[3,[3,237683374789458]]]]]]]]],[4,[\"OB_BetAmount_Num\",0,[],true,false,false],false,null,160724440459788,96,[],[],[[1,\"selectedTxt\",1,\"\",false,false,486522589667484,false,88],[0,0,false,null,352888690415199,97,[[1,63,null,0,false,false,true,169078978613806,null,[[3,0],[0,[4,[1,1,32,false]]],[0,[3,[3,946831665396307]]]]]],[[-1,37,null,866115265751803,0,null,[[11,486522589667484],[7,[4,[1,1,39,true]]]]],[-3,70,[false,false,1]]]]]],[4,[\"BO_calculation\",0,[],true,true,false],false,null,471765356601033,98,[],[],[[0,0,false,null,657543320017839,99,[],[],[[1,\"timeT\",0,0.1,false,false,854637665423945,false,84],[1,\"tweenY\",0,0,false,false,915599579030168,false,85],[1,\"BO_BetSize\",1,\"\",false,false,321796473439861,false,79],[1,\"BO_BetLevel\",1,\"\",false,false,159119179491960,false,80],[1,\"BO_Line\",1,\"\",false,false,116556785436939,false,81],[1,\"BO_BETAMOUNT\",1,\"\",false,false,190729913998795,false,87],[0,0,false,null,400271320937269,100,[[6,71,null,0,false,false,false,456248171756261,null,[[10,1],[8,0],[7,[32]]]]],[],[[0,0,false,null,838983321712488,101,[[3,36,null,0,false,true,false,561778282552333,null,[[1,[14]],[3,0]]]],[],[[0,0,false,null,897013524537446,102,[[3,63,null,0,false,false,true,854717298318713,null,[[3,0],[0,[4,[1,3,32,false]]],[0,[3,[3,946831665396307]]]]]],[[-1,37,null,167849562909744,0,null,[[11,915599579030168],[7,[27,[3,946831665396307],[1,3,33,false]]]]],[-1,37,null,173208633053005,0,null,[[11,321796473439861],[7,[4,[1,3,39,true]]]]]]]]],[0,0,false,null,578119876790294,103,[],[[3,57,\"Tween\",119213197706913,2048,null,[[1,[34]],[3,1],[0,[29,[1,3,33,false],[3,915599579030168]]],[0,[3,[3,854637665423945]]],[18,15],[3,0],[3,0],[3,0],[0,[6]]]]]]]],[0,0,false,null,442356398506594,104,[[6,71,null,0,false,false,false,870911340905186,null,[[10,1],[8,0],[7,[36]]]]],[],[[0,0,false,null,540448355229602,105,[[2,36,null,0,false,true,false,303915970543130,null,[[1,[14]],[3,0]]]],[],[[0,0,false,null,581811937441101,106,[[2,63,null,0,false,false,true,802917767539690,null,[[3,0],[0,[4,[1,2,32,false]]],[0,[3,[3,946831665396307]]]]]],[[-1,37,null,469900760345383,0,null,[[11,915599579030168],[7,[27,[3,946831665396307],[1,2,33,false]]]]],[-1,37,null,806347629914105,0,null,[[11,159119179491960],[7,[4,[1,2,39,true]]]]]]]]],[0,0,false,null,361464212954357,107,[],[[2,57,\"Tween\",383032453712724,2048,null,[[1,[34]],[3,1],[0,[29,[1,2,33,false],[3,915599579030168]]],[0,[3,[3,854637665423945]]],[18,15],[3,0],[3,0],[3,0],[0,[6]]]]]]]],[0,0,false,null,698070617600314,108,[[6,71,null,0,false,false,false,260844328891091,null,[[10,1],[8,0],[7,[37]]]]],[],[[0,0,false,null,867721775621517,109,[[5,36,null,0,false,true,false,214685590880305,null,[[1,[14]],[3,0]]]],[],[[0,0,false,null,510813205327965,110,[[5,63,null,0,false,false,true,240681510549457,null,[[3,0],[0,[4,[1,5,32,false]]],[0,[3,[3,946831665396307]]]]]],[[-1,37,null,873660942013879,0,null,[[11,915599579030168],[7,[27,[3,946831665396307],[1,5,33,false]]]]],[-1,37,null,350873358176883,0,null,[[11,116556785436939],[7,[4,[1,5,39,true]]]]]]]]],[0,0,false,null,597057760954358,111,[],[[5,57,\"Tween\",452080320596133,2048,null,[[1,[34]],[3,1],[0,[29,[1,5,33,false],[3,915599579030168]]],[0,[3,[3,854637665423945]]],[18,15],[3,0],[3,0],[3,0],[0,[6]]]]]]]],[0,0,false,null,888337857991838,112,[[6,71,null,0,false,false,false,688363941048367,null,[[10,1],[8,0],[7,[38]]]]],[],[[0,0,false,null,570397881265473,113,[[1,36,null,0,false,true,false,815524647452041,null,[[1,[14]],[3,0]]]],[],[[0,0,false,null,971336948597218,114,[[1,63,null,0,false,false,true,927776153660355,null,[[3,0],[0,[4,[1,1,32,false]]],[0,[3,[3,946831665396307]]]]]],[[-1,37,null,935950808303111,0,null,[[11,915599579030168],[7,[27,[3,946831665396307],[1,1,33,false]]]]]]]]],[0,0,false,null,129504975591829,115,[],[[1,57,\"Tween\",172879412237512,2048,null,[[1,[39]],[3,1],[0,[29,[1,1,33,false],[3,915599579030168]]],[0,[3,[3,854637665423945]]],[18,15],[3,0],[3,0],[3,0],[0,[6]]]]]]]],[0,0,false,null,645987003481880,116,[],[[6,23,null,777325384644801,0,null,[[10,1],[7,[10]]]]]]]]]],[0,0,false,null,716787278277606,117,[[16,72,null,1,false,false,false,950003926321964,null],[-1,45,null,0,false,false,false,248669580840937,null,[[11,439393046181703]]]],[[-1,46,null,799439187561523,0,null,[[11,439393046181703],[3,0]]],[-2,\"BO_calculation\",null,345710078034860,2048,null],[-1,20,null,727313090343883,4096,null],[-1,46,null,675074434907771,0,null,[[11,439393046181703],[3,1]]]]],[0,0,true,null,432776331866775,118,[[27,73,\"Tween\",1,false,false,false,162565981382913,null,[[1,[34]]]]],[[-2,\"OB_Three_Num\",null,260805077316798,0,null]]],[0,0,true,null,200948508674070,119,[[27,73,\"Tween\",1,false,false,false,507741226284032,null,[[1,[39]]]]],[[-2,\"OB_BetAmount_Num\",null,538359815108933,0,null]]],[1,\"CallCalculator\",2,true,true,false,599835203563223,false,89],[1,\"BO_Edit_Num\",2,true,true,false,439393046181703,false,90],[1,\"br\",2,false,false,false,941935417190437,false,91],[0,0,false,null,535832869968852,120,[[16,58,null,1,false,false,false,335623422897682,null,[[4,24],[3,0]]]],[[-1,46,null,453550791327320,0,null,[[11,439393046181703],[3,1]]]]],[0,0,false,null,128718400825701,121,[[6,71,null,0,false,false,false,513943152966932,null,[[10,0],[8,1],[7,[12,[1,16,60,false]]]]],[-1,45,null,0,false,false,false,841839735185912,null,[[11,439393046181703]]]],[],[[0,0,false,null,400302271819755,122,[[6,71,null,0,false,false,false,844317148366110,null,[[10,1],[8,0],[7,[32]]]]],[],[[0,0,false,null,618147475581708,123,[[3,36,null,0,false,false,false,170158298251516,null,[[1,[14]],[3,0]]]],[],[[0,0,false,null,998531162969370,124,[[3,66,null,0,false,false,false,682406189716524,null,[[10,0],[8,0],[7,[13]]]]],[],[[0,0,false,null,265483271022197,125,[[3,67,null,0,false,false,false,648001758703783,null,[[8,4],[0,[3,[3,946831665396307]]]]]],[[-1,46,null,136746109988817,0,null,[[11,941935417190437],[3,1]]]]]]],[0,0,false,null,857868007311079,126,[[3,66,null,0,false,false,false,675287370092881,null,[[10,0],[8,4],[7,[13]]]]],[],[[0,0,false,null,802272217380001,127,[[3,67,null,0,false,false,false,554863282296147,null,[[8,2],[0,[3,[3,946831665396307]]]]]],[[-1,46,null,221424439905537,0,null,[[11,941935417190437],[3,1]]]]]]]]],[0,0,false,null,527428287951621,128,[[-1,45,null,0,false,true,false,347594076331419,null,[[11,941935417190437]]]],[[3,74,null,733890056401928,0,null,[[0,[41,[1,3,33,false],[1,16,60,false],[2,6,false,0]]]]],[6,23,null,569636866611045,0,null,[[10,0],[7,[12,[1,16,60,false]]]]]]]]],[0,0,false,null,591987948910240,129,[[6,71,null,0,false,false,false,878499258093455,null,[[10,1],[8,0],[7,[36]]]]],[],[[0,0,false,null,661221702986920,130,[[2,36,null,0,false,false,false,250815808085481,null,[[1,[14]],[3,0]]]],[],[[0,0,false,null,824091694462179,131,[[2,66,null,0,false,false,false,392457818559429,null,[[10,0],[8,0],[7,[13]]]]],[],[[0,0,false,null,294341702697185,132,[[2,67,null,0,false,false,false,228405954461753,null,[[8,4],[0,[3,[3,946831665396307]]]]]],[[-1,46,null,396807468850739,0,null,[[11,941935417190437],[3,1]]]]]]],[0,0,false,null,138039582596185,133,[[2,66,null,0,false,false,false,566992246212352,null,[[10,0],[8,4],[7,[13]]]]],[],[[0,0,false,null,680326882263879,134,[[2,67,null,0,false,false,false,617491124205321,null,[[8,2],[0,[3,[3,946831665396307]]]]]],[[-1,46,null,553209706444907,0,null,[[11,941935417190437],[3,1]]]]]]]]],[0,0,false,null,455457992134482,135,[[-1,45,null,0,false,true,false,611007530185742,null,[[11,941935417190437]]]],[[2,74,null,737237042881103,0,null,[[0,[41,[1,2,33,false],[1,16,60,false],[2,6,false,0]]]]],[6,23,null,665408024940850,0,null,[[10,0],[7,[12,[1,16,60,false]]]]]]]]],[0,0,false,null,856676387622713,136,[[6,71,null,0,false,false,false,271854447502527,null,[[10,1],[8,0],[7,[37]]]]],[],[[0,0,false,null,346349566134918,137,[[5,36,null,0,false,false,false,707951919869105,null,[[1,[14]],[3,0]]]],[],[[0,0,false,null,110205176495170,138,[[5,66,null,0,false,false,false,732854839798520,null,[[10,0],[8,0],[7,[13]]]]],[],[[0,0,false,null,642617865839866,139,[[5,67,null,0,false,false,false,953621516772517,null,[[8,4],[0,[3,[3,946831665396307]]]]]],[[-1,46,null,448450599665441,0,null,[[11,941935417190437],[3,1]]]]]]],[0,0,false,null,987078343625919,140,[[5,66,null,0,false,false,false,792494960374660,null,[[10,0],[8,4],[7,[13]]]]],[],[[0,0,false,null,102480092928188,141,[[5,67,null,0,false,false,false,273365755319703,null,[[8,2],[0,[3,[3,946831665396307]]]]]],[[-1,46,null,967265537137421,0,null,[[11,941935417190437],[3,1]]]]]]]]],[0,0,false,null,477826190254819,142,[[-1,45,null,0,false,true,false,812305149167499,null,[[11,941935417190437]]]],[[5,74,null,861391293793365,0,null,[[0,[41,[1,5,33,false],[1,16,60,false],[2,6,false,0]]]]],[6,23,null,287556562614674,0,null,[[10,0],[7,[12,[1,16,60,false]]]]]]]]],[0,0,false,null,513616413467533,143,[[6,71,null,0,false,false,false,696156096555709,null,[[10,1],[8,0],[7,[38]]]]],[],[[0,0,false,null,200266276985041,144,[[1,36,null,0,false,false,false,271128140801876,null,[[1,[14]],[3,0]]]],[],[[0,0,false,null,830046090105331,145,[[1,66,null,0,false,false,false,186962109017910,null,[[10,0],[8,0],[7,[13]]]]],[],[[0,0,false,null,776490639688864,146,[[1,67,null,0,false,false,false,304498479701550,null,[[8,4],[0,[3,[3,946831665396307]]]]]],[[-1,46,null,535368878645142,0,null,[[11,941935417190437],[3,1]]]]]]],[0,0,false,null,939041923263210,147,[[1,66,null,0,false,false,false,112281169504524,null,[[10,0],[8,4],[7,[13]]]]],[],[[0,0,false,null,507456544918410,148,[[1,67,null,0,false,false,false,816819953775323,null,[[8,2],[0,[3,[3,946831665396307]]]]]],[[-1,46,null,510756387269124,0,null,[[11,941935417190437],[3,1]]]]]]]]],[0,0,false,null,162699833207468,149,[[-1,45,null,0,false,true,false,592898046649954,null,[[11,941935417190437]]]],[[1,74,null,675172123363238,0,null,[[0,[41,[1,1,33,false],[1,16,60,false],[2,6,false,0]]]]],[6,23,null,464969795786647,0,null,[[10,0],[7,[12,[1,16,60,false]]]]]]]]]]],[4,[\"maxBet\",0,[],true,false,false],false,null,576696802810016,150,[],[],[[1,\"BO_BetSize\",1,\"\",true,false,187661937746257,false,79],[1,\"BO_BetLevel\",1,\"\",true,false,181855269229766,false,80],[1,\"BO_Line\",1,\"\",true,false,578108033210324,false,81],[1,\"BO_BetAmount\",1,\"\",true,false,283871634728883,false,82],[0,0,false,null,650741971171751,151,[[3,36,null,0,false,true,false,833022406662461,null,[[1,[14]],[3,0]]]],[],[[0,0,false,null,338572718083273,152,[[3,75,null,0,false,false,true,266532413213699,null,[[3,1],[10,0]]]],[[-1,37,null,786486338246318,0,null,[[11,187661937746257],[7,[4,[1,3,39,true]]]]]]]]],[0,0,false,null,293790259708836,153,[[2,36,null,0,false,true,false,444663079110725,null,[[1,[14]],[3,0]]]],[],[[0,0,false,null,623269989162497,154,[[2,75,null,0,false,false,true,291518172761043,null,[[3,1],[10,0]]]],[[-1,37,null,522272896223627,0,null,[[11,181855269229766],[7,[4,[1,2,39,true]]]]]]]]],[0,0,false,null,856130908872923,155,[[5,36,null,0,false,true,false,625070299128906,null,[[1,[14]],[3,0]]]],[],[[0,0,false,null,621775620674591,156,[[5,75,null,0,false,false,true,404632917210924,null,[[3,1],[10,0]]]],[[-1,37,null,281979608846594,0,null,[[11,578108033210324],[7,[4,[1,5,39,true]]]]]]]]],[0,0,false,null,375558294259834,157,[[1,36,null,0,false,true,false,555832286601374,null,[[1,[14]],[3,0]]]],[],[[0,0,false,null,795128860362212,158,[[1,75,null,0,false,false,true,575367169323027,null,[[3,1],[10,0]]]],[[-1,37,null,137275317976108,0,null,[[11,283871634728883],[7,[4,[1,1,39,true]]]]]]]]],[0,0,false,null,199838909794244,159,[],[[-1,20,null,859600306934076,4096,null],[-2,\"Scroll Bet Option\",null,290122688150386,0,null,[[1,[3,[3,187661937746257]]],[1,[3,[3,181855269229766]]],[1,[3,[3,578108033210324]]],[1,[3,[3,283871634728883]]]]]]]]],[4,[\"maxBetFormCilent\",0,[],true,false,false],false,null,326910700466463,160,[],[],[[1,\"BO_BetSize\",1,\"\",true,false,793620241583571,false,79],[1,\"BO_BetLevel\",1,\"\",true,false,738360625044045,false,80],[1,\"BO_Line\",1,\"\",true,false,806673510456197,false,81],[1,\"BO_BetAmount\",1,\"\",true,false,561255076312452,false,82],[0,0,false,null,312826259045331,161,[[3,36,null,0,false,true,false,741320181802642,null,[[1,[14]],[3,0]]]],[],[[0,0,false,null,689390712631523,162,[[3,75,null,0,false,false,true,758477977065219,null,[[3,1],[10,0]]]],[[-1,37,null,960418836148658,0,null,[[11,793620241583571],[7,[4,[1,3,39,true]]]]]]]]],[0,0,false,null,115371102832860,163,[[2,36,null,0,false,true,false,586413856851660,null,[[1,[14]],[3,0]]]],[],[[0,0,false,null,882978796953452,164,[[2,75,null,0,false,false,true,274583987953332,null,[[3,1],[10,0]]]],[[-1,37,null,851104889843119,0,null,[[11,738360625044045],[7,[4,[1,2,39,true]]]]]]]]],[0,0,false,null,388719319738240,165,[[5,36,null,0,false,true,false,792672489416317,null,[[1,[14]],[3,0]]]],[],[[0,0,false,null,287513527553842,166,[[5,75,null,0,false,false,true,291981740275709,null,[[3,1],[10,0]]]],[[-1,37,null,218292066209384,0,null,[[11,806673510456197],[7,[4,[1,5,39,true]]]]]]]]],[0,0,false,null,406346165376604,167,[[1,36,null,0,false,true,false,525995353513420,null,[[1,[14]],[3,0]]]],[],[[0,0,false,null,623655704228315,168,[[1,75,null,0,false,false,true,757561891524654,null,[[3,1],[10,0]]]],[[-1,37,null,995370275409933,0,null,[[11,561255076312452],[7,[4,[1,1,39,true]]]]]]]]],[0,0,false,null,464316112627794,169,[],[[-1,20,null,811176828666281,4096,null],[-3,76,[false,false,1]]]]]],[0,0,false,null,901553874970691,170,[[16,58,null,1,false,false,false,604879072873109,null,[[4,10],[3,0]]]],[[-2,\"maxBet\",null,580491924153808,0,null]]],[0,0,false,null,757642492497940,171,[[16,58,null,1,false,false,false,467202552651325,null,[[4,6],[3,0]]]],[[25,57,\"Tween\",952441876921815,2048,null,[[1,[42]],[3,1],[0,[13]],[0,[6]],[18,15],[3,0],[3,0],[3,0],[0,[6]]]],[14,57,\"Tween\",985104114279995,2048,null,[[1,[10]],[3,5],[0,[13]],[0,[43]],[18,0],[3,0],[3,0],[3,0],[0,[6]]]],[22,57,\"Tween\",896126761911027,2048,null,[[1,[10]],[3,5],[0,[13]],[0,[30]],[18,0],[3,0],[3,0],[3,0],[0,[6]]]],[-3,77,[false,false,3]]]],[4,[\"BOScrollBack\",0,[[1,\"BO_Bet_Size1\",1,\"\",false,false,593392905797278,false,92],[1,\"BO_Bet_Level1\",1,\"\",false,false,352712037835679,false,93],[1,\"BO_Bet_Line1\",1,\"\",false,false,905729653124065,false,94],[1,\"BO_Bet_Amount1\",1,\"\",false,false,993324576633111,false,95],[1,\"BO_Bet_Credit1\",1,\"\",false,false,356737754203680,false,96],[1,\"BO_Bet_Amount2\",1,\"\",false,false,480292054773037,false,97],[1,\"BO_Win_Amount1\",1,\"\",false,false,295993434182556,false,98]],true,false,false],false,null,692317455858476,172,[[-1,45,null,0,false,true,false,786539436180051,null,[[11,958449875396847]]]],[[-1,46,null,639650726796445,0,null,[[11,958449875396847],[3,1]]],[25,57,\"Tween\",306221757860198,2048,null,[[1,[44]],[3,1],[0,[45]],[0,[6]],[18,15],[3,0],[3,0],[3,0],[0,[6]]]],[14,57,\"Tween\",412316719485525,2048,null,[[1,[10]],[3,5],[0,[46]],[0,[43]],[18,0],[3,0],[3,0],[3,0],[0,[6]]]],[22,57,\"Tween\",641660899818592,2048,null,[[1,[10]],[3,5],[0,[47]],[0,[6]],[18,0],[3,0],[3,0],[3,0],[0,[6]]]],[18,8,null,242335968198614,0,null,[[7,[3,[3,356737754203680]]]]],[20,8,null,496364816232837,0,null,[[7,[3,[3,480292054773037]]]]],[21,8,null,834462597153315,0,null,[[7,[3,[3,295993434182556]]]]],[-2,\"Scroll Bet Option\",null,227475653931859,0,null,[[1,[3,[3,593392905797278]]],[1,[3,[3,352712037835679]]],[1,[3,[3,905729653124065]]],[1,[3,[3,993324576633111]]]]],[-1,20,null,602105477210182,4096,null],[-1,46,null,397920638921566,0,null,[[11,958449875396847],[3,0]]]]],[0,0,false,null,557740064924116,173,[[16,58,null,1,false,false,false,594617050076484,null,[[4,4],[3,0]]]],[],[[1,\"BO_betsize\",1,\"\",false,false,899456817797127,false,99],[1,\"BO_betlevel\",1,\"\",false,false,485441625395853,false,100],[1,\"BO_line\",1,\"\",false,false,301980377336674,false,101],[1,\"BO_betamount\",1,\"\",false,false,485223143962118,false,102],[0,0,false,null,213879008757656,174,[[3,63,null,0,false,false,true,160324443083737,null,[[3,0],[0,[4,[1,3,32,false]]],[0,[3,[3,946831665396307]]]]]],[[-1,37,null,289366704497914,0,null,[[11,899456817797127],[7,[16,[4,38],[1,3,39,true]]]]]]],[0,0,false,null,472873035971968,175,[[2,63,null,0,false,false,true,615106701643147,null,[[3,0],[0,[4,[1,2,32,false]]],[0,[3,[3,946831665396307]]]]]],[[-1,37,null,291231044958771,0,null,[[11,485441625395853],[7,[16,[4,38],[1,2,39,true]]]]]]],[0,0,false,null,155747382717806,176,[[5,63,null,0,false,false,true,728679030402163,null,[[3,0],[0,[4,[1,5,32,false]]],[0,[3,[3,946831665396307]]]]]],[[-1,37,null,813662816529106,0,null,[[11,301980377336674],[7,[16,[4,38],[1,5,39,true]]]]]]],[0,0,false,null,574676654707889,177,[[1,63,null,0,false,false,true,350326284125991,null,[[3,0],[0,[4,[1,1,32,false]]],[0,[3,[3,946831665396307]]]]]],[[-1,37,null,189394934090018,0,null,[[11,485223143962118],[7,[16,[4,38],[1,1,39,true]]]]]]],[0,0,false,null,490465654020871,178,[],[[-1,20,null,477826920475912,4096,null],[-3,78,[false,false,1]]]],[0,0,false,null,613589723638045,179,[],[[25,57,\"Tween\",318443290359681,2048,null,[[1,[42]],[3,1],[0,[13]],[0,[6]],[18,15],[3,0],[3,0],[3,0],[0,[6]]]],[14,57,\"Tween\",748253164649155,2048,null,[[1,[10]],[3,5],[0,[13]],[0,[43]],[18,0],[3,0],[3,0],[3,0],[0,[6]]]],[22,57,\"Tween\",925300529370609,2048,null,[[1,[10]],[3,5],[0,[13]],[0,[30]],[18,0],[3,0],[3,0],[3,0],[0,[6]]]]]]]],[1,\"BOsent\",2,false,true,false,958449875396847,false,103],[4,[\"addBO\",0,[[1,\"BO_BetAmount\",1,\"\",false,false,299267237635419,false,82],[1,\"BO_Style\",1,\"\",false,false,443143843284146,false,104]],true,false,false],false,null,804520690685091,181,[[-1,45,null,0,false,true,false,499828123799236,null,[[11,958449875396847]]]],[[-1,46,null,832684463013662,0,null,[[11,958449875396847],[3,1]]]],[[0,0,false,null,259018579694040,182,[[-1,52,null,0,false,false,false,687304704299860,null,[[11,443143843284146],[8,0],[7,[23]]]]],[[-3,79,[false,false,0]]]],[0,0,false,null,473224991853550,183,[[-1,52,null,0,false,false,false,249745636015097,null,[[11,443143843284146],[8,0],[7,[24]]]]],[[-3,80,[false,false,0]]]],[0,0,false,null,182474271053373,184,[],[[-1,20,null,490050746193164,4096,null],[-3,81,[false,false,1]],[-1,20,null,814237392441493,4096,null],[-1,46,null,201452593067269,0,null,[[11,958449875396847],[3,0]]]]]]],[4,[\"subBO\",0,[[1,\"BO_BetAmount\",1,\"\",false,false,274255952905093,false,82],[1,\"BO_Style\",1,\"\",false,false,251556190701686,false,104]],true,false,false],false,null,986271071053239,185,[[-1,45,null,0,false,true,false,981504444337236,null,[[11,958449875396847]]]],[[-1,46,null,138224914470286,0,null,[[11,958449875396847],[3,1]]]],[[0,0,false,null,198227976736654,186,[[-1,52,null,0,false,false,false,173551013898731,null,[[11,251556190701686],[8,0],[7,[23]]]]],[[-3,82,[false,false,0]]]],[0,0,false,null,969325124138561,187,[[-1,52,null,0,false,false,false,415606819152951,null,[[11,251556190701686],[8,0],[7,[24]]]]],[[-3,83,[false,false,0]]]],[0,0,false,null,531991743307433,188,[],[[-1,20,null,833358825777672,4096,null],[-3,84,[false,false,1]],[-1,46,null,468742474107290,0,null,[[11,958449875396847],[3,0]]]]]]]]]]]],[],\"media/\",false,758,1346,4,false,\"trilinear\",false,\"1.0.3.4\",false,false,3,1,44,false,true,1,true,0.7853981633974483,[],\"icons/\",[],\"normalized\",\"kdbumv6pbqi\",\"fonts/\",[[\"Timeline 1\",5,0.1,\"default\",\"default\",[],0,0,1,\"\",1,1]],\"high-performance\",[],null,\"vsync\",\"com.slotgen.betoption\",\"icons/loading-logo.png\",false,4,false,null,[],\"folders\",1,10000,false,[]]}"
	},
	"images/shared-0-sheet1.webp": "data:image/webp;base64,UklGRowFAABXRUJQVlA4TH8FAAAvf8AfEM8hkE2+/J3TmH+BQJLD/qw7bNtGkrb/dv+zfVLg+AIIMIAfChA8AAF4UYCguCGGQFwoXoghKApxQpwQoAgAeAGKQAR/FMMQgME2jkAgOX/vGSIiGwRFZdurxtb3oRyQVpRFJDXF0iBFJFOK4si6/0tLjDVj93lDRP8nQLKybUFgfZ/gQgQFESRiIhCJcBFCSPd/a5bNnGP7iP5PAP4S7sqUu6dld2A1A60Pq2Ow3VGVrjiA8qhSxwVTd92xttKjovMLO9ckGdps9L1t79rMYdTfB2OaIuJqVDQmAMbldfj2mbqrd83AdMHNhd7Pjsvr8O0Cpu5y5sZgTMG3FiYEOy6vw7dlf9U/YJR8uxzDsOPyOjiALg3tmdOdS23GeR6NlrmL+TMYOy1vAwBMwzAMtzQYk9GORA/vXkQWMxOSfR6wegmlT2hXBptNZTHpA2PcrZSh/Mx9mE5AV5YpPxZvwMDVz1QDUzAmY5CZCewX8B2MYqDqT0jFHymPRKxIpSTJQqmG5EkpFRVKqYxCqYpkpZRK1toj0SsPYIlIDSAjW+BFCaDgAxgTUgHIVqLxSF4rDYCCfAEQZA9oH7RbKhwJclcBoGEGAC2jGZBey2mD3iu+TdMtDke4ohnQFFbPAkDhBeOXzHvdAOAWjnaxB15srTlqgDnyg/QS2GuypnBeKy2AzFg4aaDnhvHu8zgY5C4BQCzADMgRUFuweGTLblfrGpBwZQB6YNTAA0DltcDtarBbfJ2ma7wl3UOTkczIF+yHhDPxGu9rmYxovNL3eHr92uNFCjSkdjSF40m/bFxpIE7wLoOJh50aKFI6qmix7hsoVxSaDddQ4hv21GRrnawlobHkFvZrLY3XlO53Pp/Lyxd2FaS2ohmAIe/WadNpWdFsvHDbLcic7C32AO6kADByE9uVntnihVv8414kjaNSShVkppSSVqGUyiiUakgmSqmECoZ8+OGrjn+YJjk6glQYSbEBmLrLOX5PHYYguYS0kMm8xZ66yznedgsjJzmHNJPU77Cn7nKOvdIpiBdJPmGyMDKDJ8nqXfbUXc6xK+4QpLYkApYko3EHe+ou5zStvxCmsCITjolIst0p8MqiCEfQlkfi2ye0K7PNVLSTHkdvMouR6P16EdHODI7/mVskc6nNOM+j0TKnO3/iE47S9U454kOa4j2FwQfVxbZC48OapojWoqIx+MSz0fe2vWsz4/9Ua16D1UpKpW1Yc/2YK3nJl9Kn6zvqoviraqkfERWfXdr35B5IFb+gevYGAAgdpK/DK4ades5NXpx4oimDq4bPekPnYZ9o6tg8n+0JACXFDABXeKIf2s7OAwCiJGkKcO3yifvIXIdEO7HVs5PsdQMr7BSlQQqav1jGtfXQXQ2AM03mzTautYtmv2vLLLvWcc19pAqx3AGH7pk/o1V+LQ22z1E2zIKt2JrzaxIAzDdMzfE16gSAvPgw7QBwua+hzugujp9D4bd6V/cg+UHt1Ex8PTar+0IT+rQdnTp9l1nWdTFd/lSj44pkOl6bhJXDkwewO/Ebwu3AIcdHVQCUGLToETrEAqAofgBVwu2Zt7j+/Kxxyyduk+InkKE070vg/dhUQxHyuxwEWzW0lbRR8lZN8bjuriNOircyWnL9T36/ecNGiiObm1Yqba1Wks8mH4LcxlVIOiDZh9c2AY5kGRccyRlADvqdDhnATNJhYDtJThcAlDQ5o5UQShs3pQIA10SS+8jgSdIe6LwudB6WJD2GVg1JylCeekuQJGnq2FAMW+Hi2XdGJ9iagsGh+oak0H6Jad9TXLwWvPcVwwOiuvlVFfE/B4S6qN9RS8VHAFfy8o306cJ/HhaAmtdgtZJSaRvWXPH/Bzfg//7471sA",
	"images/botouch-sheet0.webp": "data:image/webp;base64,UklGRiQAAABXRUJQVlA4TBgAAAAv+UA+AAdQiHL2q/8BAEX6/58i+p/6/2c=",
	"images/bo_bet_bg-lsheet0.avif": "data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAC8AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAvUAAADeAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQEMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAADdtZGF0EgAKChhl703WSBAQNCAyHxIAAAAQEAHFeCR9LlyUj2OXbyRbsWnmpZVSgONt5PA=",
	"images/bo_bet_bg2-lsheet0.avif": "data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAC8AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAvUAAADeAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQEMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAADdtZGF0EgAKChhl703WSBAQNCAyHxIAAAAQEAHFeCR9LlyUj2OXbyRbsWnmpZVSgONt5PA=",
	"images/shared-0-sheet0.webp": "data:image/webp;base64,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haBql6SyFN7AOP1f3bwxR5qLTVo9MMDCNcM2LMLil2QUC9SZRYP3GD7hIr37Ej9pO7O3MHXVYQiW1ye8uI90Z9dsAv5V9NH4OxjrQ3vmf2V7N8uEko5ox165QZavU5oTLlhWcdCmlO2XwYVQjs416w4jvlbmbnAeuIq+BKNZw4lMKdSvznznTZRXE05Pl/Er/IhLXFWeMYtu12UW/xRjjc/NGcU/te3RiXz947ko1aidUqQeX+u660p09/+fEc6bXDG0TVqxjxiC5sbeUL4VyzdeT52M4liy6JJGPLFaOBFI7Ut8br07vnl3A4WU3EWBJm39e0x/1/Ov8skacM9B6R1/t1nTt3b1QaTx70kY7z/d3/9xe9jcw+7/0R727+HQHo7s4fgeTu3hzB7O7eHiHi7t4eoeru/h1h7u7OHuHh7s4eEeHu/h2R5e7OHVHt7s4f0ePuzh0x6+7OHbHn7s4dce/lQ2ld3/XjmqHFdOKmeVi8pl5bpy8z9U7v//yuN/W3mpvFbeKu+Vj/++8lX5/t8qP5Xfyl/lv7L+1/THASPif/vf/p///L/7R//o//0v/sE/+N//v//2//g//t7f+8H//z+4//E/+6//L/fw/1/4V/5z/8d/xx7+/b/+q3v4+e/fw9f/wP/6P7iHd//lH/+VPTzfw9P/xX9tD/f+G39/Dzf2cG0PV/6dB/4d+HPg14Ef/6H//4Hv//n/93/hv3Lg24EvBz4eeHfg9YGXB54deHzgwYG7B24fuHHgyoFLB84dOH3gxIGjBw4d2H9gz7/7s//6/X//P/8//z//P/8//z//P/8//z//P/8//z//P/8//z//P/8//z//P/8//z//P/8//z//P/8//z//P/8//z//P/8//z//P/8//z//P/8//z//P/8//z//P/8//z//P/8//z//P/8//z//P/8//z//P/8//z//P/8//z//P/8//z//P/8/IAIA",
	"images/shared-0-lsheet0.avif": "data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAAGNbWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAsaWxvYwAAAABEAAACAAEAAAABAAAEwgAAAQ0AAgAAAAEAAAG1AAADDQAAAEJpaW5mAAAAAAACAAAAGmluZmUCAAAAAAEAAGF2MDFDb2xvcgAAAAAaaW5mZQIAAAAAAgAAYXYwMUFscGhhAAAAABppcmVmAAAAAAAAAA5hdXhsAAIAAQABAAAAw2lwcnAAAACdaXBjbwAAABRpc3BlAAAAAAAAAQAAAAIAAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAOcGl4aQAAAAABCAAAAAxhdjFDgQAcAAAAADhhdXhDAAAAAHVybjptcGVnOm1wZWdCOmNpY3A6c3lzdGVtczphdXhpbGlhcnk6YWxwaGEAAAAAHmlwbWEAAAAAAAAAAgABBAECgwQAAgQBBYYHAAAEIm1kYXQSAAoGGB4//+yqMoAGRIADDBfAcXfHb+JS1iaeB9Fievafv8eu/2kd3bvUug35d2u4Ghm/+OEJln+GIckFgxvRScQNck9NiFM9tGeN3L4NzsK7p4ac6fTI5pbr3CE0IdsSty8UVCUODN+ERrGyDDlRjYB6x0czzqfjw6qbWi/Ifmr27BqK1b8MiVxANC5Uzr0tTzADVXIXMwlCSti+sYzubRMtno8qPb7qocDJ0H1UNDwyblUefMOzsJZ4eC0U9QJb6KCONy+ICvVj+BQUIZdvlESmL5XLkyKmEMF6jM9W//vb2fJt9LVkiVw3n8iLYEgNko5DEFFqZqKjXQwnocSCFHrgkBlaLZ8wSwusaePDAimBImd2T1pH8y4QbHqQxVfIT56KDDqrnq8EanDQN2sPnruKtBb6YKH2yXdXfeCM6bFH9n/tl9Df0RIcjpv1f+YyaRDe8l14MZt5jT/cgOJQ8pFZssS1ibjXj7fNU/Mm8IkxPvzoQIggr7fvIXd4uS+X1XOJ1RjUa2ye+oxLlXH4xgUSFqpgILAM6+lMeaOMzHHFxToBBDUBuuCDSk1Wt4tp2PB7iAnkB2jJY5MuZOO0/3/umXkL0X+Yn7yG2+su5PcJm9ACsOTiNUdvz9x1deYS3eNv3fb8ejEhxGI39qjA1feIt5Gv5WeSKeICFNrHtf1UHr9M85oh5X//4fhs9TBGJHg8NnKRSu1Fh9zYW7YZVDiQyG2ikhSAq27wZ092iBYgcbWnrj1NBmU3pdPciqWJ/3DMPSTE24YSBLEt7ANOLutbWBJ/mnumRdU74deMMEFDQylHGNwPUmKeY/Ycm5tNjIY8RD0y7A26+87rpaYAc6dLypH4hvG0cN9xlA1yL0iclEr//PDNsMil5ag0WtAfhuoxeQEdhErazKW7TnwM7b718U2sKsLogIbXW+rfNTMLGNFWKHfSrsZJN+kfIMYEl2o/iuPxtW6LY6sjiup6skLvAE7NvGQf8jLHSv7RHnlUp4ES2yybjM8oOqYVYoxEKtStzFl4mZH7kMTMEgAKChgeP//skCAgaEAy/AFEgAAABATRUZrIpguidNymDZRqA8282xsj8BehpeindNf6WFfJzQXGrTmf///oi93C8Vxom9Er04GIDKujgb5xtCYQHHoQF9lT3hnedUDV9P26N4IjkvSMZttPmyO7M0ujw3441p9qhP+Bqa3JNyo0qKhFnqEq+Si3ZsPVJA9xnBUBwIGxrtKb3RWAY4MEfwlsOHUHJhSsS9OPz8g3FxOAIa+0PVCL50OjKmzvBV1ovCaUSeMxXo/+Pa5faaPowVHOgVbSEhjUkq2cT62i4pwxso0psueZbrkeMXhEHeNgoJLx7Tm7AXJQUOb4xsnX4gGN/NCYZPXc6hoIDGA="
};
</script>
<script>
"use strict";!function(){let t=!0;t&&(window["C3_ModernJSSupport_OK"]=!0)}();
</script>
<script>
"use strict";!function(){var e,t,r,n,o=!!document.querySelector('script[src*="kaspersky"]'),s=[];document.createElement("canvas").getContext("webgl")||s.push("WebGL"),"undefined"==typeof WebAssembly&&s.push("WebAssembly"),"noModule"in HTMLScriptElement.prototype||s.push("JavaScript Modules"),window["Intl"]&&window["Intl"]["Segmenter"]||s.push("Internationalization support (Intl.Segmenter)"),window["C3_ModernJSSupport_OK"]||s.push("Modern JavaScript support"),0!==s.length||o?((e=document.createElement("div")).id="notSupportedWrap",document.body.appendChild(e),(t=document.createElement("h2")).id="notSupportedTitle",t.textContent=o?"Kaspersky Internet Security broke this export":"Software update needed",e.appendChild(t),(t=document.createElement("p")).className="notSupportedMessage",r="This content is not supported because your device's software appears to be out-of-date. ",n=navigator.userAgent,/android/i.test(n)?r+='<br><br>On Android, fix this by making sure the <a href="https://play.google.com/store/apps/details?id=com.google.android.webview">Android System Webview</a> app has updates enabled and is up-to-date.':/iphone|ipad|ipod/i.test(n)?r+="Alternatively if <strong>Lockdown mode</strong> is enabled, try turning it off to view this content.":/msie/i.test(n)||/trident/i.test(n)||/edge\//i.test(n)?r+="<br><br>Note: <strong>Internet Explorer</strong> and the <strong>legacy Edge browser</strong> are not supported. Try using <a href='https://www.google.com/chrome'>Chrome</a> or <a href='https://www.mozilla.org/firefox'>Firefox</a> instead.":o?r="It appears a script was added to this export by Kaspersky software. This prevents the exported project from working. Try disabling Kaspersky and exporting again.":r+="Try installing any available software updates. Alternatively try on a different device.",r+="<br><br><em>Missing features: "+s.join(", ")+"<br>User agent: "+navigator.userAgent+"</em>",t.innerHTML=r,e.appendChild(t),document.addEventListener("deviceready",()=>{navigator["splashscreen"]&&navigator["splashscreen"]["hide"]&&navigator["splashscreen"]["hide"]()})):window["C3_Is_Supported"]=!0}();
</script>
<script>
// Generated by Construct, the game and animation creation tool
// Visit: https://www.construct.net

"use strict";window.DOMHandler=class{constructor(e,t){this._iRuntime=e,this._componentId=t,this._hasTickCallback=!1,this._tickCallback=()=>this.Tick()}Attach(){}PostToRuntime(e,t,n,i){this._iRuntime.PostToRuntimeComponent(this._componentId,e,t,n,i)}PostToRuntimeAsync(e,t,n,i){return this._iRuntime.PostToRuntimeComponentAsync(this._componentId,e,t,n,i)}_PostToRuntimeMaybeSync(e,t,n){this._iRuntime.UsesWorker()?this.PostToRuntime(e,t,n):this._iRuntime._GetLocalRuntime()._OnMessageFromDOM({type:"event",component:this._componentId,handler:e,dispatchOpts:n||null,data:t,responseId:null})}AddRuntimeMessageHandler(e,t){this._iRuntime.AddRuntimeComponentMessageHandler(this._componentId,e,t)}AddRuntimeMessageHandlers(e){for(const[t,n]of e)this.AddRuntimeMessageHandler(t,n)}GetRuntimeInterface(){return this._iRuntime}GetComponentID(){return this._componentId}_StartTicking(){this._hasTickCallback||(this._iRuntime._AddRAFCallback(this._tickCallback),this._hasTickCallback=!0)}_StopTicking(){this._hasTickCallback&&(this._iRuntime._RemoveRAFCallback(this._tickCallback),this._hasTickCallback=!1)}Tick(){}},window.RateLimiter=class{constructor(e,t){this._callback=e,this._interval=t,this._timerId=-1,this._lastCallTime=-1/0,this._timerCallFunc=()=>this._OnTimer(),this._ignoreReset=!1,this._canRunImmediate=!1}SetCanRunImmediate(e){this._canRunImmediate=!!e}Call(){if(-1===this._timerId){const e=Date.now(),t=e-this._lastCallTime,n=this._interval;n<=t&&this._canRunImmediate?(this._lastCallTime=e,this._RunCallback()):this._timerId=self.setTimeout(this._timerCallFunc,Math.max(n-t,4))}}_RunCallback(){this._ignoreReset=!0,this._callback(),this._ignoreReset=!1}Reset(){this._ignoreReset||(this._CancelTimer(),this._lastCallTime=Date.now())}_OnTimer(){this._timerId=-1,this._lastCallTime=Date.now(),this._RunCallback()}_CancelTimer(){-1!==this._timerId&&(self.clearTimeout(this._timerId),this._timerId=-1)}Release(){this._CancelTimer(),this._callback=null,this._timerCallFunc=null}};{class y{constructor(e){this._elem=e,this._hadFirstUpdate=!1,this._isVisibleFlag=!0,this._wantHtmlIndex=-1,this._actualHtmlIndex=-1,this._htmlZIndex=-1}SetVisibleFlag(e){this._isVisibleFlag=!!e}GetVisibleFlag(){return this._isVisibleFlag}HadFirstUpdate(){return this._hadFirstUpdate}SetHadFirstUpdate(){this._hadFirstUpdate=!0}GetWantHTMLIndex(){return this._wantHtmlIndex}SetWantHTMLIndex(e){this._wantHtmlIndex=e}GetActualHTMLIndex(){return this._actualHtmlIndex}SetActualHTMLIndex(e){this._actualHtmlIndex=e}SetHTMLZIndex(e){this._htmlZIndex=e}GetHTMLZIndex(){return this._htmlZIndex}GetElement(){return this._elem}}window.DOMElementHandler=class extends self.DOMHandler{constructor(e,t){super(e,t),this._elementMap=new Map,this._autoAttach=!0,this.AddRuntimeMessageHandlers([["create",e=>this._OnCreate(e)],["destroy",e=>this._OnDestroy(e)],["set-visible",e=>this._OnSetVisible(e)],["update-position",e=>this._OnUpdatePosition(e)],["update-state",e=>this._OnUpdateState(e)],["focus",e=>this._OnSetFocus(e)],["set-css-style",e=>this._OnSetCssStyle(e)],["set-attribute",e=>this._OnSetAttribute(e)],["remove-attribute",e=>this._OnRemoveAttribute(e)]]),this.AddDOMElementMessageHandler("get-element",e=>e)}SetAutoAttach(e){this._autoAttach=!!e}AddDOMElementMessageHandler(e,i){this.AddRuntimeMessageHandler(e,e=>{const t=e.elementId,n=this.GetElementById(t);return i(n,e)})}AddDOMElementMessageHandlers(e){for(const[t,n]of e)this.AddDOMElementMessageHandler(t,n)}_OnCreate(e){const t=e.elementId,n=this.CreateElement(t,e),i=new y(n),s=(this._elementMap.set(t,i),n.style.boxSizing="border-box",n.style.display="none",i.SetVisibleFlag(e.isVisible),this._GetFocusElement(n)),r=(s.addEventListener("focus",e=>this._OnFocus(t)),s.addEventListener("blur",e=>this._OnBlur(t)),e.htmlIndex);if(i.SetWantHTMLIndex(r),i.SetHTMLZIndex(e.htmlZIndex),this._autoAttach){const o=this.GetRuntimeInterface().GetAvailableHTMLIndex(r),a=(i.SetActualHTMLIndex(o),this.GetRuntimeInterface().GetHTMLWrapElement(o));a.appendChild(n)}}CreateElement(e,t){throw new Error("required override")}DestroyElement(e){}_OnDestroy(e){const t=e.elementId,n=this.GetElementById(t);this.DestroyElement(n),this._autoAttach&&n.parentElement.removeChild(n),this._elementMap.delete(t)}PostToRuntimeElement(e,t,n){(n=n||{}).elementId=t,this.PostToRuntime(e,n)}_PostToRuntimeElementMaybeSync(e,t,n){(n=n||{}).elementId=t,this._PostToRuntimeMaybeSync(e,n)}_OnSetVisible(e){if(this._autoAttach){const t=this._elementMap.get(e.elementId),n=t.GetElement();t.HadFirstUpdate()?n.style.display=e.isVisible?"":"none":t.SetVisibleFlag(e.isVisible)}}_OnUpdatePosition(e){if(this._autoAttach){const t=this._elementMap.get(e.elementId),n=t.GetElement(),i=this.GetRuntimeInterface(),s=(n.style.left=e.left+"px",n.style.top=e.top+"px",n.style.width=e.width+"px",n.style.height=e.height+"px",e.fontSize),r=(null!==s&&(n.style.fontSize=s+"em"),e.htmlIndex),o=(t.SetWantHTMLIndex(r),i.GetAvailableHTMLIndex(r));if(o!==t.GetActualHTMLIndex()){n.remove();const l=i.GetHTMLWrapElement(o);l.appendChild(n),t.SetActualHTMLIndex(o),i._UpdateHTMLElementsZOrder()}const a=e.htmlZIndex;a!==t.GetHTMLZIndex()&&(t.SetHTMLZIndex(a),i._UpdateHTMLElementsZOrder()),t.HadFirstUpdate()||(t.SetHadFirstUpdate(),t.GetVisibleFlag()&&(n.style.display=""))}}_OnHTMLLayersChanged(){if(this._autoAttach)for(const e of this._elementMap.values()){const t=this.GetRuntimeInterface().GetAvailableHTMLIndex(e.GetWantHTMLIndex()),n=e.GetActualHTMLIndex();if(-1!==t&&-1!==n&&t!==n){const i=e.GetElement(),s=(i.remove(),this.GetRuntimeInterface().GetHTMLWrapElement(t));s.appendChild(i),e.SetActualHTMLIndex(t)}}}_GetAllElementStatesForZOrderUpdate(){return this._autoAttach?[...this._elementMap.values()]:null}_OnUpdateState(e){const t=this.GetElementById(e.elementId);this.UpdateState(t,e)}UpdateState(e,t){throw new Error("required override")}_GetFocusElement(e){return e}_OnFocus(e){this.PostToRuntimeElement("elem-focused",e)}_OnBlur(e){this.PostToRuntimeElement("elem-blurred",e)}_OnSetFocus(e){const t=this._GetFocusElement(this.GetElementById(e.elementId));e.focus?t.focus():t.blur()}_OnSetCssStyle(e){const t=this.GetElementById(e.elementId),n=e.prop,i=e.val;n.startsWith("--")?t.style.setProperty(n,i):t.style[n]=i}_OnSetAttribute(e){const t=this.GetElementById(e.elementId);t.setAttribute(e.name,e.val)}_OnRemoveAttribute(e){const t=this.GetElementById(e.elementId);t.removeAttribute(e.name)}GetElementById(e){const t=this._elementMap.get(e);if(t)return t.GetElement();throw new Error("no element with id "+e)}}}{const b0=/(iphone|ipod|ipad|macos|macintosh|mac os x)/i.test(navigator.userAgent),c0=/android/i.test(navigator.userAgent),d0=/safari/i.test(navigator.userAgent)&&!/(chrome|chromium|edg\/|OPR\/|nwjs)/i.test(navigator.userAgent);let s=0;function AddScript(n){const i=document.createElement("script");return i.async=!1,i.type="module",n.isStringSrc?new Promise(e=>{const t="c3_resolve_"+s;++s,self[t]=e,i.textContent=n.str+`

self["${t}"]();`,document.head.appendChild(i)}):new Promise((e,t)=>{i.onload=e,i.onerror=t,i.src=n,document.head.appendChild(i)})}async function CheckSupportsWorkerMode(){if(!navigator.userActivation||"undefined"==typeof OffscreenCanvas)return!1;try{let e=!1;const t=new Blob([`
	self.addEventListener("message", () =>
	{
		try {
			const offscreenCanvas = new OffscreenCanvas(32, 32);
			const gl = offscreenCanvas.getContext("webgl");
			self.postMessage(!!gl);
		}
		catch (err)
		{
			console.warn("Feature detection worker error:", err);
			self.postMessage(false);
		}
	});`],{type:"text/javascript"}),n=new Worker(URL.createObjectURL(t),{get type(){e=!0}}),i=await new Promise(t=>{n.addEventListener("message",e=>{n.terminate(),t(e.data)}),n.postMessage("")});return e&&i}catch(e){return console.warn("Error feature detecting worker mode: ",e),!1}}let e=new Audio;const g0={"audio/webm; codecs=opus":!!e.canPlayType("audio/webm; codecs=opus"),"audio/ogg; codecs=opus":!!e.canPlayType("audio/ogg; codecs=opus"),"audio/webm; codecs=vorbis":!!e.canPlayType("audio/webm; codecs=vorbis"),"audio/ogg; codecs=vorbis":!!e.canPlayType("audio/ogg; codecs=vorbis"),"audio/mp4":!!e.canPlayType("audio/mp4"),"audio/mpeg":!!e.canPlayType("audio/mpeg")};async function BlobToString(e){const t=await BlobToArrayBuffer(e),n=new TextDecoder("utf-8");return n.decode(t)}function BlobToArrayBuffer(i){return new Promise((t,n)=>{const e=new FileReader;e.onload=e=>t(e.target.result),e.onerror=e=>n(e),e.readAsArrayBuffer(i)})}e=null;const h0=[];let i=0;const j0=8,k0=(window.RealFile=window.File,[]),l0=new Map,m0=new Map;let a=0;const o0=[],p0=(self.runOnStartup=function(e){if("function"!=typeof e)throw new Error("runOnStartup called without a function");o0.push(e)},new Set(["cordova","playable-ad-single-file","playable-ad-zip","instant-games"]));function IsWebViewExportType(e){return p0.has(e)}let t=!1;window.RuntimeInterface=class P0{constructor(e){if(this._useWorker=e.useWorker,this._messageChannelPort=null,this._runtimeBaseUrl="",this._scriptFolder=e.scriptFolder,this._worker=null,this._localRuntime=null,this._domHandlers=[],this._runtimeDomHandler=null,this._isFirstSizeUpdate=!0,this._canvasLayers=[],this._pendingRemoveElements=[],this._pendingUpdateHTMLZOrder=!1,this._updateHTMLZOrderRAFCallback=()=>this._DoUpdateHTMLElementsZOrder(),this._isExportingToVideo=!1,this._exportToVideoDuration=0,this._jobScheduler=null,this._rafId=-1,this._rafFunc=()=>this._OnRAFCallback(),this._rafCallbacks=new Set,this._wrapperInitResolve=null,this._wrapperComponentIds=[],this._exportType=e.exportType,this._isFileProtocol="file"===location.protocol.substr(0,4),this._directoryHandles=[],"playable-ad-single-file"!==this._exportType&&"playable-ad-zip"!==this._exportType&&"instant-games"!==this._exportType||(this._useWorker=!1),d0&&(this._useWorker=!1),"cordova"===this._exportType&&this._useWorker&&c0){const t=/Chrome\/(\d+)/i.exec(navigator.userAgent);t&&90<=parseInt(t[1],10)||(this._useWorker=!1)}this.IsAnyWebView2Wrapper()?self.chrome.webview.addEventListener("message",e=>this._OnWrapperMessage(e.data,e.additionalObjects)):"macos-wkwebview"===this._exportType?self.C3WrapperOnMessage=e=>this._OnWrapperMessage(e):"linux-cef"===this._exportType&&self.c3_linux_cef_set_message_callback(e=>this._OnWrapperMessage(JSON.parse(e))),this._localFileBlobs=null,this._localFileStrings=null,"html5"!==this._exportType||window.isSecureContext||console.warn("[Construct] Warning: the browser indicates this is not a secure context. Some features may be unavailable. Use secure (HTTPS) hosting to ensure all features are available."),this.AddRuntimeComponentMessageHandler("canvas","update-size",e=>this._OnUpdateCanvasSize(e)),this.AddRuntimeComponentMessageHandler("canvas","set-html-layer-count",e=>this._OnSetHTMLLayerCount(e)),this.AddRuntimeComponentMessageHandler("canvas","cleanup-html-layers",()=>this._OnCleanUpHTMLLayers()),this.AddRuntimeComponentMessageHandler("canvas","update-html-layer-dom-state",e=>this._UpdateHTMLLayerDOMProperties(e.layersDomState)),this.AddRuntimeComponentMessageHandler("runtime","cordova-fetch-local-file",e=>this._OnCordovaFetchLocalFile(e)),this.AddRuntimeComponentMessageHandler("runtime","create-job-worker",e=>this._OnCreateJobWorker(e)),this.AddRuntimeComponentMessageHandler("runtime","send-wrapper-extension-message",e=>this._OnSendWrapperExtensionMessage(e)),"cordova"===this._exportType?document.addEventListener("deviceready",()=>this._Init(e)):this._Init(e),this._skipAndroidVirtualKeyboardDetection=0}Release(){this._CancelAnimationFrame(),this._messageChannelPort&&(this._messageChannelPort.onmessage=null,this._messageChannelPort=null),this._worker&&(this._worker.terminate(),this._worker=null),this._localRuntime&&(this._localRuntime.Release(),this._localRuntime=null);for(const{canvas:e,htmlWrap:t}of this._canvasLayers)e.remove(),t.remove();this._canvasLayers.length=0}GetMainCanvas(){return this._canvasLayers[0].canvas}GetAvailableHTMLIndex(e){return Math.min(e,this._canvasLayers.length-1)}GetHTMLWrapElement(e){if(e<0||e>=this._canvasLayers.length)throw new RangeError("invalid canvas layer");return this._canvasLayers[e].htmlWrap}["_GetHTMLWrapElement"](e){return this.GetHTMLWrapElement(e)}GetRuntimeBaseURL(){return this._runtimeBaseUrl}UsesWorker(){return this._useWorker}GetExportType(){return this._exportType}IsFileProtocol(){return this._isFileProtocol}GetScriptFolder(){return this._scriptFolder}IsiOSCordova(){return b0&&"cordova"===this._exportType}IsiOSWebView(){const e=navigator.userAgent;return b0&&IsWebViewExportType(this._exportType)||navigator.standalone||/crios\/|fxios\/|edgios\//i.test(e)}IsAndroid(){return c0}IsAndroidWebView(){return c0&&IsWebViewExportType(this._exportType)}IsWindowsWebView2(){return"windows-webview2"===this._exportType||!!("preview"===this._exportType&&window.chrome&&window.chrome.webview&&window.chrome.webview.postMessage)}IsAnyWebView2Wrapper(){return this.IsWindowsWebView2()||"xbox-uwp-webview2"===this._exportType}SkipNextAndroidVirtualKeyboardDetection(){this.IsAndroidWebView()&&this._skipAndroidVirtualKeyboardDetection++}CanDoAndroidVirtualKeyboardDetection(){return this._CanDoAndroidVirtualKeyboardDetection().next().value}*_CanDoAndroidVirtualKeyboardDetection(){if(!this.IsAndroidWebView())return!0;yield 0===this._skipAndroidVirtualKeyboardDetection,0<this._skipAndroidVirtualKeyboardDetection&&this._skipAndroidVirtualKeyboardDetection--}async _Init(e){if(this._useWorker){const n=await CheckSupportsWorkerMode();n||(this._useWorker=!1)}if("macos-wkwebview"===this._exportType)this._SendWrapperMessage({type:"ready"});else if(this.IsAnyWebView2Wrapper()||"linux-cef"===this._exportType){this._SetupDesktopWrapperPolyfills();const i=await this._InitWrapper();this._wrapperComponentIds=i.registeredComponentIds}if("playable-ad-single-file"===this._exportType&&(this._localFileBlobs=self.c3_base64files,this._localFileStrings={},await this._ConvertDataUrisToBlobs()),"nwjs"===this._exportType&&self.nw){const s=self.nw.Window.get();if(s.on("close",()=>self.nw.App.quit()),self.nw.App.manifest["c3-steam-mode"]){let e=0;this._AddRAFCallback(()=>{e++,document.documentElement.style.opacity=e%2==0?"1":"0.999"})}}if(e.runtimeBaseUrl)this._runtimeBaseUrl=e.runtimeBaseUrl;else{const r=location.origin,o=(this._runtimeBaseUrl=("null"===r?"file:///":r)+location.pathname,this._runtimeBaseUrl.lastIndexOf("/"));-1!==o&&(this._runtimeBaseUrl=this._runtimeBaseUrl.substr(0,o+1))}const t=new MessageChannel;if(this._messageChannelPort=t.port1,this._messageChannelPort.onmessage=e=>this._OnMessageFromRuntime(e.data),window.c3_addPortMessageHandler&&window.c3_addPortMessageHandler(e=>this._OnMessageFromDebugger(e)),this._jobScheduler=new self.JobSchedulerDOM(this),await this._jobScheduler.Init(),"object"==typeof window.StatusBar&&window.StatusBar.hide(),"object"==typeof window.AndroidFullScreen)try{await new Promise((e,t)=>{window.AndroidFullScreen.immersiveMode(e,t)})}catch(e){console.error("Failed to enter Android immersive mode: ",e)}this._useWorker?await this._InitWorker(e,t.port2):await this._InitDOM(e,t.port2)}_GetCommonRuntimeOptions(e){return{runtimeBaseUrl:this._runtimeBaseUrl,previewUrl:location.href,windowInnerWidth:this._GetWindowInnerWidth(),windowInnerHeight:this._GetWindowInnerHeight(),cssDisplayMode:this.GetCssDisplayMode(),devicePixelRatio:window.devicePixelRatio,isFullscreen:P0.IsDocumentFullscreen(),swClientId:window.cr_swClientId||"",exportType:e.exportType,isNWjs:"undefined"!=typeof nw,fileMap:globalThis.c3_swFileMap??new Map(Object.entries(this._localFileBlobs??{})),scriptFolder:this._scriptFolder,isDebug:new URLSearchParams(self.location.search).has("debug"),ife:!!self.ife,jobScheduler:this._jobScheduler.GetPortData(),supportedAudioFormats:g0,isFileProtocol:this._isFileProtocol,isiOSCordova:this.IsiOSCordova(),isiOSWebView:this.IsiOSWebView(),isWindowsWebView2:this.IsWindowsWebView2(),isAnyWebView2Wrapper:this.IsAnyWebView2Wrapper(),wrapperComponentIds:this._wrapperComponentIds,isFBInstantAvailable:void 0!==self.FBInstant}}async _InitWorker(e,t){const s=e.workerMainUrl,n=("preview"===this._exportType?(this._worker=new Worker("previewworker.js",{type:"module",name:"Runtime"}),await new Promise((t,n)=>{const i=e=>{this._worker.removeEventListener("message",i),(e.data&&"ok"===e.data.type?t:n)()};this._worker.addEventListener("message",i),this._worker.postMessage({type:"construct-worker-init",import:new URL(s,this._runtimeBaseUrl).toString()})})):this._worker=await this.CreateWorker(s,{type:"module",name:"Runtime"}),document.createElement("canvas")),i=(n.style.display="none",n.transferControlToOffscreen()),r=(document.body.appendChild(n),document.createElement("div"));r.className="c3htmlwrap",r.setAttribute("interactive",""),document.body.appendChild(r),this._canvasLayers.push({canvas:n,htmlWrap:r,lastHtmlLayerDomState:{isVisible:!0,opacity:1,isInteractive:!0}}),window.c3canvas=n,self.C3_InsertHTMLPlaceholders&&self.C3_InsertHTMLPlaceholders(),this._worker.postMessage(Object.assign(this._GetCommonRuntimeOptions(e),{type:"init-runtime",isInWorker:!0,messagePort:t,canvas:i,runtimeScriptList:e.runtimeScriptList,projectMainScriptPath:e.projectMainScriptPath,scriptsInEventsPath:e.scriptsInEventsPath}),[t,i,...this._jobScheduler.GetPortTransferables()]),this._domHandlers=k0.map(e=>new e(this)),this._FindRuntimeDOMHandler(),this._runtimeDomHandler._AddDefaultCanvasEventHandlers(n),this._runtimeDomHandler._AddDefaultHTMLWrapEventHandlers(r),this._runtimeDomHandler._EnableWindowResizeEvent(),self.c3_callFunction=(e,t)=>this._runtimeDomHandler._InvokeFunctionFromJS(e,t),"preview"===this._exportType&&(self.goToLastErrorScript=()=>this.PostToRuntimeComponent("runtime","go-to-last-error-script"))}async _InitDOM(e,t){const n=document.createElement("canvas"),i=(n.style.display="none",document.body.appendChild(n),document.createElement("div")),s=(i.className="c3htmlwrap",i.setAttribute("interactive",""),document.body.appendChild(i),this._canvasLayers.push({canvas:n,htmlWrap:i,lastHtmlLayerDomState:{isVisible:!0,opacity:1,isInteractive:!0}}),window.c3canvas=n,self.C3_InsertHTMLPlaceholders&&self.C3_InsertHTMLPlaceholders(),this._domHandlers=k0.map(e=>new e(this)),this._FindRuntimeDOMHandler(),this._runtimeDomHandler._AddDefaultCanvasEventHandlers(n),this._runtimeDomHandler._AddDefaultHTMLWrapEventHandlers(i),await Promise.all(e.runtimeScriptList.map(e=>this._MaybeGetPlatformSpecificScriptURL(e)))),r=(await Promise.all(s.map(e=>AddScript(e))),e.projectMainScriptPath),o=e.scriptsInEventsPath;if(r)try{if(await AddScript(r),"preview"===this._exportType&&!globalThis.C3_ProjectMainScriptOK)throw new Error("main script did not run to completion")}catch(e){this._RemoveLoadingMessage(),console.error("Error loading project main script: ",e),alert(`Failed to load the project main script (${r}). Check all your JavaScript code has valid syntax, all imports are written correctly, and that an exception was not thrown running the script. Press F12 and check the console for error details.`)}if(o)try{if(await AddScript(o),"preview"===this._exportType&&!globalThis.C3.ScriptsInEvents)throw new Error("scripts in events did not run to completion")}catch(e){this._RemoveLoadingMessage(),console.error("Error loading scripts in events: ",e),alert("Failed to load scripts in events. Check all your JavaScript code has valid syntax, all imports are written correctly, and that an exception was not thrown running the 'Imports for events' script. Press F12 and check the console for error details.")}const a=Object.assign(this._GetCommonRuntimeOptions(e),{isInWorker:!1,messagePort:t,canvas:n,runOnStartupFunctions:o0});this._runtimeDomHandler._EnableWindowResizeEvent(),this._OnBeforeCreateRuntime(),this._localRuntime=self.C3_CreateRuntime(a),await self.C3_InitRuntime(this._localRuntime,a)}async CreateWorker(e,t){if(e.startsWith("blob:"))return new Worker(e,t);if("cordova"===this._exportType&&this._isFileProtocol){const s=await this.CordovaFetchLocalFileAsArrayBuffer(e),r=new Blob([s],{type:"application/javascript"});return new Worker(URL.createObjectURL(r),t)}if("playable-ad-single-file"===this._exportType){const o=this._localFileBlobs[e];if(o)return new Worker(URL.createObjectURL(o),t);throw new Error("missing script: "+e)}const n=new URL(e,location.href),i=location.origin!==n.origin;if(i){const a=await fetch(n);if(!a.ok)throw new Error("failed to fetch worker script");const l=await a.blob();return new Worker(URL.createObjectURL(l),t)}return new Worker(n,t)}_GetWindowInnerWidth(){return Math.max(window.innerWidth,1)}_GetWindowInnerHeight(){return Math.max(window.innerHeight,1)}GetCssDisplayMode(){if(this.IsAnyWebView2Wrapper())return"standalone";const e=this.GetExportType(),t=new Set(["cordova","nwjs","macos-wkwebview","linux-cef"]);return t.has(e)?"standalone":window.matchMedia("(display-mode: fullscreen)").matches?"fullscreen":window.matchMedia("(display-mode: standalone)").matches?"standalone":window.matchMedia("(display-mode: minimal-ui)").matches?"minimal-ui":navigator.standalone?"standalone":"browser"}_OnBeforeCreateRuntime(){this._RemoveLoadingMessage()}_RemoveLoadingMessage(){const e=window.cr_previewLoadingElem;e&&(e.parentElement.removeChild(e),window.cr_previewLoadingElem=null)}async _OnCreateJobWorker(e){const t=await this._jobScheduler._CreateJobWorker();return{outputPort:t,transferables:[t]}}_OnUpdateCanvasSize(e){if(!this.IsExportingToVideo()){const t=e.styleWidth+"px",n=e.styleHeight+"px",i=e.marginLeft+"px",s=e.marginTop+"px";for(const{canvas:r,htmlWrap:o}of this._canvasLayers)r.style.width=t,r.style.height=n,r.style.marginLeft=i,r.style.marginTop=s,o.style.width=t,o.style.height=n,o.style.marginLeft=i,o.style.marginTop=s,this._isFirstSizeUpdate&&(r.style.display="",o.style.display="");document.documentElement.style.setProperty("--construct-scale",e.displayScale),this._isFirstSizeUpdate=!1}}["_OnSetHTMLLayerCount"](e){const n=e.count,t=e.layersDomState,i=e.immediate,s=e.styleWidth+"px",r=e.styleHeight+"px",o=e.marginLeft+"px",a=e.marginTop+"px",l=[],d=[];if(n<this._canvasLayers.length)for(;this._canvasLayers.length>n;){const{canvas:c,htmlWrap:h}=this._canvasLayers.pop();h.remove(),this._useWorker&&!i?this._pendingRemoveElements.push(c):c.remove()}else if(n>this._canvasLayers.length)for(let e=0,t=n-this._canvasLayers.length;e<t;++e){const m=document.createElement("canvas");if(m.classList.add("c3overlay"),this._useWorker){const p=m.transferControlToOffscreen();l.push(p),d.push(p)}else l.push(m);document.body.appendChild(m);const u=document.createElement("div");u.classList.add("c3htmlwrap","c3overlay"),u.setAttribute("interactive",""),document.body.appendChild(u),m.style.width=s,m.style.height=r,m.style.marginLeft=o,m.style.marginTop=a,u.style.width=s,u.style.height=r,u.style.marginLeft=o,u.style.marginTop=a,this._runtimeDomHandler._AddDefaultCanvasEventHandlers(m),this._runtimeDomHandler._AddDefaultHTMLWrapEventHandlers(u),this._canvasLayers.push({canvas:m,htmlWrap:u,lastHtmlLayerDomState:{isVisible:!0,opacity:1,isInteractive:!0}})}this._UpdateHTMLLayerDOMProperties(t);for(const _ of this._domHandlers)_ instanceof window.DOMElementHandler&&_._OnHTMLLayersChanged();return this._UpdateHTMLElementsZOrder(),{addedCanvases:l,transferables:d}}_UpdateHTMLLayerDOMProperties(n){for(let e=0,t=Math.min(this._canvasLayers.length,n.length);e<t;++e){const{htmlWrap:i,lastHtmlLayerDomState:s}=this._canvasLayers[e],r=n[e],o=r.isVisible,a=r.opacity,l=r.isInteractive;o!==s.isVisible&&(i.style.display=o?"":"none",s.isVisible=o),a!==s.opacity&&(i.style.opacity=1===a?"":String(a),s.opacity=a),l!==s.isInteractive&&(i.style.pointerEvents=l?"":"none",l?i.setAttribute("interactive",""):i.removeAttribute("interactive"),s.isInteractive=l)}}_OnCleanUpHTMLLayers(){for(const e of this._pendingRemoveElements)e.remove();this._pendingRemoveElements.length=0}_UpdateHTMLElementsZOrder(){this._pendingUpdateHTMLZOrder||(this._pendingUpdateHTMLZOrder=!0,this._AddRAFCallback(this._updateHTMLZOrderRAFCallback))}_DoUpdateHTMLElementsZOrder(){this._RemoveRAFCallback(this._updateHTMLZOrderRAFCallback),this._pendingUpdateHTMLZOrder=!1;let e=[];for(const r of this._domHandlers)if(r instanceof window.DOMElementHandler){const o=r._GetAllElementStatesForZOrderUpdate();o&&e.push(...o)}e.sort((e,t)=>{const n=e.GetActualHTMLIndex(),i=t.GetActualHTMLIndex();if(n!==i)return n-i;const s=e.GetHTMLZIndex(),r=t.GetHTMLZIndex();return s-r});let t=0,n=0,i=0,s=e.length;for(;i<s;++i){const a=e[i];a.GetActualHTMLIndex()!==t&&(this._DoUpdateHTMLElementsZOrderOnHTMLLayer(t,e.slice(n,i)),t=a.GetActualHTMLIndex(),n=i)}n<i&&this._DoUpdateHTMLElementsZOrderOnHTMLLayer(t,e.slice(n,i))}_DoUpdateHTMLElementsZOrderOnHTMLLayer(e,t){if(!(t.length<=1||e>=this._canvasLayers.length)){const i=t.map(e=>e.GetElement()),n=new Set(i),s=this.GetHTMLWrapElement(e),r=Array.from(s.children).filter(e=>n.has(e));for(let e=0,t=0,n=i.length;e<n;++e){const o=i[e],a=r[t];o===a?++t:s.insertBefore(o,a)}}}_GetLocalRuntime(){if(this._useWorker)throw new Error("not available in worker mode");return this._localRuntime}PostToRuntimeComponent(e,t,n,i,s){this._messageChannelPort.postMessage({type:"event",component:e,handler:t,dispatchOpts:i||null,data:n,responseId:null},s)}PostToRuntimeComponentAsync(e,t,n,i,s){const r=a++,o=new Promise((e,t)=>{m0.set(r,{resolve:e,reject:t})});return this._messageChannelPort.postMessage({type:"event",component:e,handler:t,dispatchOpts:i||null,data:n,responseId:r},s),o}["_OnMessageFromRuntime"](e){const t=e.type;if("event"===t)return this._OnEventFromRuntime(e);if("result"===t)this._OnResultFromRuntime(e);else if("runtime-ready"===t)this._OnRuntimeReady();else if("alert-error"===t)this._RemoveLoadingMessage(),alert(e.message);else{if("creating-runtime"!==t)throw new Error(`unknown message '${t}'`);this._OnBeforeCreateRuntime()}}_OnEventFromRuntime(t){const n=t.component,i=t.handler,s=t.data,r=t.responseId,e=l0.get(n);if(e){const o=e.get(i);if(o){let e=null;try{e=o(s)}catch(t){return console.error(`Exception in '${n}' handler '${i}':`,t),void(null!==r&&this._PostResultToRuntime(r,!1,""+t))}if(null===r)return e;e&&e.then?e.then(e=>this._PostResultToRuntime(r,!0,e)).catch(e=>{console.error(`Rejection from '${n}' handler '${i}':`,e),this._PostResultToRuntime(r,!1,""+e)}):this._PostResultToRuntime(r,!0,e)}else console.warn(`[DOM] No handler '${i}' for component '${n}'`)}else console.warn(`[DOM] No event handlers for component '${n}'`)}_PostResultToRuntime(e,t,n){let i;n&&n.transferables&&(i=n.transferables),this._messageChannelPort.postMessage({type:"result",responseId:e,isOk:t,result:n},i)}_OnResultFromRuntime(e){const t=e.responseId,n=e.isOk,i=e.result,s=m0.get(t);n?s.resolve(i):s.reject(i),m0.delete(t)}AddRuntimeComponentMessageHandler(e,t,n){let i=l0.get(e);if(i||(i=new Map,l0.set(e,i)),i.has(t))throw new Error(`[DOM] Component '${e}' already has handler '${t}'`);i.set(t,n)}static AddDOMHandlerClass(e){if(k0.includes(e))throw new Error("DOM handler already added");k0.push(e)}_FindRuntimeDOMHandler(){for(const e of this._domHandlers)if("runtime"===e.GetComponentID())return void(this._runtimeDomHandler=e);throw new Error("cannot find runtime DOM handler")}_OnMessageFromDebugger(e){this.PostToRuntimeComponent("debugger","message",e)}_OnRuntimeReady(){for(const e of this._domHandlers)e.Attach()}static IsDocumentFullscreen(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||t)}static _SetWrapperIsFullscreenFlag(e){t=!!e}async GetRemotePreviewStatusInfo(){return this.PostToRuntimeComponentAsync("runtime","get-remote-preview-status-info")}_AddRAFCallback(e){this._rafCallbacks.add(e),this._RequestAnimationFrame()}_RemoveRAFCallback(e){this._rafCallbacks.delete(e),0===this._rafCallbacks.size&&this._CancelAnimationFrame()}_RequestAnimationFrame(){-1===this._rafId&&0<this._rafCallbacks.size&&(this._rafId=requestAnimationFrame(this._rafFunc))}_CancelAnimationFrame(){-1!==this._rafId&&(cancelAnimationFrame(this._rafId),this._rafId=-1)}_OnRAFCallback(){this._rafId=-1;for(const e of this._rafCallbacks)e();this._RequestAnimationFrame()}TryPlayMedia(e){this._runtimeDomHandler.TryPlayMedia(e)}RemovePendingPlay(e){this._runtimeDomHandler.RemovePendingPlay(e)}_PlayPendingMedia(){this._runtimeDomHandler._PlayPendingMedia()}SetSilent(e){this._runtimeDomHandler.SetSilent(e)}IsAudioFormatSupported(e){return!!g0[e]}async _WasmDecodeWebMOpus(e){const t=await this.PostToRuntimeComponentAsync("runtime","opus-decode",{arrayBuffer:e},null,[e]);return new Float32Array(t)}SetIsExportingToVideo(e){this._isExportingToVideo=!0,this._exportToVideoDuration=e}IsExportingToVideo(){return this._isExportingToVideo}GetExportToVideoDuration(){return this._exportToVideoDuration}IsAbsoluteURL(e){return/^(?:[a-z\-]+:)?\/\//.test(e)||"data:"===e.substr(0,5)||"blob:"===e.substr(0,5)}IsRelativeURL(e){return!this.IsAbsoluteURL(e)}async _MaybeGetPlatformSpecificScriptURL(t){if("cordova"===this._exportType&&(t.startsWith("file:")||this._isFileProtocol&&this.IsRelativeURL(t))){let e=t;e.startsWith(this._runtimeBaseUrl)&&(e=e.substr(this._runtimeBaseUrl.length));const n=await this.CordovaFetchLocalFileAsArrayBuffer(e),i=new Blob([n],{type:"application/javascript"});return URL.createObjectURL(i)}if("playable-ad-single-file"!==this._exportType)return t;if(this._localFileStrings.hasOwnProperty(t))return{isStringSrc:!0,str:this._localFileStrings[t]};if(this._localFileBlobs.hasOwnProperty(t))return URL.createObjectURL(this._localFileBlobs[t]);throw new Error("missing script: "+t)}async _OnCordovaFetchLocalFile(e){const t=e.filename;switch(e.as){case"text":return this.CordovaFetchLocalFileAsText(t);case"buffer":return this.CordovaFetchLocalFileAsArrayBuffer(t);default:throw new Error("unsupported type")}}CordovaFetchLocalFile(e){const i=window.cordova.file.applicationDirectory+"www/"+e;return new Promise((t,n)=>{window.resolveLocalFileSystemURL(i,e=>{e.file(t,n)},n)})}async CordovaFetchLocalFileAsText(e){const t=await this.CordovaFetchLocalFile(e);return BlobToString(t)}_CordovaMaybeStartNextArrayBufferRead(){if(h0.length&&!(i>=j0)){i++;const e=h0.shift();this._CordovaDoFetchLocalFileAsAsArrayBuffer(e.filename,e.successCallback,e.errorCallback)}}CordovaFetchLocalFileAsArrayBuffer(e){return new Promise((t,n)=>{h0.push({filename:e,successCallback:e=>{i--,this._CordovaMaybeStartNextArrayBufferRead(),t(e)},errorCallback:e=>{i--,this._CordovaMaybeStartNextArrayBufferRead(),n(e)}}),this._CordovaMaybeStartNextArrayBufferRead()})}async _CordovaDoFetchLocalFileAsAsArrayBuffer(e,t,n){try{const i=await this.CordovaFetchLocalFile(e),s=await BlobToArrayBuffer(i);t(s)}catch(e){n(e)}}["_PlayableAdFetchBlob"](e){if(this._localFileBlobs.hasOwnProperty(e))return this._localFileBlobs[e];throw new Error("missing file: "+e)}_GetPermissionAPI(){const e=window.cordova&&window.cordova.plugins&&window.cordova.plugins.permissions;if("object"!=typeof e)throw new Error("Permission API is not loaded");return e}_MapPermissionID(e,t){const n=e[t];if("string"!=typeof n)throw new Error("Invalid permission name");return n}_HasPermission(n){const i=this._GetPermissionAPI();return new Promise((t,e)=>i.checkPermission(this._MapPermissionID(i,n),e=>t(!!e.hasPermission),e))}_RequestPermission(n){const i=this._GetPermissionAPI();return new Promise((t,e)=>i.requestPermission(this._MapPermissionID(i,n),e=>t(!!e.hasPermission),e))}async RequestPermissions(e){if("cordova"===this.GetExportType()&&!this.IsiOSCordova())for(const t of e){const n=await this._HasPermission(t);if(!n){const i=await this._RequestPermission(t);if(!1===i)return!1}}return!0}async RequirePermissions(...e){if(!1===await this.RequestPermissions(e))throw new Error("Permission not granted")}_OnWrapperMessage(e,t){if("entered-fullscreen"===e)P0._SetWrapperIsFullscreenFlag(!0),this._runtimeDomHandler._OnFullscreenChange();else if("exited-fullscreen"===e)P0._SetWrapperIsFullscreenFlag(!1),this._runtimeDomHandler._OnFullscreenChange();else if("object"==typeof e){const n=e.type;"directory-handles"===n?this._directoryHandles=t:"wrapper-init-response"===n?(this._wrapperInitResolve(e),this._wrapperInitResolve=null):"extension-message"===n?this.PostToRuntimeComponent("runtime","wrapper-extension-message",e):console.warn("Unknown wrapper message: ",e)}else console.warn("Unknown wrapper message: ",e)}_OnSendWrapperExtensionMessage(e){this._SendWrapperMessage({type:"extension-message",componentId:e.componentId,messageId:e.messageId,params:e.params||[],asyncId:e.asyncId})}_SendWrapperMessage(e){this.IsAnyWebView2Wrapper()?window.chrome.webview.postMessage(JSON.stringify(e)):"macos-wkwebview"===this._exportType?window.webkit.messageHandlers.C3Wrapper.postMessage(JSON.stringify(e)):"linux-cef"===this._exportType&&window.c3_linux_cef_sendmessage(JSON.stringify(e))}_SetupDesktopWrapperPolyfills(){window.moveTo=(e,t)=>{this._SendWrapperMessage({type:"set-window-position",windowX:Math.ceil(e),windowY:Math.ceil(t)})},window.resizeTo=(e,t)=>{this._SendWrapperMessage({type:"set-window-size",windowWidth:Math.ceil(e),windowHeight:Math.ceil(t)})}}_InitWrapper(){return new Promise(e=>{this._wrapperInitResolve=e,this._SendWrapperMessage({type:"wrapper-init"})})}_GetDirectoryHandles(){return this._directoryHandles}async _ConvertDataUrisToBlobs(){const e=[];for(const[t,n]of Object.entries(this._localFileBlobs))e.push(this._ConvertDataUriToBlobs(t,n));await Promise.all(e)}async _ConvertDataUriToBlobs(t,n){if("object"==typeof n)this._localFileBlobs[t]=new Blob([n.str],{type:n.type}),this._localFileStrings[t]=n.str;else{let e=await this._FetchDataUri(n);e=e||this._DataURIToBinaryBlobSync(n),this._localFileBlobs[t]=e}}async _FetchDataUri(e){try{const t=await fetch(e);return await t.blob()}catch(e){return console.warn("Failed to fetch a data: URI. Falling back to a slower workaround. This is probably because the Content Security Policy unnecessarily blocked it. Allow data: URIs in your CSP to avoid this.",e),null}}_DataURIToBinaryBlobSync(e){const t=this._ParseDataURI(e);return this._BinaryStringToBlob(t.data,t.mime_type)}_ParseDataURI(e){const t=e.indexOf(",");if(t<0)throw new URIError("expected comma in data: uri");const n=e.substring(5,t),i=e.substring(t+1),s=n.split(";"),r=s[0]||"",o=s[1],a=s[2];return{mime_type:r,data:("base64"===o||"base64"===a?atob:decodeURIComponent)(i)}}_BinaryStringToBlob(e,t){let n=e.length,i=n>>2,s=new Uint8Array(n),r=new Uint32Array(s.buffer,0,i),o,a;for(o=0,a=0;o<i;++o)r[o]=e.charCodeAt(a++)|e.charCodeAt(a++)<<8|e.charCodeAt(a++)<<16|e.charCodeAt(a++)<<24;let l=3&n;for(;l--;)s[a]=e.charCodeAt(a),++a;return new Blob([s],{type:t})}}}{const Od=self.RuntimeInterface;function IsCompatibilityMouseEvent(e){return e.sourceCapabilities&&e.sourceCapabilities.firesTouchEvents||e.originalEvent&&e.originalEvent.sourceCapabilities&&e.originalEvent.sourceCapabilities.firesTouchEvents}const Pd=new Map([["OSLeft","MetaLeft"],["OSRight","MetaRight"]]),Qd={dispatchRuntimeEvent:!0,dispatchUserScriptEvent:!0},Rd={dispatchUserScriptEvent:!0},Sd={dispatchRuntimeEvent:!0};function AddStyleSheet(i){return new Promise((e,t)=>{const n=document.createElement("link");n.onload=()=>e(n),n.onerror=e=>t(e),n.rel="stylesheet",n.href=i,document.head.appendChild(n)})}function FetchImage(i){return new Promise((e,t)=>{const n=new Image;n.onload=()=>e(n),n.onerror=e=>t(e),n.src=i})}async function BlobToImage(e){const t=URL.createObjectURL(e);try{return await FetchImage(t)}finally{URL.revokeObjectURL(t)}}function BlobToString(i){return new Promise((t,n)=>{let e=new FileReader;e.onload=e=>t(e.target.result),e.onerror=e=>n(e),e.readAsText(i)})}function IsInContentEditable(e){do{if(e.parentNode&&e.hasAttribute("contenteditable"))return!0}while(e=e.parentNode);return!1}const Td=new Set(["input","textarea","datalist","select"]);function IsKeyboardInputElement(e){return Td.has(e.tagName.toLowerCase())||IsInContentEditable(e)}const Ud=new Set(["canvas","body","html"]);function PreventDefaultOnCanvasOrDoc(e){if(e.target.tagName){const t=e.target.tagName.toLowerCase();Ud.has(t)&&e.preventDefault()}}function PreventDefaultOnHTMLWrap(e){e.target.tagName&&e.target.classList.contains("c3htmlwrap")&&e.preventDefault()}function BlockWheelZoom(e){(e.metaKey||e.ctrlKey)&&e.preventDefault()}self.C3_GetSvgImageSize=async function(e){const t=await BlobToImage(e);if(0<t.width&&0<t.height)return[t.width,t.height];{t.style.position="absolute",t.style.left="0px",t.style.top="0px",t.style.visibility="hidden",document.body.appendChild(t);const n=t.getBoundingClientRect();return document.body.removeChild(t),[n.width,n.height]}};let e=!(self.C3_RasterSvgImageBlob=async function(e,t,n,i,s){const r=await BlobToImage(e),o=document.createElement("canvas"),a=(o.width=i,o.height=s,o.getContext("2d"));return a.drawImage(r,0,0,t,n),o});function ParentHasFocus(){try{return window.parent&&window.parent.document.hasFocus()}catch(e){return!1}}document.addEventListener("pause",()=>e=!0),document.addEventListener("resume",()=>e=!1);const Wd="runtime",Xd=class extends self.DOMHandler{constructor(e){super(e,Wd),this._enableWindowResizeEvent=!1,this._simulatedResizeTimerId=-1,this._targetOrientation="any",this._attachedDeviceOrientationEvent=!1,this._attachedDeviceMotionEvent=!1,this._pageVisibilityIsHidden=!1,this._screenReaderTextWrap=document.createElement("div"),this._screenReaderTextWrap.className="c3-screen-reader-text",this._screenReaderTextWrap.setAttribute("aria-live","polite"),document.body.appendChild(this._screenReaderTextWrap),this._debugHighlightElem=null,this._isExportToVideo=!1,this._exportVideoProgressMessage="",this._exportVideoUpdateTimerId=-1,this._enableAndroidVKDetection=!1,this._lastWindowWidth=e._GetWindowInnerWidth(),this._lastWindowHeight=e._GetWindowInnerHeight(),this._virtualKeyboardHeight=0,this._vkTranslateYOffset=0,e.AddRuntimeComponentMessageHandler("runtime","invoke-download",e=>this._OnInvokeDownload(e)),e.AddRuntimeComponentMessageHandler("runtime","load-webfonts",e=>this._OnLoadWebFonts(e)),e.AddRuntimeComponentMessageHandler("runtime","raster-svg-image",e=>this._OnRasterSvgImage(e)),e.AddRuntimeComponentMessageHandler("runtime","get-svg-image-size",e=>this._OnGetSvgImageSize(e)),e.AddRuntimeComponentMessageHandler("runtime","set-target-orientation",e=>this._OnSetTargetOrientation(e)),e.AddRuntimeComponentMessageHandler("runtime","register-sw",()=>this._OnRegisterSW()),e.AddRuntimeComponentMessageHandler("runtime","post-to-debugger",e=>this._OnPostToDebugger(e)),e.AddRuntimeComponentMessageHandler("runtime","go-to-script",e=>this._OnPostToDebugger(e)),e.AddRuntimeComponentMessageHandler("runtime","before-start-ticking",()=>this._OnBeforeStartTicking()),e.AddRuntimeComponentMessageHandler("runtime","debug-highlight",e=>this._OnDebugHighlight(e)),e.AddRuntimeComponentMessageHandler("runtime","enable-device-orientation",()=>this._AttachDeviceOrientationEvent()),e.AddRuntimeComponentMessageHandler("runtime","enable-device-motion",()=>this._AttachDeviceMotionEvent()),e.AddRuntimeComponentMessageHandler("runtime","add-stylesheet",e=>this._OnAddStylesheet(e)),e.AddRuntimeComponentMessageHandler("runtime","script-create-worker",e=>this._OnScriptCreateWorker(e)),e.AddRuntimeComponentMessageHandler("runtime","alert",e=>this._OnAlert(e)),e.AddRuntimeComponentMessageHandler("runtime","screen-reader-text",e=>this._OnScreenReaderTextEvent(e)),e.AddRuntimeComponentMessageHandler("runtime","hide-cordova-splash",()=>this._OnHideCordovaSplash()),e.AddRuntimeComponentMessageHandler("runtime","set-exporting-to-video",e=>this._SetExportingToVideo(e)),e.AddRuntimeComponentMessageHandler("runtime","export-to-video-progress",e=>this._OnExportVideoProgress(e)),e.AddRuntimeComponentMessageHandler("runtime","exported-to-video",e=>this._OnExportedToVideo(e)),e.AddRuntimeComponentMessageHandler("runtime","exported-to-image-sequence",e=>this._OnExportedToImageSequence(e));const i=new Set(["input","textarea","datalist"]);if(window.addEventListener("contextmenu",e=>{const t=e.target,n=t.tagName.toLowerCase();i.has(n)||IsInContentEditable(t)||e.preventDefault()}),window.addEventListener("selectstart",PreventDefaultOnCanvasOrDoc),window.addEventListener("gesturehold",PreventDefaultOnCanvasOrDoc),window.addEventListener("touchstart",PreventDefaultOnCanvasOrDoc,{passive:!1}),window.addEventListener("pointerdown",PreventDefaultOnCanvasOrDoc,{passive:!1}),this._mousePointerLastButtons=0,window.addEventListener("mousedown",e=>{1===e.button&&e.preventDefault()}),window.addEventListener("mousewheel",BlockWheelZoom,{passive:!1}),window.addEventListener("wheel",BlockWheelZoom,{passive:!1}),window.addEventListener("resize",()=>this._OnWindowResize()),window.addEventListener("fullscreenchange",()=>this._OnFullscreenChange()),window.addEventListener("webkitfullscreenchange",()=>this._OnFullscreenChange()),window.addEventListener("mozfullscreenchange",()=>this._OnFullscreenChange()),window.addEventListener("fullscreenerror",e=>this._OnFullscreenError(e)),window.addEventListener("webkitfullscreenerror",e=>this._OnFullscreenError(e)),window.addEventListener("mozfullscreenerror",e=>this._OnFullscreenError(e)),e.IsiOSWebView()){let t=1/0;window.visualViewport.addEventListener("resize",()=>{const e=window.visualViewport.height;e>t&&(document.scrollingElement.scrollTop=0,document.scrollingElement.scrollLeft=0),t=e}),document.documentElement.setAttribute("ioswebview","")}this._mediaPendingPlay=new Set,this._mediaRemovedPendingPlay=new WeakSet,this._isSilent=!1}_AddDefaultCanvasEventHandlers(e){e.addEventListener("selectstart",PreventDefaultOnCanvasOrDoc),e.addEventListener("gesturehold",PreventDefaultOnCanvasOrDoc),e.addEventListener("pointerdown",PreventDefaultOnCanvasOrDoc)}_AddDefaultHTMLWrapEventHandlers(e){e.addEventListener("selectstart",PreventDefaultOnHTMLWrap),e.addEventListener("gesturehold",PreventDefaultOnHTMLWrap),e.addEventListener("touchstart",PreventDefaultOnHTMLWrap)}_OnBeforeStartTicking(){return self.setTimeout(()=>{this._enableAndroidVKDetection=!0},1e3),"cordova"===this._iRuntime.GetExportType()?(document.addEventListener("pause",()=>this._OnVisibilityChange(!0)),document.addEventListener("resume",()=>this._OnVisibilityChange(!1))):document.addEventListener("visibilitychange",()=>this._OnVisibilityChange("hidden"===document.visibilityState)),this._pageVisibilityIsHidden=!("hidden"!==document.visibilityState&&!e),{isSuspended:this._pageVisibilityIsHidden}}Attach(){window.addEventListener("focus",()=>this._PostRuntimeEvent("window-focus")),window.addEventListener("blur",()=>{this._PostRuntimeEvent("window-blur",{parentHasFocus:ParentHasFocus()}),this._mousePointerLastButtons=0}),window.addEventListener("focusin",e=>{IsKeyboardInputElement(e.target)&&this._PostRuntimeEvent("keyboard-blur")}),window.addEventListener("keydown",e=>this._OnKeyEvent("keydown",e)),window.addEventListener("keyup",e=>this._OnKeyEvent("keyup",e)),window.addEventListener("mousedown",e=>this._OnMouseEvent("mousedown",e,Rd)),window.addEventListener("mousemove",e=>this._OnMouseEvent("mousemove",e,Rd)),window.addEventListener("mouseup",e=>this._OnMouseEvent("mouseup",e,Rd)),window.addEventListener("dblclick",e=>this._OnMouseEvent("dblclick",e,Qd)),window.addEventListener("wheel",e=>this._OnMouseWheelEvent("wheel",e,Qd)),window.addEventListener("pointerdown",e=>{this._HandlePointerDownFocus(e),this._OnPointerEvent("pointerdown",e)}),this._iRuntime.UsesWorker()&&void 0!==window.onpointerrawupdate&&self===self.top?window.addEventListener("pointerrawupdate",e=>this._OnPointerRawUpdate(e)):window.addEventListener("pointermove",e=>this._OnPointerEvent("pointermove",e)),window.addEventListener("pointerup",e=>this._OnPointerEvent("pointerup",e)),window.addEventListener("pointercancel",e=>this._OnPointerEvent("pointercancel",e));const e=()=>this._PlayPendingMedia();window.addEventListener("pointerup",e,!0),window.addEventListener("touchend",e,!0),window.addEventListener("click",e,!0),window.addEventListener("keydown",e,!0),window.addEventListener("gamepadconnected",e,!0),this._iRuntime.IsAndroid()&&!this._iRuntime.IsAndroidWebView()&&navigator.virtualKeyboard&&(navigator.virtualKeyboard.overlaysContent=!0,navigator.virtualKeyboard.addEventListener("geometrychange",()=>{this._OnAndroidVirtualKeyboardChange(this._GetWindowInnerHeight(),navigator.virtualKeyboard.boundingRect.height)})),this._iRuntime.IsiOSWebView()&&(document.scrollingElement.scrollTop=0,document.scrollingElement.scrollLeft=0)}_OnAndroidVirtualKeyboardChange(t,n){if(document.body.style.position="",document.body.style.overflow="",document.body.style.transform="",(this._vkTranslateYOffset=0)<n){const i=document.activeElement;if(i){const s=i.getBoundingClientRect(),r=(s.top+s.bottom)/2,o=(t-n)/2;let e=r-o;0<(e=(e=n<e?n:e)<0?0:e)&&(document.body.style.position="absolute",document.body.style.overflow="visible",document.body.style.transform=`translateY(${-e}px)`,this._vkTranslateYOffset=e)}}}_PostRuntimeEvent(e,t){this.PostToRuntime(e,t||null,Sd)}_GetWindowInnerWidth(){return this._iRuntime._GetWindowInnerWidth()}_GetWindowInnerHeight(){return this._iRuntime._GetWindowInnerHeight()}_EnableWindowResizeEvent(){this._enableWindowResizeEvent=!0,this._lastWindowWidth=this._iRuntime._GetWindowInnerWidth(),this._lastWindowHeight=this._iRuntime._GetWindowInnerHeight()}_OnWindowResize(){if(!this._isExportToVideo&&this._enableWindowResizeEvent){const e=this._GetWindowInnerWidth(),t=this._GetWindowInnerHeight();if(this._iRuntime.IsAndroidWebView()){if(this._enableAndroidVKDetection){const n=this._iRuntime.CanDoAndroidVirtualKeyboardDetection();if(n&&this._lastWindowWidth===e&&t<this._lastWindowHeight)return this._virtualKeyboardHeight=this._lastWindowHeight-t,void this._OnAndroidVirtualKeyboardChange(this._lastWindowHeight,this._virtualKeyboardHeight);0<this._virtualKeyboardHeight&&(this._virtualKeyboardHeight=0,this._OnAndroidVirtualKeyboardChange(t,this._virtualKeyboardHeight))}this._lastWindowWidth=e,this._lastWindowHeight=t}this.PostToRuntime("window-resize",{innerWidth:e,innerHeight:t,devicePixelRatio:window.devicePixelRatio,isFullscreen:Od.IsDocumentFullscreen(),cssDisplayMode:this._iRuntime.GetCssDisplayMode()}),this._iRuntime.IsiOSWebView()&&(-1!==this._simulatedResizeTimerId&&clearTimeout(this._simulatedResizeTimerId),this._OnSimulatedResize(e,t,0))}}_ScheduleSimulatedResize(e,t,n){-1!==this._simulatedResizeTimerId&&clearTimeout(this._simulatedResizeTimerId),this._simulatedResizeTimerId=setTimeout(()=>this._OnSimulatedResize(e,t,n),48)}_OnSimulatedResize(e,t,n){const i=this._GetWindowInnerWidth(),s=this._GetWindowInnerHeight();this._simulatedResizeTimerId=-1,i!=e||s!=t?this.PostToRuntime("window-resize",{innerWidth:i,innerHeight:s,devicePixelRatio:window.devicePixelRatio,isFullscreen:Od.IsDocumentFullscreen(),cssDisplayMode:this._iRuntime.GetCssDisplayMode()}):n<10&&this._ScheduleSimulatedResize(i,s,n+1)}_OnSetTargetOrientation(e){this._targetOrientation=e.targetOrientation}_TrySetTargetOrientation(){const t=this._targetOrientation;if(screen.orientation&&screen.orientation.lock)screen.orientation.lock(t).catch(e=>console.warn("[Construct] Failed to lock orientation: ",e));else try{let e=!1;screen.lockOrientation?e=screen.lockOrientation(t):screen.webkitLockOrientation?e=screen.webkitLockOrientation(t):screen.mozLockOrientation?e=screen.mozLockOrientation(t):screen.msLockOrientation&&(e=screen.msLockOrientation(t)),e||console.warn("[Construct] Failed to lock orientation")}catch(e){console.warn("[Construct] Failed to lock orientation: ",e)}}_OnFullscreenChange(){if(!this._isExportToVideo){const e=Od.IsDocumentFullscreen();e&&"any"!==this._targetOrientation&&this._TrySetTargetOrientation(),this.PostToRuntime("fullscreenchange",{isFullscreen:e,innerWidth:this._GetWindowInnerWidth(),innerHeight:this._GetWindowInnerHeight()})}}_OnFullscreenError(e){console.warn("[Construct] Fullscreen request failed: ",e),this.PostToRuntime("fullscreenerror",{isFullscreen:Od.IsDocumentFullscreen(),innerWidth:this._GetWindowInnerWidth(),innerHeight:this._GetWindowInnerHeight()})}_OnVisibilityChange(e){if(this._pageVisibilityIsHidden!==e&&((this._pageVisibilityIsHidden=e)?this._iRuntime._CancelAnimationFrame():this._iRuntime._RequestAnimationFrame(),this.PostToRuntime("visibilitychange",{hidden:e}),!e)&&this._iRuntime.IsiOSWebView()){const t=()=>{document.scrollingElement.scrollTop=0,document.scrollingElement.scrollLeft=0};setTimeout(t,50),setTimeout(t,100),setTimeout(t,250),setTimeout(t,500)}}_OnKeyEvent(e,t){if(void 0!==t.key&&("Backspace"===t.key&&PreventDefaultOnCanvasOrDoc(t),"nwjs"===this._iRuntime.GetExportType()&&"u"===t.key&&(t.ctrlKey||t.metaKey)&&t.preventDefault(),!this._isExportToVideo)){const n=Pd.get(t.code)||t.code;this._PostToRuntimeMaybeSync(e,{code:n,key:t.key,which:t.which,repeat:t.repeat,altKey:t.altKey,ctrlKey:t.ctrlKey,metaKey:t.metaKey,shiftKey:t.shiftKey,timeStamp:t.timeStamp},Qd)}}_OnMouseWheelEvent(e,t,n){this._isExportToVideo||this.PostToRuntime(e,{clientX:t.clientX,clientY:t.clientY+this._vkTranslateYOffset,pageX:t.pageX,pageY:t.pageY+this._vkTranslateYOffset,deltaX:t.deltaX,deltaY:t.deltaY,deltaZ:t.deltaZ,deltaMode:t.deltaMode,timeStamp:t.timeStamp},n)}_OnMouseEvent(e,t,n){this._isExportToVideo||IsCompatibilityMouseEvent(t)||this._PostToRuntimeMaybeSync(e,{button:t.button,buttons:t.buttons,clientX:t.clientX,clientY:t.clientY+this._vkTranslateYOffset,pageX:t.pageX,pageY:t.pageY+this._vkTranslateYOffset,movementX:t.movementX||0,movementY:t.movementY||0,timeStamp:t.timeStamp},n)}_OnPointerEvent(t,n){if(!this._isExportToVideo){let e=0;"mouse"===n.pointerType&&(e=this._mousePointerLastButtons),this._PostToRuntimeMaybeSync(t,{pointerId:n.pointerId,pointerType:n.pointerType,button:n.button,buttons:n.buttons,lastButtons:e,clientX:n.clientX,clientY:n.clientY+this._vkTranslateYOffset,pageX:n.pageX,pageY:n.pageY+this._vkTranslateYOffset,movementX:n.movementX||0,movementY:n.movementY||0,width:n.width||0,height:n.height||0,pressure:n.pressure||0,tangentialPressure:n.tangentialPressure||0,tiltX:n.tiltX||0,tiltY:n.tiltY||0,twist:n.twist||0,timeStamp:n.timeStamp},Qd),"mouse"===n.pointerType&&(this._mousePointerLastButtons=n.buttons)}}_OnPointerRawUpdate(e){this._OnPointerEvent("pointermove",e)}_OnTouchEvent(n,i){if(!this._isExportToVideo)for(let e=0,t=i.changedTouches.length;e<t;++e){const s=i.changedTouches[e];this._PostToRuntimeMaybeSync(n,{pointerId:s.identifier,pointerType:"touch",button:0,buttons:0,lastButtons:0,clientX:s.clientX,clientY:s.clientY+this._vkTranslateYOffset,pageX:s.pageX,pageY:s.pageY+this._vkTranslateYOffset,movementX:i.movementX||0,movementY:i.movementY||0,width:2*(s.radiusX||s.webkitRadiusX||0),height:2*(s.radiusY||s.webkitRadiusY||0),pressure:s.force||s.webkitForce||0,tangentialPressure:0,tiltX:0,tiltY:0,twist:s.rotationAngle||0,timeStamp:i.timeStamp},Qd)}}_HandlePointerDownFocus(e){window!==window.top&&window.focus(),this._IsElementCanvasOrDocument(e.target)&&document.activeElement&&!this._IsElementCanvasOrDocument(document.activeElement)&&document.activeElement.blur()}_IsElementCanvasOrDocument(e){return!e||e===document||e===window||e===document.body||"canvas"===e.tagName.toLowerCase()}_AttachDeviceOrientationEvent(){this._attachedDeviceOrientationEvent||(this._attachedDeviceOrientationEvent=!0,window.addEventListener("deviceorientation",e=>this._OnDeviceOrientation(e)),window.addEventListener("deviceorientationabsolute",e=>this._OnDeviceOrientationAbsolute(e)))}_AttachDeviceMotionEvent(){this._attachedDeviceMotionEvent||(this._attachedDeviceMotionEvent=!0,window.addEventListener("devicemotion",e=>this._OnDeviceMotion(e)))}_OnDeviceOrientation(e){this._isExportToVideo||this.PostToRuntime("deviceorientation",{absolute:!!e.absolute,alpha:e.alpha||0,beta:e.beta||0,gamma:e.gamma||0,timeStamp:e.timeStamp,webkitCompassHeading:e.webkitCompassHeading,webkitCompassAccuracy:e.webkitCompassAccuracy},Qd)}_OnDeviceOrientationAbsolute(e){this._isExportToVideo||this.PostToRuntime("deviceorientationabsolute",{absolute:!!e.absolute,alpha:e.alpha||0,beta:e.beta||0,gamma:e.gamma||0,timeStamp:e.timeStamp},Qd)}_OnDeviceMotion(i){if(!this._isExportToVideo){let e=null;const s=i.acceleration;s&&(e={x:s.x||0,y:s.y||0,z:s.z||0});let t=null;const r=i.accelerationIncludingGravity;r&&(t={x:r.x||0,y:r.y||0,z:r.z||0});let n=null;const o=i.rotationRate;o&&(n={alpha:o.alpha||0,beta:o.beta||0,gamma:o.gamma||0}),this.PostToRuntime("devicemotion",{acceleration:e,accelerationIncludingGravity:t,rotationRate:n,interval:i.interval,timeStamp:i.timeStamp},Qd)}}_OnInvokeDownload(e){const t=e.url,n=e.filename,i=document.createElement("a"),s=document.body;i.textContent=n,i.href=t,i.download=n,s.appendChild(i),i.click(),s.removeChild(i)}async _OnLoadWebFonts(e){const t=e.webfonts;await Promise.all(t.map(async e=>{const t=new FontFace(e.name,`url('${e.url}')`);document.fonts.add(t),await t.load()}))}async _OnRasterSvgImage(e){const t=e.blob,n=e.imageWidth,i=e.imageHeight,s=e.surfaceWidth,r=e.surfaceHeight,o=e.imageBitmapOpts,a=await self.C3_RasterSvgImageBlob(t,n,i,s,r);let l;return{imageBitmap:l=o?await createImageBitmap(a,o):await createImageBitmap(a),transferables:[l]}}async _OnGetSvgImageSize(e){return self.C3_GetSvgImageSize(e.blob)}async _OnAddStylesheet(e){await AddStyleSheet(e.url)}_PlayPendingMedia(){const e=[...this._mediaPendingPlay];if(this._mediaPendingPlay.clear(),!this._isSilent)for(const t of e){const n=t.play();n&&n.catch(e=>{this._mediaRemovedPendingPlay.has(t)||this._mediaPendingPlay.add(t)})}}TryPlayMedia(t){if("function"!=typeof t.play)throw new Error("missing play function");this._mediaRemovedPendingPlay.delete(t);let e;try{e=t.play()}catch(e){return void this._mediaPendingPlay.add(t)}e&&e.catch(e=>{this._mediaRemovedPendingPlay.has(t)||this._mediaPendingPlay.add(t)})}RemovePendingPlay(e){this._mediaPendingPlay.delete(e),this._mediaRemovedPendingPlay.add(e)}SetSilent(e){this._isSilent=!!e}_OnHideCordovaSplash(){navigator.splashscreen&&navigator.splashscreen.hide&&navigator.splashscreen.hide()}_OnDebugHighlight(e){const t=e.show;if(t){this._debugHighlightElem||(this._debugHighlightElem=document.createElement("div"),this._debugHighlightElem.id="inspectOutline",document.body.appendChild(this._debugHighlightElem));const n=this._debugHighlightElem;n.style.display="",n.style.left=e.left-1+"px",n.style.top=e.top-1+"px",n.style.width=e.width+2+"px",n.style.height=e.height+2+"px",n.textContent=e.name}else this._debugHighlightElem&&(this._debugHighlightElem.style.display="none")}_OnRegisterSW(){window.C3_RegisterSW&&window.C3_RegisterSW()}_OnPostToDebugger(e){window.c3_postToMessagePort&&(e.from="runtime",window.c3_postToMessagePort(e))}_InvokeFunctionFromJS(e,t){return this.PostToRuntimeAsync("js-invoke-function",{name:e,params:t})}_OnScriptCreateWorker(e){const t=e.url,n=e.opts,i=e.port2,s=new Worker(t,n);s.postMessage({type:"construct-worker-init",port2:i},[i])}_OnAlert(e){alert(e.message)}_OnScreenReaderTextEvent(e){const t=e.type;if("create"===t){const n=document.createElement("p");n.id="c3-sr-"+e.id,n.textContent=e.text,this._screenReaderTextWrap.appendChild(n)}else if("update"===t){const i=document.getElementById("c3-sr-"+e.id);i?i.textContent=e.text:console.warn("[Construct] Missing screen reader text with id "+e.id)}else if("release"===t){const s=document.getElementById("c3-sr-"+e.id);s?s.remove():console.warn("[Construct] Missing screen reader text with id "+e.id)}else console.warn(`[Construct] Unknown screen reader text update '${t}'`)}_SetExportingToVideo(e){this._isExportToVideo=!0;const t=document.createElement("h1");t.id="exportToVideoMessage",t.textContent=e.message,document.body.prepend(t),document.body.classList.add("exportingToVideo"),this.GetRuntimeInterface().GetMainCanvas().style.display="",this._iRuntime.SetIsExportingToVideo(e.duration)}_OnExportVideoProgress(e){this._exportVideoProgressMessage=e.message,-1===this._exportVideoUpdateTimerId&&(this._exportVideoUpdateTimerId=setTimeout(()=>this._DoUpdateExportVideoProgressMessage(),250))}_DoUpdateExportVideoProgressMessage(){this._exportVideoUpdateTimerId=-1;const e=document.getElementById("exportToVideoMessage");e&&(e.textContent=this._exportVideoProgressMessage)}_OnExportedToVideo(e){window.c3_postToMessagePort({type:"exported-video",arrayBuffer:e.arrayBuffer,contentType:e.contentType,time:e.time})}_OnExportedToImageSequence(e){window.c3_postToMessagePort({type:"exported-image-sequence",blobArr:e.blobArr,time:e.time,gif:e.gif})}};Od.AddDOMHandlerClass(Xd)}{const Cf="dispatchworker.js",Df="jobworker.js";self.JobSchedulerDOM=class{constructor(e){this._runtimeInterface=e,this._maxNumWorkers=Math.min(navigator.hardwareConcurrency||2,16),this._dispatchWorker=null,this._jobWorkers=[],this._inputPort=null,this._outputPort=null}async Init(){if(this._hasInitialised)throw new Error("already initialised");this._hasInitialised=!0;const e=this._runtimeInterface.GetScriptFolder()+Cf,t=(this._dispatchWorker=await this._runtimeInterface.CreateWorker(e,{name:"DispatchWorker"}),new MessageChannel);this._inputPort=t.port1,this._dispatchWorker.postMessage({type:"_init","in-port":t.port2},[t.port2]),this._outputPort=await this._CreateJobWorker()}async _CreateJobWorker(){const e=this._jobWorkers.length,t=this._runtimeInterface.GetScriptFolder()+Df,n=await this._runtimeInterface.CreateWorker(t,{name:"JobWorker"+e}),i=new MessageChannel,s=new MessageChannel;return this._dispatchWorker.postMessage({type:"_addJobWorker",port:i.port1},[i.port1]),n.postMessage({type:"init",number:e,"dispatch-port":i.port2,"output-port":s.port2},[i.port2,s.port2]),this._jobWorkers.push(n),s.port1}GetPortData(){return{inputPort:this._inputPort,outputPort:this._outputPort,maxNumWorkers:this._maxNumWorkers}}GetPortTransferables(){return[this._inputPort,this._outputPort]}}}{const Mf="touch",Nf=class extends self.DOMHandler{constructor(e){super(e,Mf),this.AddRuntimeMessageHandler("request-permission",e=>this._OnRequestPermission(e))}async _OnRequestPermission(e){const t=e.type;let n=!0;0===t?n=await this._RequestOrientationPermission():1===t&&(n=await this._RequestMotionPermission()),this.PostToRuntime("permission-result",{type:t,result:n})}async _RequestOrientationPermission(){if(!self.DeviceOrientationEvent||!self.DeviceOrientationEvent.requestPermission)return!0;try{const e=await self.DeviceOrientationEvent.requestPermission();return"granted"===e}catch(e){return console.warn("[Touch] Failed to request orientation permission: ",e),!1}}async _RequestMotionPermission(){if(!self.DeviceMotionEvent||!self.DeviceMotionEvent.requestPermission)return!0;try{const e=await self.DeviceMotionEvent.requestPermission();return"granted"===e}catch(e){return console.warn("[Touch] Failed to request motion permission: ",e),!1}}};self.RuntimeInterface.AddDOMHandlerClass(Nf)}{const Xf="mouse",Yf=class extends self.DOMHandler{constructor(e){super(e,Xf),this.AddRuntimeMessageHandlers([["cursor",e=>this._OnChangeCursorStyle(e)],["request-pointer-lock",e=>this._OnRequestPointerLock(e)],["release-pointer-lock",()=>this._OnReleasePointerLock()]]),document.addEventListener("pointerlockchange",e=>this._OnPointerLockChange()),document.addEventListener("pointerlockerror",e=>this._OnPointerLockError())}_OnChangeCursorStyle(e){document.documentElement.style.cursor=e}_OnRequestPointerLock(e){this._iRuntime.GetMainCanvas().requestPointerLock(e)}_OnReleasePointerLock(){document.exitPointerLock()}_OnPointerLockChange(){this.PostToRuntime("pointer-lock-change",{"has-pointer-lock":!!document.pointerLockElement})}_OnPointerLockError(){this.PostToRuntime("pointer-lock-error",{"has-pointer-lock":!!document.pointerLockElement})}};self.RuntimeInterface.AddDOMHandlerClass(Yf)}if(window.C3_Is_Supported){const e5=!1;window.c3_runtimeInterface=new self.RuntimeInterface({useWorker:e5,workerMainUrl:"workermain.js",runtimeScriptList:["scripts/c3main.js"],scriptFolder:"scripts/",exportType:"playable-ad-single-file"})}
</script>


</body> 
</html>